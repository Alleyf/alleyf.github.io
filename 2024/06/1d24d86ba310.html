

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="http://qnpicmap.fcsluck.top/pics/202311162214229.png">
  <link rel="icon" href="http://qnpicmap.fcsluck.top/pics/202311162214229.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="fcs">
  <meta name="keywords" content="">
  
    <meta name="description" content="è¿ç»´æ’é”™è§£å†³é—®é¢˜çš„å¿…æŸ¥æ‰‹å†Œ">
<meta property="og:type" content="article">
<meta property="og:title" content="è¿ç»´æ’å¿§è§£éš¾">
<meta property="og:url" content="https://alleyf.github.io/2024/06/1d24d86ba310.html">
<meta property="og:site_name" content="alleyf">
<meta property="og:description" content="è¿ç»´æ’é”™è§£å†³é—®é¢˜çš„å¿…æŸ¥æ‰‹å†Œ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://picsum.photos/800/250">
<meta property="article:published_time" content="2024-06-27T16:37:11.000Z">
<meta property="article:modified_time" content="2026-01-03T14:29:34.154Z">
<meta property="article:author" content="alleyf">
<meta property="article:tag" content="DevOps">
<meta property="article:tag" content="è¿ç»´">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://picsum.photos/800/250">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>è¿ç»´æ’å¿§è§£éš¾ - alleyf</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"alleyf.github.io","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"d57048846da607439cf11718741f2eb0","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?d57048846da607439cf11718741f2eb0";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  

  

  



  
<!-- hexo injector head_end start --><script> let HEXO_MMEDIA_DATA = { js: [], css: [], aplayerData: [], metingData: [], artPlayerData: [], dplayerData: []}; </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="alleyf" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Mr.Alleyf</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/gallery/">
                <i class="iconfont icon-images"></i>
                ç”»å»Š
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml">
                <i class="iconfont icon-rss"></i>
                RSS
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" target="_blank" rel="noopener" href="https://github.com/Alleyf">
                <i class="iconfont icon-github-fill"></i>
                Github
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                å‹é“¾
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://api.likepoems.com/img/nature') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="è¿ç»´æ’å¿§è§£éš¾"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        fcs
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-06-28 00:37" pubdate>
          2024å¹´6æœˆ28æ—¥ å‡Œæ™¨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          23k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          189 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> æ¬¡
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">è¿ç»´æ’å¿§è§£éš¾</h1>
            
              <p class="note note-info">
                
                  
                    æœ¬æ–‡æœ€åæ›´æ–°äºï¼šå‡ ç§’å‰
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p><img src="https://picsum.photos/800/250" srcset="/img/loading.gif" lazyload></p>
<h1 id="1-å¸¸ç”¨æŒ‡ä»¤"><a href="#1-å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="1 å¸¸ç”¨æŒ‡ä»¤"></a>1 å¸¸ç”¨æŒ‡ä»¤</h1><blockquote>
<p>[!NOTE] ç¬¦å·è¯´æ˜<br>æŒ‡ä»¤ä¸­å°æ‹¬å· <code>()</code> å†…ä¸º<strong>é€‰å¡«é¡¹</strong>ï¼Œ<code>&lt;&gt;</code> ä¸º<strong>å¡«å……é¡¹</strong>ï¼ˆæ ¹æ®å®é™…å˜é‡è¿›è¡Œå¡«å……ï¼‰ã€‚</p>
</blockquote>
<h2 id="1-1-Linux-æŒ‡ä»¤"><a href="#1-1-Linux-æŒ‡ä»¤" class="headerlink" title="1.1 Linux æŒ‡ä»¤"></a>1.1 Linux æŒ‡ä»¤</h2><p><a href="source/_posts/%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/%E5%90%84%E7%A7%8D%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.md">å„ç§ç¯å¢ƒé…ç½®</a></p>
<h3 id="1-1-1-ç£ç›˜æ‰©å®¹"><a href="#1-1-1-ç£ç›˜æ‰©å®¹" class="headerlink" title="1.1.1 ç£ç›˜æ‰©å®¹"></a>1.1.1 ç£ç›˜æ‰©å®¹</h3><h4 id="1-1-1-1-å·²å­˜åœ¨ç£ç›˜ï¼ˆä½¿ç”¨ä½™é‡æ‰©å®¹åˆ†åŒºï¼‰"><a href="#1-1-1-1-å·²å­˜åœ¨ç£ç›˜ï¼ˆä½¿ç”¨ä½™é‡æ‰©å®¹åˆ†åŒºï¼‰" class="headerlink" title="1.1.1.1 å·²å­˜åœ¨ç£ç›˜ï¼ˆä½¿ç”¨ä½™é‡æ‰©å®¹åˆ†åŒºï¼‰"></a>1.1.1.1 å·²å­˜åœ¨ç£ç›˜ï¼ˆä½¿ç”¨ä½™é‡æ‰©å®¹åˆ†åŒºï¼‰</h4><h5 id="1-1-1-1-1-ç¡®è®¤å‰©ä½™ç©ºé—´"><a href="#1-1-1-1-1-ç¡®è®¤å‰©ä½™ç©ºé—´" class="headerlink" title="1.1.1.1.1 ç¡®è®¤å‰©ä½™ç©ºé—´"></a>1.1.1.1.1 <strong>ç¡®è®¤å‰©ä½™ç©ºé—´</strong></h5><p>ä½¿ç”¨ <code>lsblk</code> æˆ– <code>fdisk -l</code> æŸ¥çœ‹æ–°å¢ç£ç›˜çš„è®¾å¤‡åï¼ˆå¦‚ <code>/dev/sdb</code>ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo fdisk -l<br></code></pre></td></tr></table></figure>

<ol>
<li><p>â€‹<strong>æŸ¥çœ‹ç£ç›˜æ€»å®¹é‡</strong><br> <code>/dev/sda</code>Â æ€»å®¹é‡ä¸º 322.1GBï¼Œå·²åˆ†é…çš„åˆ†åŒºå¦‚ä¸‹ï¼š</p>
<ul>
<li><code>/dev/sda1</code>ï¼ˆå¯åŠ¨åˆ†åŒºï¼‰ï¼š1GB</li>
<li><code>/dev/sda2</code>ï¼ˆLVM ç‰©ç†å·ï¼‰ï¼š107.4GB<ul>
<li><code>centos-root</code>ï¼ˆæ ¹åˆ†åŒºï¼‰ï¼š53.7GB</li>
<li><code>centos-swap</code>ï¼ˆäº¤æ¢åˆ†åŒºï¼‰ï¼š5.3GB</li>
<li><code>centos-home</code>ï¼ˆç”¨æˆ·æ•°æ®åˆ†åŒºï¼‰ï¼š47.3GB</li>
</ul>
</li>
</ul>
</li>
<li><p>â€‹<strong>è®¡ç®—æœªä½¿ç”¨ç©ºé—´</strong><br> <code>sda2</code>Â çš„ç»“æŸæ‰‡åŒºä¸ºÂ <code>209715199</code>ï¼Œè€ŒÂ <code>/dev/sda</code>Â æ€»æ‰‡åŒºä¸ºÂ <code>629145600</code>ï¼Œæœªåˆ†é…ç©ºé—´çº¦ä¸º â€‹<strong>214.7GB</strong>â€‹ï¼ˆ322.1GB - 107.4GBï¼‰</p>
</li>
<li><p><strong>æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿ</strong></p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lsblk -f<br></code></pre></td></tr></table></figure>

<h5 id="1-1-1-1-2-æ‰©å®¹æ ¹ç›®å½•é€»è¾‘å·"><a href="#1-1-1-1-2-æ‰©å®¹æ ¹ç›®å½•é€»è¾‘å·" class="headerlink" title="1.1.1.1.2 æ‰©å®¹æ ¹ç›®å½•é€»è¾‘å·"></a>1.1.1.1.2 <strong>æ‰©å®¹æ ¹ç›®å½•é€»è¾‘å·</strong></h5><h6 id="æ­¥éª¤-1ï¼šæ‰©å±•-Sda2-åˆ†åŒº"><a href="#æ­¥éª¤-1ï¼šæ‰©å±•-Sda2-åˆ†åŒº" class="headerlink" title="æ­¥éª¤ 1ï¼šæ‰©å±• Sda2 åˆ†åŒº"></a><strong>æ­¥éª¤ 1ï¼šæ‰©å±• Sda2 åˆ†åŒº</strong></h6><p>ç”±äºæœªåˆ†é…ç©ºé—´ä½äºÂ <code>sda2</code>Â ä¹‹åï¼Œéœ€å…ˆæ‰©å±•Â <code>sda2</code>Â åˆ†åŒºä»¥åŒ…å«å…¨éƒ¨ç£ç›˜ç©ºé—´ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo parted /dev/sda<br>(parted) resizepart 2 100%  <span class="hljs-comment"># å°†sda2æ‰©å±•åˆ°ç£ç›˜æœ«å°¾</span><br>(parted) quit<br></code></pre></td></tr></table></figure>

<h6 id="æ­¥éª¤-2ï¼šæ‰©å±•ç‰©ç†å·"><a href="#æ­¥éª¤-2ï¼šæ‰©å±•ç‰©ç†å·" class="headerlink" title="æ­¥éª¤ 2ï¼šæ‰©å±•ç‰©ç†å·"></a><strong>æ­¥éª¤ 2ï¼šæ‰©å±•ç‰©ç†å·</strong></h6><p>å°†æ–°å¢ç©ºé—´åŠ å…¥ LVM ç‰©ç†å·ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo pvresize /dev/sda2  <span class="hljs-comment"># è‡ªåŠ¨è¯†åˆ«æ‰©å±•åçš„ç©ºé—´</span><br></code></pre></td></tr></table></figure>

<h6 id="â€‹æ­¥éª¤-3ï¼šæ‰©å±•é€»è¾‘å·"><a href="#â€‹æ­¥éª¤-3ï¼šæ‰©å±•é€»è¾‘å·" class="headerlink" title="â€‹æ­¥éª¤ 3ï¼šæ‰©å±•é€»è¾‘å·"></a>â€‹<strong>æ­¥éª¤ 3ï¼šæ‰©å±•é€»è¾‘å·</strong></h6><ol>
<li>â€‹<strong>æŸ¥çœ‹å·ç»„ï¼ˆVGï¼‰ä¿¡æ¯</strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo vgdisplay centos  <span class="hljs-comment"># ç¡®è®¤VGåç§°ä¸º&quot;centos&quot;</span><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>â€‹<strong>æ‰©å±•æ ¹é€»è¾‘å·ï¼ˆLVï¼‰â€‹</strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo lvextend -l +100%FREE /dev/mapper/centos-root  <span class="hljs-comment"># å°†å‰©ä½™ç©ºé—´å…¨éƒ¨åˆ†é…ç»™æ ¹ç›®å½•</span><br></code></pre></td></tr></table></figure>

<h6 id="æ­¥éª¤-4ï¼šè°ƒæ•´æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ­¥éª¤-4ï¼šè°ƒæ•´æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ­¥éª¤ 4ï¼šè°ƒæ•´æ–‡ä»¶ç³»ç»Ÿ"></a><strong>æ­¥éª¤ 4ï¼šè°ƒæ•´æ–‡ä»¶ç³»ç»Ÿ</strong></h6><p>æ ¹æ®æ–‡ä»¶ç³»ç»Ÿç±»å‹æ‰§è¡Œæ‰©å®¹ï¼š</p>
<ul>
<li>â€‹<strong>ext4 æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo resize2fs /dev/mapper/centos-root<br></code></pre></td></tr></table></figure>

<ul>
<li>â€‹<strong>xfs æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo xfs_growfs /<br></code></pre></td></tr></table></figure>

<hr>
<h5 id="1-1-1-1-3-â€‹éªŒè¯ç»“æœ"><a href="#1-1-1-1-3-â€‹éªŒè¯ç»“æœ" class="headerlink" title="1.1.1.1.3 â€‹éªŒè¯ç»“æœ"></a>1.1.1.1.3 â€‹<strong>éªŒè¯ç»“æœ</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">df</span> -h /  <span class="hljs-comment"># æŸ¥çœ‹æ ¹ç›®å½•å®¹é‡æ˜¯å¦å¢åŠ </span><br>lsblk    <span class="hljs-comment"># ç¡®è®¤é€»è¾‘å·å¤§å°å˜åŒ–</span><br></code></pre></td></tr></table></figure>

<hr>
<h5 id="1-1-1-1-4-â€‹æ³¨æ„äº‹é¡¹"><a href="#1-1-1-1-4-â€‹æ³¨æ„äº‹é¡¹" class="headerlink" title="1.1.1.1.4 â€‹æ³¨æ„äº‹é¡¹"></a>1.1.1.1.4 â€‹<strong>æ³¨æ„äº‹é¡¹</strong></h5><ol>
<li>â€‹<strong>å¤‡ä»½æ•°æ®</strong><br> æ“ä½œå‰å»ºè®®å¯¹é‡è¦æ•°æ®å¤‡ä»½ï¼Œé¿å…æ‰©å®¹å¤±è´¥å¯¼è‡´æ•°æ®ä¸¢å¤±</li>
<li>â€‹<strong>æ–‡ä»¶ç³»ç»Ÿç±»å‹</strong><br> é€šè¿‡Â <code>lsblk -f</code>Â ç¡®è®¤æ ¹ç›®å½•æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆå¦‚ xfs æˆ– ext4ï¼‰ã€‚</li>
<li>â€‹<strong>åœ¨çº¿æ‰©å®¹</strong><br> è‹¥ä½¿ç”¨ xfs æ–‡ä»¶ç³»ç»Ÿï¼Œæ”¯æŒåœ¨çº¿æ‰©å®¹ï¼›ext4 éœ€ç¡®ä¿æ–‡ä»¶ç³»ç»ŸæœªæŸåã€‚</li>
</ol>
<hr>
<h5 id="1-1-1-1-5-â€‹æ‰©å±•åœºæ™¯ï¼ˆå¯é€‰ï¼‰â€‹"><a href="#1-1-1-1-5-â€‹æ‰©å±•åœºæ™¯ï¼ˆå¯é€‰ï¼‰â€‹" class="headerlink" title="1.1.1.1.5 â€‹æ‰©å±•åœºæ™¯ï¼ˆå¯é€‰ï¼‰â€‹"></a>1.1.1.1.5 â€‹<strong>æ‰©å±•åœºæ™¯ï¼ˆå¯é€‰ï¼‰â€‹</strong></h5><ul>
<li>â€‹<strong>è°ƒæ•´ home åˆ†åŒºç©ºé—´</strong><br>  è‹¥æ— éœ€ä¿ç•™homeåˆ†åŒºæ•°æ®ï¼Œå¯åˆ é™¤Â <code>/dev/mapper/centos-home</code>ï¼Œå°†å…¶ç©ºé—´åˆå¹¶åˆ°æ ¹ç›®å½•ï¼š</li>
</ul>
<ol>
<li>å¤‡ä»½ home æ•°æ®åå¸è½½ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo umount /home<br>sudo lvremove /dev/mapper/centos-home<br></code></pre></td></tr></table></figure>

<ol>
<li>æ‰©å±•æ ¹é€»è¾‘å·ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo lvextend -l +100%FREE /dev/mapper/centos-root<br>sudo resize2fs /dev/mapper/centos-root  <span class="hljs-comment"># æˆ–xfs_growfs</span><br></code></pre></td></tr></table></figure>

<hr>
<h4 id="1-1-1-2-æ–°å¢ç£ç›˜"><a href="#1-1-1-2-æ–°å¢ç£ç›˜" class="headerlink" title="1.1.1.2 æ–°å¢ç£ç›˜"></a>1.1.1.2 æ–°å¢ç£ç›˜</h4><h5 id="1-1-1-2-1-VSphere-ç»™è™šæ‹ŸæœºåŠ æ–°ç¡¬ç›˜"><a href="#1-1-1-2-1-VSphere-ç»™è™šæ‹ŸæœºåŠ æ–°ç¡¬ç›˜" class="headerlink" title="1.1.1.2.1 VSphere ç»™è™šæ‹ŸæœºåŠ æ–°ç¡¬ç›˜"></a>1.1.1.2.1 VSphere ç»™è™šæ‹ŸæœºåŠ æ–°ç¡¬ç›˜</h5><p><img src="http://img.fcs.cloudns.ch/pics/20250606171759126.png" srcset="/img/loading.gif" lazyload alt="image.png"><br>æ·»åŠ å®Œæˆç¡¬ç›˜åï¼Œé‡å¯è™šæ‹Ÿæœºä»¥è¯†åˆ«åˆ°æ–°ç¡¬ç›˜ã€‚</p>
<h5 id="1-1-1-2-2-æ–°ç¡¬ç›˜åˆ›å»ºç‰©ç†å·ï¼ˆPVï¼‰"><a href="#1-1-1-2-2-æ–°ç¡¬ç›˜åˆ›å»ºç‰©ç†å·ï¼ˆPVï¼‰" class="headerlink" title="1.1.1.2.2 æ–°ç¡¬ç›˜åˆ›å»ºç‰©ç†å·ï¼ˆPVï¼‰"></a>1.1.1.2.2 æ–°ç¡¬ç›˜åˆ›å»ºç‰©ç†å·ï¼ˆPVï¼‰</h5><p>é¦–å…ˆï¼Œä½ éœ€è¦å°† sdb ç£ç›˜è½¬åŒ–ä¸ºç‰©ç†å·ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pvcreate /dev/sdb<br></code></pre></td></tr></table></figure>

<h5 id="1-1-1-2-3-æ‰©å±•å·ç»„ï¼ˆVGï¼‰"><a href="#1-1-1-2-3-æ‰©å±•å·ç»„ï¼ˆVGï¼‰" class="headerlink" title="1.1.1.2.3 æ‰©å±•å·ç»„ï¼ˆVGï¼‰"></a>1.1.1.2.3 æ‰©å±•å·ç»„ï¼ˆVGï¼‰</h5><blockquote>
<p>å°†è¿™ä¸ªæ–°çš„ç‰©ç†å·åŠ å…¥åˆ°ç°æœ‰çš„å·ç»„ä¸­</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vgextend centos /dev/sdb<br></code></pre></td></tr></table></figure>

<h5 id="1-1-1-2-4-æ‰©å±•é€»è¾‘å·ï¼ˆLVï¼‰"><a href="#1-1-1-2-4-æ‰©å±•é€»è¾‘å·ï¼ˆLVï¼‰" class="headerlink" title="1.1.1.2.4 æ‰©å±•é€»è¾‘å·ï¼ˆLVï¼‰"></a>1.1.1.2.4 æ‰©å±•é€»è¾‘å·ï¼ˆLVï¼‰</h5><blockquote>
<p>ç°åœ¨å¯ä»¥æ‰©å±• &#x2F; æ ¹ç›®å½•æ‰€åœ¨çš„é€»è¾‘å·äº†ï¼Œä»¥å¢åŠ  100GB ä¸ºä¾‹ï¼ˆæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å¤§å°ï¼‰</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lvextend -L +100G /dev/centos/root<br></code></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœä½ æƒ³ä½¿ç”¨ sdb ä¸Šçš„æ‰€æœ‰ç©ºé—´</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lvextend -l +100%FREE /dev/centos/root<br></code></pre></td></tr></table></figure>

<h5 id="1-1-1-2-5-æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ"><a href="#1-1-1-2-5-æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="1.1.1.2.5 æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ"></a>1.1.1.2.5 æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ</h5><p>æœ€åä¸€æ­¥æ˜¯æ‰©å±•æ–‡ä»¶ç³»ç»Ÿä»¥ä½¿ç”¨æ–°å¢çš„ç©ºé—´ã€‚è¿™ä¸ªæ­¥éª¤ä¾èµ–äºä½  &#x2F; æ ¹ç›®å½•ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚</p>
<h6 id="å¦‚æœæ˜¯-ext4-æ–‡ä»¶ç³»ç»Ÿ"><a href="#å¦‚æœæ˜¯-ext4-æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="å¦‚æœæ˜¯ ext4 æ–‡ä»¶ç³»ç»Ÿ"></a>å¦‚æœæ˜¯ ext4 æ–‡ä»¶ç³»ç»Ÿ</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">resize2fs /dev/rl/root<br></code></pre></td></tr></table></figure>

<h6 id="å¦‚æœæ˜¯-XFS-æ–‡ä»¶ç³»ç»Ÿ"><a href="#å¦‚æœæ˜¯-XFS-æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="å¦‚æœæ˜¯ XFS æ–‡ä»¶ç³»ç»Ÿ"></a>å¦‚æœæ˜¯ XFS æ–‡ä»¶ç³»ç»Ÿ</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">xfs_growfs /<br></code></pre></td></tr></table></figure>


<h3 id="1-1-2-æ£€æŸ¥ç£ç›˜ç©ºé—´å¹¶æ¸…ç†"><a href="#1-1-2-æ£€æŸ¥ç£ç›˜ç©ºé—´å¹¶æ¸…ç†" class="headerlink" title="1.1.2 æ£€æŸ¥ç£ç›˜ç©ºé—´å¹¶æ¸…ç†"></a>1.1.2 æ£€æŸ¥ç£ç›˜ç©ºé—´å¹¶æ¸…ç†</h3><p>ä½ çš„ç³»ç»Ÿæ ¹åˆ†åŒº <code>/dev/mapper/centos-root</code> å·² <strong>100% æ»¡äº†</strong>ï¼ˆ196G å·²ç”¨å®Œï¼Œä»…å‰© 104Kï¼‰ï¼Œå¿…é¡»ç«‹å³æ¸…ç†ï¼Œå¦åˆ™ç³»ç»Ÿå¯èƒ½å´©æºƒã€æœåŠ¡å®•æœºã€æ— æ³•ç™»å½•ã€‚</p>
<hr>
<h4 id="1-1-2-1-ğŸ”-ç¬¬ä¸€æ­¥ï¼šå¿«é€Ÿå®šä½å¤§ç›®å½•ï¼ˆæŒ‰å¤§å°æ’åºï¼‰"><a href="#1-1-2-1-ğŸ”-ç¬¬ä¸€æ­¥ï¼šå¿«é€Ÿå®šä½å¤§ç›®å½•ï¼ˆæŒ‰å¤§å°æ’åºï¼‰" class="headerlink" title="1.1.2.1 ğŸ” ç¬¬ä¸€æ­¥ï¼šå¿«é€Ÿå®šä½å¤§ç›®å½•ï¼ˆæŒ‰å¤§å°æ’åºï¼‰"></a>1.1.2.1 ğŸ” ç¬¬ä¸€æ­¥ï¼šå¿«é€Ÿå®šä½å¤§ç›®å½•ï¼ˆæŒ‰å¤§å°æ’åºï¼‰</h4><p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œ<strong>ä»æ ¹ç›®å½•å¼€å§‹ï¼Œæ‰¾å‡ºå ç”¨ç©ºé—´æœ€å¤§çš„ç›®å½•</strong>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æŸ¥çœ‹æ ¹ç›®å½•ä¸‹å„å­ç›®å½•å¤§å°ï¼ˆäººç±»å¯è¯»ï¼ŒæŒ‰å¤§å°æ’åºï¼‰</span><br>sudo <span class="hljs-built_in">du</span> -h --max-depth=1 / | <span class="hljs-built_in">sort</span> -hr<br></code></pre></td></tr></table></figure>

<blockquote>
<p>âœ… è¾“å‡ºç¤ºä¾‹ï¼š</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">150G    <span class="hljs-string">/var</span><br>30G     <span class="hljs-string">/usr</span><br>10G     <span class="hljs-string">/home</span><br>5G      <span class="hljs-string">/opt</span><br><span class="hljs-string">...</span><br></code></pre></td></tr></table></figure>
</blockquote>
<p>é‡ç‚¹å…³æ³¨ <strong><code>/var</code>ã€<code>/tmp</code>ã€<code>/home</code>ã€<code>/root</code>ã€<code>/usr</code></strong> ç­‰ç›®å½•ã€‚</p>
<hr>
<h4 id="1-1-2-2-ğŸ§¹-ç¬¬äºŒæ­¥ï¼šé‡ç‚¹æ¸…ç†å¸¸è§â€œä¸´æ—¶-æ—¥å¿—â€ç›®å½•"><a href="#1-1-2-2-ğŸ§¹-ç¬¬äºŒæ­¥ï¼šé‡ç‚¹æ¸…ç†å¸¸è§â€œä¸´æ—¶-æ—¥å¿—â€ç›®å½•" class="headerlink" title="1.1.2.2 ğŸ§¹ ç¬¬äºŒæ­¥ï¼šé‡ç‚¹æ¸…ç†å¸¸è§â€œä¸´æ—¶&#x2F;æ—¥å¿—â€ç›®å½•"></a>1.1.2.2 ğŸ§¹ ç¬¬äºŒæ­¥ï¼šé‡ç‚¹æ¸…ç†å¸¸è§â€œä¸´æ—¶&#x2F;æ—¥å¿—â€ç›®å½•</h4><h5 id="1-1-2-2-1-æ¸…ç†ç³»ç»Ÿæ—¥å¿—ï¼ˆé€šå¸¸åœ¨-var-logï¼‰"><a href="#1-1-2-2-1-æ¸…ç†ç³»ç»Ÿæ—¥å¿—ï¼ˆé€šå¸¸åœ¨-var-logï¼‰" class="headerlink" title="1.1.2.2.1 æ¸…ç†ç³»ç»Ÿæ—¥å¿—ï¼ˆé€šå¸¸åœ¨ /var/logï¼‰"></a>1.1.2.2.1 <strong>æ¸…ç†ç³»ç»Ÿæ—¥å¿—ï¼ˆé€šå¸¸åœ¨ <code>/var/log</code>ï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æŸ¥çœ‹ /var/log å¤§å°</span><br>sudo <span class="hljs-built_in">du</span> -sh /var/log<br><br><span class="hljs-comment"># æ¸…ç©ºå¤§æ—¥å¿—æ–‡ä»¶ï¼ˆä¸è¦ç›´æ¥åˆ ï¼Œé¿å…æœåŠ¡å¼‚å¸¸ï¼‰</span><br>sudo <span class="hljs-built_in">truncate</span> -s 0 /var/log/messages<br>sudo <span class="hljs-built_in">truncate</span> -s 0 /var/log/secure<br>sudo <span class="hljs-built_in">truncate</span> -s 0 /var/log/maillog<br>sudo <span class="hljs-built_in">truncate</span> -s 0 /var/log/cron<br>sudo <span class="hljs-built_in">truncate</span> -s 0 /var/log/dmesg<br><br><span class="hljs-comment"># æ¸…ç† journal æ—¥å¿—ï¼ˆå¦‚æœä½¿ç”¨ systemdï¼‰</span><br>sudo journalctl --vacuum-size=100M<br><span class="hljs-comment"># æˆ–æ¸…ç©º</span><br>sudo journalctl --vacuum-time=1s<br></code></pre></td></tr></table></figure>

<h5 id="1-1-2-2-2-æ¸…ç†ä¸´æ—¶ç›®å½•"><a href="#1-1-2-2-2-æ¸…ç†ä¸´æ—¶ç›®å½•" class="headerlink" title="1.1.2.2.2 æ¸…ç†ä¸´æ—¶ç›®å½•"></a>1.1.2.2.2 <strong>æ¸…ç†ä¸´æ—¶ç›®å½•</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ¸…ç† /tmpï¼ˆé‡å¯ä¼šè‡ªåŠ¨æ¸…ï¼Œä½†å¯æ‰‹åŠ¨åˆ ï¼‰</span><br>sudo <span class="hljs-built_in">rm</span> -rf /tmp/*<br><br><span class="hljs-comment"># æ¸…ç† /var/tmp</span><br>sudo <span class="hljs-built_in">rm</span> -rf /var/tmp/*<br></code></pre></td></tr></table></figure>

<h5 id="1-1-2-2-3-æ¸…ç†-YUM-ç¼“å­˜ï¼ˆå¦‚æœæ˜¯-CentOS-RHELï¼‰"><a href="#1-1-2-2-3-æ¸…ç†-YUM-ç¼“å­˜ï¼ˆå¦‚æœæ˜¯-CentOS-RHELï¼‰" class="headerlink" title="1.1.2.2.3 æ¸…ç† YUM ç¼“å­˜ï¼ˆå¦‚æœæ˜¯ CentOS&#x2F;RHELï¼‰"></a>1.1.2.2.3 <strong>æ¸…ç† YUM ç¼“å­˜ï¼ˆå¦‚æœæ˜¯ CentOS&#x2F;RHELï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ¸…ç† yum ç¼“å­˜</span><br>sudo yum clean all<br><br><span class="hljs-comment"># æˆ–ç›´æ¥åˆ ç¼“å­˜ç›®å½•</span><br>sudo <span class="hljs-built_in">rm</span> -rf /var/cache/yum<br></code></pre></td></tr></table></figure>

<h5 id="1-1-2-2-4-æ¸…ç†-Dockerï¼ˆå¦‚æœä½ ç”¨äº†-Dockerï¼‰"><a href="#1-1-2-2-4-æ¸…ç†-Dockerï¼ˆå¦‚æœä½ ç”¨äº†-Dockerï¼‰" class="headerlink" title="1.1.2.2.4 æ¸…ç† Dockerï¼ˆå¦‚æœä½ ç”¨äº† Dockerï¼‰"></a>1.1.2.2.4 <strong>æ¸…ç† Dockerï¼ˆå¦‚æœä½ ç”¨äº† Dockerï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æŸ¥çœ‹ Docker ç£ç›˜ä½¿ç”¨</span><br>docker system <span class="hljs-built_in">df</span><br><br><span class="hljs-comment"># æ¸…ç†æ— ç”¨é•œåƒã€å®¹å™¨ã€å·</span><br>docker system prune -a -f --volumes<br></code></pre></td></tr></table></figure>

<h5 id="1-1-2-2-5-æ¸…ç†æ—§å†…æ ¸ï¼ˆå¦‚æœ-boot-ä¹Ÿæ»¡ï¼Œä½†ä½ è¿™é‡Œ-boot-åªç”¨äº†-5-ï¼‰"><a href="#1-1-2-2-5-æ¸…ç†æ—§å†…æ ¸ï¼ˆå¦‚æœ-boot-ä¹Ÿæ»¡ï¼Œä½†ä½ è¿™é‡Œ-boot-åªç”¨äº†-5-ï¼‰" class="headerlink" title="1.1.2.2.5 æ¸…ç†æ—§å†…æ ¸ï¼ˆå¦‚æœ &#x2F;boot ä¹Ÿæ»¡ï¼Œä½†ä½ è¿™é‡Œ &#x2F;boot åªç”¨äº† 5%ï¼‰"></a>1.1.2.2.5 <strong>æ¸…ç†æ—§å†…æ ¸ï¼ˆå¦‚æœ &#x2F;boot ä¹Ÿæ»¡ï¼Œä½†ä½ è¿™é‡Œ &#x2F;boot åªç”¨äº† 5%ï¼‰</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åˆ—å‡ºå·²å®‰è£…å†…æ ¸</span><br>rpm -q kernel<br><br><span class="hljs-comment"># åˆ é™¤æ—§å†…æ ¸ï¼ˆä¿ç•™æœ€æ–°1-2ä¸ªï¼‰</span><br>sudo package-cleanup --oldkernels --count=1<br></code></pre></td></tr></table></figure>

<hr>
<h4 id="1-1-2-3-ğŸ”-ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾å¤§æ–‡ä»¶ï¼ˆ-100MBï¼‰"><a href="#1-1-2-3-ğŸ”-ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾å¤§æ–‡ä»¶ï¼ˆ-100MBï¼‰" class="headerlink" title="1.1.2.3 ğŸ” ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾å¤§æ–‡ä»¶ï¼ˆ&gt;100MBï¼‰"></a>1.1.2.3 ğŸ” ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾å¤§æ–‡ä»¶ï¼ˆ&gt;100MBï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æŸ¥æ‰¾å…¨ç³»ç»Ÿå¤§äº 100MB çš„æ–‡ä»¶</span><br>sudo find / -<span class="hljs-built_in">type</span> f -size +100M -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">ls</span> -lh &#123;&#125; \; 2&gt;/dev/null | <span class="hljs-built_in">sort</span> -k5 -hr<br><br><span class="hljs-comment"># æˆ–åªæŸ¥æœ€è¿‘ä¿®æ”¹çš„å¤§æ–‡ä»¶</span><br>sudo find / -<span class="hljs-built_in">type</span> f -size +100M -mtime -7 -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">ls</span> -lh &#123;&#125; \; 2&gt;/dev/null<br></code></pre></td></tr></table></figure>

<p>å¸¸è§â€œç½ªé­ç¥¸é¦–â€ï¼š</p>
<ul>
<li>æ—¥å¿—æ–‡ä»¶ï¼š<code>*.log</code>ã€<code>journal</code>ã€<code>catalina.out</code>ï¼ˆTomcatï¼‰</li>
<li>æ•°æ®åº“ dump æ–‡ä»¶ï¼š<code>*.sql</code>ã€<code>*.bak</code></li>
<li>ä¸´æ—¶ä¸‹è½½æ–‡ä»¶ï¼š<code>/root/*.zip</code>ã€<code>/tmp/*.tar.gz</code></li>
<li>åº”ç”¨ç¼“å­˜ï¼š<code>/home/*/.cache</code>ã€<code>/var/lib/*</code></li>
</ul>
<hr>
<h4 id="1-1-2-4-ğŸ’¡-ç¬¬å››æ­¥ï¼šç´§æ€¥é‡Šæ”¾ç©ºé—´ï¼ˆå¦‚æœä¸Šè¿°ä¸å¤Ÿï¼‰"><a href="#1-1-2-4-ğŸ’¡-ç¬¬å››æ­¥ï¼šç´§æ€¥é‡Šæ”¾ç©ºé—´ï¼ˆå¦‚æœä¸Šè¿°ä¸å¤Ÿï¼‰" class="headerlink" title="1.1.2.4 ğŸ’¡ ç¬¬å››æ­¥ï¼šç´§æ€¥é‡Šæ”¾ç©ºé—´ï¼ˆå¦‚æœä¸Šè¿°ä¸å¤Ÿï¼‰"></a>1.1.2.4 ğŸ’¡ ç¬¬å››æ­¥ï¼šç´§æ€¥é‡Šæ”¾ç©ºé—´ï¼ˆå¦‚æœä¸Šè¿°ä¸å¤Ÿï¼‰</h4><h5 id="1-1-2-4-1-æ–¹æ¡ˆ-Aï¼šä¸´æ—¶æ‰©å®¹ï¼ˆå¦‚æœç”¨äº†-LVMï¼‰"><a href="#1-1-2-4-1-æ–¹æ¡ˆ-Aï¼šä¸´æ—¶æ‰©å®¹ï¼ˆå¦‚æœç”¨äº†-LVMï¼‰" class="headerlink" title="1.1.2.4.1 æ–¹æ¡ˆ Aï¼šä¸´æ—¶æ‰©å®¹ï¼ˆå¦‚æœç”¨äº† LVMï¼‰"></a>1.1.2.4.1 æ–¹æ¡ˆ Aï¼šä¸´æ—¶æ‰©å®¹ï¼ˆå¦‚æœç”¨äº† LVMï¼‰</h5><p>ä½†ä½ çš„ <code>df -h</code> æ˜¾ç¤ºæ˜¯ LVMï¼ˆ<code>/dev/mapper/centos-root</code>ï¼‰ï¼Œå¯æ£€æŸ¥æ˜¯å¦æœ‰æœªåˆ†é…ç©ºé—´ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo vgs    <span class="hljs-comment"># æŸ¥çœ‹å·ç»„å‰©ä½™ç©ºé—´</span><br>sudo lvs    <span class="hljs-comment"># æŸ¥çœ‹é€»è¾‘å·</span><br></code></pre></td></tr></table></figure>
<p>å¦‚æœæœ‰å‰©ä½™ï¼Œå¯æ‰©å®¹ï¼ˆä½†éœ€å…ˆæ¸…ç†å‡ºä¸€ç‚¹ç©ºé—´æ‰èƒ½æ“ä½œï¼‰ã€‚</p>
<h5 id="1-1-2-4-2-æ–¹æ¡ˆ-Bï¼šåˆ é™¤æ— ç”¨å¤§æ–‡ä»¶ï¼ˆè°¨æ…ï¼ï¼‰"><a href="#1-1-2-4-2-æ–¹æ¡ˆ-Bï¼šåˆ é™¤æ— ç”¨å¤§æ–‡ä»¶ï¼ˆè°¨æ…ï¼ï¼‰" class="headerlink" title="1.1.2.4.2 æ–¹æ¡ˆ Bï¼šåˆ é™¤æ— ç”¨å¤§æ–‡ä»¶ï¼ˆè°¨æ…ï¼ï¼‰"></a>1.1.2.4.2 æ–¹æ¡ˆ Bï¼šåˆ é™¤æ— ç”¨å¤§æ–‡ä»¶ï¼ˆè°¨æ…ï¼ï¼‰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ç¤ºä¾‹ï¼šåˆ é™¤æŸä¸ªå¤§æ—¥å¿—</span><br>sudo <span class="hljs-built_in">rm</span> -f /var/log/your_app_huge.log<br><br><span class="hljs-comment"># æˆ–æ¸…ç©ºï¼ˆæ›´å®‰å…¨ï¼‰</span><br>sudo <span class="hljs-built_in">truncate</span> -s 0 /path/to/huge_file<br></code></pre></td></tr></table></figure>

<blockquote>
<p>âš ï¸ <strong>åˆ‡å‹¿åˆ é™¤ä½ ä¸è®¤è¯†çš„æ–‡ä»¶ï¼</strong> å°¤å…¶æ˜¯ <code>/bin</code>ã€<code>/sbin</code>ã€<code>/lib</code> ä¸‹çš„æ–‡ä»¶ã€‚</p>
</blockquote>
<hr>
<h4 id="1-1-2-5-âœ…-ç¬¬äº”æ­¥ï¼šé¢„é˜²æªæ–½"><a href="#1-1-2-5-âœ…-ç¬¬äº”æ­¥ï¼šé¢„é˜²æªæ–½" class="headerlink" title="1.1.2.5 âœ… ç¬¬äº”æ­¥ï¼šé¢„é˜²æªæ–½"></a>1.1.2.5 âœ… ç¬¬äº”æ­¥ï¼šé¢„é˜²æªæ–½</h4><ol>
<li><strong>è®¾ç½® logrotate</strong>ï¼ˆè‡ªåŠ¨è½®è½¬æ—¥å¿—ï¼‰<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo vi /etc/logrotate.d/your_app<br></code></pre></td></tr></table></figure></li>
<li><strong>ç›‘æ§ç£ç›˜ä½¿ç”¨</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å®‰è£…ç›‘æ§å·¥å…·</span><br>sudo yum install -y ncdu<br><span class="hljs-comment"># äº¤äº’å¼æŸ¥çœ‹ç›®å½•å¤§å°</span><br>sudo ncdu /<br></code></pre></td></tr></table></figure></li>
<li><strong>å®šæœŸæ¸…ç†è„šæœ¬</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ·»åŠ  cron ä»»åŠ¡</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;0 2 * * 0 /usr/bin/yum clean all&quot;</span> | sudo crontab -<br></code></pre></td></tr></table></figure></li>
</ol>
<hr>
<h4 id="1-1-2-6-ğŸš¨-ç´§æ€¥æ“ä½œå»ºè®®"><a href="#1-1-2-6-ğŸš¨-ç´§æ€¥æ“ä½œå»ºè®®" class="headerlink" title="1.1.2.6 ğŸš¨ ç´§æ€¥æ“ä½œå»ºè®®"></a>1.1.2.6 ğŸš¨ ç´§æ€¥æ“ä½œå»ºè®®</h4><p>ä½ ç°åœ¨ <strong>å¿…é¡»ç«‹å³æ¸…ç†è‡³å°‘ 1~2GB ç©ºé—´</strong>ï¼Œå¦åˆ™ï¼š</p>
<ul>
<li><code>systemd</code> å¯èƒ½æ— æ³•å†™æ—¥å¿—</li>
<li>SSH å¯èƒ½æ‹’ç»æ–°è¿æ¥</li>
<li>æ•°æ®åº“å¯èƒ½ crash</li>
</ul>
<p><strong>ä¼˜å…ˆæ‰§è¡Œï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1. æ¸…ç† journal æ—¥å¿—</span><br>sudo journalctl --vacuum-size=50M<br><br><span class="hljs-comment"># 2. æ¸…ç©ºä¸»è¦æ—¥å¿—</span><br>sudo <span class="hljs-built_in">truncate</span> -s 0 /var/log/messages<br>sudo <span class="hljs-built_in">truncate</span> -s 0 /var/log/secure<br><br><span class="hljs-comment"># 3. æ¸…ç† yum ç¼“å­˜</span><br>sudo yum clean all<br><br><span class="hljs-comment"># 4. æ£€æŸ¥ /tmp å’Œ /var/tmp</span><br>sudo <span class="hljs-built_in">rm</span> -rf /tmp/*<br>sudo <span class="hljs-built_in">rm</span> -rf /var/tmp/*<br></code></pre></td></tr></table></figure>

<p>ç„¶åå†æ¬¡è¿è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">df</span> -h<br></code></pre></td></tr></table></figure>
<p>ç¡®è®¤ <code>/</code> åˆ†åŒº <strong>Use% é™åˆ° 95% ä»¥ä¸‹</strong>ã€‚</p>
<hr>
<p>å®Œæˆæ¸…ç†åï¼Œå»ºè®®ç”¨ <code>ncdu</code> å·¥å…·æ·±å…¥åˆ†æï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo yum install -y ncdu<br>sudo ncdu /<br></code></pre></td></tr></table></figure>
<p>å®ƒä¼šäº¤äº’å¼æ˜¾ç¤ºç›®å½•å¤§å°ï¼Œæ–¹ä¾¿ä½ ç²¾å‡†å®šä½â€œç©ºé—´åå™¬è€…â€ã€‚</p>
<h3 id="1-1-3-Ssh-è¿æ¥"><a href="#1-1-3-Ssh-è¿æ¥" class="headerlink" title="1.1.3 Ssh è¿æ¥"></a>1.1.3 Ssh è¿æ¥</h3><p>-p æŒ‡å®šç«¯å£ï¼Œé»˜è®¤ä¸å¸¦åˆ™ä¸º 22 ç«¯å£</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ssh -p &lt;port&gt; &lt;username&gt;@&lt;ip/hostname&gt;<br></code></pre></td></tr></table></figure>

<h3 id="1-1-4-Glusterfs-æ–‡ä»¶æŒ‚è½½"><a href="#1-1-4-Glusterfs-æ–‡ä»¶æŒ‚è½½" class="headerlink" title="1.1.4 Glusterfs æ–‡ä»¶æŒ‚è½½"></a>1.1.4 Glusterfs æ–‡ä»¶æŒ‚è½½</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åˆ›å»ºæŒ‚è½½ç‚¹ç›®å½•ï¼ˆéœ€æŒ‡å®šè·¯å¾„ï¼‰</span><br>sudo <span class="hljs-built_in">mkdir</span> -p /mnt/glusterfs<br><br><span class="hljs-comment"># æŒ‚è½½ GlusterFS å·ï¼ˆä½¿ç”¨ FUSE å®¢æˆ·ç«¯ï¼‰</span><br>mount -t glusterfs 192.168.88.170:vol_69994102f7e8a927ebeb3acd3784590c  /mnt/hsas_log<br>sudo mount -t glusterfs &lt;GlusterFSèŠ‚ç‚¹IPæˆ–ä¸»æœºå&gt;:/&lt;å·å&gt; /mnt/glusterfs<br></code></pre></td></tr></table></figure>

<blockquote>
<p>å·åé€šè¿‡ rancher é‡Œæ‰¾åˆ°å¯¹åº”çš„ volume æŸ¥çœ‹ã€‚</p>
</blockquote>
<h3 id="1-1-5-æ–‡ä»¶ä¼ è¾“"><a href="#1-1-5-æ–‡ä»¶ä¼ è¾“" class="headerlink" title="1.1.5 æ–‡ä»¶ä¼ è¾“"></a>1.1.5 æ–‡ä»¶ä¼ è¾“</h3><blockquote>
<p>é€šè¿‡ ssh åè®®ç”¨äºåœ¨æœ¬åœ°è®¡ç®—æœºå’Œè¿œç¨‹è®¡ç®—æœºä¹‹é—´å®‰å…¨åœ°å¤åˆ¶æ–‡ä»¶</p>
</blockquote>
<ol>
<li>æœ¬åœ°åˆ°è¿œç¨‹</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">scp (-p &lt;port&gt;) &lt;/path/to/local/file&gt; &lt;username&gt;@&lt;remote_host/host_name&gt;:&lt;/path/to/remote/directory&gt;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>è¿œç¨‹åˆ°æœ¬åœ°</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">scp (-p &lt;port&gt;) &lt;username&gt;@&lt;remote_host/host_name&gt;: &lt;/path/to/remote/directory&gt; &lt;/path/to/local/file&gt; <br></code></pre></td></tr></table></figure>

<h3 id="1-1-6-æŸ¥çœ‹è·¯ç”±è¡¨"><a href="#1-1-6-æŸ¥çœ‹è·¯ç”±è¡¨" class="headerlink" title="1.1.6 æŸ¥çœ‹è·¯ç”±è¡¨"></a>1.1.6 æŸ¥çœ‹è·¯ç”±è¡¨</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum install net-tools -y<br>route -n <span class="hljs-comment">#åˆ—å‡ºæ‰€æœ‰è·¯ç”±</span><br></code></pre></td></tr></table></figure>

<h3 id="1-1-7-æŸ¥çœ‹èµ„æº"><a href="#1-1-7-æŸ¥çœ‹èµ„æº" class="headerlink" title="1.1.7 æŸ¥çœ‹èµ„æº"></a>1.1.7 æŸ¥çœ‹èµ„æº</h3><p>æŸ¥çœ‹æ‰€æœ‰èµ„æºå ç”¨æƒ…å†µï¼Œé™åºæ’åˆ—ï¼Œ<code>top</code> é»˜è®¤ä¼šå®æ—¶æ›´æ–°æ˜¾ç¤ºçš„ä¿¡æ¯ï¼Œé€šå¸¸æ¯ç§’åˆ·æ–°ä¸€æ¬¡ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">top <br></code></pre></td></tr></table></figure>

<ol>
<li><strong>æ’åº</strong>ï¼š<ul>
<li>æŒ‰ CPU ä½¿ç”¨ç‡æ’åºï¼šæŒ‰Â <code>P</code>Â é”®ã€‚</li>
<li>æŒ‰å†…å­˜ä½¿ç”¨ç‡æ’åºï¼šæŒ‰Â <code>M</code>Â é”®ã€‚</li>
<li>æŒ‰æ‰§è¡Œæ—¶é—´æ’åºï¼šæŒ‰Â <code>T</code>Â é”®ã€‚</li>
</ul>
</li>
<li><strong>æœç´¢è¿›ç¨‹</strong>ï¼š<ul>
<li>è¾“å…¥Â <code>u</code>Â é”®ï¼Œç„¶åè¾“å…¥ç”¨æˆ·åï¼Œå¯ä»¥æ˜¾ç¤ºè¯¥ç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ã€‚</li>
<li>è¾“å…¥Â <code>p</code>Â é”®ï¼Œç„¶åè¾“å…¥è¿›ç¨‹ IDï¼ˆPIDï¼‰ï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ°ç‰¹å®šè¿›ç¨‹ã€‚</li>
</ul>
</li>
<li><strong>è¿‡æ»¤è¿›ç¨‹</strong>ï¼š<ul>
<li>è¾“å…¥Â <code>U</code>Â é”®ï¼Œç„¶åè¾“å…¥ç”¨æˆ·åï¼Œå¯ä»¥è¿‡æ»¤æ˜¾ç¤ºè¯¥ç”¨æˆ·çš„è¿›ç¨‹ã€‚</li>
<li>è¾“å…¥Â <code>P</code>Â é”®ï¼Œç„¶åè¾“å…¥è¿›ç¨‹ IDï¼ˆPIDï¼‰ï¼Œå¯ä»¥è¿‡æ»¤æ˜¾ç¤ºè¯¥ PID çš„è¿›ç¨‹ã€‚</li>
</ul>
</li>
<li><strong>æ€æ­»è¿›ç¨‹</strong>ï¼š<ul>
<li>è¾“å…¥Â <code>k</code>Â é”®ï¼Œç„¶åè¾“å…¥è¿›ç¨‹ ID å’Œè¦å‘é€çš„ä¿¡å·ï¼ˆé»˜è®¤æ˜¯ SIGTERMï¼Œå³ 15ï¼‰ï¼Œå¯ä»¥æ€æ­»è¿›ç¨‹ã€‚</li>
</ul>
</li>
</ol>
<h3 id="1-1-8-æŸ¥çœ‹è¿›ç¨‹"><a href="#1-1-8-æŸ¥çœ‹è¿›ç¨‹" class="headerlink" title="1.1.8 æŸ¥çœ‹è¿›ç¨‹"></a>1.1.8 æŸ¥çœ‹è¿›ç¨‹</h3><p><code>ps</code> å‘½ä»¤åœ¨ Unix-like ç³»ç»Ÿä¸­ç”¨äºæ˜¾ç¤ºå½“å‰è¿›ç¨‹çš„çŠ¶æ€ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ps<br></code></pre></td></tr></table></figure>

<ol>
<li><p>å‚æ•°è¯´æ˜</p>
<ul>
<li><code>USER</code>ï¼šè¿›ç¨‹æ‰€æœ‰è€…çš„ç”¨æˆ·åã€‚</li>
<li><code>PID</code>ï¼šè¿›ç¨‹çš„ IDã€‚</li>
<li><code>%CPU</code>ï¼šè¿›ç¨‹å ç”¨çš„ CPU ç™¾åˆ†æ¯”ã€‚</li>
<li><code>%MEM</code>ï¼šè¿›ç¨‹å ç”¨çš„å†…å­˜ç™¾åˆ†æ¯”ã€‚</li>
<li><code>VSZ</code>ï¼šè™šæ‹Ÿå†…å­˜å¤§å°ï¼ˆVirtual Sizeï¼‰ã€‚</li>
<li><code>RSS</code>ï¼šå®é™…å†…å­˜å¤§å°ï¼ˆResident Set Sizeï¼‰ã€‚</li>
<li><code>TTY</code>ï¼šè¿›ç¨‹ç»ˆç«¯ç±»å‹ã€‚</li>
<li><code>STAT</code>ï¼šè¿›ç¨‹çŠ¶æ€ã€‚</li>
<li><code>START</code>ï¼šè¿›ç¨‹å¯åŠ¨æ—¶é—´ã€‚</li>
<li><code>TIME</code>ï¼šè¿›ç¨‹å ç”¨ CPU çš„æ—¶é—´ã€‚</li>
<li><code>COMMAND</code>ï¼šå¯åŠ¨è¿›ç¨‹çš„å‘½ä»¤ã€‚</li>
</ul>
</li>
<li><p>å¸¸è§ç»„åˆ</p>
<ul>
<li>ps aux (â€“sort&#x3D;-%mem&#x2F;cpu)ï¼š æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹(æŒ‰ç…§å†…å­˜&#x2F;CPU ä½¿ç”¨ç‡é™åºæ’åˆ—è¿›ç¨‹)</li>
<li>ps -efï¼šæ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹çš„å®Œæ•´ä¿¡æ¯ã€‚</li>
<li>ps -p PIDï¼šæ˜¾ç¤ºç‰¹å®šè¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ã€‚</li>
</ul>
</li>
</ol>
<h3 id="1-1-9-æŸ¥çœ‹å†…å­˜"><a href="#1-1-9-æŸ¥çœ‹å†…å­˜" class="headerlink" title="1.1.9 æŸ¥çœ‹å†…å­˜"></a>1.1.9 æŸ¥çœ‹å†…å­˜</h3><p>ä»¥äººç±»å¯è¯»çš„æ–¹å¼å±•ç¤ºå†…å­˜ä½¿ç”¨çŠ¶æ€ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">free -mh<br></code></pre></td></tr></table></figure>

<h3 id="1-1-10-æŸ¥çœ‹ç¡¬ç›˜"><a href="#1-1-10-æŸ¥çœ‹ç¡¬ç›˜" class="headerlink" title="1.1.10 æŸ¥çœ‹ç¡¬ç›˜"></a>1.1.10 æŸ¥çœ‹ç¡¬ç›˜</h3><p>ä»¥äººç±»å¯è¯»çš„æ–¹å¼å±•ç¤ºç£ç›˜åˆ†é…çŠ¶æ€ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">df</span> -h<br></code></pre></td></tr></table></figure>

<h3 id="1-1-11-æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—"><a href="#1-1-11-æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—" class="headerlink" title="1.1.11 æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—"></a>1.1.11 æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—</h3><p><code>journalctl</code> æ˜¯ <code>systemd</code> ç³»ç»ŸæœåŠ¡ç®¡ç†å™¨çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºæŸ¥è¯¢å’Œæ˜¾ç¤ºæ—¥å¿—æ¶ˆæ¯ã€‚å®ƒæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼Œç‰¹åˆ«æ˜¯ä¸ç‰¹å®šæœåŠ¡æˆ–å•å…ƒç›¸å…³çš„æ—¥å¿—ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo journalctl -u &lt;NetworkManager&gt;<br></code></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span>/vim /var/log/messages<br>dmesg<br></code></pre></td></tr></table></figure>

<p>æŸ¥æ‰¾ cpu ç›¸å…³æ—¥å¿—ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">grep -r Call -C 10 /var/log/messages*<br>grep -r Call /var/log/messages*<br></code></pre></td></tr></table></figure>

<h3 id="1-1-12-æŸ¥çœ‹ç¼–è¾‘æ–‡ä»¶"><a href="#1-1-12-æŸ¥çœ‹ç¼–è¾‘æ–‡ä»¶" class="headerlink" title="1.1.12 æŸ¥çœ‹ç¼–è¾‘æ–‡ä»¶"></a>1.1.12 æŸ¥çœ‹ç¼–è¾‘æ–‡ä»¶</h3><h4 id="1-1-12-1-æœç´¢æ–‡ä»¶"><a href="#1-1-12-1-æœç´¢æ–‡ä»¶" class="headerlink" title="1.1.12.1 æœç´¢æ–‡ä»¶"></a>1.1.12.1 æœç´¢æ–‡ä»¶</h4><p>æŒ‰ç…§å…³é”®è¯æœç´¢å«æœ‰å…³é”®è¯çš„æ–‡ä»¶</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">find . -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">exec</span> grep -l <span class="hljs-string">&#x27;mysql-master&#x27;</span> &#123;&#125; \;<br></code></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">grep <span class="hljs-string">&#x27;temporary password&#x27;</span> /var/log/mysqld.log<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo find / -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.yaml&quot;</span> -<span class="hljs-built_in">exec</span> grep -H <span class="hljs-string">&#x27;service-node-port-range&#x27;</span> &#123;&#125; \; 2&gt;/dev/null<br></code></pre></td></tr></table></figure>

<p>æœç´¢æŒ‡å®šæ–‡ä»¶åçš„æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo find / -name <span class="hljs-string">&quot;kube-apiserver.yaml&quot;</span> 2&gt;/dev/null<br></code></pre></td></tr></table></figure>

<h4 id="1-1-12-2-æŸ¥çœ‹æ–‡ä»¶æ•°é‡"><a href="#1-1-12-2-æŸ¥çœ‹æ–‡ä»¶æ•°é‡" class="headerlink" title="1.1.12.2 æŸ¥çœ‹æ–‡ä»¶æ•°é‡"></a>1.1.12.2 æŸ¥çœ‹æ–‡ä»¶æ•°é‡</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">find /path/to/directory -<span class="hljs-built_in">type</span> f | <span class="hljs-built_in">wc</span> -l<br></code></pre></td></tr></table></figure>

<h4 id="1-1-12-3-æŸ¥çœ‹ç›®å½•"><a href="#1-1-12-3-æŸ¥çœ‹ç›®å½•" class="headerlink" title="1.1.12.3 æŸ¥çœ‹ç›®å½•"></a>1.1.12.3 æŸ¥çœ‹ç›®å½•</h4><p>åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure>

<ol>
<li><p>å¸¸è§æ­é…</p>
<ul>
<li>ls -lhï¼šç»„åˆä½¿ç”¨ <code>-l</code> å’Œ <code>-h</code> é€‰é¡¹ï¼Œä»¥æ˜“è¯»çš„æ ¼å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°ã€‚</li>
<li>ls -lï¼šä»¥é•¿åˆ—è¡¨æ ¼å¼æ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æƒé™ã€æ‰€æœ‰è€…ã€å¤§å°å’Œæœ€åä¿®æ”¹æ—¶é—´ã€‚</li>
<li>ls -ltï¼šä»¥ä¿®æ”¹æ—¶é—´æ’åºï¼Œæœ€æ–°ä¿®æ”¹çš„æ–‡ä»¶æ’åœ¨æœ€å‰é¢ã€‚</li>
<li>ls -lSï¼šä»¥æ–‡ä»¶å¤§å°æ’åºã€‚</li>
<li>ls -aï¼šæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä»¥ç‚¹ï¼ˆ<code>.</code>ï¼‰å¼€å¤´çš„éšè—æ–‡ä»¶ã€‚</li>
<li>ls -Rï¼šé€’å½’åœ°åˆ—å‡ºæ‰€æœ‰å­ç›®å½•çš„å†…å®¹ã€‚</li>
<li>ls -Fï¼šåœ¨æ¯ä¸ªæ–‡ä»¶ååæ·»åŠ ä¸€ä¸ªå­—ç¬¦ä»¥æŒ‡ç¤ºæ–‡ä»¶ç±»å‹ï¼Œä¾‹å¦‚ï¼Œ<code>/</code> è¡¨ç¤ºç›®å½•ï¼Œ<code>*</code> è¡¨ç¤ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li>ls -oï¼šæ˜¾ç¤ºæ–‡ä»¶æ‰€æœ‰è€…å’Œç»„ï¼Œä½†ä¸æ˜¾ç¤ºç»„åã€‚</li>
<li>ls â€“colorï¼šä½¿ç”¨é¢œè‰²æ¥åŒºåˆ†ä¸åŒç±»å‹çš„æ–‡ä»¶ã€‚</li>
<li>ls *.txtï¼šåˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„ <code>.txt</code> æ–‡ä»¶ã€‚</li>
</ul>
</li>
<li><p>å‚æ•°è§£é‡Šï¼š<code>drwxr-xr-x 10 root root 4.0K Feb 22 21:41 clash</code></p>
<ul>
<li>dï¼šç›®å½•&#x2F;æ–‡ä»¶</li>
<li>rwxï¼šæ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ï¼Œ<code>r</code>Â ä»£è¡¨å¯è¯»ï¼ˆreadï¼‰ï¼Œ<code>w</code>Â ä»£è¡¨å¯å†™ï¼ˆwriteï¼‰ï¼Œ<code>x</code>Â ä»£è¡¨å¯æ‰§è¡Œï¼ˆexecuteï¼‰</li>
<li>r-xï¼šæ–‡ä»¶æ‰€æœ‰è€…åŒç»„çš„ç”¨æˆ·ï¼ˆgroupï¼‰çš„æƒé™ï¼Œå¯è¯»å¯æ‰§è¡Œä½†ä¸å¯å†™</li>
<li>r-xï¼šå…¶ä»–ç”¨æˆ·ï¼ˆothersï¼‰çš„æƒé™ï¼Œå¯è¯»å¯æ‰§è¡Œä½†ä¸å¯å†™</li>
<li>10ï¼šç¡¬é“¾æ¥æŒ‡å‘è¿™ä¸ªç›®å½•çš„ä¸ªæ•°ï¼Œç›®å½•è‡³å°‘ä¸º2ï¼ˆä¸€ä¸ªæ˜¯Â <code>.</code>Â è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œå¦ä¸€ä¸ªæ˜¯Â <code>..</code>Â è¡¨ç¤ºçˆ¶ç›®å½•ï¼‰ï¼ŒåŠ ä¸Šç›®å½•ä¸‹æ–‡ä»¶å’Œå­ç›®å½•çš„æ•°é‡ã€‚</li>
<li>root rootï¼šæ–‡ä»¶æ‰€æœ‰è€…å’Œç»„çš„åç§°ã€‚</li>
<li>4.0Kï¼šç›®å½•å ç”¨ç©ºé—´å¤§å°ï¼ˆä¸åŒ…æ‹¬å­æ–‡ä»¶å’Œå­ç›®å½•ï¼‰ã€‚</li>
<li>Feb 22 21:41ï¼šç›®å½•æœ€åä¿®æ”¹çš„æ—¥æœŸå’Œæ—¶é—´ã€‚</li>
<li>clashï¼šç›®å½•åç§°ã€‚</li>
</ul>
</li>
</ol>
<h4 id="1-1-12-4-æŸ¥çœ‹å†…å®¹"><a href="#1-1-12-4-æŸ¥çœ‹å†…å®¹" class="headerlink" title="1.1.12.4 æŸ¥çœ‹å†…å®¹"></a>1.1.12.4 æŸ¥çœ‹å†…å®¹</h4><p>æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œæ‰“å°åœ¨æ§åˆ¶å°</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> &lt;fileName&gt;<br></code></pre></td></tr></table></figure>

<h4 id="1-1-12-5-æ–°å»ºæ–‡ä»¶"><a href="#1-1-12-5-æ–°å»ºæ–‡ä»¶" class="headerlink" title="1.1.12.5 æ–°å»ºæ–‡ä»¶"></a>1.1.12.5 æ–°å»ºæ–‡ä»¶</h4><p>æ–°å¢ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ–å†™å…¥å†…å®¹åˆ°æ–‡ä»¶ä¸­</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> &gt; &lt;file.txt&gt;<br><span class="hljs-built_in">echo</span> &lt;content&gt; &gt; &lt;file.txt&gt;<br><span class="hljs-built_in">touch</span> &lt;file.txt&gt;<br></code></pre></td></tr></table></figure>

<h4 id="1-1-12-6-ç¼–è¾‘å†…å®¹"><a href="#1-1-12-6-ç¼–è¾‘å†…å®¹" class="headerlink" title="1.1.12.6 ç¼–è¾‘å†…å®¹"></a>1.1.12.6 ç¼–è¾‘å†…å®¹</h4><p>ä½¿ç”¨ Vim ç¼–è¾‘å™¨ç¼–è¾‘æ–‡ä»¶</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">vi(m) &lt;fileName&gt;<br></code></pre></td></tr></table></figure>

<ol>
<li>å¸¸è§æ“ä½œï¼š<ul>
<li>iï¼šè¿›å…¥æ’å…¥å†™æ¨¡å¼</li>
<li>escï¼šé€€å‡ºå½“å‰æ¨¡å¼</li>
<li>ï¼šæŒ‡ä»¤æ¨¡å¼</li>
<li>:qï¼šç›´æ¥é€€å‡º</li>
<li>:wqï¼šä¿å­˜é€€å‡º</li>
</ul>
</li>
</ol>
<h2 id="1-2-K8s-å’Œ-Docker-ç›¸å…³æŒ‡ä»¤"><a href="#1-2-K8s-å’Œ-Docker-ç›¸å…³æŒ‡ä»¤" class="headerlink" title="1.2 K8s å’Œ Docker ç›¸å…³æŒ‡ä»¤"></a>1.2 K8s å’Œ Docker ç›¸å…³æŒ‡ä»¤</h2><p><a target="_blank" rel="noopener" href="https://www.rainbond.com/docs/quick-start/quick-install">å¿«é€Ÿå®‰è£… | Rainbond</a></p>
<h3 id="1-2-1-K8s"><a href="#1-2-1-K8s" class="headerlink" title="1.2.1 K8s"></a>1.2.1 K8s</h3><h4 id="1-2-1-1-é›†ç¾¤"><a href="#1-2-1-1-é›†ç¾¤" class="headerlink" title="1.2.1.1 é›†ç¾¤"></a>1.2.1.1 é›†ç¾¤</h4><p>è·å– prod é›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># æ­£å¼é›†ç¾¤</span><br>kube-prod get nodes<br><span class="hljs-comment"># æµ‹è¯•é›†ç¾¤</span><br>kube-test get nodes<br></code></pre></td></tr></table></figure>

<h4 id="1-2-1-2-èŠ‚ç‚¹"><a href="#1-2-1-2-èŠ‚ç‚¹" class="headerlink" title="1.2.1.2 èŠ‚ç‚¹"></a>1.2.1.2 èŠ‚ç‚¹</h4><p>è·å–æŒ‡å®šå‘½åç©ºé—´ä¸‹çš„æ‰€æœ‰ pod</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">kube-prod get pod -n &lt;namespace&gt;<br></code></pre></td></tr></table></figure>

<p>è·å–æŒ‡å®š pod çš„è¯¦æƒ…ï¼ˆ<code>å¯æ ¹æ® event æ’æŸ¥ pod çš„é”™è¯¯ä¿¡æ¯</code>ï¼‰</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">kube-prod describe pod &lt;pod-name&gt; -n &lt;namespace&gt;<br></code></pre></td></tr></table></figure>

<p>æ¡ä»¶æŸ¥è¯¢æŒ‡å®šå‘½åç©ºé—´ä¸‹æŒ‡å®šçŠ¶æ€çš„ pod å¹¶æ‰¹é‡åˆ é™¤</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">kubectl get pods -n etms | grep Evicted | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | xargs kubectl delete pods --kubeconfig ./kube_config_cluster.yml -n etms<br></code></pre></td></tr></table></figure>

<p>egï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">kube-test get pods -n etms | grep Evicted | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | xargs kubectl delete pods --kubeconfig ./test/kube_config_cluster.yml -n etms<br></code></pre></td></tr></table></figure>

<p>å¼ºåˆ¶åˆ é™¤ pod</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">kubectl delete pod hsas-1721236200-5q59b --grace-period=0 --force -n hsas<br></code></pre></td></tr></table></figure>

<h4 id="1-2-1-3-Pod"><a href="#1-2-1-3-Pod" class="headerlink" title="1.2.1.3 Pod"></a>1.2.1.3 Pod</h4><p>å¯åŠ¨å®šæ—¶ä»»åŠ¡</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">kubectl-prod -n mysql create job --from=cronjob/cweb-mysql-backup cweb-k8s-mysql-master<br>ç¬¬ä¸€ä¸ªcwebï¼šåç§°ç©ºé—´<br>ç¬¬äºŒä¸ªcwebï¼šå®šæ—¶ä»»åŠ¡å<br>ç¬¬ä¸‰ä¸ªcwebï¼šå¯åŠ¨çš„podå<br></code></pre></td></tr></table></figure>

<p>å¯åŠ¨å®šæ—¶ä»»åŠ¡å¹¶æŸ¥çœ‹æ—¥å¿—</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">kube-prod create job bems-backup-test-$(<span class="hljs-built_in">date</span> +%s) --from=cronjob/bems-backup -n bems<br>kube-prod get job -n bems<br>POD_NAME=$(kube-prod get pods -n bems -l job-name=bems-backup-test-1767168515 -o jsonpath=<span class="hljs-string">&#x27;&#123;.items[0].metadata.name&#125;&#x27;</span>)<br>kube-prod logs -n bems <span class="hljs-variable">$POD_NAME</span> -c backup<br>kube-prod delete job bems-backup-test-1767168515 -n bems<br></code></pre></td></tr></table></figure>

<h4 id="1-2-1-4-Deployment"><a href="#1-2-1-4-Deployment" class="headerlink" title="1.2.1.4 Deployment"></a>1.2.1.4 Deployment</h4><h5 id="1-2-1-4-1-æŸ¥çœ‹-deployment-çš„æ ‡ç­¾"><a href="#1-2-1-4-1-æŸ¥çœ‹-deployment-çš„æ ‡ç­¾" class="headerlink" title="1.2.1.4.1 æŸ¥çœ‹ deployment çš„æ ‡ç­¾"></a>1.2.1.4.1 æŸ¥çœ‹ deployment çš„æ ‡ç­¾</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kube-etms get deploy -n etms etms-web --show-labels<br></code></pre></td></tr></table></figure>

<h5 id="1-2-1-4-2-å®æ—¶æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—"><a href="#1-2-1-4-2-å®æ—¶æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—" class="headerlink" title="1.2.1.4.2 å®æ—¶æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—"></a>1.2.1.4.2 å®æ—¶æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kube-etms logs -n etms -l app=etms-web --prefix -f | grep --line-buffered <span class="hljs-string">&quot;å…³é”®è¯&quot;</span><br></code></pre></td></tr></table></figure>
<h4 id="1-2-1-5-å¤åˆ¶æ–‡ä»¶"><a href="#1-2-1-5-å¤åˆ¶æ–‡ä»¶" class="headerlink" title="1.2.1.5 å¤åˆ¶æ–‡ä»¶"></a>1.2.1.5 å¤åˆ¶æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubectl <span class="hljs-built_in">cp</span> -n å‘½åç©ºé—´ -c å®¹å™¨å podå:æ–‡ä»¶ç»å¯¹è·¯å¾„ æ–‡ä»¶ç›®æ ‡ä½ç½®<br><br>kube-test <span class="hljs-built_in">cp</span> -n tool -c kkfileview kkfileview-644dcccf65-r4kqb:/opt/kkFileView-4.1.0/config/application.properties ./application.properties<br></code></pre></td></tr></table></figure>

<h4 id="1-2-1-6-åˆ›å»º-Configmap"><a href="#1-2-1-6-åˆ›å»º-Configmap" class="headerlink" title="1.2.1.6 åˆ›å»º Configmap"></a>1.2.1.6 åˆ›å»º Configmap</h4><ol>
<li>å‘½ä»¤åˆ›å»º</li>
</ol>
<blockquote>
<p><strong>é€šè¿‡å‚æ•° <code>--from-literal</code> ç›´æ¥æŒ‡å®šé”®å€¼å¯¹ã€‚è¿™ç§æ–¹å¼æ¯”è¾ƒé€‚ç”¨äºä¸´æ—¶æµ‹è¯•ä½¿ç”¨ï¼Œè€Œä¸”ä¸é€‚åˆé…ç½®å¾ˆå¤šçš„æƒ…å†µã€‚</strong></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ kubectl create configmap config-literal \<br>--from-literal=pkslow.name=Larry \<br>--from-literal=pkslow.age=18 \<br>--from-literal=pkslow.webSite=www.pkslow.com <br></code></pre></td></tr></table></figure>

<ol>
<li>æ–‡ä»¶åˆ›å»º</li>
</ol>
<blockquote>
<p>é€šè¿‡å‚æ•° <code>--from-file</code> æ¥æŒ‡å®šæ–‡ä»¶ã€‚æŸ¥çœ‹å†…å®¹å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ kubectl create configmap config-file \<br>--namespace=tool \<br>--from-file=application.yaml \<br></code></pre></td></tr></table></figure>

<h3 id="1-2-2-Docker"><a href="#1-2-2-Docker" class="headerlink" title="1.2.2 Docker"></a>1.2.2 Docker</h3><h4 id="1-2-2-1-é…ç½®é•œåƒ"><a href="#1-2-2-1-é…ç½®é•œåƒ" class="headerlink" title="1.2.2.1 é…ç½®é•œåƒ"></a>1.2.2.1 é…ç½®é•œåƒ</h4><p>ä¸ºé•œåƒä»“åº“é…ç½®ä¸‹è½½æºï¼ŒæŸ¥çœ‹ <code>/etc/docker/daemon.json</code> æ–‡ä»¶æ¥ç¡®å®šå½“å‰é…ç½®çš„é•œåƒæºï¼Œå¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨æˆ–ä¸ºç©ºï¼Œåˆ™é»˜è®¤ä½¿ç”¨ Docker å®˜æ–¹é•œåƒæºã€‚</p>
<ol>
<li>æŸ¥çœ‹é•œåƒæºé…ç½®</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> /etc/docker/daemon.json<br><span class="hljs-built_in">cat</span> ~/.docker/config.json<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>ä¿®æ”¹é…ç½®<br>å¤šä¸ªé•œåƒæºä»¥é€—å·åˆ†éš”</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh">&#123;<br>  <span class="hljs-string">&quot;registry-mirrors&quot;</span>: [<span class="hljs-string">&quot;http://hub-mirror.c.163.com&quot;</span>]<br>&#125;<br><br><span class="hljs-comment">#ä»…ä¾›ç§äººä½¿ç”¨</span><br>&#123;<br>  <span class="hljs-string">&quot;registry-mirrors&quot;</span>: [<br>                        <span class="hljs-string">&quot;https://dockerhub.icu&quot;</span>,<br>                        <span class="hljs-string">&quot;https://registry.dockermirror.com&quot;</span>,<br>                        <span class="hljs-string">&quot;https://docker.m.daocloud.io&quot;</span>,<br>                        <span class="hljs-string">&quot;https://docker.fxxk.dedyn.io&quot;</span>,<br>                        <span class="hljs-string">&quot;https://dk.csfan.fun&quot;</span><br>					],<br>  <span class="hljs-string">&quot;exec-opts&quot;</span>: [<span class="hljs-string">&quot;native.cgroupdriver=systemd&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¸¸è§é•œåƒæºï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docker.m.daocloud.io/">public-image-mirror</a></li>
<li><a target="_blank" rel="noopener" href="https://mirror.iscas.ac.cn/">ISCAS å¼€æºé•œåƒç«™</a></li>
<li><a target="_blank" rel="noopener" href="https://docker.rainbond.cc/">docker.rainbond.cc</a></li>
<li><a target="_blank" rel="noopener" href="http://hub-mirror.c.163.com/">ç½‘æ˜“äº‘é•œåƒæº</a></li>
<li><a target="_blank" rel="noopener" href="https://dockerhub.icu/">icuç´§æ€¥é•œåƒæº</a></li>
<li><a href="https://<your_code>.mirror.aliyuncs.com">é˜¿é‡Œäº‘é•œåƒæº</a></li>
<li><a target="_blank" rel="noopener" href="https://docker.mirrors.sjtug.sjtu.edu.cn/">ä¸Šæµ·äº¤å¤§é•œåƒç«™</a></li>
<li><a target="_blank" rel="noopener" href="https://docker.nju.edu.cn/">å—äº¬å¤§å­¦é•œåƒç«™</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/cmliu/CF-Workers-docker.io/issues/8">DockerHubå›½å†…é•œåƒæºåˆ—è¡¨-20240618</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2430473">ä» Docker Hub æ‹‰å–é•œåƒå—é˜»ï¼Ÿè¿™äº›è§£å†³æ–¹æ¡ˆå¸®ä½ è½»æ¾åº”å¯¹</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2434428">å›½å†…æ— æ³•æ‹‰å–Dockeré•œåƒäº†ï¼Ÿè¿™äº›æ–¹æ³•æ‹¯æ•‘ä½ çš„Docker-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></li>
</ul>
<blockquote>
<p>æµ‹é€Ÿï¼ˆæµ‹é€Ÿå‰å…ˆç§»é™¤æœ¬åœ°çš„é•œåƒï¼ï¼‰<br>docker rmi nginx:latest<br>time docker pull nginx:latest</p>
</blockquote>
<ol>
<li>é‡å¯æœåŠ¡æ›´æ–°é…ç½®</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">systemctl restart docker.service<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker<br></code></pre></td></tr></table></figure>

<h4 id="1-2-2-2-ä¿å­˜é•œåƒ"><a href="#1-2-2-2-ä¿å­˜é•œåƒ" class="headerlink" title="1.2.2.2 ä¿å­˜é•œåƒ"></a>1.2.2.2 ä¿å­˜é•œåƒ</h4><p>å°†æŒ‡å®šæœ¬åœ°é•œåƒä¿å­˜ä¸º tar å‹ç¼©åŒ…</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker save -o &lt;image.tar&gt; &lt;image&gt;<br></code></pre></td></tr></table></figure>

<h4 id="1-2-2-3-åŠ è½½é•œåƒ"><a href="#1-2-2-3-åŠ è½½é•œåƒ" class="headerlink" title="1.2.2.3 åŠ è½½é•œåƒ"></a>1.2.2.3 åŠ è½½é•œåƒ</h4><p>æ ¹æ®æŒ‡å®šé•œåƒå‹ç¼©åŒ…åŠ è½½é•œåƒåˆ°æœ¬åœ°</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker load -i &lt;image.tar&gt;<br></code></pre></td></tr></table></figure>

<h4 id="1-2-2-4-åˆ é™¤é•œåƒ"><a href="#1-2-2-4-åˆ é™¤é•œåƒ" class="headerlink" title="1.2.2.4 åˆ é™¤é•œåƒ"></a>1.2.2.4 åˆ é™¤é•œåƒ</h4><p>åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„é•œåƒï¼Œå®¹å™¨å’Œå­˜å‚¨å·ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker image prune<br>docker container prune<br>docker volume prune<br></code></pre></td></tr></table></figure>

<h4 id="1-2-2-5-æ›´æ–°é•œåƒ"><a href="#1-2-2-5-æ›´æ–°é•œåƒ" class="headerlink" title="1.2.2.5 æ›´æ–°é•œåƒ"></a>1.2.2.5 æ›´æ–°é•œåƒ</h4><p>å¯¹å·²æœ‰çš„å˜æ›´ç¯å¢ƒè¿›è¡Œä¿å­˜ä»¥ä¾¿äº pod é‡å¯åç»´æŒæœ€æ–°ç¯å¢ƒ</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]<br>docker commit -a <span class="hljs-string">&#x27;fcs&#x27;</span>(commit msg) c3a6f02ad044(containerId/name) conda:fcs202407080840(newImageName)<br></code></pre></td></tr></table></figure>

<ul>
<li><code>OPTIONS</code><ul>
<li><code>-a</code>Â æˆ–Â <code>--author</code>ï¼šè®¾ç½®é•œåƒçš„ä½œè€…å­—æ®µã€‚</li>
<li><code>-c</code>Â æˆ–Â <code>--change</code>ï¼šåº”ç”¨ Dockerfile æŒ‡ä»¤æ¥åˆ›å»ºé•œåƒã€‚</li>
<li><code>-m</code>Â æˆ–Â <code>--message</code>ï¼šæäº¤æ—¶çš„è¯´æ˜ä¿¡æ¯ã€‚</li>
<li><code>-p</code>Â æˆ–Â <code>--pause</code>ï¼šæäº¤æ—¶æš‚åœå®¹å™¨è¿è¡Œï¼ˆé»˜è®¤ä¸º trueï¼‰ã€‚</li>
</ul>
</li>
<li><code>CONTAINER</code>Â æ˜¯ä½ è¦æäº¤çš„å®¹å™¨çš„ ID æˆ–åç§°ã€‚</li>
<li><code>REPOSITORY</code>Â æ˜¯æ–°åˆ›å»ºé•œåƒçš„ä»“åº“åç§°ã€‚</li>
<li><code>TAG</code>Â æ˜¯å¯é€‰çš„ï¼Œç”¨äºç»™é•œåƒæŒ‡å®šä¸€ä¸ªæ ‡ç­¾ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æ ‡ç­¾æ˜¯Â <code>latest</code>ã€‚</li>
</ul>
<h2 id="1-3-MySQL-æŒ‡ä»¤"><a href="#1-3-MySQL-æŒ‡ä»¤" class="headerlink" title="1.3 MySQL æŒ‡ä»¤"></a>1.3 MySQL æŒ‡ä»¤</h2><h3 id="1-3-1-æ‰¾åˆ°é…ç½®æ–‡ä»¶ä½ç½®"><a href="#1-3-1-æ‰¾åˆ°é…ç½®æ–‡ä»¶ä½ç½®" class="headerlink" title="1.3.1 æ‰¾åˆ°é…ç½®æ–‡ä»¶ä½ç½®"></a>1.3.1 æ‰¾åˆ°é…ç½®æ–‡ä»¶ä½ç½®</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">show variables like &#x27;datadir&#x27;;<br></code></pre></td></tr></table></figure>

<h3 id="1-3-2-æŸ¥çœ‹æ—¥å¿—æ‰€åœ¨ä½ç½®"><a href="#1-3-2-æŸ¥çœ‹æ—¥å¿—æ‰€åœ¨ä½ç½®" class="headerlink" title="1.3.2 æŸ¥çœ‹æ—¥å¿—æ‰€åœ¨ä½ç½®"></a>1.3.2 æŸ¥çœ‹æ—¥å¿—æ‰€åœ¨ä½ç½®</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">show variables like &#x27;log_bin&#x27;;<br></code></pre></td></tr></table></figure>

<h1 id="2-å¸¸è§é—®é¢˜"><a href="#2-å¸¸è§é—®é¢˜" class="headerlink" title="2 å¸¸è§é—®é¢˜"></a>2 å¸¸è§é—®é¢˜</h1><blockquote>
<p>[!warning] Tips</p>
<ol>
<li><strong>é‡å¯ï¼ˆç‰©ç†æœºã€è™šæ‹Ÿæœºã€æœåŠ¡ã€pod ç­‰ï¼‰</strong> å¯èƒ½æ˜¯ <code>æœ€ç›´æ¥å¸¸è§çš„åŠæ³•</code>ï¼Œä½† <code>ä¸æ˜¯æœ€æœ‰æ•ˆ</code> çš„åŠæ³•ï¼Œå…·ä½“é—®é¢˜å…·ä½“åˆ†æï¼Œé‡åœ¨<strong>æ ¹æ®é—®é¢˜é€æ­¥æœç´¢çš„æ’æŸ¥æ€è·¯ï¼Œè‡ªé¡¶å‘ä¸‹æ’æŸ¥ï¼Œè‡ªåº•å‘ä¸Šè§£å†³</strong>ã€‚</li>
<li><em>é‡åˆ°é—®é¢˜ä¸è¦æ…Œï¼Œä¼—é‡Œå¯»å®ƒå…ˆç™¾åº¦ï¼Œå±æ˜¯ä¸è¡Œå†é—®è·¯ï¼Œå…ˆæ€è€ƒååŠ¨è„‘ï¼Œå¤šå­¦å¤šçœ‹å¤šå®è·µï¼Œèƒ½åŠ›æ—¥ç›ŠèŠ‚èŠ‚é«˜</em>ã€‚</li>
</ol>
</blockquote>
<h2 id="2-1-é•œåƒæ— æ³•æ‹‰å–"><a href="#2-1-é•œåƒæ— æ³•æ‹‰å–" class="headerlink" title="2.1 é•œåƒæ— æ³•æ‹‰å–"></a>2.1 é•œåƒæ— æ³•æ‹‰å–</h2><ol>
<li>åŸå› ï¼šç”±äºå›½å†…é˜²ç«å¢™å¯¼è‡´å›½å¤–å®˜æ–¹é•œåƒä»“åº“è¢«å¢™æ— æ³•æ‹‰å–é•œåƒï¼Œæœ¬åœ°é•œåƒåº“ç¼“å­˜å¯¼è‡´æ‹‰å–æ—¶æ²¡æœ‰æ‰¾åˆ°æœ€æ–°é•œåƒï¼Œdocker ç½‘ç»œé—®é¢˜ï¼Œç³»ç»Ÿç½‘ç»œé—®é¢˜</li>
<li>åŠæ³•ï¼š<ul>
<li>å‡ºå›½æ—…æ¸¸ï¼šwindosw å¼€å¯é­”æ³•æ‹‰å–é•œåƒåé€šè¿‡ docker save å’Œ load è½¬ç§»é•œåƒï¼Œå¹¶ push åˆ°æœ¬åœ°ç§æœ‰é•œåƒä»“åº“ç•™å­˜ã€‚</li>
<li>å–è€Œä»£ä¹‹ï¼šå¯»æ‰¾å›½å†…é•œåƒæºä»“åº“ï¼Œç›´æ¥æ‹‰å–å›½å†…é•œåƒä»“åº“çš„é•œåƒåˆ°æœ¬åœ°ï¼Œå¹¶æ¨é€åˆ°æœ¬åœ°ç§æœ‰ä»“åº“ç•™å­˜ã€‚ï¼ˆå›½å†…é•œåƒä»“åº“ä¸ç¨³å®šï¼Œå¯èƒ½ä¼šæ¸…é™¤é•œåƒï¼‰</li>
<li>é‡å¯ dockerï¼šdocker pull å¡åœ¨ waiting åˆ™å¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜ï¼Œå°† pod æ‰€åœ¨èŠ‚ç‚¹çš„ docker è¿›è¡Œé‡å¯ã€‚</li>
<li>æ£€æŸ¥ hosts æ·»åŠ è®°å½•ï¼š<code>cat /etc/hosts</code> è®°å½•æ ¼å¼ï¼šip    domain</li>
<li>é‡å¯ç³»ç»Ÿç½‘ç»œï¼š<code>sudo systemctl restart NetworkManager</code></li>
</ul>
</li>
</ol>
<h2 id="2-2-å†…å­˜-ç¡¬ç›˜æ»¡è½½-æº¢å‡º"><a href="#2-2-å†…å­˜-ç¡¬ç›˜æ»¡è½½-æº¢å‡º" class="headerlink" title="2.2 å†…å­˜&#x2F;ç¡¬ç›˜æ»¡è½½&#x2F;æº¢å‡º"></a>2.2 å†…å­˜&#x2F;ç¡¬ç›˜æ»¡è½½&#x2F;æº¢å‡º</h2><ol>
<li>åŸå› ï¼šéšç€æ—¶é—´çš„ç´¯ç§¯å’Œè´Ÿè½½å˜åŒ–ï¼Œå†…å­˜æˆ–ç¡¬ç›˜èµ„æºå¯èƒ½ä¼šä¸å¤Ÿï¼Œè™šæ‹Ÿæœºè´Ÿè½½è¿‡å¤§ï¼Œæ— æ³•æä¾›æ­£å¸¸å“åº”ã€‚</li>
<li>åŠæ³•ï¼š<ul>
<li>å†…å­˜ï¼šæ¸…ç†æ— ç”¨è¿›ç¨‹ï¼ˆkillï¼‰ï¼Œé‡å¯è™šæ‹Ÿæœºï¼ˆrebootï¼‰ï¼Œæ‰©å®¹å†…å­˜ï¼ˆvcenter æ‰©å¤§è™šæ‹Ÿæœºå†…å­˜ï¼‰</li>
<li>ç¡¬ç›˜ï¼šæŸ¥çœ‹ç£ç›˜åˆ†åŒºå’ŒæŒ‚è½½æƒ…å†µï¼ˆdf -hï¼‰ï¼Œæ¸…ç†æ— ç”¨æ–‡ä»¶ï¼ˆrm -rfï¼‰ï¼Œè½¬ç§»æ–‡ä»¶ï¼ˆmvï¼‰ï¼Œç¡¬ç›˜æ‰©å®¹ï¼ˆåˆ†é…æ›´å¤šåˆ†å¸ƒå¼å­˜å‚¨å®¹é‡ï¼Œæ·»åŠ ä¸€å—ç£ç›˜å¹¶è¿›è¡Œç£ç›˜åˆ†åŒºï¼‰</li>
</ul>
</li>
</ol>
<h2 id="2-3-æŒ‚è½½å·å­˜å‚¨æ»¡è½½"><a href="#2-3-æŒ‚è½½å·å­˜å‚¨æ»¡è½½" class="headerlink" title="2.3 æŒ‚è½½å·å­˜å‚¨æ»¡è½½"></a>2.3 æŒ‚è½½å·å­˜å‚¨æ»¡è½½</h2><ol>
<li>åŸå› ï¼šæŒ‚è½½çš„æ•°æ®å·å­˜å‚¨å®¹é‡æœ‰é™ï¼Œå½“æ»¡è½½åæ— æ³•åœ¨æŒ‚è½½ç›®å½•ä¸‹æ–°å¢ç›®å½•æˆ–æ–‡ä»¶ã€‚</li>
<li>åŠæ³•ï¼š<ul>
<li>æ¸…ç†æŒ‚è½½ç›®å½•ä¸‹æ— ç”¨çš„æ–‡ä»¶ï¼Œè…¾å‡ºå¯ç”¨ç©ºé—´</li>
<li>å¯¹æŒ‚è½½å·è¿›è¡Œæ‰©å®¹ï¼Œå¢åŠ å…¶å­˜å‚¨å®¹é‡ã€‚</li>
</ul>
</li>
</ol>
<h2 id="2-4-CPU-æ ¸å¿ƒè¿‡å¤šè½¯é”å®š"><a href="#2-4-CPU-æ ¸å¿ƒè¿‡å¤šè½¯é”å®š" class="headerlink" title="2.4 CPU æ ¸å¿ƒè¿‡å¤šè½¯é”å®š"></a>2.4 CPU æ ¸å¿ƒè¿‡å¤šè½¯é”å®š</h2><ol>
<li>é—®é¢˜æè¿°ï¼š</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">   [1539310.375852]NMI watchdog:BUG:soft lockup CPU<span class="hljs-comment">#20 stuck for 23s![migration/20:111]</span><br>[1539310.375856]NMI watchdog:BUG:soft lockup CPU<span class="hljs-comment">#28 stuck for 23s![kubelet:9779]</span><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>åŸå› ï¼šæ—¥å¿—è¡¨æ˜ç³»ç»Ÿé‡åˆ°äº†ä¸€ä¸ªâ€œè½¯é”å®šâ€ï¼ˆsoft lockupï¼‰çš„æƒ…å†µã€‚è¿™é€šå¸¸æ„å‘³ç€æŸä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹åœ¨ CPU ä¸Šè¿è¡Œäº†å¾ˆé•¿æ—¶é—´ï¼Œå¯¼è‡´ç³»ç»Ÿç›‘è§†å™¨è®¤ä¸ºå®ƒå¯èƒ½å·²ç»å†»ç»“æˆ–å¡ä½ã€‚<ul>
<li><strong>æ­»é”</strong>ï¼šä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹å¯èƒ½é™·å…¥äº†æ­»é”çŠ¶æ€ï¼Œå¯¼è‡´ CPU æ— æ³•å¤„ç†å…¶ä»–ä»»åŠ¡ã€‚</li>
<li><strong>èµ„æºç«äº‰</strong>ï¼šè¿›ç¨‹ä¹‹é—´å¯èƒ½å­˜åœ¨èµ„æºç«äº‰ï¼Œå¯¼è‡´ CPU é•¿æ—¶é—´å ç”¨ã€‚</li>
<li><strong>æ— é™å¾ªç¯</strong>ï¼šä»£ç ä¸­å¯èƒ½å­˜åœ¨æ— é™å¾ªç¯ï¼Œå¯¼è‡´ CPU è¢«æŒç»­å ç”¨ã€‚</li>
<li><strong>å†…æ ¸é—®é¢˜</strong>ï¼šå¯èƒ½æ˜¯å†…æ ¸æœ¬èº«çš„é—®é¢˜ï¼Œæ¯”å¦‚é©±åŠ¨ç¨‹åºæˆ–å†…æ ¸è¡¥ä¸å¼•èµ·çš„é—®é¢˜ã€‚</li>
<li><strong>é«˜è´Ÿè½½</strong>ï¼šç³»ç»Ÿå¯èƒ½ç”±äºé«˜è´Ÿè½½è€Œæ— æ³•åŠæ—¶å“åº”ã€‚</li>
</ul>
</li>
</ol>
<blockquote>
<p>cpu stuck è½¯é”å®šçš„åŸå› æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚ä¾›ç”µä¸è¶³ã€è™šæ‹Ÿæœº cpu æ ¸å¿ƒæ•°è¶…è¿‡ç‰©ç†æœºæ ¸å¿ƒæ•°ã€è™šæ‹Ÿæœº&#x2F;ç‰©ç†æœº cpu å¤ªå¿™æˆ–ç£ç›˜ IO å¤ªé«˜ã€linux å†…æ ¸ bug ç­‰</p>
</blockquote>
<ol>
<li>åŠæ³•ï¼š<ul>
<li>ä½¿ç”¨ <code>catÂ /var/dmesg</code>Â æˆ–Â <code>journalctl</code>Â æŸ¥çœ‹å†…æ ¸æ—¥å¿—ã€‚</li>
<li>æŸ¥çœ‹æ ¸å¿ƒæ•°æ˜¯å¦è¿‡å¤šï¼ˆegï¼š32ï¼‰ï¼Œå…³æœºå‡å°‘æ ¸å¿ƒæ•°ï¼ˆegï¼š12ï¼‰ï¼›æ‰€æœ‰è™šæ‹Ÿæœºçš„è™šæ‹Ÿ cpu åŠ èµ·æ¥å¯èƒ½ä¼šè¶…è¿‡ç‰©ç†æœºå®é™… cpu çº¿ç¨‹æ•°ï¼Œä½†å•ä¸ªè™šæ‹Ÿæœºçš„è™šæ‹Ÿ cpu å¤„ç†å™¨æ•°ä¸èƒ½è¶…è¿‡ç‰©ç†æœºçº¿ç¨‹æ•°ï¼Œ<strong>ä¸€èˆ¬è™šæ‹Ÿ cpu ä¸ªæ•°å’Œç‰©ç†æœº cpu ä¸ªæ•°ä¿æŒä¸€è‡´ï¼Œæ€»å¤„ç†å™¨æ•°è®¾ä¸ºç‰©ç†æœºçš„ä¸€åŠ</strong>ã€‚(å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45603370/article/details/140293255">è™šæ‹Ÿæœºå¦‚ä½•é€‰æ‹©å¤„ç†å™¨å’Œå†…æ ¸æ•°é‡ï¼Œå®ç°æœ€ä½³æ€§èƒ½_è™šæ‹Ÿæœºè®¾ç½®cpuå¤„ç†å™¨åªæœ‰å¤„ç†å†…æ ¸æ•°é‡-CSDNåšå®¢</a>)</li>
</ul>
</li>
</ol>
<h2 id="2-5-å†…å­˜å ç”¨è™šé«˜"><a href="#2-5-å†…å­˜å ç”¨è™šé«˜" class="headerlink" title="2.5 å†…å­˜å ç”¨è™šé«˜"></a>2.5 å†…å­˜å ç”¨è™šé«˜</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/vincent0920/article/details/135485154">vmwareè™šæ‹Ÿæœºå†…å­˜å¼‚å¸¸å ç”¨é—®é¢˜ä¸€ä¾‹_esxi8.0å ç”¨å†…å­˜æ€ä¹ˆå¤„ç†</a></p>
<h2 id="2-6-MySQL-æ•…éšœ"><a href="#2-6-MySQL-æ•…éšœ" class="headerlink" title="2.6 MySQL æ•…éšœ"></a>2.6 MySQL æ•…éšœ</h2><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/paul8339/p/16880095.html">MySQLå¯åŠ¨æŠ¥é”™[ERROR] InnoDB: Trying to access page number 4294967295 in space 0, space name innodb</a></p>
<h3 id="2-6-1-K8s-é›†ç¾¤è¿ä¸ä¸Š"><a href="#2-6-1-K8s-é›†ç¾¤è¿ä¸ä¸Š" class="headerlink" title="2.6.1 K8s é›†ç¾¤è¿ä¸ä¸Š"></a>2.6.1 K8s é›†ç¾¤è¿ä¸ä¸Š</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45547688/article/details/131325877">k8s é›†ç¾¤ kubeletæ—¥å¿—æŠ¥é”™ command failedâ€œ err&#x3D;â€œfailed to parse kubelet flag: unknown flag: â€“network-p_command failedâ€ err&#x3D;â€failed to parse kubelet flag</a><br>kubelet ç‰ˆæœ¬èŠ‚ç‚¹ä¹‹é—´ä¸ä¸€è‡´</p>
<p>æŸ¥çœ‹çŠ¶æ€å’Œæ—¥å¿—ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">systemctl status kubelet.service<br>journalctl -u kubelet -f<br></code></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ç‰ˆæœ¬ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">rpm -qa | grep kube<br></code></pre></td></tr></table></figure>

<p>ç‰ˆæœ¬é™çº§ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum downgrade kubeadm-1.18.0-0.x86_64 kubectl-1.18.0-0.x86_64 kubelet-1.18.0-0.x86_64<br></code></pre></td></tr></table></figure>

<p>é‡å¯ kubeletï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo systemctl restart kubelet.service<br>systemctl daemon-reload<br></code></pre></td></tr></table></figure>

<h2 id="2-7-Rancher-æ•…éšœ"><a href="#2-7-Rancher-æ•…éšœ" class="headerlink" title="2.7 Rancher æ•…éšœ"></a>2.7 Rancher æ•…éšœ</h2><h3 id="2-7-1-Rancher-è¿ä¸ä¸Š-Apiserver"><a href="#2-7-1-Rancher-è¿ä¸ä¸Š-Apiserver" class="headerlink" title="2.7.1 Rancher è¿ä¸ä¸Š Apiserver"></a>2.7.1 Rancher è¿ä¸ä¸Š Apiserver</h3><p>åŸå› ï¼šcni ä¸Šå±‚çš„ç½‘ç»œç»„ä»¶å‡ºç°äº†é—®é¢˜ï¼Œå¯èƒ½æ˜¯ç½‘ç»œç›¸å…³çš„ podï¼ˆkube-system ç©ºé—´ä¸‹æˆ–è€…ç›´æ¥-A æŸ¥çœ‹æ‰€æœ‰æ¶‰åŠåˆ°ç½‘ç»œç›¸å…³çš„ podï¼‰æŒ‚äº†ï¼Œé‡å¯åæ‹‰ä¸åˆ°é•œåƒå¯¼è‡´ç½‘ç»œä¸å¯ç”¨ã€‚<br>è§£å†³ï¼šæ’æŸ¥ç½‘ç»œç›¸å…³ç»„ä»¶ pod æ˜¯å¦æ­£å¸¸ï¼Œä¸æ­£å¸¸åˆ™æ ¹æ® event å’Œ status è¿›è¡Œè§£å†³ã€‚</p>
<h2 id="2-8-é›†ç¾¤åŸŸåä¿®æ”¹"><a href="#2-8-é›†ç¾¤åŸŸåä¿®æ”¹" class="headerlink" title="2.8 é›†ç¾¤åŸŸåä¿®æ”¹"></a>2.8 é›†ç¾¤åŸŸåä¿®æ”¹</h2><h3 id="2-8-1-ä¿®æ”¹-242nginx-åŸŸåé…ç½®"><a href="#2-8-1-ä¿®æ”¹-242nginx-åŸŸåé…ç½®" class="headerlink" title="2.8.1 ä¿®æ”¹ 242nginx åŸŸåé…ç½®"></a>2.8.1 ä¿®æ”¹ 242nginx åŸŸåé…ç½®</h3><p>ä¿®æ”¹ <code>admin/nginx</code> ç›®å½•ä¸‹çš„ nginx åŸŸåé…ç½®ã€‚<br>å†ä½¿ç”¨ <code>./config</code> è„šæœ¬æ›´æ–°é‡å¯ nginx ä»¥ç”Ÿæ•ˆé…ç½®ã€‚</p>
<h3 id="2-8-2-æ”¹-233gitlab-é…ç½®æ–‡ä»¶é‡Œçš„åŸŸå"><a href="#2-8-2-æ”¹-233gitlab-é…ç½®æ–‡ä»¶é‡Œçš„åŸŸå" class="headerlink" title="2.8.2 æ”¹ 233gitlab é…ç½®æ–‡ä»¶é‡Œçš„åŸŸå"></a>2.8.2 æ”¹ 233gitlab é…ç½®æ–‡ä»¶é‡Œçš„åŸŸå</h3><p>é…ç½®æ–‡ä»¶ä½ç½®ï¼š<code>/etc/gitlab/gitlab.rb</code><br>ä¿®æ”¹ gitlab é…ç½®åé‡å¯ï¼ŒåŒæ­¥ä¿®æ”¹é›†ç¾¤å†…çš„ gitlab-runner é…ç½®ï¼ˆconfigmapï¼‰é‡Œçš„åŸŸåã€‚<br><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/blog/20250324223941398.png" srcset="/img/loading.gif" lazyload alt="|600"></p>
<h3 id="2-8-3-æ”¹-102harbor-é…ç½®æ–‡ä»¶é‡Œçš„åŸŸå"><a href="#2-8-3-æ”¹-102harbor-é…ç½®æ–‡ä»¶é‡Œçš„åŸŸå" class="headerlink" title="2.8.3 æ”¹ 102harbor é…ç½®æ–‡ä»¶é‡Œçš„åŸŸå"></a>2.8.3 æ”¹ 102harbor é…ç½®æ–‡ä»¶é‡Œçš„åŸŸå</h3><p>é…ç½®æ–‡ä»¶ä½ç½®ï¼š<code>/opt/harbor_1_7/harbor.cfg</code><br>ä¿®æ”¹ harbor é…ç½®åé‡å¯ï¼ŒåŒæ­¥ä¿®æ”¹é›†ç¾¤å†…çš„æ‰€æœ‰é•œåƒçš„ä»“åº“åœ°å€ï¼ˆåŸºç¡€è®¾æ–½ã€å®šæ—¶ä»»åŠ¡ã€åº”ç”¨æœåŠ¡ç­‰ï¼‰ã€‚</p>
<h3 id="2-8-4-ä¿®æ”¹-kubelet-çš„é…ç½®ä»“åº“é‰´æƒåŸŸå"><a href="#2-8-4-ä¿®æ”¹-kubelet-çš„é…ç½®ä»“åº“é‰´æƒåŸŸå" class="headerlink" title="2.8.4 ä¿®æ”¹ kubelet çš„é…ç½®ä»“åº“é‰´æƒåŸŸå"></a>2.8.4 ä¿®æ”¹ kubelet çš„é…ç½®ä»“åº“é‰´æƒåŸŸå</h3><p>é…ç½®æ–‡ä»¶ä½äºï¼š<code>/var/lib/kubelet/config.json</code><br>ä¿®æ”¹é‡Œé¢çš„ä»“åº“åŸŸåã€‚</p>
<h2 id="2-9-Harbor-é•œåƒä»“åº“æ¸…ç†"><a href="#2-9-Harbor-é•œåƒä»“åº“æ¸…ç†" class="headerlink" title="2.9 Harbor é•œåƒä»“åº“æ¸…ç†"></a>2.9 Harbor é•œåƒä»“åº“æ¸…ç†</h2><ol>
<li><strong>å®šä½æ¸…ç†ç›®æ ‡é¡¹ç›®</strong>ï¼šç™»å½• harbor é•œåƒä»“åº“ï¼ˆregistry.csdcinfo.cnï¼‰ï¼Œè¿›å…¥éœ€è¦æ¸…ç†çš„é¡¹ç›®ã€‚</li>
<li><strong>è¿‡æ»¤å‡ºå¾…åˆ é™¤ä»“åº“é•œåƒ</strong>ï¼šè¿›å…¥éœ€è¦åˆ é™¤çš„ä»“åº“ï¼ŒæŒ‰ç…§æ—¥æœŸå‡åºå¤šé€‰é€‰ä¸­éœ€è¦åˆ é™¤çš„é•œåƒã€‚<br><img src="http://img.fcs.cloudns.ch/pics/20250407150126574.png" srcset="/img/loading.gif" lazyload alt="|500"></li>
<li><strong>åˆ é™¤é€‰ä¸­çš„ tag é•œåƒ</strong>ï¼šåœ¨ä»“åº“ä¸­åˆ é™¤å‰é¢é€‰ä¸­çš„ tag é•œåƒã€‚<br><img src="http://img.fcs.cloudns.ch/pics/20250407150346301.png" srcset="/img/loading.gif" lazyload alt="|500"></li>
<li><strong>æ¸…ç†ç£ç›˜ç©ºé—´</strong>ï¼šä¸Šè¿°åˆ é™¤ä»…ä¸ºè½¯åˆ é™¤å¹¶æ²¡æœ‰é‡Šæ”¾ç£ç›˜ç©ºé—´ï¼Œéœ€è¦è¿›å…¥ç³»ç»Ÿç®¡ç†çš„åƒåœ¾æ¸…ç†ç‚¹å‡»ç«‹å³æ¸…ç†åƒåœ¾ï¼Œæ­¤æ—¶ä¼šå°†å‰é¢è½¯åˆ é™¤çš„é•œåƒå®é™…åˆ é™¤é‡Šæ”¾å‡ºå ç”¨çš„ç©ºé—´ã€‚<br><img src="http://img.fcs.cloudns.ch/pics/20250407150534168.png" srcset="/img/loading.gif" lazyload alt="|500"></li>
</ol>
<h2 id="2-10-Mongodb-å¯åŠ¨å¤±è´¥"><a href="#2-10-Mongodb-å¯åŠ¨å¤±è´¥" class="headerlink" title="2.10 Mongodb å¯åŠ¨å¤±è´¥"></a>2.10 Mongodb å¯åŠ¨å¤±è´¥</h2><blockquote>
<p>é—®é¢˜ï¼šRollback failed with unrecoverable error: UnrecoverableRollbackError: not willing to roll back more than 86400 seconds of data. Have: 263733 seconds</p>
</blockquote>
<p>åŸå› ï¼šåˆ†ç‰‡æŒ‚æ‰æ²¡æœ‰åŠæ—¶å¯åŠ¨ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼Œæ— æ³•å¯åŠ¨ã€‚</p>
<p>è§£å†³åŠæ³•ï¼š</p>
<ol>
<li>å…³é—­ mongo é›†ç¾¤ï¼Œæ‰¾åˆ°è¿™ä¸ªåˆ†ç‰‡çš„ä¸»åˆ†ç‰‡ï¼ŒæŠŠå®ƒçš„æ•´ä¸ªç›®å½•å¤åˆ¶åˆ°æ— æ³•å¯åŠ¨çš„é‚£å°åˆ†ç‰‡ä¸Š</li>
<li>å¢å¤§åŒæ­¥æ—¶é—´é™åˆ¶ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡ MONGODB_EXTRA_FLAGS &#x3D; â€“setParameter&#x3D;rollbackTimeLimitSecs&#x3D;172800ï¼Œé€šè¿‡ä»¥ä¸‹æŒ‡ä»¤éªŒè¯ï¼šmongo -u username -p password â€“authenticationDatabase admin â€“eval â€œdb.adminCommand({getParameter: 1, rollbackTimeLimitSecs: 1})â€</li>
</ol>
<h1 id="3-å¸¸ç”¨é•œåƒ"><a href="#3-å¸¸ç”¨é•œåƒ" class="headerlink" title="3 å¸¸ç”¨é•œåƒ"></a>3 å¸¸ç”¨é•œåƒ</h1><h2 id="3-1-åŸºç¡€è®¾æ–½"><a href="#3-1-åŸºç¡€è®¾æ–½" class="headerlink" title="3.1 åŸºç¡€è®¾æ–½"></a>3.1 åŸºç¡€è®¾æ–½</h2><h3 id="3-1-1-Longhorn"><a href="#3-1-1-Longhorn" class="headerlink" title="3.1.1 Longhorn"></a>3.1.1 Longhorn</h3><p>longhornio&#x2F;csi-attacher:v2.2.1-lh1<br>longhornio&#x2F;csi-provisioner:v1.6.0-lh1<br><code>longhornio/csi-resizer:v0.5.1-lh1</code><br>longhornio&#x2F;csi-snapshotter:v2.1.1-lh1<br>longhornio&#x2F;longhorn-engine:v1.1.0<br>longhornio&#x2F;longhorn-instance-manager:v1_20201216<br>longhornio&#x2F;longhorn-manager:v1.1.0<br>longhornio&#x2F;csi-node-driver-registrar:v1.2.0-lh1<br>longhornio&#x2F;longhorn-ui:v1.1.0</p>
<h3 id="3-1-2-æ•°æ®åº“"><a href="#3-1-2-æ•°æ®åº“" class="headerlink" title="3.1.2 æ•°æ®åº“"></a>3.1.2 æ•°æ®åº“</h3><h4 id="3-1-2-1-å…³ç³»å‹"><a href="#3-1-2-1-å…³ç³»å‹" class="headerlink" title="3.1.2.1 å…³ç³»å‹"></a>3.1.2.1 å…³ç³»å‹</h4><p>busybox:1.32<br>registry.csdc.info&#x2F;publish&#x2F;mysql:5.7.31<br>mysql:5.7.31<br>nacos&#x2F;nacos-mysql-master:latest<br>nacos&#x2F;nacos-mysql-slave:latest<br>prom&#x2F;mysqld-exporter</p>
<h4 id="3-1-2-2-éå…³ç³»å‹"><a href="#3-1-2-2-éå…³ç³»å‹" class="headerlink" title="3.1.2.2 éå…³ç³»å‹"></a>3.1.2.2 éå…³ç³»å‹</h4><h5 id="3-1-2-2-1-Redis"><a href="#3-1-2-2-1-Redis" class="headerlink" title="3.1.2.2.1 Redis"></a>3.1.2.2.1 Redis</h5><p>registry.csdc.info&#x2F;publish&#x2F;redis507<br>registry.csdc.info&#x2F;publish&#x2F;redis-exporter135<br>oliver006&#x2F;redis_exporter:v1.3.4<br>registry.csdc.info&#x2F;publish&#x2F;redisinsight:latest</p>
<h5 id="3-1-2-2-2-Neo4j"><a href="#3-1-2-2-2-Neo4j" class="headerlink" title="3.1.2.2.2 Neo4j"></a>3.1.2.2.2 Neo4j</h5><p>neo4j:3.5</p>
<h5 id="3-1-2-2-3-ELK"><a href="#3-1-2-2-3-ELK" class="headerlink" title="3.1.2.2.3 ELK"></a>3.1.2.2.3 ELK</h5><p>registry.csdc.info&#x2F;publish&#x2F;elasticsearch-ik-py:7.16.2<br>registry.csdc.info&#x2F;publish&#x2F;elasticsearch-ik:7.9.2<br>docker.elastic.co&#x2F;kibana&#x2F;kibana:7.16.2<br>registry.csdc.info&#x2F;elk&#x2F;logstash&#x2F;logstash:7.16.2<br>docker.elastic.co&#x2F;eck&#x2F;eck-operator:1.9.1</p>
<h5 id="3-1-2-2-4-Mongodb"><a href="#3-1-2-2-4-Mongodb" class="headerlink" title="3.1.2.2.4 Mongodb"></a>3.1.2.2.4 Mongodb</h5><p>registry.csdc.info&#x2F;publish&#x2F;mongodb424:latest<br>registry.csdc.info&#x2F;publish&#x2F;mongodb-exporter:latest</p>
<h4 id="3-1-2-3-OSS"><a href="#3-1-2-3-OSS" class="headerlink" title="3.1.2.3 OSS"></a>3.1.2.3 OSS</h4><p>minio&#x2F;minio:RELEASE.2022-03-17T06-34-49Z</p>
<h3 id="3-1-3-åå‘ä»£ç†"><a href="#3-1-3-åå‘ä»£ç†" class="headerlink" title="3.1.3 åå‘ä»£ç†"></a>3.1.3 åå‘ä»£ç†</h3><p>nginx:stable<br>nginx:1.7.9<br>nginx:1.15</p>
<h3 id="3-1-4-å¾®æœåŠ¡ä¸­é—´ä»¶"><a href="#3-1-4-å¾®æœåŠ¡ä¸­é—´ä»¶" class="headerlink" title="3.1.4 å¾®æœåŠ¡ä¸­é—´ä»¶"></a>3.1.4 å¾®æœåŠ¡ä¸­é—´ä»¶</h3><h4 id="3-1-4-1-Nacos"><a href="#3-1-4-1-Nacos" class="headerlink" title="3.1.4.1 Nacos"></a>3.1.4.1 Nacos</h4><p>nacos&#x2F;nacos-server:0.9.0<br>registry.csdc.info&#x2F;publish&#x2F;nacos&#x2F;nacos-server:0.9.0<br>nacos&#x2F;nacos-server:2.0.3<br>registry.csdc.info&#x2F;publish&#x2F;nacos221:latest</p>
<h4 id="3-1-4-2-RabbitMQ"><a href="#3-1-4-2-RabbitMQ" class="headerlink" title="3.1.4.2 RabbitMQ"></a>3.1.4.2 RabbitMQ</h4><p>docker.io&#x2F;bitnami&#x2F;rabbitmq:3.11.6-debian-11-r0</p>
<h4 id="3-1-4-3-Seata"><a href="#3-1-4-3-Seata" class="headerlink" title="3.1.4.3 Seata"></a>3.1.4.3 Seata</h4><p>docker.io&#x2F;seataio&#x2F;seata-server:latest<br>registry.csdc.info&#x2F;etms&#x2F;seata-server:latest</p>
<h3 id="3-1-5-Gitlab"><a href="#3-1-5-Gitlab" class="headerlink" title="3.1.5 Gitlab"></a>3.1.5 Gitlab</h3><p>registry.csdc.info&#x2F;publish&#x2F;docker:stable-dind<br>gitlab&#x2F;gitlab-runner:alpine-v13.7.0<br>gitlab&#x2F;gitlab-runner-helper:x86_64-943fc252</p>
<h3 id="3-1-6-Harbor"><a href="#3-1-6-Harbor" class="headerlink" title="3.1.6 Harbor"></a>3.1.6 Harbor</h3><p>harbor.newershoe.com:8443&#x2F;library&#x2F;etcd</p>
<h3 id="3-1-7-ç›‘æ§çœ‹æ¿"><a href="#3-1-7-ç›‘æ§çœ‹æ¿" class="headerlink" title="3.1.7 ç›‘æ§çœ‹æ¿"></a>3.1.7 ç›‘æ§çœ‹æ¿</h3><h4 id="3-1-7-1-Grafana"><a href="#3-1-7-1-Grafana" class="headerlink" title="3.1.7.1 Grafana"></a>3.1.7.1 Grafana</h4><p>rancher&#x2F;grafana-grafana:7.1.5<br>rancher&#x2F;prometheus-auth:v0.2.1<br>grafana&#x2F;loki:2.4.2<br>grafana&#x2F;grafana:8.3.5<br>grafana&#x2F;promtail:2.1.0</p>
<h4 id="3-1-7-2-Prometheus"><a href="#3-1-7-2-Prometheus" class="headerlink" title="3.1.7.2 Prometheus"></a>3.1.7.2 Prometheus</h4><p>rancher&#x2F;prom-prometheus:v2.18.2<br>rancher&#x2F;coreos-prometheus-config-reloader:v0.39.0<br>rancher&#x2F;jimmidyson-configmap-reload:v0.3.0<br>rancher&#x2F;mirrored-library-nginx:1.19.9-alpine</p>
<h3 id="3-1-8-SSH"><a href="#3-1-8-SSH" class="headerlink" title="3.1.8 SSH"></a>3.1.8 SSH</h3><p>registry.csdc.info&#x2F;publish&#x2F;panubo-sshd:latest<br>panubo&#x2F;sshd</p>
<h3 id="3-1-9-å…¶ä»–"><a href="#3-1-9-å…¶ä»–" class="headerlink" title="3.1.9 å…¶ä»–"></a>3.1.9 å…¶ä»–</h3><p>registry.csdc.info&#x2F;publish&#x2F;dingtalk-chatbot:1.0.3<br>registry.csdc.info&#x2F;publish&#x2F;databasetools:0.0.2<br>registry.csdc.info&#x2F;publish&#x2F;rsync-ssh:latest<br>rancher&#x2F;rancher-agent:v2.5.8<br>rancher&#x2F;fleet:v0.3.1<br>rancher&#x2F;gitjob:v0.1.8<br>rancher&#x2F;nginx-ingress-controller-defaultbackend:1.5-rancher1<br>rancher&#x2F;nginx-ingress-controller:nginx-0.35.0-rancher1<br>rancher&#x2F;calico-kube-controllers:v3.16.1<br>rancher&#x2F;calico-cni:v3.16.1<br>rancher&#x2F;calico-pod2daemon-flexvol:v3.16.1<br>rancher&#x2F;calico-node:v3.16.1<br>rancher&#x2F;coreos-flannel:v0.13.0-rancher1<br>rancher&#x2F;coredns-coredns:1.7.0<br>rancher&#x2F;cluster-proportional-autoscaler:1.8.1<br>rancher&#x2F;metrics-server:v0.3.6<br>rancher&#x2F;hyperkube:v1.19.3-rancher1<br>registry.csdc.info&#x2F;publish&#x2F;k8s-sidecar:1.15.1<br>registry.csdc.info&#x2F;publish&#x2F;kube-state-metrics:v2.2.4<br>quay.io&#x2F;prometheus&#x2F;alertmanager:v0.23.0<br>jimmidyson&#x2F;configmap-reload:v0.5.0<br>quay.io&#x2F;prometheus&#x2F;node-exporter:v1.3.0<br>prom&#x2F;pushgateway:v1.4.2<br>quay.io&#x2F;prometheus&#x2F;prometheus:v2.31.1<br>rancher&#x2F;rancher-operator:v0.1.3<br>registry.csdc.info&#x2F;publish&#x2F;tomcat:7<br>registry.csdc.info&#x2F;elk&#x2F;filebeat:7.9.2<br>registry.csdc.info&#x2F;publish&#x2F;locust-tasks<br>registry.csdc.info&#x2F;publish&#x2F;kubectl:v1.14</p>
<h3 id="3-1-10-Research"><a href="#3-1-10-Research" class="headerlink" title="3.1.10 Research"></a>3.1.10 Research</h3><p>conda:fus<br>centos:latest<br>nvidia&#x2F;cuda:10.1-devel-ubuntu18.04<br>nvidia&#x2F;cuda:10.1-cudnn7-devel-centos7</p>
<h1 id="4-æ•°æ®å¤‡ä»½"><a href="#4-æ•°æ®å¤‡ä»½" class="headerlink" title="4 æ•°æ®å¤‡ä»½"></a>4 æ•°æ®å¤‡ä»½</h1><h2 id="4-1-å¤‡ä»½æ¸…å•"><a href="#4-1-å¤‡ä»½æ¸…å•" class="headerlink" title="4.1 å¤‡ä»½æ¸…å•"></a>4.1 å¤‡ä»½æ¸…å•</h2><h3 id="4-1-1-æ•°æ®åº“å¤‡ä»½"><a href="#4-1-1-æ•°æ®åº“å¤‡ä»½" class="headerlink" title="4.1.1 æ•°æ®åº“å¤‡ä»½"></a>4.1.1 æ•°æ®åº“å¤‡ä»½</h3><p>åº”ç”¨æ•°æ®åº“å¤‡ä»½ï¼ˆæ¯å¤©ï¼‰ï¼š</p>
<ol>
<li>K8s å†…å¤‡ä»½ï¼š<ul>
<li>srdb: mysqlï¼Œmongodb</li>
<li>smdb: mysql</li>
<li>hsas: mysql</li>
<li>cwebï¼ˆæ¯æœˆï¼‰ï¼šmysql</li>
</ul>
</li>
<li>dbServï¼ˆ220ï¼‰ä¸Šå¤‡ä»½ï¼š<ul>
<li>cmisï¼šmysql(auth)ï¼Œoracle</li>
</ul>
</li>
</ol>
<h3 id="4-1-2-æ–‡ä»¶å¤‡ä»½"><a href="#4-1-2-æ–‡ä»¶å¤‡ä»½" class="headerlink" title="4.1.2 æ–‡ä»¶å¤‡ä»½"></a>4.1.2 æ–‡ä»¶å¤‡ä»½</h3><p>åº”ç”¨æ–‡ä»¶å¤‡ä»½ï¼š</p>
<ol>
<li>K8S å†…å¤‡ä»½ï¼ˆæ¯å¤©ï¼‰ï¼š<ul>
<li>srdb</li>
<li>smdb</li>
<li>hsas</li>
<li>cmis</li>
<li>cwebï¼ˆæ¯æœˆï¼‰</li>
</ul>
</li>
</ol>
<p>FTP æ–‡ä»¶å¤‡ä»½ï¼š<br>210 ä¸Šå¤‡ä»½ï¼ˆæ¯æ—©ä¸Š 8 ç‚¹ï¼‰ï¼š<code>autosync_push.sh</code></p>
<p>GitLab ä»£ç å¤‡ä»½ï¼ˆæ¯å‘¨å¤©ï¼‰ï¼š<code>autobackup.sh</code></p>
<h2 id="4-2-æ³¨æ„äº‹é¡¹"><a href="#4-2-æ³¨æ„äº‹é¡¹" class="headerlink" title="4.2 æ³¨æ„äº‹é¡¹"></a>4.2 æ³¨æ„äº‹é¡¹</h2><p>oracle æ•°æ®åº“å®šæ—¶ä»»åŠ¡æ— æ³•å¤‡ä»½å¦‚ä¸‹æŠ¥é”™ï¼š</p>
<blockquote>
<p>ORA-31634: ä½œä¸šå·²å­˜åœ¨<br>ORA-31664: å¦‚æœé‡‡ç”¨é»˜è®¤å€¼, å°†æ— æ³•æ„é€ å”¯ä¸€çš„ä½œä¸šå</p>
</blockquote>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/yabingshi_tech/article/details/110822529">ORA-31634: ä½œä¸šå·²å­˜åœ¨</a><br>åŸå› ï¼šjob é˜Ÿåˆ—æ»¡äº†ã€‚<br>è§£å†³ï¼š<br>    1. å…ˆæŸ¥è¯¢å‡ºæ‰€æœ‰æœªè¿è¡Œçš„ Jobsï¼š<code>SELECT &#39;DROP TABLE &#39; || OWNER_NAME ||&#39;.&#39;|| JOB_NAME ||&#39;;&#39; FROM DBA_DATAPUMP_JOBS WHERE   STATE=&#39;NOT RUNNING&#39;;</code><br>    2. åˆ é™¤æŸ¥è¯¢åˆ°çš„å®šæ—¶ä»»åŠ¡è®¡åˆ’è¡¨ï¼š<code>DROP TABLE CMIS.SYS_EXPORT_SCHEMA_xx;</code></p>
<h1 id="5-åº”ç”¨éƒ¨ç½²"><a href="#5-åº”ç”¨éƒ¨ç½²" class="headerlink" title="5 åº”ç”¨éƒ¨ç½²"></a>5 åº”ç”¨éƒ¨ç½²</h1><h2 id="5-1-æ–°å»ºé¡¹ç›®"><a href="#5-1-æ–°å»ºé¡¹ç›®" class="headerlink" title="5.1 æ–°å»ºé¡¹ç›®"></a>5.1 æ–°å»ºé¡¹ç›®</h2><h3 id="5-1-1-Gitlab"><a href="#5-1-1-Gitlab" class="headerlink" title="5.1.1 Gitlab"></a>5.1.1 Gitlab</h3><p>åœ¨ gitlab æ–°å»ºä¸€ä¸ªè¦å¼€å‘éƒ¨ç½²çš„é¡¹ç›®</p>
<h3 id="5-1-2-Harbor"><a href="#5-1-2-Harbor" class="headerlink" title="5.1.2 Harbor"></a>5.1.2 Harbor</h3><p>åœ¨ harbor é•œåƒä»“åº“æ–°å»ºä¸€ä¸ªç§æœ‰é¡¹ç›®ï¼Œåç»­è¯¥åº”ç”¨çš„æ‰€æœ‰é•œåƒéƒ½å­˜å‚¨åœ¨è¯¥é•œåƒä»“åº“ï¼Œä¾¿äºåç»­ä¸Šä¼ å’Œæ‹‰å–åº”ç”¨é•œåƒã€‚</p>
<blockquote>
<p>[!NOTE] æ³¨æ„<br>harbor ä»¥ docker å®¹å™¨åŒ–éƒ¨ç½²çš„ï¼Œé‡å¯ 102 è™šæ‹Ÿæœºæˆ–è€… docker åéœ€è¦å¯åŠ¨æ‰€æœ‰ç›¸å…³çš„å®¹å™¨æ‰èƒ½æ¢å¤æ­£å¸¸ã€‚</p>
</blockquote>
<h1 id="6-å®¿ä¸»æœº-IP-æ›´æ¢"><a href="#6-å®¿ä¸»æœº-IP-æ›´æ¢" class="headerlink" title="6 å®¿ä¸»æœº IP æ›´æ¢"></a>6 å®¿ä¸»æœº IP æ›´æ¢</h1><ol>
<li>å°† ESXi ä¸»æœºç½®äºç»´æŠ¤æ¨¡å¼ã€‚ï¼ˆå¯è·³è¿‡ï¼‰</li>
<li>ä½¿ç”¨ ESXi ä¸»æœº UI Client æˆ– KVM æˆ– ssh ç›´æ¥è¿æ¥ã€‚ï¼ˆå¯è·³è¿‡ï¼‰</li>
<li>æ›´æ”¹ IP åœ°å€å¹¶æ›´æ–° DNS æœåŠ¡å™¨ã€‚ <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cp</span> /etc/vmware/esx.conf.backup /etc/vmware/esx.conf <span class="hljs-comment">#å¤‡ä»½å®¿ä¸»æœºé…ç½®æ–‡ä»¶</span><br>esxcli network ip interface ipv4 <span class="hljs-built_in">set</span> -i vmk0 -I 192.168.88.206 -N 255.255.255.0 -t static <span class="hljs-comment">#ä¿®æ”¹ip</span><br>esxcli network ip interface ipv4 get <span class="hljs-comment">#æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆ</span><br></code></pre></td></tr></table></figure></li>
<li>å°† ESXi ä¸»æœºå–æ¶ˆç»´æŠ¤æ¨¡å¼ï¼Œè¿ç§»åŸè™šæ‹Ÿæœºå›æ¥ã€‚ï¼ˆå¯è·³è¿‡ï¼‰</li>
<li>ç¼–è¾‘è™šæ‹Ÿæœºç½‘ç»œçŠ¶æ€ä¸ºå·²è¿æ¥ï¼Œå¦åˆ™ ping ä¸é€šã€‚</li>
</ol>
<blockquote>
<p>[!NOTE] æ³¨æ„<br>é‡å¯ harborï¼Œopenrestryã€‚</p>
</blockquote>
<h1 id="7-RKE-è°ƒæ•´é›†ç¾¤èŠ‚ç‚¹"><a href="#7-RKE-è°ƒæ•´é›†ç¾¤èŠ‚ç‚¹" class="headerlink" title="7 RKE è°ƒæ•´é›†ç¾¤èŠ‚ç‚¹"></a>7 RKE è°ƒæ•´é›†ç¾¤èŠ‚ç‚¹</h1><ol>
<li>åˆ°ç›®æ ‡é›†ç¾¤çš„ etcd0 èŠ‚ç‚¹ä¸Šï¼Œä¸€èˆ¬åœ¨ home&#x2F;root ç›®å½•æˆ–è€…&#x2F;home&#x2F;docker ç›®å½•ä¸‹æœ‰ rke åŠ cluster.yml é…ç½®æ–‡ä»¶ã€‚</li>
<li>ä¿®æ”¹ <code>cluster.yml</code> é…ç½®æ–‡ä»¶ï¼Œå¯¹èŠ‚ç‚¹æˆ–å…¶ä»–é…ç½®è¿›è¡Œä¿®æ”¹ã€‚</li>
<li>é€šè¿‡ <code>rke up --update-only --config cluster.yml</code> æŒ‡ä»¤æ›´æ–°é›†ç¾¤é…ç½®ã€‚</li>
</ol>
<blockquote>
<ol>
<li>æ³¨æ„æ‰€æœ‰èŠ‚ç‚¹çš„ docker ç‰ˆæœ¬è¦å’Œ rke æ”¯æŒçš„ç‰ˆæœ¬å¯¹åº”ï¼Œâ€‹â€‹<strong>RKE 1.2.1â€‹â€‹ ä»…æ”¯æŒ Docker 1.13.x ~ 19.03.x</strong>ã€‚<br>â€‹â€‹RKE 1.3.24â€‹â€‹ æ”¯æŒ Docker 20.10.x ~ 26.xï¼Œä¸å¯¹åº”å°±é™ä½ docker ç‰ˆæœ¬ã€‚</li>
<li>å¦‚æœæ˜¯æ–°å¢èŠ‚ç‚¹æŒ‰ç…§ä¸‹é¢è¯¦ç»†è¿‡ç¨‹é…ç½®æ·»åŠ ï¼Œå¦‚æœæ˜¯ç§»é™¤èŠ‚ç‚¹é‡æ–°æ·»åŠ åˆ™ cluster.yml æ–‡ä»¶å…ˆæ³¨é‡Šæ‰èŠ‚ç‚¹é…ç½®ï¼Œæ›´æ–°é›†ç¾¤ä¸€éåå†å–æ¶ˆæ³¨é‡Šé€æ­¥åŠ  roleï¼ˆå…ˆåŠ  worker å†åŠ  controller æˆ– etcd ç­‰ï¼‰ã€‚</li>
</ol>
</blockquote>
<h2 id="7-1-è¯¦ç»†è¿‡ç¨‹"><a href="#7-1-è¯¦ç»†è¿‡ç¨‹" class="headerlink" title="7.1 è¯¦ç»†è¿‡ç¨‹"></a>7.1 è¯¦ç»†è¿‡ç¨‹</h2><ol>
<li><p>æ‰€æœ‰ etcd å’Œ master å’Œ worker èŠ‚ç‚¹çš„ <code>/etc/hosts</code> æ·»åŠ ä¸Šæ‰€æœ‰èŠ‚ç‚¹åç§°å’Œ ip å¯¹åº”è§£æã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">192.168.88.129 etcd0 etcd0.linux.csdc<br>192.168.88.128 etcd1<br>192.168.88.127 etcd2<br>192.168.88.126 master0<br>192.168.88.125 master1<br>192.168.88.124 master2<br>192.168.88.123 build0<br>192.168.88.122 node0<br>192.168.88.121 node1<br>192.168.88.120 node2<br>192.168.88.119 node3<br>192.168.88.118 node4<br>192.168.88.117 node5<br>192.168.88.116 node6<br>192.168.88.115 node7<br>192.168.88.190 gpu<br>192.168.88.192 gpu2 h3cgpu<br>192.168.88.194 gpu3 h3cgpu2<br>192.168.88.196 gpu4 h3cgpu3<br>192.168.88.102 registry.csdcinfo.cn registry.csdc.info<br>192.168.88.233 gitlab.csdcinfo.cn gitlab.csdc.info<br>192.168.88.231 rancher.csdcinfo.cn rancher.csdc.info<br></code></pre></td></tr></table></figure>
</li>
<li><p><code>vim /etc/sysctl.conf</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">net.ipv4.ip_forward = 1<br>net.bridge.bridge-nf-call-ip6tables = 1<br>net.bridge.bridge-nf-call-iptables = 1<br></code></pre></td></tr></table></figure>
<p>åˆ·æ–°é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">modprobe br_netfilter<br>sysctl -p<br></code></pre></td></tr></table></figure>
</li>
<li><p>å…³é—­é˜²ç«å¢™</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl stop firewalld<br>systemctl <span class="hljs-built_in">disable</span> firewalld<br>firewall-cmd --state<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>å…³é—­ selinux</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#æ°¸ä¹…å…³é—­ï¼Œä¸€å®šè¦é‡å¯æ“ä½œç³»ç»Ÿåç”Ÿæ•ˆã€‚</span><br>sudo sed -i <span class="hljs-string">&#x27;s/^SELINUX=.*/SELINUX=disabled/&#x27;</span> /etc/selinux/config<br><br><span class="hljs-comment">#ä¸´æ—¶å…³é—­ï¼Œä¸é‡å¯æ“ä½œç³»ç»Ÿï¼Œå³åˆ»ç”Ÿæ•ˆã€‚</span><br>sudo setenforce 0<br></code></pre></td></tr></table></figure>

<ol start="5">
<li><p>ä¸»æœº swap åˆ†åŒºè®¾ç½®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#æ°¸ä¹…å…³é—­ï¼Œéœ€è¦é‡å¯æ“ä½œç³»ç»Ÿç”Ÿæ•ˆã€‚</span><br>sudo swapoff -a<br><span class="hljs-comment"># æ³¨é‡Šæ‰ /etc/fstab é‡Œæ‰€æœ‰ swap è¡Œ</span><br>sudo sed -i <span class="hljs-string">&#x27;/swap/s/^/#/&#x27;</span> /etc/fstab<br><br><span class="hljs-comment"># åº”è¯¥æ— è¾“å‡º</span><br>swapon --show<br>free -h              <span class="hljs-comment"># Swap è¡Œåº”ä¸º 0B</span><br><br><span class="hljs-comment"># cat /etc/fstab</span><br>Â·Â·Â·<br><span class="hljs-comment">#/dev/mapper/centos_192-swap swap defaults &#123;&#125; &#123;&#125;</span><br><span class="hljs-comment">#ä¸´æ—¶å…³é—­ï¼Œä¸éœ€è¦é‡å¯æ“ä½œç³»ç»Ÿï¼Œå³åˆ»ç”Ÿæ•ˆã€‚</span><br><span class="hljs-comment"># swapoff a</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>æ—¶é—´åŒæ­¥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum -y install ntpdate<br>crontab -e<br>0 */1 * * * ntpdate time1.aliyun.com<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ·»åŠ  rancher ç”¨æˆ·<br>ä½¿ç”¨ CentOS æ—¶ï¼Œä¸èƒ½ä½¿ç”¨ root è´¦å·ï¼Œå› æ­¤è¦æ·»åŠ ä¸“ç”¨çš„è´¦å·è¿›è¡Œ docker ç›¸å…³æ“ä½œã€‚é‡å¯ç³»ç»Ÿä»¥åæ‰èƒ½ç”Ÿæ•ˆï¼Œåªé‡<br>çš„ï¼é‡å¯åï¼Œrancher ç”¨æˆ·ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ docker ps å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">useradd rancher<br>usermod -aG docker rancher<br><span class="hljs-built_in">echo</span> 123 | passwd --stdin rancher<br></code></pre></td></tr></table></figure></li>
<li><p>å¤åˆ¶ ssh è¯ä¹¦<br>ä» rke äºŒè¿›åˆ¶æ–‡ä»¶å®‰è£…ä¸»æœºä¸Šå¤åˆ¶ï¼Œå¦‚æœå·²ç»å¤åˆ¶ï¼Œåˆ™å¯ä¸éœ€è¦é‡å¤æ€§å¤åˆ¶ã€‚</p>
</li>
</ol>
<ul>
<li>å¤åˆ¶è¯ä¹¦<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh-copy-id rancher@worker02<br></code></pre></td></tr></table></figure></li>
<li>éªŒè¯ ssh è¯ä¹¦æ˜¯å¦å¯ç”¨<br>åœ¨ rke äºŒè¿›åˆ¶æ–‡ä»¶å®‰è£…ä¸»æœºæœºæµ‹è¯•è¿æ¥å…¶å®ƒé›†ç¾¤ä¸»æœºï¼ŒéªŒè¯æ˜¯å¦å¯ä½¿ç”¨ docker ps å‘½ä»¤å³å¯ã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh rancher@worker02<br></code></pre></td></tr></table></figure></li>
</ul>
<hr>
<h1 id="8-ack-é›†ç¾¤-arthas-è°ƒè¯•æ–¹æ³•"><a href="#8-ack-é›†ç¾¤-arthas-è°ƒè¯•æ–¹æ³•" class="headerlink" title="8 ack é›†ç¾¤ arthas è°ƒè¯•æ–¹æ³•"></a>8 ack é›†ç¾¤ arthas è°ƒè¯•æ–¹æ³•</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># è¿›å…¥arthasç›®å½•</span><br><span class="hljs-built_in">cd</span> /opt/arthas/<br><span class="hljs-comment"># ä¸‹è½½jattach</span><br>wget https://hub.gitmirror.com/https://github.com/apangin/jattach/releases/download/v2.1/jattach<br><span class="hljs-comment"># æ·»åŠ ç›®å½•æ‰§è¡Œæƒé™</span><br><span class="hljs-built_in">chmod</span> +x /opt/arthas/jattach<br><span class="hljs-comment"># åŠ è½½javaè¿›ç¨‹åˆ°arthas</span><br>./jattach 1 load instrument <span class="hljs-literal">false</span> /opt/arthas/arthas-agent.jar<br><span class="hljs-comment"># å¯åŠ¨arthas</span><br>java -jar arthas-client.jar 127.0.0.1 3658<br></code></pre></td></tr></table></figure>


<h1 id="9-æ‰‹åŠ¨è°ƒæ•´ä¸“ç½‘é»˜è®¤ç¼ºçœè·¯ç”±"><a href="#9-æ‰‹åŠ¨è°ƒæ•´ä¸“ç½‘é»˜è®¤ç¼ºçœè·¯ç”±" class="headerlink" title="9 æ‰‹åŠ¨è°ƒæ•´ä¸“ç½‘é»˜è®¤ç¼ºçœè·¯ç”±"></a>9 æ‰‹åŠ¨è°ƒæ•´ä¸“ç½‘é»˜è®¤ç¼ºçœè·¯ç”±</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#99æ®µä¼˜å…ˆ</span><br>route del default gw 192.168.99.1<br>route add default gw 192.168.99.1 metric 50<br>route -n<br><br><span class="hljs-comment">#88æ®µä¼˜å…ˆ</span><br>route del default gw 192.168.99.1<br>route add default gw 192.168.99.1 metric 101<br>route -n<br></code></pre></td></tr></table></figure>

<h2 id="9-1-åˆ›å»º-Systemd-æœåŠ¡å›ºåŒ–è·¯ç”±é…ç½®"><a href="#9-1-åˆ›å»º-Systemd-æœåŠ¡å›ºåŒ–è·¯ç”±é…ç½®" class="headerlink" title="9.1 åˆ›å»º Systemd æœåŠ¡å›ºåŒ–è·¯ç”±é…ç½®"></a>9.1 åˆ›å»º Systemd æœåŠ¡å›ºåŒ–è·¯ç”±é…ç½®</h2><p>é€‚ç”¨äºä½¿ç”¨ Systemd çš„ç°ä»£ Linux ç³»ç»Ÿï¼ˆCentOS 7+, Ubuntu 16.04+ï¼‰</p>
<ol>
<li>åˆ›å»ºæœåŠ¡æ–‡ä»¶ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo vim /etc/systemd/system/static-routes.service<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</li>
</ol>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Unit]</span><br><span class="hljs-attr">Description</span>=Static Routes<br><span class="hljs-attr">After</span>=network.target<br><br><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Type</span>=<span class="hljs-literal">on</span>eshot<br><span class="hljs-attr">RemainAfterExit</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">ExecStart</span>=/sbin/ip route add <span class="hljs-number">100.1</span>.<span class="hljs-number">1.0</span>/<span class="hljs-number">24</span> via <span class="hljs-number">192.168</span>.<span class="hljs-number">99.1</span><br><span class="hljs-attr">ExecStart</span>=/sbin/ip route add <span class="hljs-number">144.0</span>.<span class="hljs-number">0.0</span>/<span class="hljs-number">8</span> via <span class="hljs-number">192.168</span>.<span class="hljs-number">99.1</span><br><br><span class="hljs-section">[Install]</span><br><span class="hljs-attr">WantedBy</span>=multi-user.target<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo systemctl daemon-reload<br>sudo systemctl <span class="hljs-built_in">enable</span> static-routes.service<br>sudo systemctl start static-routes.service<br></code></pre></td></tr></table></figure>

<h1 id="10-Glusterfs-å¸¸ç”¨æ“ä½œ"><a href="#10-Glusterfs-å¸¸ç”¨æ“ä½œ" class="headerlink" title="10 Glusterfs å¸¸ç”¨æ“ä½œ"></a>10 Glusterfs å¸¸ç”¨æ“ä½œ</h1><h2 id="10-1-æŸ¥çœ‹å®¹é‡"><a href="#10-1-æŸ¥çœ‹å®¹é‡" class="headerlink" title="10.1 æŸ¥çœ‹å®¹é‡"></a>10.1 æŸ¥çœ‹å®¹é‡</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">heketi-cli node list æŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹<br><br>heketi-cli node info 1f5074b6a92ff222cc59d71426638c56 æŸ¥çœ‹å•ä¸ªèŠ‚ç‚¹<br><br>heketi-cli volume list æŸ¥çœ‹æ‰€æœ‰å·<br><br>heketi-cli volume list | grep vol_366bbff89824f57eb02ffa290462d39b æŸ¥çœ‹ç‰¹å®šå·<br><br>heketi-cli volume delete 366bbff89824f57eb02ffa290462d39b åˆ é™¤å·<br><br>mount -t glusterfs 192.168.88.170:vol_69994102f7e8a927ebeb3acd3784590c /mnt/hsas_log/<br></code></pre></td></tr></table></figure>

<h2 id="10-2-æ‰©å®¹"><a href="#10-2-æ‰©å®¹" class="headerlink" title="10.2 æ‰©å®¹"></a>10.2 æ‰©å®¹</h2><blockquote>
<p>åœ¨ 170 ä¸»èŠ‚ç‚¹ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">heketi-cli device add --name /dev/sde --node 1f5074b6a92ff222cc59d71426638c56<br><br>heketi-cli device add --name /dev/sdf --node 1f5074b6a92ff222cc59d71426638c56<br><br>heketi-cli device add --name /dev/sde --node a55452348b59fe6312e34d9801a33e1e<br><br>heketi-cli device add --name /dev/sdf --node a55452348b59fe6312e34d9801a33e1e<br><br>heketi-cli device add --name /dev/sde --node c69166fd5d586c4354d6c77312467a6a<br><br>heketi-cli device add --name /dev/sdf --node c69166fd5d586c4354d6c77312467a6a<br></code></pre></td></tr></table></figure>


<h1 id="11-K8sé™æ€è·¯ç”±é…ç½®"><a href="#11-K8sé™æ€è·¯ç”±é…ç½®" class="headerlink" title="11 K8sé™æ€è·¯ç”±é…ç½®"></a>11 K8sé™æ€è·¯ç”±é…ç½®</h1><p>æœ¬åœ°Windowså¦‚æœéœ€è¦èƒ½å¤Ÿè®¿é—®k8sçš„å†…éƒ¨ç½‘ç»œï¼Œéœ€è¦åšé™æ€è·¯ç”±ï¼š</p>
<ul>
<li><p>æµ‹è¯•ç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">route add 10.44.0.0 mask 255.255.0.0 -p 192.168.88.115<br></code></pre></td></tr></table></figure></li>
<li><p>æ­£å¼ç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">route add 10.42.0.0 mask 255.255.0.0 -p 192.168.88.133<br></code></pre></td></tr></table></figure></li>
<li><p>ç ”ç©¶ç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">route add 10.64.0.0 mask 255.255.0.0 -p 192.168.88.126<br></code></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥çœ‹é™æ€è·¯ç”±è¡¨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">route <span class="hljs-built_in">print</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h1 id="12-å‚è€ƒæ–‡çŒ®"><a href="#12-å‚è€ƒæ–‡çŒ®" class="headerlink" title="12 å‚è€ƒæ–‡çŒ®"></a>12 å‚è€ƒæ–‡çŒ®</h1><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/EbookFoundation/free-programming-books/blob/main/books/free-programming-books-zh.md">free-programming-books&#x2F;books&#x2F;free-programming-books-zh.md</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/node-pressure-eviction/">èŠ‚ç‚¹å‹åŠ›é©±é€ | Kubernetes</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_59267075/article/details/127710880">Erroræ’é”™ï¼šThe node was low on resource: ephemeral-storage</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45603370/article/details/140293255">è™šæ‹Ÿæœºå¦‚ä½•é€‰æ‹©å¤„ç†å™¨å’Œå†…æ ¸æ•°é‡ï¼Œå®ç°æœ€ä½³æ€§èƒ½_è™šæ‹Ÿæœºè®¾ç½®cpuå¤„ç†å™¨åªæœ‰å¤„ç†å†…æ ¸æ•°é‡</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/quantoublog/articles/17352359.html">æ— æ³•æ‰“å¼€è™šæ‹Ÿæœºï¼Œè·å–è¯¥è™šæ‹Ÿæœºçš„æ‰€æœ‰æƒå¤±è´¥ã€‚ ä¸»æœºä¸Šçš„æŸä¸ªåº”ç”¨ç¨‹åºæ­£åœ¨ä½¿ç”¨è¯¥è™šæ‹Ÿæœº</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/Dearggae/article/details/136793788">ã€vSphereã€‘æ›´æ”¹é›†ç¾¤ä¸­ESXiä¸»æœºIPåœ°å€çš„å®‰å…¨æ–¹æ³•_vsphereæ”¹ip-CSDNåšå®¢</a></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/" class="category-chain-item">è¿ç»´å¼€å‘</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/DevOps/">#DevOps</a>
      
        <a href="/tags/%E8%BF%90%E7%BB%B4/">#è¿ç»´</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>è¿ç»´æ’å¿§è§£éš¾</div>
      <div>https://alleyf.github.io/2024/06/1d24d86ba310.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>fcs</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2024å¹´6æœˆ28æ—¥</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>æ›´æ–°äº</div>
          <div>2026å¹´1æœˆ3æ—¥</div>
        </div>
      
      <div class="license-meta-item">
        <div>è®¸å¯åè®®</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/07/e01892fcb965.html" title="å¸¸ç”¨è½¯ä»¶å’Œç¯å¢ƒ">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">å¸¸ç”¨è½¯ä»¶å’Œç¯å¢ƒ</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/05/9b5fa9c35ad7.html" title="Kuberneteså…¥é—¨">
                        <span class="hidden-mobile">Kuberneteså…¥é—¨</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.7.2/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"636f2864e051a199b91c","clientSecret":"5185fd11115bbcd8d2f636bc80de6bed98ed14c1","repo":"Gitalk","owner":"Alleyf","admin":["Alleyf"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":false,"proxy":"https://shielded-brushlands-08810.herokuapp.com/https://github.com/login/oauth/access_token"},
          {
            id: '75d97e607d0442444dacc2c3f65d4b19'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://github.com/Alleyf" target="_blank" rel="nofollow noopener"><span>Alleyf</span></a> <i class="iconfont icon-love"></i> <a href="https://fcsy.fit" target="_blank" rel="nofollow noopener"><span>Homepage</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="busuanzi_value_site_pv"></span>
         æ¬¡
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="busuanzi_value_site_uv"></span>
         äºº
      </span>
    
    
  
</div>

  
  
    <!-- å¤‡æ¡ˆä¿¡æ¯ ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      é™•ICPå¤‡2022010038å·
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=2022010038"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="http://qnpicmap.fcsluck.top/pics/202311161820757.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>é™•å…¬ç½‘å®‰å¤‡2022010038å·</span>
        </a>
      </span>
    
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/assets/mmedia/mmedia-loader.js"></script><!-- hexo injector body_end end --></body>
</html>
