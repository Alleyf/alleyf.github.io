/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source visit the plugins github repository
*/

"use strict";var pj=Object.create;var Ko=Object.defineProperty;var Tv=Object.getOwnPropertyDescriptor;var dj=Object.getOwnPropertyNames;var mj=Object.getPrototypeOf,hj=Object.prototype.hasOwnProperty;var gj=(e,t,r)=>t in e?Ko(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Du=(e,t)=>()=>(e&&(t=e(e=0)),t);var g=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ov=(e,t)=>{for(var r in t)Ko(e,r,{get:t[r],enumerable:!0})},kv=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of dj(t))!hj.call(e,o)&&o!==r&&Ko(e,o,{get:()=>t[o],enumerable:!(n=Tv(t,o))||n.enumerable});return e};var me=(e,t,r)=>(r=e!=null?pj(mj(e)):{},kv(t||!e||!e.__esModule?Ko(r,"default",{value:e,enumerable:!0}):r,e)),wd=e=>kv(Ko({},"__esModule",{value:!0}),e),fe=(e,t,r,n)=>{for(var o=n>1?void 0:n?Tv(t,r):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(o=(n?s(t,r,o):s(o))||o);return n&&o&&Ko(t,r,o),o};var Av=(e,t,r)=>(gj(e,typeof t!="symbol"?t+"":t,r),r);var t0=g((_ne,e0)=>{var Zo=1e3,Yo=Zo*60,Xo=Yo*60,Jn=Xo*24,Cj=Jn*7,Tj=Jn*365.25;e0.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return Oj(e);if(r==="number"&&isFinite(e))return t.long?Aj(e):kj(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Oj(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Tj;case"weeks":case"week":case"w":return r*Cj;case"days":case"day":case"d":return r*Jn;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Xo;case"minutes":case"minute":case"mins":case"min":case"m":return r*Yo;case"seconds":case"second":case"secs":case"sec":case"s":return r*Zo;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function kj(e){var t=Math.abs(e);return t>=Jn?Math.round(e/Jn)+"d":t>=Xo?Math.round(e/Xo)+"h":t>=Yo?Math.round(e/Yo)+"m":t>=Zo?Math.round(e/Zo)+"s":e+"ms"}function Aj(e){var t=Math.abs(e);return t>=Jn?zu(e,t,Jn,"day"):t>=Xo?zu(e,t,Xo,"hour"):t>=Yo?zu(e,t,Yo,"minute"):t>=Zo?zu(e,t,Zo,"second"):e+" ms"}function zu(e,t,r,n){var o=t>=r*1.5;return Math.round(e/r)+" "+n+(o?"s":"")}});var n0=g((Cne,r0)=>{function Nj(e){r.debug=r,r.default=r,r.coerce=u,r.disable=i,r.enable=o,r.enabled=s,r.humanize=t0(),r.destroy=l,Object.keys(e).forEach(c=>{r[c]=e[c]}),r.names=[],r.skips=[],r.formatters={};function t(c){let f=0;for(let p=0;p<c.length;p++)f=(f<<5)-f+c.charCodeAt(p),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=t;function r(c){let f,p=null,d,h;function b(...y){if(!b.enabled)return;let v=b,w=Number(new Date),T=w-(f||w);v.diff=T,v.prev=f,v.curr=w,f=w,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let M=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(J,G)=>{if(J==="%%")return"%";M++;let K=r.formatters[G];if(typeof K=="function"){let P=y[M];J=K.call(v,P),y.splice(M,1),M--}return J}),r.formatArgs.call(v,y),(v.log||r.log).apply(v,y)}return b.namespace=c,b.useColors=r.useColors(),b.color=r.selectColor(c),b.extend=n,b.destroy=r.destroy,Object.defineProperty(b,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(d!==r.namespaces&&(d=r.namespaces,h=r.enabled(c)),h),set:y=>{p=y}}),typeof r.init=="function"&&r.init(b),b}function n(c,f){let p=r(this.namespace+(typeof f>"u"?":":f)+c);return p.log=this.log,p}function o(c){r.save(c),r.namespaces=c,r.names=[],r.skips=[];let f,p=(typeof c=="string"?c:"").split(/[\s,]+/),d=p.length;for(f=0;f<d;f++)p[f]&&(c=p[f].replace(/\*/g,".*?"),c[0]==="-"?r.skips.push(new RegExp("^"+c.slice(1)+"$")):r.names.push(new RegExp("^"+c+"$")))}function i(){let c=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),c}function s(c){if(c[c.length-1]==="*")return!0;let f,p;for(f=0,p=r.skips.length;f<p;f++)if(r.skips[f].test(c))return!1;for(f=0,p=r.names.length;f<p;f++)if(r.names[f].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function u(c){return c instanceof Error?c.stack||c.message:c}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}r0.exports=Nj});var Ue=g((kt,Uu)=>{kt.formatArgs=Dj;kt.save=Pj;kt.load=Fj;kt.useColors=Rj;kt.storage=$j();kt.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();kt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Rj(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Dj(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Uu.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(r++,o==="%c"&&(n=r))}),e.splice(n,0,t)}kt.log=console.debug||console.log||(()=>{});function Pj(e){try{e?kt.storage.setItem("debug",e):kt.storage.removeItem("debug")}catch{}}function Fj(){let e;try{e=kt.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function $j(){try{return localStorage}catch{}}Uu.exports=n0()(kt);var{formatters:Mj}=Uu.exports;Mj.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var i0=g((Tne,o0)=>{"use strict";o0.exports=jj;function Qo(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function jj(e){if(e=e||{},e.circles)return qj(e);return e.proto?n:r;function t(o,i){for(var s=Object.keys(o),a=new Array(s.length),u=0;u<s.length;u++){var l=s[u],c=o[l];typeof c!="object"||c===null?a[l]=c:c instanceof Date?a[l]=new Date(c):ArrayBuffer.isView(c)?a[l]=Qo(c):a[l]=i(c)}return a}function r(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return t(o,r);if(o instanceof Map)return new Map(t(Array.from(o),r));if(o instanceof Set)return new Set(t(Array.from(o),r));var i={};for(var s in o)if(Object.hasOwnProperty.call(o,s)!==!1){var a=o[s];typeof a!="object"||a===null?i[s]=a:a instanceof Date?i[s]=new Date(a):a instanceof Map?i[s]=new Map(t(Array.from(a),r)):a instanceof Set?i[s]=new Set(t(Array.from(a),r)):ArrayBuffer.isView(a)?i[s]=Qo(a):i[s]=r(a)}return i}function n(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return t(o,n);if(o instanceof Map)return new Map(t(Array.from(o),n));if(o instanceof Set)return new Set(t(Array.from(o),n));var i={};for(var s in o){var a=o[s];typeof a!="object"||a===null?i[s]=a:a instanceof Date?i[s]=new Date(a):a instanceof Map?i[s]=new Map(t(Array.from(a),n)):a instanceof Set?i[s]=new Set(t(Array.from(a),n)):ArrayBuffer.isView(a)?i[s]=Qo(a):i[s]=n(a)}return i}}function qj(e){var t=[],r=[];return e.proto?i:o;function n(s,a){for(var u=Object.keys(s),l=new Array(u.length),c=0;c<u.length;c++){var f=u[c],p=s[f];if(typeof p!="object"||p===null)l[f]=p;else if(p instanceof Date)l[f]=new Date(p);else if(ArrayBuffer.isView(p))l[f]=Qo(p);else{var d=t.indexOf(p);d!==-1?l[f]=r[d]:l[f]=a(p)}}return l}function o(s){if(typeof s!="object"||s===null)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return n(s,o);if(s instanceof Map)return new Map(n(Array.from(s),o));if(s instanceof Set)return new Set(n(Array.from(s),o));var a={};t.push(s),r.push(a);for(var u in s)if(Object.hasOwnProperty.call(s,u)!==!1){var l=s[u];if(typeof l!="object"||l===null)a[u]=l;else if(l instanceof Date)a[u]=new Date(l);else if(l instanceof Map)a[u]=new Map(n(Array.from(l),o));else if(l instanceof Set)a[u]=new Set(n(Array.from(l),o));else if(ArrayBuffer.isView(l))a[u]=Qo(l);else{var c=t.indexOf(l);c!==-1?a[u]=r[c]:a[u]=o(l)}}return t.pop(),r.pop(),a}function i(s){if(typeof s!="object"||s===null)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return n(s,i);if(s instanceof Map)return new Map(n(Array.from(s),i));if(s instanceof Set)return new Set(n(Array.from(s),i));var a={};t.push(s),r.push(a);for(var u in s){var l=s[u];if(typeof l!="object"||l===null)a[u]=l;else if(l instanceof Date)a[u]=new Date(l);else if(l instanceof Map)a[u]=new Map(n(Array.from(l),i));else if(l instanceof Set)a[u]=new Set(n(Array.from(l),i));else if(ArrayBuffer.isView(l))a[u]=Qo(l);else{var c=t.indexOf(l);c!==-1?a[u]=r[c]:a[u]=i(l)}}return t.pop(),r.pop(),a}}});var Yn=g((One,c0)=>{var Lj=require("util"),Zn=Ue()("log4js:configuration"),Wu=[],Hu=[],s0=e=>!e,a0=e=>e&&typeof e=="object"&&!Array.isArray(e),Bj=e=>/^[A-Za-z][A-Za-z0-9_]*$/g.test(e),zj=e=>e&&typeof e=="number"&&Number.isInteger(e),Uj=e=>{Hu.push(e),Zn(`Added listener, now ${Hu.length} listeners`)},Wj=e=>{Wu.push(e),Zn(`Added pre-processing listener, now ${Wu.length} listeners`)},u0=(e,t,r)=>{(Array.isArray(t)?t:[t]).forEach(o=>{if(o)throw new Error(`Problem with log4js configuration: (${Lj.inspect(e,{depth:5})}) - ${r}`)})},Hj=e=>{Zn("New configuration to be validated: ",e),u0(e,s0(a0(e)),"must be an object."),Zn(`Calling pre-processing listeners (${Wu.length})`),Wu.forEach(t=>t(e)),Zn("Configuration pre-processing finished."),Zn(`Calling configuration listeners (${Hu.length})`),Hu.forEach(t=>t(e)),Zn("Configuration finished.")};c0.exports={configure:Hj,addListener:Uj,addPreProcessingListener:Wj,throwExceptionIf:u0,anObject:a0,anInteger:zj,validIdentifier:Bj,not:s0}});var Ku=g((kne,zt)=>{"use strict";function l0(e,t){for(var r=e.toString();r.length<t;)r="0"+r;return r}function Xn(e){return l0(e,2)}function Kj(e){var t=Math.abs(e),r=String(Math.floor(t/60)),n=String(t%60);return r=("0"+r).slice(-2),n=("0"+n).slice(-2),e===0?"Z":(e<0?"+":"-")+r+":"+n}function f0(e,t){typeof e!="string"&&(t=e,e=zt.exports.ISO8601_FORMAT),t||(t=zt.exports.now());var r=Xn(t.getDate()),n=Xn(t.getMonth()+1),o=Xn(t.getFullYear()),i=Xn(o.substring(2,4)),s=e.indexOf("yyyy")>-1?o:i,a=Xn(t.getHours()),u=Xn(t.getMinutes()),l=Xn(t.getSeconds()),c=l0(t.getMilliseconds(),3),f=Kj(t.getTimezoneOffset()),p=e.replace(/dd/g,r).replace(/MM/g,n).replace(/y{1,4}/g,s).replace(/hh/g,a).replace(/mm/g,u).replace(/ss/g,l).replace(/SSS/g,c).replace(/O/g,f);return p}function dn(e,t,r,n){e["set"+(n?"":"UTC")+t](r)}function Vj(e,t,r){var n=e.indexOf("O")<0,o=!1,i=[{pattern:/y{1,4}/,regexp:"\\d{1,4}",fn:function(f,p){dn(f,"FullYear",p,n)}},{pattern:/MM/,regexp:"\\d{1,2}",fn:function(f,p){dn(f,"Month",p-1,n),f.getMonth()!==p-1&&(o=!0)}},{pattern:/dd/,regexp:"\\d{1,2}",fn:function(f,p){o&&dn(f,"Month",f.getMonth()-1,n),dn(f,"Date",p,n)}},{pattern:/hh/,regexp:"\\d{1,2}",fn:function(f,p){dn(f,"Hours",p,n)}},{pattern:/mm/,regexp:"\\d\\d",fn:function(f,p){dn(f,"Minutes",p,n)}},{pattern:/ss/,regexp:"\\d\\d",fn:function(f,p){dn(f,"Seconds",p,n)}},{pattern:/SSS/,regexp:"\\d\\d\\d",fn:function(f,p){dn(f,"Milliseconds",p,n)}},{pattern:/O/,regexp:"[+-]\\d{1,2}:?\\d{2}?|Z",fn:function(f,p){p==="Z"?p=0:p=p.replace(":","");var d=Math.abs(p),h=(p>0?-1:1)*(d%100+Math.floor(d/100)*60);f.setUTCMinutes(f.getUTCMinutes()+h)}}],s=i.reduce(function(f,p){return p.pattern.test(f.regexp)?(p.index=f.regexp.match(p.pattern).index,f.regexp=f.regexp.replace(p.pattern,"("+p.regexp+")")):p.index=-1,f},{regexp:e,index:[]}),a=i.filter(function(f){return f.index>-1});a.sort(function(f,p){return f.index-p.index});var u=new RegExp(s.regexp),l=u.exec(t);if(l){var c=r||zt.exports.now();return a.forEach(function(f,p){f.fn(c,l[p+1])}),c}throw new Error("String '"+t+"' could not be parsed as '"+e+"'")}function Gj(e,t,r){if(!e)throw new Error("pattern must be supplied");return Vj(e,t,r)}function Jj(){return new Date}zt.exports=f0;zt.exports.asString=f0;zt.exports.parse=Gj;zt.exports.now=Jj;zt.exports.ISO8601_FORMAT="yyyy-MM-ddThh:mm:ss.SSS";zt.exports.ISO8601_WITH_TZ_OFFSET_FORMAT="yyyy-MM-ddThh:mm:ss.SSSO";zt.exports.DATETIME_FORMAT="dd MM yyyy hh:mm:ss.SSS";zt.exports.ABSOLUTETIME_FORMAT="hh:mm:ss.SSS"});var Fd=g((Ane,S0)=>{var mn=Ku(),p0=require("os"),gs=require("util"),hs=require("path"),d0=require("url"),m0=Ue()("log4js:layouts"),h0={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[90,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[91,39],yellow:[33,39]};function g0(e){return e?`\x1B[${h0[e][0]}m`:""}function y0(e){return e?`\x1B[${h0[e][1]}m`:""}function Zj(e,t){return g0(t)+e+y0(t)}function b0(e,t){return Zj(gs.format("[%s] [%s] %s - ",mn.asString(e.startTime),e.level.toString(),e.categoryName),t)}function v0(e){return b0(e)+gs.format(...e.data)}function Vu(e){return b0(e,e.level.colour)+gs.format(...e.data)}function x0(e){return gs.format(...e.data)}function w0(e){return e.data[0]}function E0(e,t){let r="%r %p %c - %m%n",n=/%(-?[0-9]+)?(\.?-?[0-9]+)?([[\]cdhmnprzxXyflos%])(\{([^}]+)\})?|([^%]+)/;e=e||r;function o(C,_){let I=C.categoryName;if(_){let B=parseInt(_,10),D=I.split(".");B<D.length&&(I=D.slice(D.length-B).join("."))}return I}function i(C,_){let I=mn.ISO8601_FORMAT;if(_)switch(I=_,I){case"ISO8601":case"ISO8601_FORMAT":I=mn.ISO8601_FORMAT;break;case"ISO8601_WITH_TZ_OFFSET":case"ISO8601_WITH_TZ_OFFSET_FORMAT":I=mn.ISO8601_WITH_TZ_OFFSET_FORMAT;break;case"ABSOLUTE":process.emitWarning("Pattern %d{ABSOLUTE} is deprecated in favor of %d{ABSOLUTETIME}. Please use %d{ABSOLUTETIME} instead.","DeprecationWarning","log4js-node-DEP0003"),m0("[log4js-node-DEP0003]","DEPRECATION: Pattern %d{ABSOLUTE} is deprecated and replaced by %d{ABSOLUTETIME}.");case"ABSOLUTETIME":case"ABSOLUTETIME_FORMAT":I=mn.ABSOLUTETIME_FORMAT;break;case"DATE":process.emitWarning("Pattern %d{DATE} is deprecated due to the confusion it causes when used. Please use %d{DATETIME} instead.","DeprecationWarning","log4js-node-DEP0004"),m0("[log4js-node-DEP0004]","DEPRECATION: Pattern %d{DATE} is deprecated and replaced by %d{DATETIME}.");case"DATETIME":case"DATETIME_FORMAT":I=mn.DATETIME_FORMAT;break}return mn.asString(I,C.startTime)}function s(){return p0.hostname().toString()}function a(C){return gs.format(...C.data)}function u(){return p0.EOL}function l(C){return C.level.toString()}function c(C){return mn.asString("hh:mm:ss",C.startTime)}function f(C){return g0(C.level.colour)}function p(C){return y0(C.level.colour)}function d(){return"%"}function h(C){return C&&C.pid?C.pid.toString():process.pid.toString()}function b(){return h()}function y(C,_){return typeof t[_]<"u"?typeof t[_]=="function"?t[_](C):t[_]:null}function v(C,_){let I=C.context[_];return typeof I<"u"?typeof I=="function"?I(C):I:null}function w(C,_){let I=C.fileName||"";if(I=function(D){let re="file://";return D.startsWith(re)&&(typeof d0.fileURLToPath=="function"?D=d0.fileURLToPath(D):(D=hs.normalize(D.replace(new RegExp(`^${re}`),"")),process.platform==="win32"&&(D.startsWith("\\")?D=D.slice(1):D=hs.sep+hs.sep+D))),D}(I),_){let D=parseInt(_,10),re=I.split(hs.sep);re.length>D&&(I=re.slice(-D).join(hs.sep))}return I}function T(C){return C.lineNumber?`${C.lineNumber}`:""}function M(C){return C.columnNumber?`${C.columnNumber}`:""}function V(C){return C.callStack||""}let J={c:o,d:i,h:s,m:a,n:u,p:l,r:c,"[":f,"]":p,y:b,z:h,"%":d,x:y,X:v,f:w,l:T,o:M,s:V};function G(C,_,I){return J[C](_,I)}function K(C,_){let I;return C?(I=parseInt(C.slice(1),10),I>0?_.slice(0,I):_.slice(I)):_}function P(C,_){let I;if(C)if(C.charAt(0)==="-")for(I=parseInt(C.slice(1),10);_.length<I;)_+=" ";else for(I=parseInt(C,10);_.length<I;)_=` ${_}`;return _}function X(C,_,I){let B=C;return B=K(_,B),B=P(I,B),B}return function(C){let _="",I,B=e;for(;(I=n.exec(B))!==null;){let D=I[1],re=I[2],oe=I[3],he=I[5],ae=I[6];if(ae)_+=ae.toString();else{let E=G(oe,C,he);_+=X(E,re,D)}B=B.slice(I.index+I[0].length)}return _}}var Pd={messagePassThrough(){return x0},basic(){return v0},colored(){return Vu},coloured(){return Vu},pattern(e){return E0(e&&e.pattern,e&&e.tokens)},dummy(){return w0}};S0.exports={basicLayout:v0,messagePassThroughLayout:x0,patternLayout:E0,colouredLayout:Vu,coloredLayout:Vu,dummyLayout:w0,addLayout(e,t){Pd[e]=t},layout(e,t){return Pd[e]&&Pd[e](t)}}});var Qn=g((Nne,_0)=>{var $e=Yn(),I0=["white","grey","black","blue","cyan","green","magenta","red","yellow"],Me=class{constructor(t,r,n){this.level=t,this.levelStr=r,this.colour=n}toString(){return this.levelStr}static getLevel(t,r){return t?t instanceof Me?t:(t instanceof Object&&t.levelStr&&(t=t.levelStr),Me[t.toString().toUpperCase()]||r):r}static addLevels(t){t&&(Object.keys(t).forEach(n=>{let o=n.toUpperCase();Me[o]=new Me(t[n].value,o,t[n].colour);let i=Me.levels.findIndex(s=>s.levelStr===o);i>-1?Me.levels[i]=Me[o]:Me.levels.push(Me[o])}),Me.levels.sort((n,o)=>n.level-o.level))}isLessThanOrEqualTo(t){return typeof t=="string"&&(t=Me.getLevel(t)),this.level<=t.level}isGreaterThanOrEqualTo(t){return typeof t=="string"&&(t=Me.getLevel(t)),this.level>=t.level}isEqualTo(t){return typeof t=="string"&&(t=Me.getLevel(t)),this.level===t.level}};Me.levels=[];Me.addLevels({ALL:{value:Number.MIN_VALUE,colour:"grey"},TRACE:{value:5e3,colour:"blue"},DEBUG:{value:1e4,colour:"cyan"},INFO:{value:2e4,colour:"green"},WARN:{value:3e4,colour:"yellow"},ERROR:{value:4e4,colour:"red"},FATAL:{value:5e4,colour:"magenta"},MARK:{value:9007199254740992,colour:"grey"},OFF:{value:Number.MAX_VALUE,colour:"grey"}});$e.addListener(e=>{let t=e.levels;t&&($e.throwExceptionIf(e,$e.not($e.anObject(t)),"levels must be an object"),Object.keys(t).forEach(n=>{$e.throwExceptionIf(e,$e.not($e.validIdentifier(n)),`level name "${n}" is not a valid identifier (must start with a letter, only contain A-Z,a-z,0-9,_)`),$e.throwExceptionIf(e,$e.not($e.anObject(t[n])),`level "${n}" must be an object`),$e.throwExceptionIf(e,$e.not(t[n].value),`level "${n}" must have a 'value' property`),$e.throwExceptionIf(e,$e.not($e.anInteger(t[n].value)),`level "${n}".value must have an integer value`),$e.throwExceptionIf(e,$e.not(t[n].colour),`level "${n}" must have a 'colour' property`),$e.throwExceptionIf(e,$e.not(I0.indexOf(t[n].colour)>-1),`level "${n}".colour must be one of ${I0.join(", ")}`)}))});$e.addListener(e=>{Me.addLevels(e.levels)});_0.exports=Me});var F0=g(bs=>{"use strict";var{parse:O0,stringify:k0}=JSON,{keys:Yj}=Object,ys=String,A0="string",C0={},Gu="object",N0=(e,t)=>t,Xj=e=>e instanceof ys?ys(e):e,Qj=(e,t)=>typeof t===A0?new ys(t):t,R0=(e,t,r,n)=>{let o=[];for(let i=Yj(r),{length:s}=i,a=0;a<s;a++){let u=i[a],l=r[u];if(l instanceof ys){let c=e[l];typeof c===Gu&&!t.has(c)?(t.add(c),r[u]=C0,o.push({k:u,a:[e,t,c,n]})):r[u]=n.call(r,u,c)}else r[u]!==C0&&(r[u]=n.call(r,u,l))}for(let{length:i}=o,s=0;s<i;s++){let{k:a,a:u}=o[s];r[a]=n.call(r,a,R0.apply(null,u))}return r},T0=(e,t,r)=>{let n=ys(t.push(r)-1);return e.set(r,n),n},D0=(e,t)=>{let r=O0(e,Qj).map(Xj),n=r[0],o=t||N0,i=typeof n===Gu&&n?R0(r,new Set,n,o):n;return o.call({"":i},"",i)};bs.parse=D0;var P0=(e,t,r)=>{let n=t&&typeof t===Gu?(c,f)=>c===""||-1<t.indexOf(c)?f:void 0:t||N0,o=new Map,i=[],s=[],a=+T0(o,i,n.call({"":e},"",e)),u=!a;for(;a<i.length;)u=!0,s[a]=k0(i[a++],l,r);return"["+s.join(",")+"]";function l(c,f){if(u)return u=!u,f;let p=n.call(this,c,f);switch(typeof p){case Gu:if(p===null)return p;case A0:return o.get(p)||T0(o,i,p)}return p}};bs.stringify=P0;var e3=e=>O0(P0(e));bs.toJSON=e3;var t3=e=>D0(k0(e));bs.fromJSON=t3});var $d=g((Dne,j0)=>{var $0=F0(),M0=Qn(),ei=class{constructor(t,r,n,o,i){this.startTime=new Date,this.categoryName=t,this.data=n,this.level=r,this.context=Object.assign({},o),this.pid=process.pid,i&&(this.functionName=i.functionName,this.fileName=i.fileName,this.lineNumber=i.lineNumber,this.columnNumber=i.columnNumber,this.callStack=i.callStack)}serialise(){return $0.stringify(this,(t,r)=>(r&&r.message&&r.stack?r=Object.assign({message:r.message,stack:r.stack},r):typeof r=="number"&&(Number.isNaN(r)||!Number.isFinite(r))?r=r.toString():typeof r>"u"&&(r=typeof r),r))}static deserialise(t){let r;try{let n=$0.parse(t,(o,i)=>{if(i&&i.message&&i.stack){let s=new Error(i);Object.keys(i).forEach(a=>{s[a]=i[a]}),i=s}return i});n.location={functionName:n.functionName,fileName:n.fileName,lineNumber:n.lineNumber,columnNumber:n.columnNumber,callStack:n.callStack},r=new ei(n.categoryName,M0.getLevel(n.level.levelStr),n.data,n.context,n.location),r.startTime=new Date(n.startTime),r.pid=n.pid,r.cluster=n.cluster}catch(n){r=new ei("log4js",M0.ERROR,["Unable to parse log:",t,"because: ",n])}return r}};j0.exports=ei});var Zu=g((Pne,B0)=>{var Ut=Ue()("log4js:clustering"),r3=$d(),n3=Yn(),ti=!1,Wt=null;try{Wt=require("cluster")}catch{Ut("cluster module not present"),ti=!0}var jd=[],xs=!1,vs="NODE_APP_INSTANCE",q0=()=>xs&&process.env[vs]==="0",Md=()=>ti||Wt&&Wt.isMaster||q0(),L0=e=>{jd.forEach(t=>t(e))},Ju=(e,t)=>{if(Ut("cluster message received from worker ",e,": ",t),e.topic&&e.data&&(t=e,e=void 0),t&&t.topic&&t.topic==="log4js:message"){Ut("received message: ",t.data);let r=r3.deserialise(t.data);L0(r)}};ti||n3.addListener(e=>{jd.length=0,{pm2:xs,disableClustering:ti,pm2InstanceVar:vs="NODE_APP_INSTANCE"}=e,Ut(`clustering disabled ? ${ti}`),Ut(`cluster.isMaster ? ${Wt&&Wt.isMaster}`),Ut(`pm2 enabled ? ${xs}`),Ut(`pm2InstanceVar = ${vs}`),Ut(`process.env[${vs}] = ${process.env[vs]}`),xs&&process.removeListener("message",Ju),Wt&&Wt.removeListener&&Wt.removeListener("message",Ju),ti||e.disableClustering?Ut("Not listening for cluster messages, because clustering disabled."):q0()?(Ut("listening for PM2 broadcast messages"),process.on("message",Ju)):Wt&&Wt.isMaster?(Ut("listening for cluster messages"),Wt.on("message",Ju)):Ut("not listening for messages, because we are not a master process")});B0.exports={onlyOnMaster:(e,t)=>Md()?e():t,isMaster:Md,send:e=>{Md()?L0(e):(xs||(e.cluster={workerId:Wt.worker.id,worker:process.pid}),process.send({topic:"log4js:message",data:e.serialise()}))},onMessage:e=>{jd.push(e)}}});var W0=g((Fne,U0)=>{function o3(e){if(typeof e=="number"&&Number.isInteger(e))return e;let t={K:1024,M:1024*1024,G:1024*1024*1024},r=Object.keys(t),n=e.slice(-1).toLocaleUpperCase(),o=e.slice(0,-1).trim();if(r.indexOf(n)<0||!Number.isInteger(Number(o)))throw Error(`maxLogSize: "${e}" is invalid`);return o*t[n]}function i3(e,t){let r=Object.assign({},t);return Object.keys(e).forEach(n=>{r[n]&&(r[n]=e[n](t[n]))}),r}function qd(e){return i3({maxLogSize:o3},e)}var z0={dateFile:qd,file:qd,fileSync:qd};U0.exports.modifyConfig=e=>z0[e.type]?z0[e.type](e):e});var K0=g(($ne,H0)=>{var s3=console.log.bind(console);function a3(e,t){return r=>{s3(e(r,t))}}function u3(e,t){let r=t.colouredLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),a3(r,e.timezoneOffset)}H0.exports.configure=u3});var G0=g(V0=>{function c3(e,t){return r=>{process.stdout.write(`${e(r,t)}
`)}}function l3(e,t){let r=t.colouredLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),c3(r,e.timezoneOffset)}V0.configure=l3});var Z0=g((jne,J0)=>{function f3(e,t){return r=>{process.stderr.write(`${e(r,t)}
`)}}function p3(e,t){let r=t.colouredLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),f3(r,e.timezoneOffset)}J0.exports.configure=p3});var X0=g((qne,Y0)=>{function d3(e,t,r,n){let o=n.getLevel(e),i=n.getLevel(t,n.FATAL);return s=>{let a=s.level;o.isLessThanOrEqualTo(a)&&i.isGreaterThanOrEqualTo(a)&&r(s)}}function m3(e,t,r,n){let o=r(e.appender);return d3(e.level,e.maxLevel,o,n)}Y0.exports.configure=m3});var tx=g((Lne,ex)=>{var Q0=Ue()("log4js:categoryFilter");function h3(e,t){return typeof e=="string"&&(e=[e]),r=>{Q0(`Checking ${r.categoryName} against ${e}`),e.indexOf(r.categoryName)===-1&&(Q0("Not excluded, sending to appender"),t(r))}}function g3(e,t,r){let n=r(e.appender);return h3(e.exclude,n)}ex.exports.configure=g3});var ox=g((Bne,nx)=>{var rx=Ue()("log4js:noLogFilter");function y3(e){return e.filter(r=>r!=null&&r!=="")}function b3(e,t){return r=>{rx(`Checking data: ${r.data} against filters: ${e}`),typeof e=="string"&&(e=[e]),e=y3(e);let n=new RegExp(e.join("|"),"i");(e.length===0||r.data.findIndex(o=>n.test(o))<0)&&(rx("Not excluded, sending to appender"),t(r))}}function v3(e,t,r){let n=r(e.appender);return b3(e.exclude,n)}nx.exports.configure=v3});var gt=g(Ld=>{"use strict";Ld.fromCallback=function(e){return Object.defineProperty(function(){if(typeof arguments[arguments.length-1]=="function")e.apply(this,arguments);else return new Promise((t,r)=>{arguments[arguments.length]=(n,o)=>{if(n)return r(n);t(o)},arguments.length++,e.apply(this,arguments)})},"name",{value:e.name})};Ld.fromPromise=function(e){return Object.defineProperty(function(){let t=arguments[arguments.length-1];if(typeof t!="function")return e.apply(this,arguments);e.apply(this,arguments).then(r=>t(null,r),t)},"name",{value:e.name})}});var sx=g((Une,ix)=>{var hn=require("constants"),x3=process.cwd,Yu=null,w3=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Yu||(Yu=x3.call(process)),Yu};try{process.cwd()}catch{}typeof process.chdir=="function"&&(Bd=process.chdir,process.chdir=function(e){Yu=null,Bd.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Bd));var Bd;ix.exports=E3;function E3(e){hn.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||r(e),e.chown=i(e.chown),e.fchown=i(e.fchown),e.lchown=i(e.lchown),e.chmod=n(e.chmod),e.fchmod=n(e.fchmod),e.lchmod=n(e.lchmod),e.chownSync=s(e.chownSync),e.fchownSync=s(e.fchownSync),e.lchownSync=s(e.lchownSync),e.chmodSync=o(e.chmodSync),e.fchmodSync=o(e.fchmodSync),e.lchmodSync=o(e.lchmodSync),e.stat=a(e.stat),e.fstat=a(e.fstat),e.lstat=a(e.lstat),e.statSync=u(e.statSync),e.fstatSync=u(e.fstatSync),e.lstatSync=u(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(c,f,p){p&&process.nextTick(p)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(c,f,p,d){d&&process.nextTick(d)},e.lchownSync=function(){}),w3==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(c){function f(p,d,h){var b=Date.now(),y=0;c(p,d,function v(w){if(w&&(w.code==="EACCES"||w.code==="EPERM"||w.code==="EBUSY")&&Date.now()-b<6e4){setTimeout(function(){e.stat(d,function(T,M){T&&T.code==="ENOENT"?c(p,d,v):h(w)})},y),y<100&&(y+=10);return}h&&h(w)})}return Object.setPrototypeOf&&Object.setPrototypeOf(f,c),f}(e.rename)),e.read=typeof e.read!="function"?e.read:function(c){function f(p,d,h,b,y,v){var w;if(v&&typeof v=="function"){var T=0;w=function(M,V,J){if(M&&M.code==="EAGAIN"&&T<10)return T++,c.call(e,p,d,h,b,y,w);v.apply(this,arguments)}}return c.call(e,p,d,h,b,y,w)}return Object.setPrototypeOf&&Object.setPrototypeOf(f,c),f}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(c){return function(f,p,d,h,b){for(var y=0;;)try{return c.call(e,f,p,d,h,b)}catch(v){if(v.code==="EAGAIN"&&y<10){y++;continue}throw v}}}(e.readSync);function t(c){c.lchmod=function(f,p,d){c.open(f,hn.O_WRONLY|hn.O_SYMLINK,p,function(h,b){if(h){d&&d(h);return}c.fchmod(b,p,function(y){c.close(b,function(v){d&&d(y||v)})})})},c.lchmodSync=function(f,p){var d=c.openSync(f,hn.O_WRONLY|hn.O_SYMLINK,p),h=!0,b;try{b=c.fchmodSync(d,p),h=!1}finally{if(h)try{c.closeSync(d)}catch{}else c.closeSync(d)}return b}}function r(c){hn.hasOwnProperty("O_SYMLINK")&&c.futimes?(c.lutimes=function(f,p,d,h){c.open(f,hn.O_SYMLINK,function(b,y){if(b){h&&h(b);return}c.futimes(y,p,d,function(v){c.close(y,function(w){h&&h(v||w)})})})},c.lutimesSync=function(f,p,d){var h=c.openSync(f,hn.O_SYMLINK),b,y=!0;try{b=c.futimesSync(h,p,d),y=!1}finally{if(y)try{c.closeSync(h)}catch{}else c.closeSync(h)}return b}):c.futimes&&(c.lutimes=function(f,p,d,h){h&&process.nextTick(h)},c.lutimesSync=function(){})}function n(c){return c&&function(f,p,d){return c.call(e,f,p,function(h){l(h)&&(h=null),d&&d.apply(this,arguments)})}}function o(c){return c&&function(f,p){try{return c.call(e,f,p)}catch(d){if(!l(d))throw d}}}function i(c){return c&&function(f,p,d,h){return c.call(e,f,p,d,function(b){l(b)&&(b=null),h&&h.apply(this,arguments)})}}function s(c){return c&&function(f,p,d){try{return c.call(e,f,p,d)}catch(h){if(!l(h))throw h}}}function a(c){return c&&function(f,p,d){typeof p=="function"&&(d=p,p=null);function h(b,y){y&&(y.uid<0&&(y.uid+=4294967296),y.gid<0&&(y.gid+=4294967296)),d&&d.apply(this,arguments)}return p?c.call(e,f,p,h):c.call(e,f,h)}}function u(c){return c&&function(f,p){var d=p?c.call(e,f,p):c.call(e,f);return d&&(d.uid<0&&(d.uid+=4294967296),d.gid<0&&(d.gid+=4294967296)),d}}function l(c){if(!c||c.code==="ENOSYS")return!0;var f=!process.getuid||process.getuid()!==0;return!!(f&&(c.code==="EINVAL"||c.code==="EPERM"))}}});var cx=g((Wne,ux)=>{var ax=require("stream").Stream;ux.exports=S3;function S3(e){return{ReadStream:t,WriteStream:r};function t(n,o){if(!(this instanceof t))return new t(n,o);ax.call(this);var i=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,o=o||{};for(var s=Object.keys(o),a=0,u=s.length;a<u;a++){var l=s[a];this[l]=o[l]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){i._read()});return}e.open(this.path,this.flags,this.mode,function(c,f){if(c){i.emit("error",c),i.readable=!1;return}i.fd=f,i.emit("open",f),i._read()})}function r(n,o){if(!(this instanceof r))return new r(n,o);ax.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,o=o||{};for(var i=Object.keys(o),s=0,a=i.length;s<a;s++){var u=i[s];this[u]=o[u]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var fx=g((Hne,lx)=>{"use strict";lx.exports=_3;var I3=Object.getPrototypeOf||function(e){return e.__proto__};function _3(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:I3(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}});var je=g((Kne,Wd)=>{var Ce=require("fs"),C3=sx(),T3=cx(),O3=fx(),Xu=require("util"),Ye,ec;typeof Symbol=="function"&&typeof Symbol.for=="function"?(Ye=Symbol.for("graceful-fs.queue"),ec=Symbol.for("graceful-fs.previous")):(Ye="___graceful-fs.queue",ec="___graceful-fs.previous");function k3(){}function mx(e,t){Object.defineProperty(e,Ye,{get:function(){return t}})}var eo=k3;Xu.debuglog?eo=Xu.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(eo=function(){var e=Xu.format.apply(Xu,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `),console.error(e)});Ce[Ye]||(px=global[Ye]||[],mx(Ce,px),Ce.close=function(e){function t(r,n){return e.call(Ce,r,function(o){o||dx(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(t,ec,{value:e}),t}(Ce.close),Ce.closeSync=function(e){function t(r){e.apply(Ce,arguments),dx()}return Object.defineProperty(t,ec,{value:e}),t}(Ce.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){eo(Ce[Ye]),require("assert").equal(Ce[Ye].length,0)}));var px;global[Ye]||mx(global,Ce[Ye]);Wd.exports=zd(O3(Ce));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!Ce.__patched&&(Wd.exports=zd(Ce),Ce.__patched=!0);function zd(e){C3(e),e.gracefulify=zd,e.createReadStream=V,e.createWriteStream=J;var t=e.readFile;e.readFile=r;function r(P,X,C){return typeof X=="function"&&(C=X,X=null),_(P,X,C);function _(I,B,D,re){return t(I,B,function(oe){oe&&(oe.code==="EMFILE"||oe.code==="ENFILE")?ri([_,[I,B,D],oe,re||Date.now(),Date.now()]):typeof D=="function"&&D.apply(this,arguments)})}}var n=e.writeFile;e.writeFile=o;function o(P,X,C,_){return typeof C=="function"&&(_=C,C=null),I(P,X,C,_);function I(B,D,re,oe,he){return n(B,D,re,function(ae){ae&&(ae.code==="EMFILE"||ae.code==="ENFILE")?ri([I,[B,D,re,oe],ae,he||Date.now(),Date.now()]):typeof oe=="function"&&oe.apply(this,arguments)})}}var i=e.appendFile;i&&(e.appendFile=s);function s(P,X,C,_){return typeof C=="function"&&(_=C,C=null),I(P,X,C,_);function I(B,D,re,oe,he){return i(B,D,re,function(ae){ae&&(ae.code==="EMFILE"||ae.code==="ENFILE")?ri([I,[B,D,re,oe],ae,he||Date.now(),Date.now()]):typeof oe=="function"&&oe.apply(this,arguments)})}}var a=e.copyFile;a&&(e.copyFile=u);function u(P,X,C,_){return typeof C=="function"&&(_=C,C=0),I(P,X,C,_);function I(B,D,re,oe,he){return a(B,D,re,function(ae){ae&&(ae.code==="EMFILE"||ae.code==="ENFILE")?ri([I,[B,D,re,oe],ae,he||Date.now(),Date.now()]):typeof oe=="function"&&oe.apply(this,arguments)})}}var l=e.readdir;e.readdir=f;var c=/^v[0-5]\./;function f(P,X,C){typeof X=="function"&&(C=X,X=null);var _=c.test(process.version)?function(D,re,oe,he){return l(D,I(D,re,oe,he))}:function(D,re,oe,he){return l(D,re,I(D,re,oe,he))};return _(P,X,C);function I(B,D,re,oe){return function(he,ae){he&&(he.code==="EMFILE"||he.code==="ENFILE")?ri([_,[B,D,re],he,oe||Date.now(),Date.now()]):(ae&&ae.sort&&ae.sort(),typeof re=="function"&&re.call(this,he,ae))}}}if(process.version.substr(0,4)==="v0.8"){var p=T3(e);v=p.ReadStream,T=p.WriteStream}var d=e.ReadStream;d&&(v.prototype=Object.create(d.prototype),v.prototype.open=w);var h=e.WriteStream;h&&(T.prototype=Object.create(h.prototype),T.prototype.open=M),Object.defineProperty(e,"ReadStream",{get:function(){return v},set:function(P){v=P},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return T},set:function(P){T=P},enumerable:!0,configurable:!0});var b=v;Object.defineProperty(e,"FileReadStream",{get:function(){return b},set:function(P){b=P},enumerable:!0,configurable:!0});var y=T;Object.defineProperty(e,"FileWriteStream",{get:function(){return y},set:function(P){y=P},enumerable:!0,configurable:!0});function v(P,X){return this instanceof v?(d.apply(this,arguments),this):v.apply(Object.create(v.prototype),arguments)}function w(){var P=this;K(P.path,P.flags,P.mode,function(X,C){X?(P.autoClose&&P.destroy(),P.emit("error",X)):(P.fd=C,P.emit("open",C),P.read())})}function T(P,X){return this instanceof T?(h.apply(this,arguments),this):T.apply(Object.create(T.prototype),arguments)}function M(){var P=this;K(P.path,P.flags,P.mode,function(X,C){X?(P.destroy(),P.emit("error",X)):(P.fd=C,P.emit("open",C))})}function V(P,X){return new e.ReadStream(P,X)}function J(P,X){return new e.WriteStream(P,X)}var G=e.open;e.open=K;function K(P,X,C,_){return typeof C=="function"&&(_=C,C=null),I(P,X,C,_);function I(B,D,re,oe,he){return G(B,D,re,function(ae,E){ae&&(ae.code==="EMFILE"||ae.code==="ENFILE")?ri([I,[B,D,re,oe],ae,he||Date.now(),Date.now()]):typeof oe=="function"&&oe.apply(this,arguments)})}}return e}function ri(e){eo("ENQUEUE",e[0].name,e[1]),Ce[Ye].push(e),Ud()}var Qu;function dx(){for(var e=Date.now(),t=0;t<Ce[Ye].length;++t)Ce[Ye][t].length>2&&(Ce[Ye][t][3]=e,Ce[Ye][t][4]=e);Ud()}function Ud(){if(clearTimeout(Qu),Qu=void 0,Ce[Ye].length!==0){var e=Ce[Ye].shift(),t=e[0],r=e[1],n=e[2],o=e[3],i=e[4];if(o===void 0)eo("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-o>=6e4){eo("TIMEOUT",t.name,r);var s=r.pop();typeof s=="function"&&s.call(null,n)}else{var a=Date.now()-i,u=Math.max(i-o,1),l=Math.min(u*1.2,100);a>=l?(eo("RETRY",t.name,r),t.apply(null,r.concat([o]))):Ce[Ye].push(e)}Qu===void 0&&(Qu=setTimeout(Ud,0))}}});var Hd=g(to=>{"use strict";var hx=gt().fromCallback,Ht=je(),A3=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","lchmod","link","lstat","mkdir","mkdtemp","open","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof Ht[e]=="function");Object.keys(Ht).forEach(e=>{e!=="promises"&&(to[e]=Ht[e])});A3.forEach(e=>{to[e]=hx(Ht[e])});to.exists=function(e,t){return typeof t=="function"?Ht.exists(e,t):new Promise(r=>Ht.exists(e,r))};to.read=function(e,t,r,n,o,i){return typeof i=="function"?Ht.read(e,t,r,n,o,i):new Promise((s,a)=>{Ht.read(e,t,r,n,o,(u,l,c)=>{if(u)return a(u);s({bytesRead:l,buffer:c})})})};to.write=function(e,t,...r){return typeof r[r.length-1]=="function"?Ht.write(e,t,...r):new Promise((n,o)=>{Ht.write(e,t,...r,(i,s,a)=>{if(i)return o(i);n({bytesWritten:s,buffer:a})})})};typeof Ht.realpath.native=="function"&&(to.realpath.native=hx(Ht.realpath.native))});var Vd=g((Gne,yx)=>{"use strict";var Kd=require("path");function gx(e){return e=Kd.normalize(Kd.resolve(e)).split(Kd.sep),e.length>0?e[0]:null}var N3=/[<>:"|?*]/;function R3(e){let t=gx(e);return e=e.replace(t,""),N3.test(e)}yx.exports={getRootPath:gx,invalidWin32Path:R3}});var vx=g((Jne,bx)=>{"use strict";var D3=je(),Gd=require("path"),P3=Vd().invalidWin32Path,F3=parseInt("0777",8);function Jd(e,t,r,n){if(typeof t=="function"?(r=t,t={}):(!t||typeof t!="object")&&(t={mode:t}),process.platform==="win32"&&P3(e)){let s=new Error(e+" contains invalid WIN32 path characters.");return s.code="EINVAL",r(s)}let o=t.mode,i=t.fs||D3;o===void 0&&(o=F3&~process.umask()),n||(n=null),r=r||function(){},e=Gd.resolve(e),i.mkdir(e,o,s=>{if(!s)return n=n||e,r(null,n);switch(s.code){case"ENOENT":if(Gd.dirname(e)===e)return r(s);Jd(Gd.dirname(e),t,(a,u)=>{a?r(a,u):Jd(e,t,r,u)});break;default:i.stat(e,(a,u)=>{a||!u.isDirectory()?r(s,n):r(null,n)});break}})}bx.exports=Jd});var wx=g((Zne,xx)=>{"use strict";var $3=je(),Zd=require("path"),M3=Vd().invalidWin32Path,j3=parseInt("0777",8);function Yd(e,t,r){(!t||typeof t!="object")&&(t={mode:t});let n=t.mode,o=t.fs||$3;if(process.platform==="win32"&&M3(e)){let i=new Error(e+" contains invalid WIN32 path characters.");throw i.code="EINVAL",i}n===void 0&&(n=j3&~process.umask()),r||(r=null),e=Zd.resolve(e);try{o.mkdirSync(e,n),r=r||e}catch(i){if(i.code==="ENOENT"){if(Zd.dirname(e)===e)throw i;r=Yd(Zd.dirname(e),t,r),Yd(e,t,r)}else{let s;try{s=o.statSync(e)}catch{throw i}if(!s.isDirectory())throw i}}return r}xx.exports=Yd});var At=g((Yne,Ex)=>{"use strict";var q3=gt().fromCallback,Xd=q3(vx()),Qd=wx();Ex.exports={mkdirs:Xd,mkdirsSync:Qd,mkdirp:Xd,mkdirpSync:Qd,ensureDir:Xd,ensureDirSync:Qd}});var em=g((Xne,Ix)=>{"use strict";var nt=je(),Sx=require("os"),tc=require("path");function L3(){let e=tc.join("millis-test-sync"+Date.now().toString()+Math.random().toString().slice(2));e=tc.join(Sx.tmpdir(),e);let t=new Date(1435410243862);nt.writeFileSync(e,"https://github.com/jprichardson/node-fs-extra/pull/141");let r=nt.openSync(e,"r+");return nt.futimesSync(r,t,t),nt.closeSync(r),nt.statSync(e).mtime>1435410243e3}function B3(e){let t=tc.join("millis-test"+Date.now().toString()+Math.random().toString().slice(2));t=tc.join(Sx.tmpdir(),t);let r=new Date(1435410243862);nt.writeFile(t,"https://github.com/jprichardson/node-fs-extra/pull/141",n=>{if(n)return e(n);nt.open(t,"r+",(o,i)=>{if(o)return e(o);nt.futimes(i,r,r,s=>{if(s)return e(s);nt.close(i,a=>{if(a)return e(a);nt.stat(t,(u,l)=>{if(u)return e(u);e(null,l.mtime>1435410243e3)})})})})})}function z3(e){if(typeof e=="number")return Math.floor(e/1e3)*1e3;if(e instanceof Date)return new Date(Math.floor(e.getTime()/1e3)*1e3);throw new Error("fs-extra: timeRemoveMillis() unknown parameter type")}function U3(e,t,r,n){nt.open(e,"r+",(o,i)=>{if(o)return n(o);nt.futimes(i,t,r,s=>{nt.close(i,a=>{n&&n(s||a)})})})}function W3(e,t,r){let n=nt.openSync(e,"r+");return nt.futimesSync(n,t,r),nt.closeSync(n)}Ix.exports={hasMillisRes:B3,hasMillisResSync:L3,timeRemoveMillis:z3,utimesMillis:U3,utimesMillisSync:W3}});var Ss=g((Qne,Ax)=>{"use strict";var Kt=je(),yt=require("path"),_x=10,Cx=5,H3=0,rm=process.versions.node.split("."),Tx=Number.parseInt(rm[0],10),Ox=Number.parseInt(rm[1],10),K3=Number.parseInt(rm[2],10);function ws(){if(Tx>_x)return!0;if(Tx===_x){if(Ox>Cx)return!0;if(Ox===Cx&&K3>=H3)return!0}return!1}function V3(e,t,r){ws()?Kt.stat(e,{bigint:!0},(n,o)=>{if(n)return r(n);Kt.stat(t,{bigint:!0},(i,s)=>i?i.code==="ENOENT"?r(null,{srcStat:o,destStat:null}):r(i):r(null,{srcStat:o,destStat:s}))}):Kt.stat(e,(n,o)=>{if(n)return r(n);Kt.stat(t,(i,s)=>i?i.code==="ENOENT"?r(null,{srcStat:o,destStat:null}):r(i):r(null,{srcStat:o,destStat:s}))})}function G3(e,t){let r,n;ws()?r=Kt.statSync(e,{bigint:!0}):r=Kt.statSync(e);try{ws()?n=Kt.statSync(t,{bigint:!0}):n=Kt.statSync(t)}catch(o){if(o.code==="ENOENT")return{srcStat:r,destStat:null};throw o}return{srcStat:r,destStat:n}}function J3(e,t,r,n){V3(e,t,(o,i)=>{if(o)return n(o);let{srcStat:s,destStat:a}=i;return a&&a.ino&&a.dev&&a.ino===s.ino&&a.dev===s.dev?n(new Error("Source and destination must not be the same.")):s.isDirectory()&&nm(e,t)?n(new Error(Es(e,t,r))):n(null,{srcStat:s,destStat:a})})}function Z3(e,t,r){let{srcStat:n,destStat:o}=G3(e,t);if(o&&o.ino&&o.dev&&o.ino===n.ino&&o.dev===n.dev)throw new Error("Source and destination must not be the same.");if(n.isDirectory()&&nm(e,t))throw new Error(Es(e,t,r));return{srcStat:n,destStat:o}}function tm(e,t,r,n,o){let i=yt.resolve(yt.dirname(e)),s=yt.resolve(yt.dirname(r));if(s===i||s===yt.parse(s).root)return o();ws()?Kt.stat(s,{bigint:!0},(a,u)=>a?a.code==="ENOENT"?o():o(a):u.ino&&u.dev&&u.ino===t.ino&&u.dev===t.dev?o(new Error(Es(e,r,n))):tm(e,t,s,n,o)):Kt.stat(s,(a,u)=>a?a.code==="ENOENT"?o():o(a):u.ino&&u.dev&&u.ino===t.ino&&u.dev===t.dev?o(new Error(Es(e,r,n))):tm(e,t,s,n,o))}function kx(e,t,r,n){let o=yt.resolve(yt.dirname(e)),i=yt.resolve(yt.dirname(r));if(i===o||i===yt.parse(i).root)return;let s;try{ws()?s=Kt.statSync(i,{bigint:!0}):s=Kt.statSync(i)}catch(a){if(a.code==="ENOENT")return;throw a}if(s.ino&&s.dev&&s.ino===t.ino&&s.dev===t.dev)throw new Error(Es(e,r,n));return kx(e,t,i,n)}function nm(e,t){let r=yt.resolve(e).split(yt.sep).filter(o=>o),n=yt.resolve(t).split(yt.sep).filter(o=>o);return r.reduce((o,i,s)=>o&&n[s]===i,!0)}function Es(e,t,r){return`Cannot ${r} '${e}' to a subdirectory of itself, '${t}'.`}Ax.exports={checkPaths:J3,checkPathsSync:Z3,checkParentPaths:tm,checkParentPathsSync:kx,isSrcSubdir:nm}});var Rx=g((eoe,Nx)=>{"use strict";Nx.exports=function(e){if(typeof Buffer.allocUnsafe=="function")try{return Buffer.allocUnsafe(e)}catch{return new Buffer(e)}return new Buffer(e)}});var Mx=g((toe,$x)=>{"use strict";var Ie=je(),Is=require("path"),Y3=At().mkdirsSync,X3=em().utimesMillisSync,_s=Ss();function Q3(e,t,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;

    see https://github.com/jprichardson/node-fs-extra/issues/269`);let{srcStat:n,destStat:o}=_s.checkPathsSync(e,t,"copy");return _s.checkParentPathsSync(e,n,t,"copy"),e5(o,e,t,r)}function e5(e,t,r,n){if(n.filter&&!n.filter(t,r))return;let o=Is.dirname(r);return Ie.existsSync(o)||Y3(o),Dx(e,t,r,n)}function Dx(e,t,r,n){if(!(n.filter&&!n.filter(t,r)))return t5(e,t,r,n)}function t5(e,t,r,n){let i=(n.dereference?Ie.statSync:Ie.lstatSync)(t);if(i.isDirectory())return i5(i,e,t,r,n);if(i.isFile()||i.isCharacterDevice()||i.isBlockDevice())return r5(i,e,t,r,n);if(i.isSymbolicLink())return u5(e,t,r,n)}function r5(e,t,r,n,o){return t?n5(e,r,n,o):Px(e,r,n,o)}function n5(e,t,r,n){if(n.overwrite)return Ie.unlinkSync(r),Px(e,t,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function Px(e,t,r,n){return typeof Ie.copyFileSync=="function"?(Ie.copyFileSync(t,r),Ie.chmodSync(r,e.mode),n.preserveTimestamps?X3(r,e.atime,e.mtime):void 0):o5(e,t,r,n)}function o5(e,t,r,n){let i=Rx()(65536),s=Ie.openSync(t,"r"),a=Ie.openSync(r,"w",e.mode),u=0;for(;u<e.size;){let l=Ie.readSync(s,i,0,65536,u);Ie.writeSync(a,i,0,l),u+=l}n.preserveTimestamps&&Ie.futimesSync(a,e.atime,e.mtime),Ie.closeSync(s),Ie.closeSync(a)}function i5(e,t,r,n,o){if(!t)return s5(e,r,n,o);if(t&&!t.isDirectory())throw new Error(`Cannot overwrite non-directory '${n}' with directory '${r}'.`);return Fx(r,n,o)}function s5(e,t,r,n){return Ie.mkdirSync(r),Fx(t,r,n),Ie.chmodSync(r,e.mode)}function Fx(e,t,r){Ie.readdirSync(e).forEach(n=>a5(n,e,t,r))}function a5(e,t,r,n){let o=Is.join(t,e),i=Is.join(r,e),{destStat:s}=_s.checkPathsSync(o,i,"copy");return Dx(s,o,i,n)}function u5(e,t,r,n){let o=Ie.readlinkSync(t);if(n.dereference&&(o=Is.resolve(process.cwd(),o)),e){let i;try{i=Ie.readlinkSync(r)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return Ie.symlinkSync(o,r);throw s}if(n.dereference&&(i=Is.resolve(process.cwd(),i)),_s.isSrcSubdir(o,i))throw new Error(`Cannot copy '${o}' to a subdirectory of itself, '${i}'.`);if(Ie.statSync(r).isDirectory()&&_s.isSrcSubdir(i,o))throw new Error(`Cannot overwrite '${i}' with '${o}'.`);return c5(o,r)}else return Ie.symlinkSync(o,r)}function c5(e,t){return Ie.unlinkSync(t),Ie.symlinkSync(e,t)}$x.exports=Q3});var om=g((roe,jx)=>{"use strict";jx.exports={copySync:Mx()}});var xr=g((noe,Lx)=>{"use strict";var l5=gt().fromPromise,qx=Hd();function f5(e){return qx.access(e).then(()=>!0).catch(()=>!1)}Lx.exports={pathExists:l5(f5),pathExistsSync:qx.existsSync}});var Jx=g((ooe,Gx)=>{"use strict";var Xe=je(),Cs=require("path"),p5=At().mkdirs,d5=xr().pathExists,m5=em().utimesMillis,Ts=Ss();function h5(e,t,r,n){typeof r=="function"&&!n?(n=r,r={}):typeof r=="function"&&(r={filter:r}),n=n||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;

    see https://github.com/jprichardson/node-fs-extra/issues/269`),Ts.checkPaths(e,t,"copy",(o,i)=>{if(o)return n(o);let{srcStat:s,destStat:a}=i;Ts.checkParentPaths(e,s,t,"copy",u=>u?n(u):r.filter?Ux(Bx,a,e,t,r,n):Bx(a,e,t,r,n))})}function Bx(e,t,r,n,o){let i=Cs.dirname(r);d5(i,(s,a)=>{if(s)return o(s);if(a)return im(e,t,r,n,o);p5(i,u=>u?o(u):im(e,t,r,n,o))})}function Ux(e,t,r,n,o,i){Promise.resolve(o.filter(r,n)).then(s=>s?e(t,r,n,o,i):i(),s=>i(s))}function im(e,t,r,n,o){return n.filter?Ux(zx,e,t,r,n,o):zx(e,t,r,n,o)}function zx(e,t,r,n,o){(n.dereference?Xe.stat:Xe.lstat)(t,(s,a)=>{if(s)return o(s);if(a.isDirectory())return v5(a,e,t,r,n,o);if(a.isFile()||a.isCharacterDevice()||a.isBlockDevice())return g5(a,e,t,r,n,o);if(a.isSymbolicLink())return E5(e,t,r,n,o)})}function g5(e,t,r,n,o,i){return t?y5(e,r,n,o,i):Wx(e,r,n,o,i)}function y5(e,t,r,n,o){if(n.overwrite)Xe.unlink(r,i=>i?o(i):Wx(e,t,r,n,o));else return n.errorOnExist?o(new Error(`'${r}' already exists`)):o()}function Wx(e,t,r,n,o){return typeof Xe.copyFile=="function"?Xe.copyFile(t,r,i=>i?o(i):Hx(e,r,n,o)):b5(e,t,r,n,o)}function b5(e,t,r,n,o){let i=Xe.createReadStream(t);i.on("error",s=>o(s)).once("open",()=>{let s=Xe.createWriteStream(r,{mode:e.mode});s.on("error",a=>o(a)).on("open",()=>i.pipe(s)).once("close",()=>Hx(e,r,n,o))})}function Hx(e,t,r,n){Xe.chmod(t,e.mode,o=>o?n(o):r.preserveTimestamps?m5(t,e.atime,e.mtime,n):n())}function v5(e,t,r,n,o,i){return t?t&&!t.isDirectory()?i(new Error(`Cannot overwrite non-directory '${n}' with directory '${r}'.`)):Kx(r,n,o,i):x5(e,r,n,o,i)}function x5(e,t,r,n,o){Xe.mkdir(r,i=>{if(i)return o(i);Kx(t,r,n,s=>s?o(s):Xe.chmod(r,e.mode,o))})}function Kx(e,t,r,n){Xe.readdir(e,(o,i)=>o?n(o):Vx(i,e,t,r,n))}function Vx(e,t,r,n,o){let i=e.pop();return i?w5(e,i,t,r,n,o):o()}function w5(e,t,r,n,o,i){let s=Cs.join(r,t),a=Cs.join(n,t);Ts.checkPaths(s,a,"copy",(u,l)=>{if(u)return i(u);let{destStat:c}=l;im(c,s,a,o,f=>f?i(f):Vx(e,r,n,o,i))})}function E5(e,t,r,n,o){Xe.readlink(t,(i,s)=>{if(i)return o(i);if(n.dereference&&(s=Cs.resolve(process.cwd(),s)),e)Xe.readlink(r,(a,u)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?Xe.symlink(s,r,o):o(a):(n.dereference&&(u=Cs.resolve(process.cwd(),u)),Ts.isSrcSubdir(s,u)?o(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${u}'.`)):e.isDirectory()&&Ts.isSrcSubdir(u,s)?o(new Error(`Cannot overwrite '${u}' with '${s}'.`)):S5(s,r,o)));else return Xe.symlink(s,r,o)})}function S5(e,t,r){Xe.unlink(t,n=>n?r(n):Xe.symlink(e,t,r))}Gx.exports=h5});var sm=g((ioe,Zx)=>{"use strict";var I5=gt().fromCallback;Zx.exports={copy:I5(Jx())}});var iw=g((soe,ow)=>{"use strict";var Yx=je(),tw=require("path"),le=require("assert"),Os=process.platform==="win32";function rw(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{e[r]=e[r]||Yx[r],r=r+"Sync",e[r]=e[r]||Yx[r]}),e.maxBusyTries=e.maxBusyTries||3}function am(e,t,r){let n=0;typeof t=="function"&&(r=t,t={}),le(e,"rimraf: missing path"),le.strictEqual(typeof e,"string","rimraf: path should be a string"),le.strictEqual(typeof r,"function","rimraf: callback function required"),le(t,"rimraf: invalid options argument provided"),le.strictEqual(typeof t,"object","rimraf: options should be object"),rw(t),Xx(e,t,function o(i){if(i){if((i.code==="EBUSY"||i.code==="ENOTEMPTY"||i.code==="EPERM")&&n<t.maxBusyTries){n++;let s=n*100;return setTimeout(()=>Xx(e,t,o),s)}i.code==="ENOENT"&&(i=null)}r(i)})}function Xx(e,t,r){le(e),le(t),le(typeof r=="function"),t.lstat(e,(n,o)=>{if(n&&n.code==="ENOENT")return r(null);if(n&&n.code==="EPERM"&&Os)return Qx(e,t,n,r);if(o&&o.isDirectory())return rc(e,t,n,r);t.unlink(e,i=>{if(i){if(i.code==="ENOENT")return r(null);if(i.code==="EPERM")return Os?Qx(e,t,i,r):rc(e,t,i,r);if(i.code==="EISDIR")return rc(e,t,i,r)}return r(i)})})}function Qx(e,t,r,n){le(e),le(t),le(typeof n=="function"),r&&le(r instanceof Error),t.chmod(e,438,o=>{o?n(o.code==="ENOENT"?null:r):t.stat(e,(i,s)=>{i?n(i.code==="ENOENT"?null:r):s.isDirectory()?rc(e,t,r,n):t.unlink(e,n)})})}function ew(e,t,r){let n;le(e),le(t),r&&le(r instanceof Error);try{t.chmodSync(e,438)}catch(o){if(o.code==="ENOENT")return;throw r}try{n=t.statSync(e)}catch(o){if(o.code==="ENOENT")return;throw r}n.isDirectory()?nc(e,t,r):t.unlinkSync(e)}function rc(e,t,r,n){le(e),le(t),r&&le(r instanceof Error),le(typeof n=="function"),t.rmdir(e,o=>{o&&(o.code==="ENOTEMPTY"||o.code==="EEXIST"||o.code==="EPERM")?_5(e,t,n):o&&o.code==="ENOTDIR"?n(r):n(o)})}function _5(e,t,r){le(e),le(t),le(typeof r=="function"),t.readdir(e,(n,o)=>{if(n)return r(n);let i=o.length,s;if(i===0)return t.rmdir(e,r);o.forEach(a=>{am(tw.join(e,a),t,u=>{if(!s){if(u)return r(s=u);--i===0&&t.rmdir(e,r)}})})})}function nw(e,t){let r;t=t||{},rw(t),le(e,"rimraf: missing path"),le.strictEqual(typeof e,"string","rimraf: path should be a string"),le(t,"rimraf: missing options"),le.strictEqual(typeof t,"object","rimraf: options should be object");try{r=t.lstatSync(e)}catch(n){if(n.code==="ENOENT")return;n.code==="EPERM"&&Os&&ew(e,t,n)}try{r&&r.isDirectory()?nc(e,t,null):t.unlinkSync(e)}catch(n){if(n.code==="ENOENT")return;if(n.code==="EPERM")return Os?ew(e,t,n):nc(e,t,n);if(n.code!=="EISDIR")throw n;nc(e,t,n)}}function nc(e,t,r){le(e),le(t),r&&le(r instanceof Error);try{t.rmdirSync(e)}catch(n){if(n.code==="ENOTDIR")throw r;if(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")C5(e,t);else if(n.code!=="ENOENT")throw n}}function C5(e,t){if(le(e),le(t),t.readdirSync(e).forEach(r=>nw(tw.join(e,r),t)),Os){let r=Date.now();do try{return t.rmdirSync(e,t)}catch{}while(Date.now()-r<500)}else return t.rmdirSync(e,t)}ow.exports=am;am.sync=nw});var ks=g((aoe,aw)=>{"use strict";var T5=gt().fromCallback,sw=iw();aw.exports={remove:T5(sw),removeSync:sw.sync}});var hw=g((uoe,mw)=>{"use strict";var O5=gt().fromCallback,lw=je(),fw=require("path"),pw=At(),dw=ks(),uw=O5(function(t,r){r=r||function(){},lw.readdir(t,(n,o)=>{if(n)return pw.mkdirs(t,r);o=o.map(s=>fw.join(t,s)),i();function i(){let s=o.pop();if(!s)return r();dw.remove(s,a=>{if(a)return r(a);i()})}})});function cw(e){let t;try{t=lw.readdirSync(e)}catch{return pw.mkdirsSync(e)}t.forEach(r=>{r=fw.join(e,r),dw.removeSync(r)})}mw.exports={emptyDirSync:cw,emptydirSync:cw,emptyDir:uw,emptydir:uw}});var vw=g((coe,bw)=>{"use strict";var k5=gt().fromCallback,gw=require("path"),As=je(),yw=At(),A5=xr().pathExists;function N5(e,t){function r(){As.writeFile(e,"",n=>{if(n)return t(n);t()})}As.stat(e,(n,o)=>{if(!n&&o.isFile())return t();let i=gw.dirname(e);A5(i,(s,a)=>{if(s)return t(s);if(a)return r();yw.mkdirs(i,u=>{if(u)return t(u);r()})})})}function R5(e){let t;try{t=As.statSync(e)}catch{}if(t&&t.isFile())return;let r=gw.dirname(e);As.existsSync(r)||yw.mkdirsSync(r),As.writeFileSync(e,"")}bw.exports={createFile:k5(N5),createFileSync:R5}});var Iw=g((loe,Sw)=>{"use strict";var D5=gt().fromCallback,ww=require("path"),ro=je(),Ew=At(),xw=xr().pathExists;function P5(e,t,r){function n(o,i){ro.link(o,i,s=>{if(s)return r(s);r(null)})}xw(t,(o,i)=>{if(o)return r(o);if(i)return r(null);ro.lstat(e,s=>{if(s)return s.message=s.message.replace("lstat","ensureLink"),r(s);let a=ww.dirname(t);xw(a,(u,l)=>{if(u)return r(u);if(l)return n(e,t);Ew.mkdirs(a,c=>{if(c)return r(c);n(e,t)})})})})}function F5(e,t){if(ro.existsSync(t))return;try{ro.lstatSync(e)}catch(i){throw i.message=i.message.replace("lstat","ensureLink"),i}let n=ww.dirname(t);return ro.existsSync(n)||Ew.mkdirsSync(n),ro.linkSync(e,t)}Sw.exports={createLink:D5(P5),createLinkSync:F5}});var Cw=g((foe,_w)=>{"use strict";var gn=require("path"),Ns=je(),$5=xr().pathExists;function M5(e,t,r){if(gn.isAbsolute(e))return Ns.lstat(e,n=>n?(n.message=n.message.replace("lstat","ensureSymlink"),r(n)):r(null,{toCwd:e,toDst:e}));{let n=gn.dirname(t),o=gn.join(n,e);return $5(o,(i,s)=>i?r(i):s?r(null,{toCwd:o,toDst:e}):Ns.lstat(e,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),r(a)):r(null,{toCwd:e,toDst:gn.relative(n,e)})))}}function j5(e,t){let r;if(gn.isAbsolute(e)){if(r=Ns.existsSync(e),!r)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}else{let n=gn.dirname(t),o=gn.join(n,e);if(r=Ns.existsSync(o),r)return{toCwd:o,toDst:e};if(r=Ns.existsSync(e),!r)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:gn.relative(n,e)}}}_w.exports={symlinkPaths:M5,symlinkPathsSync:j5}});var kw=g((poe,Ow)=>{"use strict";var Tw=je();function q5(e,t,r){if(r=typeof t=="function"?t:r,t=typeof t=="function"?!1:t,t)return r(null,t);Tw.lstat(e,(n,o)=>{if(n)return r(null,"file");t=o&&o.isDirectory()?"dir":"file",r(null,t)})}function L5(e,t){let r;if(t)return t;try{r=Tw.lstatSync(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}Ow.exports={symlinkType:q5,symlinkTypeSync:L5}});var $w=g((doe,Fw)=>{"use strict";var B5=gt().fromCallback,Nw=require("path"),ni=je(),Rw=At(),z5=Rw.mkdirs,U5=Rw.mkdirsSync,Dw=Cw(),W5=Dw.symlinkPaths,H5=Dw.symlinkPathsSync,Pw=kw(),K5=Pw.symlinkType,V5=Pw.symlinkTypeSync,Aw=xr().pathExists;function G5(e,t,r,n){n=typeof r=="function"?r:n,r=typeof r=="function"?!1:r,Aw(t,(o,i)=>{if(o)return n(o);if(i)return n(null);W5(e,t,(s,a)=>{if(s)return n(s);e=a.toDst,K5(a.toCwd,r,(u,l)=>{if(u)return n(u);let c=Nw.dirname(t);Aw(c,(f,p)=>{if(f)return n(f);if(p)return ni.symlink(e,t,l,n);z5(c,d=>{if(d)return n(d);ni.symlink(e,t,l,n)})})})})})}function J5(e,t,r){if(ni.existsSync(t))return;let o=H5(e,t);e=o.toDst,r=V5(o.toCwd,r);let i=Nw.dirname(t);return ni.existsSync(i)||U5(i),ni.symlinkSync(e,t,r)}Fw.exports={createSymlink:B5(G5),createSymlinkSync:J5}});var jw=g((moe,Mw)=>{"use strict";var oc=vw(),ic=Iw(),sc=$w();Mw.exports={createFile:oc.createFile,createFileSync:oc.createFileSync,ensureFile:oc.createFile,ensureFileSync:oc.createFileSync,createLink:ic.createLink,createLinkSync:ic.createLinkSync,ensureLink:ic.createLink,ensureLinkSync:ic.createLinkSync,createSymlink:sc.createSymlink,createSymlinkSync:sc.createSymlinkSync,ensureSymlink:sc.createSymlink,ensureSymlinkSync:sc.createSymlinkSync}});var zw=g((hoe,Bw)=>{var oi;try{oi=je()}catch{oi=require("fs")}function Z5(e,t,r){r==null&&(r=t,t={}),typeof t=="string"&&(t={encoding:t}),t=t||{};var n=t.fs||oi,o=!0;"throws"in t&&(o=t.throws),n.readFile(e,t,function(i,s){if(i)return r(i);s=Lw(s);var a;try{a=JSON.parse(s,t?t.reviver:null)}catch(u){return o?(u.message=e+": "+u.message,r(u)):r(null,null)}r(null,a)})}function Y5(e,t){t=t||{},typeof t=="string"&&(t={encoding:t});var r=t.fs||oi,n=!0;"throws"in t&&(n=t.throws);try{var o=r.readFileSync(e,t);return o=Lw(o),JSON.parse(o,t.reviver)}catch(i){if(n)throw i.message=e+": "+i.message,i;return null}}function qw(e,t){var r,n=`
`;typeof t=="object"&&t!==null&&(t.spaces&&(r=t.spaces),t.EOL&&(n=t.EOL));var o=JSON.stringify(e,t?t.replacer:null,r);return o.replace(/\n/g,n)+n}function X5(e,t,r,n){n==null&&(n=r,r={}),r=r||{};var o=r.fs||oi,i="";try{i=qw(t,r)}catch(s){n&&n(s,null);return}o.writeFile(e,i,r,n)}function Q5(e,t,r){r=r||{};var n=r.fs||oi,o=qw(t,r);return n.writeFileSync(e,o,r)}function Lw(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e=e.replace(/^\uFEFF/,""),e}var eq={readFile:Z5,readFileSync:Y5,writeFile:X5,writeFileSync:Q5};Bw.exports=eq});var uc=g((goe,Ww)=>{"use strict";var Uw=gt().fromCallback,ac=zw();Ww.exports={readJson:Uw(ac.readFile),readJsonSync:ac.readFileSync,writeJson:Uw(ac.writeFile),writeJsonSync:ac.writeFileSync}});var Vw=g((yoe,Kw)=>{"use strict";var tq=require("path"),rq=At(),nq=xr().pathExists,Hw=uc();function oq(e,t,r,n){typeof r=="function"&&(n=r,r={});let o=tq.dirname(e);nq(o,(i,s)=>{if(i)return n(i);if(s)return Hw.writeJson(e,t,r,n);rq.mkdirs(o,a=>{if(a)return n(a);Hw.writeJson(e,t,r,n)})})}Kw.exports=oq});var Jw=g((boe,Gw)=>{"use strict";var iq=je(),sq=require("path"),aq=At(),uq=uc();function cq(e,t,r){let n=sq.dirname(e);iq.existsSync(n)||aq.mkdirsSync(n),uq.writeJsonSync(e,t,r)}Gw.exports=cq});var Yw=g((voe,Zw)=>{"use strict";var lq=gt().fromCallback,ut=uc();ut.outputJson=lq(Vw());ut.outputJsonSync=Jw();ut.outputJSON=ut.outputJson;ut.outputJSONSync=ut.outputJsonSync;ut.writeJSON=ut.writeJson;ut.writeJSONSync=ut.writeJsonSync;ut.readJSON=ut.readJson;ut.readJSONSync=ut.readJsonSync;Zw.exports=ut});var nE=g((xoe,rE)=>{"use strict";var eE=je(),fq=require("path"),pq=om().copySync,tE=ks().removeSync,dq=At().mkdirpSync,Xw=Ss();function mq(e,t,r){r=r||{};let n=r.overwrite||r.clobber||!1,{srcStat:o}=Xw.checkPathsSync(e,t,"move");return Xw.checkParentPathsSync(e,o,t,"move"),dq(fq.dirname(t)),hq(e,t,n)}function hq(e,t,r){if(r)return tE(t),Qw(e,t,r);if(eE.existsSync(t))throw new Error("dest already exists.");return Qw(e,t,r)}function Qw(e,t,r){try{eE.renameSync(e,t)}catch(n){if(n.code!=="EXDEV")throw n;return gq(e,t,r)}}function gq(e,t,r){return pq(e,t,{overwrite:r,errorOnExist:!0}),tE(e)}rE.exports=mq});var iE=g((woe,oE)=>{"use strict";oE.exports={moveSync:nE()}});var lE=g((Eoe,cE)=>{"use strict";var yq=je(),bq=require("path"),vq=sm().copy,uE=ks().remove,xq=At().mkdirp,wq=xr().pathExists,sE=Ss();function Eq(e,t,r,n){typeof r=="function"&&(n=r,r={});let o=r.overwrite||r.clobber||!1;sE.checkPaths(e,t,"move",(i,s)=>{if(i)return n(i);let{srcStat:a}=s;sE.checkParentPaths(e,a,t,"move",u=>{if(u)return n(u);xq(bq.dirname(t),l=>l?n(l):Sq(e,t,o,n))})})}function Sq(e,t,r,n){if(r)return uE(t,o=>o?n(o):aE(e,t,r,n));wq(t,(o,i)=>o?n(o):i?n(new Error("dest already exists.")):aE(e,t,r,n))}function aE(e,t,r,n){yq.rename(e,t,o=>o?o.code!=="EXDEV"?n(o):Iq(e,t,r,n):n())}function Iq(e,t,r,n){vq(e,t,{overwrite:r,errorOnExist:!0},i=>i?n(i):uE(e,n))}cE.exports=Eq});var pE=g((Soe,fE)=>{"use strict";var _q=gt().fromCallback;fE.exports={move:_q(lE())}});var gE=g((Ioe,hE)=>{"use strict";var Cq=gt().fromCallback,Rs=je(),dE=require("path"),mE=At(),Tq=xr().pathExists;function Oq(e,t,r,n){typeof r=="function"&&(n=r,r="utf8");let o=dE.dirname(e);Tq(o,(i,s)=>{if(i)return n(i);if(s)return Rs.writeFile(e,t,r,n);mE.mkdirs(o,a=>{if(a)return n(a);Rs.writeFile(e,t,r,n)})})}function kq(e,...t){let r=dE.dirname(e);if(Rs.existsSync(r))return Rs.writeFileSync(e,...t);mE.mkdirsSync(r),Rs.writeFileSync(e,...t)}hE.exports={outputFile:Cq(Oq),outputFileSync:kq}});var cm=g((_oe,um)=>{"use strict";um.exports=Object.assign({},Hd(),om(),sm(),hw(),jw(),Yw(),At(),iE(),pE(),gE(),xr(),ks());var yE=require("fs");Object.getOwnPropertyDescriptor(yE,"promises")&&Object.defineProperty(um.exports,"promises",{get(){return yE.promises}})});var vE=g((Coe,bE)=>{bE.exports=()=>new Date});var wE=g((Toe,xE)=>{var Aq=Ue()("streamroller:fileNameFormatter"),Nq=require("path"),Rq=".gz",Dq=".";xE.exports=({file:e,keepFileExt:t,needsIndex:r,alwaysIncludeDate:n,compress:o,fileNameSep:i})=>{let s=i||Dq,a=Nq.join(e.dir,e.name),u=d=>d+e.ext,l=(d,h,b)=>(r||!b)&&h?d+s+h:d,c=(d,h,b)=>(h>0||n)&&b?d+s+b:d,f=(d,h)=>h&&o?d+Rq:d,p=t?[c,l,u,f]:[u,c,l,f];return({date:d,index:h})=>(Aq(`_formatFileName: date=${d}, index=${h}`),p.reduce((b,y)=>y(b,h,d),a))}});var _E=g((Ooe,IE)=>{var no=Ue()("streamroller:fileNameParser"),EE=".gz",SE=Ku(),Pq=".";IE.exports=({file:e,keepFileExt:t,pattern:r,fileNameSep:n})=>{let o=n||Pq,i=(p,d)=>p.endsWith(EE)?(no("it is gzipped"),d.isCompressed=!0,p.slice(0,-1*EE.length)):p,s="__NOT_MATCHING__",f=[i,t?p=>p.startsWith(e.name)&&p.endsWith(e.ext)?(no("it starts and ends with the right things"),p.slice(e.name.length+1,-1*e.ext.length)):s:p=>p.startsWith(e.base)?(no("it starts with the right things"),p.slice(e.base.length+1)):s,r?(p,d)=>{let h=p.split(o),b=h[h.length-1];no("items: ",h,", indexStr: ",b);let y=p;b!==void 0&&b.match(/^\d+$/)?(y=p.slice(0,-1*(b.length+1)),no(`dateStr is ${y}`),r&&!y&&(y=b,b="0")):b="0";try{let v=SE.parse(r,y,new Date(0,0));return SE.asString(r,v)!==y?p:(d.index=parseInt(b,10),d.date=y,d.timestamp=v.getTime(),"")}catch(v){return no(`Problem parsing ${y} as ${r}, error was: `,v),p}}:(p,d)=>p.match(/^\d+$/)?(no("it has an index"),d.index=parseInt(p,10),""):p];return p=>{let d={filename:p,index:0,isCompressed:!1};return f.reduce((b,y)=>y(b,d),p)?null:d}}});var TE=g((koe,CE)=>{var bt=Ue()("streamroller:moveAndMaybeCompressFile"),Lr=cm(),Fq=require("zlib"),$q=function(e){let t={mode:parseInt("0600",8),compress:!1},r=Object.assign({},t,e);return bt(`_parseOption: moveAndMaybeCompressFile called with option=${JSON.stringify(r)}`),r},Mq=async(e,t,r)=>{if(r=$q(r),e===t){bt("moveAndMaybeCompressFile: source and target are the same, not doing anything");return}if(await Lr.pathExists(e))if(bt(`moveAndMaybeCompressFile: moving file from ${e} to ${t} ${r.compress?"with":"without"} compress`),r.compress)await new Promise((n,o)=>{let i=!1,s=Lr.createWriteStream(t,{mode:r.mode,flags:"wx"}).on("open",()=>{i=!0;let a=Lr.createReadStream(e).on("open",()=>{a.pipe(Fq.createGzip()).pipe(s)}).on("error",u=>{bt(`moveAndMaybeCompressFile: error reading ${e}`,u),s.destroy(u)})}).on("finish",()=>{bt(`moveAndMaybeCompressFile: finished compressing ${t}, deleting ${e}`),Lr.unlink(e).then(n).catch(a=>{bt(`moveAndMaybeCompressFile: error deleting ${e}, truncating instead`,a),Lr.truncate(e).then(n).catch(u=>{bt(`moveAndMaybeCompressFile: error truncating ${e}`,u),o(u)})})}).on("error",a=>{i?(bt(`moveAndMaybeCompressFile: error writing ${t}, deleting`,a),Lr.unlink(t).then(()=>{o(a)}).catch(u=>{bt(`moveAndMaybeCompressFile: error deleting ${t}`,u),o(u)})):(bt(`moveAndMaybeCompressFile: error creating ${t}`,a),o(a))})}).catch(()=>{});else{bt(`moveAndMaybeCompressFile: renaming ${e} to ${t}`);try{await Lr.move(e,t,{overwrite:!0})}catch(n){if(bt(`moveAndMaybeCompressFile: error renaming ${e} to ${t}`,n),n.code!=="ENOENT"){bt("moveAndMaybeCompressFile: trying copy+truncate instead");try{await Lr.copy(e,t,{overwrite:!0}),await Lr.truncate(e)}catch(o){bt("moveAndMaybeCompressFile: error copy+truncate",o)}}}}};CE.exports=Mq});var fc=g((Aoe,OE)=>{var Nt=Ue()("streamroller:RollingFileWriteStream"),io=cm(),oo=require("path"),jq=require("os"),cc=vE(),lc=Ku(),{Writable:qq}=require("stream"),Lq=wE(),Bq=_E(),zq=TE(),Uq=e=>(Nt(`deleteFiles: files to delete: ${e}`),Promise.all(e.map(t=>io.unlink(t).catch(r=>{Nt(`deleteFiles: error when unlinking ${t}, ignoring. Error was ${r}`)})))),lm=class extends qq{constructor(t,r){if(Nt(`constructor: creating RollingFileWriteStream. path=${t}`),typeof t!="string"||t.length===0)throw new Error(`Invalid filename: ${t}`);if(t.endsWith(oo.sep))throw new Error(`Filename is a directory: ${t}`);t.indexOf(`~${oo.sep}`)===0&&(t=t.replace("~",jq.homedir())),super(r),this.options=this._parseOption(r),this.fileObject=oo.parse(t),this.fileObject.dir===""&&(this.fileObject=oo.parse(oo.join(process.cwd(),t))),this.fileFormatter=Lq({file:this.fileObject,alwaysIncludeDate:this.options.alwaysIncludePattern,needsIndex:this.options.maxSize<Number.MAX_SAFE_INTEGER,compress:this.options.compress,keepFileExt:this.options.keepFileExt,fileNameSep:this.options.fileNameSep}),this.fileNameParser=Bq({file:this.fileObject,keepFileExt:this.options.keepFileExt,pattern:this.options.pattern,fileNameSep:this.options.fileNameSep}),this.state={currentSize:0},this.options.pattern&&(this.state.currentDate=lc(this.options.pattern,cc())),this.filename=this.fileFormatter({index:0,date:this.state.currentDate}),["a","a+","as","as+"].includes(this.options.flags)&&this._setExistingSizeAndDate(),Nt(`constructor: create new file ${this.filename}, state=${JSON.stringify(this.state)}`),this._renewWriteStream()}_setExistingSizeAndDate(){try{let t=io.statSync(this.filename);this.state.currentSize=t.size,this.options.pattern&&(this.state.currentDate=lc(this.options.pattern,t.mtime))}catch{return}}_parseOption(t){let r={maxSize:0,numToKeep:Number.MAX_SAFE_INTEGER,encoding:"utf8",mode:parseInt("0600",8),flags:"a",compress:!1,keepFileExt:!1,alwaysIncludePattern:!1},n=Object.assign({},r,t);if(!n.maxSize)delete n.maxSize;else if(n.maxSize<=0)throw new Error(`options.maxSize (${n.maxSize}) should be > 0`);if(n.numBackups||n.numBackups===0){if(n.numBackups<0)throw new Error(`options.numBackups (${n.numBackups}) should be >= 0`);if(n.numBackups>=Number.MAX_SAFE_INTEGER)throw new Error(`options.numBackups (${n.numBackups}) should be < Number.MAX_SAFE_INTEGER`);n.numToKeep=n.numBackups+1}else if(n.numToKeep<=0)throw new Error(`options.numToKeep (${n.numToKeep}) should be > 0`);return Nt(`_parseOption: creating stream with option=${JSON.stringify(n)}`),n}_final(t){this.currentFileStream.end("",this.options.encoding,t)}_write(t,r,n){this._shouldRoll().then(()=>{Nt(`_write: writing chunk. file=${this.currentFileStream.path} state=${JSON.stringify(this.state)} chunk=${t}`),this.currentFileStream.write(t,r,o=>{this.state.currentSize+=t.length,n(o)})})}async _shouldRoll(){(this._dateChanged()||this._tooBig())&&(Nt(`_shouldRoll: rolling because dateChanged? ${this._dateChanged()} or tooBig? ${this._tooBig()}`),await this._roll())}_dateChanged(){return this.state.currentDate&&this.state.currentDate!==lc(this.options.pattern,cc())}_tooBig(){return this.state.currentSize>=this.options.maxSize}_roll(){return Nt("_roll: closing the current stream"),new Promise((t,r)=>{this.currentFileStream.end("",this.options.encoding,()=>{this._moveOldFiles().then(t).catch(r)})})}async _moveOldFiles(){let t=await this._getExistingFiles(),r=this.state.currentDate?t.filter(n=>n.date===this.state.currentDate):t;for(let n=r.length;n>=0;n--){Nt(`_moveOldFiles: i = ${n}`);let o=this.fileFormatter({date:this.state.currentDate,index:n}),i=this.fileFormatter({date:this.state.currentDate,index:n+1}),s={compress:this.options.compress&&n===0,mode:this.options.mode};await zq(o,i,s)}this.state.currentSize=0,this.state.currentDate=this.state.currentDate?lc(this.options.pattern,cc()):null,Nt(`_moveOldFiles: finished rolling files. state=${JSON.stringify(this.state)}`),this._renewWriteStream(),await new Promise((n,o)=>{this.currentFileStream.write("","utf8",()=>{this._clean().then(n).catch(o)})})}async _getExistingFiles(){let t=await io.readdir(this.fileObject.dir).catch(()=>[]);Nt(`_getExistingFiles: files=${t}`);let r=t.map(o=>this.fileNameParser(o)).filter(o=>o),n=o=>(o.timestamp?o.timestamp:cc().getTime())-o.index;return r.sort((o,i)=>n(o)-n(i)),r}_renewWriteStream(){let t=this.fileFormatter({date:this.state.currentDate,index:0}),r=i=>{try{return io.mkdirSync(i,{recursive:!0})}catch(s){if(s.code==="ENOENT")return r(oo.dirname(i)),r(i);if(s.code!=="EEXIST"&&s.code!=="EROFS")throw s;try{if(io.statSync(i).isDirectory())return i;throw s}catch{throw s}}};r(this.fileObject.dir);let n={flags:this.options.flags,encoding:this.options.encoding,mode:this.options.mode},o=function(i,s,a){return i[a]=i[s],delete i[s],i};io.appendFileSync(t,"",o({...n},"flags","flag")),this.currentFileStream=io.createWriteStream(t,n),this.currentFileStream.on("error",i=>{this.emit("error",i)})}async _clean(){let t=await this._getExistingFiles();if(Nt(`_clean: numToKeep = ${this.options.numToKeep}, existingFiles = ${t.length}`),Nt("_clean: existing files are: ",t),this._tooManyFiles(t.length)){let r=t.slice(0,t.length-this.options.numToKeep).map(n=>oo.format({dir:this.fileObject.dir,base:n.filename}));await Uq(r)}}_tooManyFiles(t){return this.options.numToKeep>0&&t>this.options.numToKeep}};OE.exports=lm});var AE=g((Noe,kE)=>{var Wq=fc(),fm=class extends Wq{constructor(t,r,n,o){o||(o={}),r&&(o.maxSize=r),!o.numBackups&&o.numBackups!==0&&(!n&&n!==0&&(n=1),o.numBackups=n),super(t,o),this.backups=o.numBackups,this.size=this.options.maxSize}get theStream(){return this.currentFileStream}};kE.exports=fm});var RE=g((Roe,NE)=>{var Hq=fc(),pm=class extends Hq{constructor(t,r,n){r&&typeof r=="object"&&(n=r,r=null),n||(n={}),r||(r="yyyy-MM-dd"),n.pattern=r,!n.numBackups&&n.numBackups!==0?(!n.daysToKeep&&n.daysToKeep!==0?n.daysToKeep=1:process.emitWarning("options.daysToKeep is deprecated due to the confusion it causes when used together with file size rolling. Please use options.numBackups instead.","DeprecationWarning","streamroller-DEP0001"),n.numBackups=n.daysToKeep):n.daysToKeep=n.numBackups,super(t,n),this.mode=this.options.mode}get theStream(){return this.currentFileStream}};NE.exports=pm});var dm=g((Doe,DE)=>{DE.exports={RollingFileWriteStream:fc(),RollingFileStream:AE(),DateRollingFileStream:RE()}});var jE=g((Poe,ME)=>{var PE=Ue()("log4js:file"),mm=require("path"),Kq=dm(),$E=require("os"),Vq=$E.EOL,pc=!1,dc=new Set;function FE(){dc.forEach(e=>{e.sighupHandler()})}function Gq(e,t,r,n,o,i){if(typeof e!="string"||e.length===0)throw new Error(`Invalid filename: ${e}`);if(e.endsWith(mm.sep))throw new Error(`Filename is a directory: ${e}`);e=e.replace(new RegExp(`^~(?=${mm.sep}.+)`),$E.homedir()),e=mm.normalize(e),n=!n&&n!==0?5:n,PE("Creating file appender (",e,", ",r,", ",n,", ",o,", ",i,")");function s(l,c,f,p){let d=new Kq.RollingFileStream(l,c,f,p);return d.on("error",h=>{console.error("log4js.fileAppender - Writing to file %s, error happened ",l,h)}),d.on("drain",()=>{process.emit("log4js:pause",!1)}),d}let a=s(e,r,n,o),u=function(l){if(a.writable){if(o.removeColor===!0){let c=/\x1b[[0-9;]*m/g;l.data=l.data.map(f=>typeof f=="string"?f.replace(c,""):f)}a.write(t(l,i)+Vq,"utf8")||process.emit("log4js:pause",!0)}};return u.reopen=function(){a.end(()=>{a=s(e,r,n,o)})},u.sighupHandler=function(){PE("SIGHUP handler called."),u.reopen()},u.shutdown=function(l){dc.delete(u),dc.size===0&&pc&&(process.removeListener("SIGHUP",FE),pc=!1),a.end("","utf-8",l)},dc.add(u),pc||(process.on("SIGHUP",FE),pc=!0),u}function Jq(e,t){let r=t.basicLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),e.mode=e.mode||384,Gq(e.filename,r,e.maxLogSize,e.backups,e,e.timezoneOffset)}ME.exports.configure=Jq});var LE=g((Foe,qE)=>{var Zq=dm(),Yq=require("os"),Xq=Yq.EOL;function Qq(e,t,r){let n=new Zq.DateRollingFileStream(e,t,r);return n.on("error",o=>{console.error("log4js.dateFileAppender - Writing to file %s, error happened ",e,o)}),n.on("drain",()=>{process.emit("log4js:pause",!1)}),n}function eL(e,t,r,n,o){n.maxSize=n.maxLogSize;let i=Qq(e,t,n),s=function(a){i.writable&&(i.write(r(a,o)+Xq,"utf8")||process.emit("log4js:pause",!0))};return s.shutdown=function(a){i.end("","utf-8",a)},s}function tL(e,t){let r=t.basicLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),e.alwaysIncludePattern||(e.alwaysIncludePattern=!1),e.mode=e.mode||384,eL(e.filename,e.pattern,r,e,e.timezoneOffset)}qE.exports.configure=tL});var WE=g(($oe,UE)=>{var Br=Ue()("log4js:fileSync"),Er=require("path"),wr=require("fs"),BE=require("os"),rL=BE.EOL;function zE(e,t){let r=n=>{try{return wr.mkdirSync(n,{recursive:!0})}catch(o){if(o.code==="ENOENT")return r(Er.dirname(n)),r(n);if(o.code!=="EEXIST"&&o.code!=="EROFS")throw o;try{if(wr.statSync(n).isDirectory())return n;throw o}catch{throw o}}};r(Er.dirname(e)),wr.appendFileSync(e,"",{mode:t.mode,flag:t.flags})}var hm=class{constructor(t,r,n,o){if(Br("In RollingFileStream"),r<0)throw new Error(`maxLogSize (${r}) should be > 0`);this.filename=t,this.size=r,this.backups=n,this.options=o,this.currentSize=0;function i(s){let a=0;try{a=wr.statSync(s).size}catch{zE(s,o)}return a}this.currentSize=i(this.filename)}shouldRoll(){return Br("should roll with current size %d, and max size %d",this.currentSize,this.size),this.currentSize>=this.size}roll(t){let r=this,n=new RegExp(`^${Er.basename(t)}`);function o(l){return n.test(l)}function i(l){return parseInt(l.slice(`${Er.basename(t)}.`.length),10)||0}function s(l,c){return i(l)-i(c)}function a(l){let c=i(l);if(Br(`Index of ${l} is ${c}`),r.backups===0)wr.truncateSync(t,0);else if(c<r.backups){try{wr.unlinkSync(`${t}.${c+1}`)}catch{}Br(`Renaming ${l} -> ${t}.${c+1}`),wr.renameSync(Er.join(Er.dirname(t),l),`${t}.${c+1}`)}}function u(){Br("Renaming the old files"),wr.readdirSync(Er.dirname(t)).filter(o).sort(s).reverse().forEach(a)}Br("Rolling, rolling, rolling"),u()}write(t,r){let n=this;function o(){Br("writing the chunk to the file"),n.currentSize+=t.length,wr.appendFileSync(n.filename,t)}Br("in write"),this.shouldRoll()&&(this.currentSize=0,this.roll(this.filename)),o()}};function nL(e,t,r,n,o,i){if(typeof e!="string"||e.length===0)throw new Error(`Invalid filename: ${e}`);if(e.endsWith(Er.sep))throw new Error(`Filename is a directory: ${e}`);e=e.replace(new RegExp(`^~(?=${Er.sep}.+)`),BE.homedir()),e=Er.normalize(e),n=!n&&n!==0?5:n,Br("Creating fileSync appender (",e,", ",r,", ",n,", ",o,", ",i,")");function s(u,l,c){let f;return l?f=new hm(u,l,c,o):f=(p=>(zE(p,o),{write(d){wr.appendFileSync(p,d)}}))(u),f}let a=s(e,r,n);return u=>{a.write(t(u,i)+rL)}}function oL(e,t){let r=t.basicLayout;e.layout&&(r=t.layout(e.layout.type,e.layout));let n={flags:e.flags||"a",encoding:e.encoding||"utf8",mode:e.mode||384};return nL(e.filename,r,e.maxLogSize,e.backups,n,e.timezoneOffset)}UE.exports.configure=oL});var KE=g((Moe,HE)=>{var Sr=Ue()("log4js:tcp"),iL=require("net");function sL(e,t){let r=!1,n=[],o,i=3,s="__LOG4JS__";function a(f){Sr("Writing log event to socket"),r=o.write(`${t(f)}${s}`,"utf8")}function u(){let f;for(Sr("emptying buffer");f=n.shift();)a(f)}function l(){Sr(`appender creating socket to ${e.host||"localhost"}:${e.port||5e3}`),s=`${e.endMsg||"__LOG4JS__"}`,o=iL.createConnection(e.port||5e3,e.host||"localhost"),o.on("connect",()=>{Sr("socket connected"),u(),r=!0}),o.on("drain",()=>{Sr("drain event received, emptying buffer"),r=!0,u()}),o.on("timeout",o.end.bind(o)),o.on("error",f=>{Sr("connection error",f),r=!1,u()}),o.on("close",l)}l();function c(f){r?a(f):(Sr("buffering log event because it cannot write at the moment"),n.push(f))}return c.shutdown=function(f){Sr("shutdown called"),n.length&&i?(Sr("buffer has items, waiting 100ms to empty"),i-=1,setTimeout(()=>{c.shutdown(f)},100)):(o.removeAllListeners("close"),o.end(f))},c}function aL(e,t){Sr(`configure with config = ${e}`);let r=function(n){return n.serialise()};return e.layout&&(r=t.layout(e.layout.type,e.layout)),sL(e,r)}HE.exports.configure=aL});var bm=g((joe,ym)=>{var gm=require("path"),yn=Ue()("log4js:appenders"),Vt=Yn(),VE=Zu(),uL=Qn(),cL=Fd(),lL=W0(),ar=new Map;ar.set("console",K0());ar.set("stdout",G0());ar.set("stderr",Z0());ar.set("logLevelFilter",X0());ar.set("categoryFilter",tx());ar.set("noLogFilter",ox());ar.set("file",jE());ar.set("dateFile",LE());ar.set("fileSync",WE());ar.set("tcp",KE());var Ds=new Map,mc=(e,t)=>{let r;try{let n=`${e}.cjs`;r=require.resolve(n),yn("Loading module from ",n)}catch{r=e,yn("Loading module from ",e)}try{return require(r)}catch(n){Vt.throwExceptionIf(t,n.code!=="MODULE_NOT_FOUND",`appender "${e}" could not be loaded (error was: ${n})`);return}},fL=(e,t)=>ar.get(e)||mc(`./${e}`,t)||mc(e,t)||require.main&&require.main.filename&&mc(gm.join(gm.dirname(require.main.filename),e),t)||mc(gm.join(process.cwd(),e),t),hc=new Set,GE=(e,t)=>{if(Ds.has(e))return Ds.get(e);if(!t.appenders[e])return!1;if(hc.has(e))throw new Error(`Dependency loop detected for appender ${e}.`);hc.add(e),yn(`Creating appender ${e}`);let r=pL(e,t);return hc.delete(e),Ds.set(e,r),r},pL=(e,t)=>{let r=t.appenders[e],n=r.type.configure?r.type:fL(r.type,t);return Vt.throwExceptionIf(t,Vt.not(n),`appender "${e}" is not valid (type "${r.type}" could not be found)`),n.appender&&(process.emitWarning(`Appender ${r.type} exports an appender function.`,"DeprecationWarning","log4js-node-DEP0001"),yn("[log4js-node-DEP0001]",`DEPRECATION: Appender ${r.type} exports an appender function.`)),n.shutdown&&(process.emitWarning(`Appender ${r.type} exports a shutdown function.`,"DeprecationWarning","log4js-node-DEP0002"),yn("[log4js-node-DEP0002]",`DEPRECATION: Appender ${r.type} exports a shutdown function.`)),yn(`${e}: clustering.isMaster ? ${VE.isMaster()}`),yn(`${e}: appenderModule is ${require("util").inspect(n)}`),VE.onlyOnMaster(()=>(yn(`calling appenderModule.configure for ${e} / ${r.type}`),n.configure(lL.modifyConfig(r),cL,o=>GE(o,t),uL)),()=>{})},JE=e=>{if(Ds.clear(),hc.clear(),!e)return;let t=[];Object.values(e.categories).forEach(r=>{t.push(...r.appenders)}),Object.keys(e.appenders).forEach(r=>{(t.includes(r)||e.appenders[r].type==="tcp-server"||e.appenders[r].type==="multiprocess")&&GE(r,e)})},ZE=()=>{JE()};ZE();Vt.addListener(e=>{Vt.throwExceptionIf(e,Vt.not(Vt.anObject(e.appenders)),'must have a property "appenders" of type object.');let t=Object.keys(e.appenders);Vt.throwExceptionIf(e,Vt.not(t.length),"must define at least one appender."),t.forEach(r=>{Vt.throwExceptionIf(e,Vt.not(e.appenders[r].type),`appender "${r}" is not valid (must be an object with property "type")`)})});Vt.addListener(JE);ym.exports=Ds;ym.exports.init=ZE});var wm=g((qoe,gc)=>{var Ps=Ue()("log4js:categories"),Ae=Yn(),vm=Qn(),YE=bm(),bn=new Map;function XE(e,t,r){if(t.inherit===!1)return;let n=r.lastIndexOf(".");if(n<0)return;let o=r.slice(0,n),i=e.categories[o];i||(i={inherit:!0,appenders:[]}),XE(e,i,o),!e.categories[o]&&i.appenders&&i.appenders.length&&i.level&&(e.categories[o]=i),t.appenders=t.appenders||[],t.level=t.level||i.level,i.appenders.forEach(s=>{t.appenders.includes(s)||t.appenders.push(s)}),t.parent=i}function dL(e){if(!e.categories)return;Object.keys(e.categories).forEach(r=>{let n=e.categories[r];XE(e,n,r)})}Ae.addPreProcessingListener(e=>dL(e));Ae.addListener(e=>{Ae.throwExceptionIf(e,Ae.not(Ae.anObject(e.categories)),'must have a property "categories" of type object.');let t=Object.keys(e.categories);Ae.throwExceptionIf(e,Ae.not(t.length),"must define at least one category."),t.forEach(r=>{let n=e.categories[r];Ae.throwExceptionIf(e,[Ae.not(n.appenders),Ae.not(n.level)],`category "${r}" is not valid (must be an object with properties "appenders" and "level")`),Ae.throwExceptionIf(e,Ae.not(Array.isArray(n.appenders)),`category "${r}" is not valid (appenders must be an array of appender names)`),Ae.throwExceptionIf(e,Ae.not(n.appenders.length),`category "${r}" is not valid (appenders must contain at least one appender name)`),Object.prototype.hasOwnProperty.call(n,"enableCallStack")&&Ae.throwExceptionIf(e,typeof n.enableCallStack!="boolean",`category "${r}" is not valid (enableCallStack must be boolean type)`),n.appenders.forEach(o=>{Ae.throwExceptionIf(e,Ae.not(YE.get(o)),`category "${r}" is not valid (appender "${o}" is not defined)`)}),Ae.throwExceptionIf(e,Ae.not(vm.getLevel(n.level)),`category "${r}" is not valid (level "${n.level}" not recognised; valid levels are ${vm.levels.join(", ")})`)}),Ae.throwExceptionIf(e,Ae.not(e.categories.default),'must define a "default" category.')});var xm=e=>{if(bn.clear(),!e)return;Object.keys(e.categories).forEach(r=>{let n=e.categories[r],o=[];n.appenders.forEach(i=>{o.push(YE.get(i)),Ps(`Creating category ${r}`),bn.set(r,{appenders:o,level:vm.getLevel(n.level),enableCallStack:n.enableCallStack||!1})})})},QE=()=>{xm()};QE();Ae.addListener(xm);var ii=e=>{if(Ps(`configForCategory: searching for config for ${e}`),bn.has(e))return Ps(`configForCategory: ${e} exists in config, returning it`),bn.get(e);let t;return e.indexOf(".")>0?(Ps(`configForCategory: ${e} has hierarchy, cloning from parents`),t={...ii(e.slice(0,e.lastIndexOf(".")))}):(bn.has("default")||xm({categories:{default:{appenders:["out"],level:"OFF"}}}),Ps("configForCategory: cloning default category"),t={...bn.get("default")}),bn.set(e,t),t},mL=e=>ii(e).appenders,hL=e=>ii(e).level,gL=(e,t)=>{ii(e).level=t},yL=e=>ii(e).enableCallStack===!0,bL=(e,t)=>{ii(e).enableCallStack=t};gc.exports=bn;gc.exports=Object.assign(gc.exports,{appendersForCategory:mL,getLevelForCategory:hL,setLevelForCategory:gL,getEnableCallStackForCategory:yL,setEnableCallStackForCategory:bL,init:QE})});var oS=g((Loe,nS)=>{var eS=Ue()("log4js:logger"),vL=$d(),Ir=Qn(),xL=Zu(),yc=wm(),tS=Yn(),wL=/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/;function EL(e,t=4){try{let r=e.stack.split(`
`).slice(t),n=wL.exec(r[0]);if(n&&n.length===6)return{functionName:n[1],fileName:n[2],lineNumber:parseInt(n[3],10),columnNumber:parseInt(n[4],10),callStack:r.join(`
`)};console.error("log4js.logger - defaultParseCallStack error")}catch(r){console.error("log4js.logger - defaultParseCallStack error",r)}return null}var Fs=class{constructor(t){if(!t)throw new Error("No category provided.");this.category=t,this.context={},this.parseCallStack=EL,eS(`Logger created (${this.category}, ${this.level})`)}get level(){return Ir.getLevel(yc.getLevelForCategory(this.category),Ir.OFF)}set level(t){yc.setLevelForCategory(this.category,Ir.getLevel(t,this.level))}get useCallStack(){return yc.getEnableCallStackForCategory(this.category)}set useCallStack(t){yc.setEnableCallStackForCategory(this.category,t===!0)}log(t,...r){let n=Ir.getLevel(t);n?this.isLevelEnabled(n)&&this._log(n,r):tS.validIdentifier(t)&&r.length>0?(this.log(Ir.WARN,"log4js:logger.log: valid log-level not found as first parameter given:",t),this.log(Ir.INFO,`[${t}]`,...r)):this.log(Ir.INFO,t,...r)}isLevelEnabled(t){return this.level.isLessThanOrEqualTo(t)}_log(t,r){eS(`sending log data (${t}) to appenders`);let n=new vL(this.category,t,r,this.context,this.useCallStack&&this.parseCallStack(new Error));xL.send(n)}addContext(t,r){this.context[t]=r}removeContext(t){delete this.context[t]}clearContext(){this.context={}}setParseCallStackFunction(t){this.parseCallStack=t}};function rS(e){let t=Ir.getLevel(e),n=t.toString().toLowerCase().replace(/_([a-z])/g,i=>i[1].toUpperCase()),o=n[0].toUpperCase()+n.slice(1);Fs.prototype[`is${o}Enabled`]=function(){return this.isLevelEnabled(t)},Fs.prototype[n]=function(...i){this.log(t,...i)}}Ir.levels.forEach(rS);tS.addListener(()=>{Ir.levels.forEach(rS)});nS.exports=Fs});var aS=g((Boe,sS)=>{var si=Qn(),SL=':remote-addr - - ":method :url HTTP/:http-version" :status :content-length ":referrer" ":user-agent"';function IL(e){return e.originalUrl||e.url}function _L(e,t,r){let n=i=>{let s=i.concat();for(let a=0;a<s.length;++a)for(let u=a+1;u<s.length;++u)s[a].token==s[u].token&&s.splice(u--,1);return s},o=[];return o.push({token:":url",replacement:IL(e)}),o.push({token:":protocol",replacement:e.protocol}),o.push({token:":hostname",replacement:e.hostname}),o.push({token:":method",replacement:e.method}),o.push({token:":status",replacement:t.__statusCode||t.statusCode}),o.push({token:":response-time",replacement:t.responseTime}),o.push({token:":date",replacement:new Date().toUTCString()}),o.push({token:":referrer",replacement:e.headers.referer||e.headers.referrer||""}),o.push({token:":http-version",replacement:`${e.httpVersionMajor}.${e.httpVersionMinor}`}),o.push({token:":remote-addr",replacement:e.headers["x-forwarded-for"]||e.ip||e._remoteAddress||e.socket&&(e.socket.remoteAddress||e.socket.socket&&e.socket.socket.remoteAddress)}),o.push({token:":user-agent",replacement:e.headers["user-agent"]}),o.push({token:":content-length",replacement:t.getHeader("content-length")||t.__headers&&t.__headers["Content-Length"]||"-"}),o.push({token:/:req\[([^\]]+)]/g,replacement(i,s){return e.headers[s.toLowerCase()]}}),o.push({token:/:res\[([^\]]+)]/g,replacement(i,s){return t.getHeader(s.toLowerCase())||t.__headers&&t.__headers[s]}}),n(r.concat(o))}function iS(e,t){for(let r=0;r<t.length;r++)e=e.replace(t[r].token,t[r].replacement);return e}function CL(e){let t=null;if(e instanceof RegExp&&(t=e),typeof e=="string"&&(t=new RegExp(e)),Array.isArray(e)){let r=e.map(n=>n.source?n.source:n);t=new RegExp(r.join("|"))}return t}function TL(e,t,r){let n=t;if(r){let o=r.find(i=>{let s=!1;return i.from&&i.to?s=e>=i.from&&e<=i.to:s=i.codes.indexOf(e)!==-1,s});o&&(n=si.getLevel(o.level,n))}return n}sS.exports=function(t,r){typeof r=="string"||typeof r=="function"?r={format:r}:r=r||{};let n=t,o=si.getLevel(r.level,si.INFO),i=r.format||SL;return(s,a,u)=>{if(s._logging!==void 0)return u();if(typeof r.nolog!="function"){let l=CL(r.nolog);if(l&&l.test(s.originalUrl))return u()}if(n.isLevelEnabled(o)||r.level==="auto"){let l=new Date,{writeHead:c}=a;s._logging=!0,a.writeHead=(d,h)=>{a.writeHead=c,a.writeHead(d,h),a.__statusCode=d,a.__headers=h||{}};let f=!1,p=()=>{if(f)return;if(f=!0,typeof r.nolog=="function"&&r.nolog(s,a)===!0){s._logging=!1;return}a.responseTime=new Date-l,a.statusCode&&r.level==="auto"&&(o=si.INFO,a.statusCode>=300&&(o=si.WARN),a.statusCode>=400&&(o=si.ERROR)),o=TL(a.statusCode,o,r.statusRules);let d=_L(s,a,r.tokens||[]);if(r.context&&n.addContext("res",a),typeof i=="function"){let h=i(s,a,b=>iS(b,d));h&&n.log(o,h)}else n.log(o,iS(i,d));r.context&&n.removeContext("res")};a.on("end",p),a.on("finish",p),a.on("error",p),a.on("close",p)}return u()}}});var pS=g((zoe,fS)=>{var uS=Ue()("log4js:recording"),bc=[];function OL(){return function(e){uS(`received logEvent, number of events now ${bc.length+1}`),uS("log event was ",e),bc.push(e)}}function cS(){return bc.slice()}function lS(){bc.length=0}fS.exports={configure:OL,replay:cS,playback:cS,reset:lS,erase:lS}});var vS=g((Uoe,bS)=>{var vn=Ue()("log4js:main"),kL=require("fs"),AL=i0()({proto:!0}),NL=Yn(),RL=Fd(),DL=Qn(),dS=bm(),mS=wm(),PL=oS(),FL=Zu(),$L=aS(),ML=pS(),$s=!1;function jL(e){if(!$s)return;vn("Received log event ",e),mS.appendersForCategory(e.categoryName).forEach(r=>{r(e)})}function qL(e){vn(`Loading configuration from ${e}`);try{return JSON.parse(kL.readFileSync(e,"utf8"))}catch(t){throw new Error(`Problem reading config from file "${e}". Error was ${t.message}`,t)}}function hS(e){$s&&gS();let t=e;return typeof t=="string"&&(t=qL(e)),vn(`Configuration is ${t}`),NL.configure(AL(t)),FL.onMessage(jL),$s=!0,yS}function LL(){return ML}function gS(e){vn("Shutdown called. Disabling all log writing."),$s=!1;let t=Array.from(dS.values());dS.init(),mS.init();let r=t.reduceRight((s,a)=>a.shutdown?s+1:s,0);if(r===0)return vn("No appenders with shutdown functions found."),e!==void 0&&e();let n=0,o;vn(`Found ${r} appenders with shutdown functions.`);function i(s){o=o||s,n+=1,vn(`Appender shutdowns complete: ${n} / ${r}`),n>=r&&(vn("All shutdown functions completed."),e&&e(o))}return t.filter(s=>s.shutdown).forEach(s=>s.shutdown(i)),null}function BL(e){return $s||hS(process.env.LOG4JS_CONFIG||{appenders:{out:{type:"stdout"}},categories:{default:{appenders:["out"],level:"OFF"}}}),new PL(e||"default")}var yS={getLogger:BL,configure:hS,shutdown:gS,connectLogger:$L,levels:DL,addLayout:RL.addLayout,recording:LL};bS.exports=yS});var xn=g(vc=>{"use strict";Object.defineProperty(vc,"__esModule",{value:!0});function xS(e,t){if(t)return e;throw new Error("Unhandled discriminated union member: "+JSON.stringify(e))}vc.assertNever=xS;vc.default=xS});var SS=g((Hoe,ES)=>{"use strict";var zL=["h","min","s","ms","\u03BCs","ns"],UL=["hour","minute","second","millisecond","microsecond","nanosecond"],wS=[3600,60,1,1e6,1e3,1];ES.exports=function(e,t){var r,n,o,i,s,a,u,l,c,f;if(r=!1,n=!1,t&&(r=t.verbose||!1,n=t.precise||!1),!Array.isArray(e)||e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")return"";for(e[1]<0&&(f=e[0]+e[1]/1e9,e[0]=parseInt(f),e[1]=parseFloat((f%1).toPrecision(9))*1e9),c="",o=0;o<6&&(i=o<3?0:1,s=e[i],o!==3&&o!==0&&(s=s%wS[o-1]),o===2&&(s+=e[1]/1e9),a=s/wS[o],!(a>=1&&(r&&(a=Math.floor(a)),n?l=a.toString():(u=a>=10?0:2,l=a.toFixed(u)),l.indexOf(".")>-1&&l[l.length-1]==="0"&&(l=l.replace(/\.?0+$/,"")),c&&(c+=" "),c+=l,r?(c+=" "+UL[o],l!=="1"&&(c+="s")):c+=" "+zL[o],!r)));o++);return c}});var _S=g((Koe,IS)=>{"use strict";IS.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`)});var AS=g((Voe,kS)=>{"use strict";var OS="%[a-f0-9]{2}",CS=new RegExp("("+OS+")|([^%]+?)","gi"),TS=new RegExp("("+OS+")+","gi");function Em(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],Em(r),Em(n))}function WL(e){try{return decodeURIComponent(e)}catch{for(var t=e.match(CS)||[],r=1;r<t.length;r++)e=Em(t,r).join(""),t=e.match(CS)||[];return e}}function HL(e){for(var t={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=TS.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var n=WL(r[0]);n!==r[0]&&(t[r[0]]=n)}r=TS.exec(e)}t["%C2"]="\uFFFD";for(var o=Object.keys(t),i=0;i<o.length;i++){var s=o[i];e=e.replace(new RegExp(s,"g"),t[s])}return e}kS.exports=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return HL(e)}}});var RS=g((Goe,NS)=>{"use strict";NS.exports=(e,t)=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[e];let r=e.indexOf(t);return r===-1?[e]:[e.slice(0,r),e.slice(r+t.length)]}});var PS=g((Joe,DS)=>{"use strict";DS.exports=function(e,t){for(var r={},n=Object.keys(e),o=Array.isArray(t),i=0;i<n.length;i++){var s=n[i],a=e[s];(o?t.indexOf(s)!==-1:t(s,a,e))&&(r[s]=a)}return r}});var Im=g(vt=>{"use strict";var KL=_S(),VL=AS(),$S=RS(),GL=PS(),JL=e=>e==null,Sm=Symbol("encodeFragmentIdentifier");function ZL(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{let o=r.length;return n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?r:n===null?[...r,[Re(t,e),"[",o,"]"].join("")]:[...r,[Re(t,e),"[",Re(o,e),"]=",Re(n,e)].join("")]};case"bracket":return t=>(r,n)=>n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?r:n===null?[...r,[Re(t,e),"[]"].join("")]:[...r,[Re(t,e),"[]=",Re(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?r:n===null?[...r,[Re(t,e),":list="].join("")]:[...r,[Re(t,e),":list=",Re(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{let t=e.arrayFormat==="bracket-separator"?"[]=":"=";return r=>(n,o)=>o===void 0||e.skipNull&&o===null||e.skipEmptyString&&o===""?n:(o=o===null?"":o,n.length===0?[[Re(r,e),t,Re(o,e)].join("")]:[[n,Re(o,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?r:n===null?[...r,Re(t,e)]:[...r,[Re(t,e),"=",Re(n,e)].join("")]}}function YL(e){let t;switch(e.arrayFormat){case"index":return(r,n,o)=>{if(t=/\[(\d*)\]$/.exec(r),r=r.replace(/\[\d*\]$/,""),!t){o[r]=n;return}o[r]===void 0&&(o[r]={}),o[r][t[1]]=n};case"bracket":return(r,n,o)=>{if(t=/(\[\])$/.exec(r),r=r.replace(/\[\]$/,""),!t){o[r]=n;return}if(o[r]===void 0){o[r]=[n];return}o[r]=[].concat(o[r],n)};case"colon-list-separator":return(r,n,o)=>{if(t=/(:list)$/.exec(r),r=r.replace(/:list$/,""),!t){o[r]=n;return}if(o[r]===void 0){o[r]=[n];return}o[r]=[].concat(o[r],n)};case"comma":case"separator":return(r,n,o)=>{let i=typeof n=="string"&&n.includes(e.arrayFormatSeparator),s=typeof n=="string"&&!i&&zr(n,e).includes(e.arrayFormatSeparator);n=s?zr(n,e):n;let a=i||s?n.split(e.arrayFormatSeparator).map(u=>zr(u,e)):n===null?n:zr(n,e);o[r]=a};case"bracket-separator":return(r,n,o)=>{let i=/(\[\])$/.test(r);if(r=r.replace(/\[\]$/,""),!i){o[r]=n&&zr(n,e);return}let s=n===null?[]:n.split(e.arrayFormatSeparator).map(a=>zr(a,e));if(o[r]===void 0){o[r]=s;return}o[r]=[].concat(o[r],s)};default:return(r,n,o)=>{if(o[r]===void 0){o[r]=n;return}o[r]=[].concat(o[r],n)}}}function MS(e){if(typeof e!="string"||e.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function Re(e,t){return t.encode?t.strict?KL(e):encodeURIComponent(e):e}function zr(e,t){return t.decode?VL(e):e}function jS(e){return Array.isArray(e)?e.sort():typeof e=="object"?jS(Object.keys(e)).sort((t,r)=>Number(t)-Number(r)).map(t=>e[t]):e}function qS(e){let t=e.indexOf("#");return t!==-1&&(e=e.slice(0,t)),e}function XL(e){let t="",r=e.indexOf("#");return r!==-1&&(t=e.slice(r)),t}function LS(e){e=qS(e);let t=e.indexOf("?");return t===-1?"":e.slice(t+1)}function FS(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?e=Number(e):t.parseBooleans&&e!==null&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&(e=e.toLowerCase()==="true"),e}function BS(e,t){t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t),MS(t.arrayFormatSeparator);let r=YL(t),n=Object.create(null);if(typeof e!="string"||(e=e.trim().replace(/^[?#&]/,""),!e))return n;for(let o of e.split("&")){if(o==="")continue;let[i,s]=$S(t.decode?o.replace(/\+/g," "):o,"=");s=s===void 0?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?s:zr(s,t),r(zr(i,t),s,n)}for(let o of Object.keys(n)){let i=n[o];if(typeof i=="object"&&i!==null)for(let s of Object.keys(i))i[s]=FS(i[s],t);else n[o]=FS(i,t)}return t.sort===!1?n:(t.sort===!0?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce((o,i)=>{let s=n[i];return s&&typeof s=="object"&&!Array.isArray(s)?o[i]=jS(s):o[i]=s,o},Object.create(null))}vt.extract=LS;vt.parse=BS;vt.stringify=(e,t)=>{if(!e)return"";t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t),MS(t.arrayFormatSeparator);let r=s=>t.skipNull&&JL(e[s])||t.skipEmptyString&&e[s]==="",n=ZL(t),o={};for(let s of Object.keys(e))r(s)||(o[s]=e[s]);let i=Object.keys(o);return t.sort!==!1&&i.sort(t.sort),i.map(s=>{let a=e[s];return a===void 0?"":a===null?Re(s,t):Array.isArray(a)?a.length===0&&t.arrayFormat==="bracket-separator"?Re(s,t)+"[]":a.reduce(n(s),[]).join("&"):Re(s,t)+"="+Re(a,t)}).filter(s=>s.length>0).join("&")};vt.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);let[r,n]=$S(e,"#");return Object.assign({url:r.split("?")[0]||"",query:BS(LS(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:zr(n,t)}:{})};vt.stringifyUrl=(e,t)=>{t=Object.assign({encode:!0,strict:!0,[Sm]:!0},t);let r=qS(e.url).split("?")[0]||"",n=vt.extract(e.url),o=vt.parse(n,{sort:!1}),i=Object.assign(o,e.query),s=vt.stringify(i,t);s&&(s=`?${s}`);let a=XL(e.url);return e.fragmentIdentifier&&(a=`#${t[Sm]?Re(e.fragmentIdentifier,t):e.fragmentIdentifier}`),`${r}${s}${a}`};vt.pick=(e,t,r)=>{r=Object.assign({parseFragmentIdentifier:!0,[Sm]:!1},r);let{url:n,query:o,fragmentIdentifier:i}=vt.parseUrl(e,r);return vt.stringifyUrl({url:n,query:GL(o,t),fragmentIdentifier:i},r)};vt.exclude=(e,t,r)=>{let n=Array.isArray(t)?o=>!t.includes(o):(o,i)=>!t(o,i);return vt.pick(e,n,r)}});function Gr(e,t){for(var r in t)e[r]=t[r];return e}function p_(e){var t=e.parentNode;t&&t.removeChild(e)}function H(e,t,r){var n,o,i,s={};for(i in t)i=="key"?n=t[i]:i=="ref"?o=t[i]:s[i]=t[i];if(arguments.length>2&&(s.children=arguments.length>3?sa.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(i in e.defaultProps)s[i]===void 0&&(s[i]=e.defaultProps[i]);return oa(e,s,n,o,null)}function oa(e,t,r,n,o){var i={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:o??++c_};return o==null&&L.vnode!=null&&L.vnode(i),i}function cl(){return{current:null}}function $(e){return e.children}function Dt(e,t){this.props=e,this.context=t}function ia(e,t){if(t==null)return e.__?ia(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?ia(e):null}function d_(e){var t,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((r=e.__k[t])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return d_(e)}}function Sh(e){(!e.__d&&(e.__d=!0)&&na.push(e)&&!al.__r++||i_!==L.debounceRendering)&&((i_=L.debounceRendering)||setTimeout)(al)}function al(){for(var e;al.__r=na.length;)e=na.sort(function(t,r){return t.__v.__b-r.__v.__b}),na=[],e.some(function(t){var r,n,o,i,s,a;t.__d&&(s=(i=(r=t).__v).__e,(a=r.__P)&&(n=[],(o=Gr({},i)).__v=i.__v+1,Ih(a,i,o,r.__n,a.ownerSVGElement!==void 0,i.__h!=null?[s]:null,n,s??ia(i),i.__h),y_(n,i),i.__e!=s&&d_(i)))})}function m_(e,t,r,n,o,i,s,a,u,l){var c,f,p,d,h,b,y,v=n&&n.__k||f_,w=v.length;for(r.__k=[],c=0;c<t.length;c++)if((d=r.__k[c]=(d=t[c])==null||typeof d=="boolean"?null:typeof d=="string"||typeof d=="number"||typeof d=="bigint"?oa(null,d,null,null,d):Array.isArray(d)?oa($,{children:d},null,null,null):d.__b>0?oa(d.type,d.props,d.key,d.ref?d.ref:null,d.__v):d)!=null){if(d.__=r,d.__b=r.__b+1,(p=v[c])===null||p&&d.key==p.key&&d.type===p.type)v[c]=void 0;else for(f=0;f<w;f++){if((p=v[f])&&d.key==p.key&&d.type===p.type){v[f]=void 0;break}p=null}Ih(e,d,p=p||sl,o,i,s,a,u,l),h=d.__e,(f=d.ref)&&p.ref!=f&&(y||(y=[]),p.ref&&y.push(p.ref,null,d),y.push(f,d.__c||h,d)),h!=null?(b==null&&(b=h),typeof d.type=="function"&&d.__k===p.__k?d.__d=u=h_(d,u,e):u=g_(e,d,p,v,h,u),typeof r.type=="function"&&(r.__d=u)):u&&p.__e==u&&u.parentNode!=e&&(u=ia(p))}for(r.__e=b,c=w;c--;)v[c]!=null&&v_(v[c],v[c]);if(y)for(c=0;c<y.length;c++)b_(y[c],y[++c],y[++c])}function h_(e,t,r){for(var n,o=e.__k,i=0;o&&i<o.length;i++)(n=o[i])&&(n.__=e,t=typeof n.type=="function"?h_(n,t,r):g_(r,n,n,o,n.__e,t));return t}function Ar(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(r){Ar(r,t)}):t.push(e)),t}function g_(e,t,r,n,o,i){var s,a,u;if(t.__d!==void 0)s=t.__d,t.__d=void 0;else if(r==null||o!=i||o.parentNode==null)e:if(i==null||i.parentNode!==e)e.appendChild(o),s=null;else{for(a=i,u=0;(a=a.nextSibling)&&u<n.length;u+=1)if(a==o)break e;e.insertBefore(o,i),s=i}return s!==void 0?s:o.nextSibling}function Az(e,t,r,n,o){var i;for(i in r)i==="children"||i==="key"||i in t||ul(e,i,null,r[i],n);for(i in t)o&&typeof t[i]!="function"||i==="children"||i==="key"||i==="value"||i==="checked"||r[i]===t[i]||ul(e,i,t[i],r[i],n)}function s_(e,t,r){t[0]==="-"?e.setProperty(t,r):e[t]=r==null?"":typeof r!="number"||kz.test(t)?r:r+"px"}function ul(e,t,r,n,o){var i;e:if(t==="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||s_(e.style,t,"");if(r)for(t in r)n&&r[t]===n[t]||s_(e.style,t,r[t])}else if(t[0]==="o"&&t[1]==="n")i=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=r,r?n||e.addEventListener(t,i?u_:a_,i):e.removeEventListener(t,i?u_:a_,i);else if(t!=="dangerouslySetInnerHTML"){if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&t.indexOf("-")==-1?e.removeAttribute(t):e.setAttribute(t,r))}}function a_(e){this.l[e.type+!1](L.event?L.event(e):e)}function u_(e){this.l[e.type+!0](L.event?L.event(e):e)}function Ih(e,t,r,n,o,i,s,a,u){var l,c,f,p,d,h,b,y,v,w,T,M,V,J,G,K=t.type;if(t.constructor!==void 0)return null;r.__h!=null&&(u=r.__h,a=t.__e=r.__e,t.__h=null,i=[a]),(l=L.__b)&&l(t);try{e:if(typeof K=="function"){if(y=t.props,v=(l=K.contextType)&&n[l.__c],w=l?v?v.props.value:l.__:n,r.__c?b=(c=t.__c=r.__c).__=c.__E:("prototype"in K&&K.prototype.render?t.__c=c=new K(y,w):(t.__c=c=new Dt(y,w),c.constructor=K,c.render=Rz),v&&v.sub(c),c.props=y,c.state||(c.state={}),c.context=w,c.__n=n,f=c.__d=!0,c.__h=[],c._sb=[]),c.__s==null&&(c.__s=c.state),K.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=Gr({},c.__s)),Gr(c.__s,K.getDerivedStateFromProps(y,c.__s))),p=c.props,d=c.state,f)K.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(K.getDerivedStateFromProps==null&&y!==p&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(y,w),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(y,c.__s,w)===!1||t.__v===r.__v){for(c.props=y,c.state=c.__s,t.__v!==r.__v&&(c.__d=!1),c.__v=t,t.__e=r.__e,t.__k=r.__k,t.__k.forEach(function(P){P&&(P.__=t)}),T=0;T<c._sb.length;T++)c.__h.push(c._sb[T]);c._sb=[],c.__h.length&&s.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(y,c.__s,w),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(p,d,h)})}if(c.context=w,c.props=y,c.__v=t,c.__P=e,M=L.__r,V=0,"prototype"in K&&K.prototype.render){for(c.state=c.__s,c.__d=!1,M&&M(t),l=c.render(c.props,c.state,c.context),J=0;J<c._sb.length;J++)c.__h.push(c._sb[J]);c._sb=[]}else do c.__d=!1,M&&M(t),l=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++V<25);c.state=c.__s,c.getChildContext!=null&&(n=Gr(Gr({},n),c.getChildContext())),f||c.getSnapshotBeforeUpdate==null||(h=c.getSnapshotBeforeUpdate(p,d)),G=l!=null&&l.type===$&&l.key==null?l.props.children:l,m_(e,Array.isArray(G)?G:[G],t,r,n,o,i,s,a,u),c.base=t.__e,t.__h=null,c.__h.length&&s.push(c),b&&(c.__E=c.__=null),c.__e=!1}else i==null&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=Nz(r.__e,t,r,n,o,i,s,u);(l=L.diffed)&&l(t)}catch(P){t.__v=null,(u||i!=null)&&(t.__e=a,t.__h=!!u,i[i.indexOf(a)]=null),L.__e(P,t,r)}}function y_(e,t){L.__c&&L.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(n){n.call(r)})}catch(n){L.__e(n,r.__v)}})}function Nz(e,t,r,n,o,i,s,a){var u,l,c,f=r.props,p=t.props,d=t.type,h=0;if(d==="svg"&&(o=!0),i!=null){for(;h<i.length;h++)if((u=i[h])&&"setAttribute"in u==!!d&&(d?u.localName===d:u.nodeType===3)){e=u,i[h]=null;break}}if(e==null){if(d===null)return document.createTextNode(p);e=o?document.createElementNS("http://www.w3.org/2000/svg",d):document.createElement(d,p.is&&p),i=null,a=!1}if(d===null)f===p||a&&e.data===p||(e.data=p);else{if(i=i&&sa.call(e.childNodes),l=(f=r.props||sl).dangerouslySetInnerHTML,c=p.dangerouslySetInnerHTML,!a){if(i!=null)for(f={},h=0;h<e.attributes.length;h++)f[e.attributes[h].name]=e.attributes[h].value;(c||l)&&(c&&(l&&c.__html==l.__html||c.__html===e.innerHTML)||(e.innerHTML=c&&c.__html||""))}if(Az(e,p,f,o,a),c)t.__k=[];else if(h=t.props.children,m_(e,Array.isArray(h)?h:[h],t,r,n,o&&d!=="foreignObject",i,s,i?i[0]:r.__k&&ia(r,0),a),i!=null)for(h=i.length;h--;)i[h]!=null&&p_(i[h]);a||("value"in p&&(h=p.value)!==void 0&&(h!==e.value||d==="progress"&&!h||d==="option"&&h!==f.value)&&ul(e,"value",h,f.value,!1),"checked"in p&&(h=p.checked)!==void 0&&h!==e.checked&&ul(e,"checked",h,f.checked,!1))}return e}function b_(e,t,r){try{typeof e=="function"?e(t):e.current=t}catch(n){L.__e(n,r)}}function v_(e,t,r){var n,o;if(L.unmount&&L.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||b_(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){L.__e(i,t)}n.base=n.__P=null,e.__c=void 0}if(n=e.__k)for(o=0;o<n.length;o++)n[o]&&v_(n[o],t,r||typeof e.type!="function");r||e.__e==null||p_(e.__e),e.__=e.__e=e.__d=void 0}function Rz(e,t,r){return this.constructor(e,r)}function xi(e,t,r){var n,o,i;L.__&&L.__(e,t),o=(n=typeof r=="function")?null:r&&r.__k||t.__k,i=[],Ih(t,e=(!n&&r||t).__k=H($,null,[e]),o||sl,sl,t.ownerSVGElement!==void 0,!n&&r?[r]:o?null:t.firstChild?sa.call(t.childNodes):null,i,!n&&r?r:o?o.__e:t.firstChild,n),y_(i,e)}function _h(e,t){xi(e,t,_h)}function x_(e,t,r){var n,o,i,s=Gr({},e.props);for(i in t)i=="key"?n=t[i]:i=="ref"?o=t[i]:s[i]=t[i];return arguments.length>2&&(s.children=arguments.length>3?sa.call(arguments,2):r),oa(e.type,s,n||e.key,o||e.ref,null)}function qe(e,t){var r={__c:t="__cC"+l_++,__:e,Consumer:function(n,o){return n.children(o)},Provider:function(n){var o,i;return this.getChildContext||(o=[],(i={})[t]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(s){this.props.value!==s.value&&o.some(Sh)},this.sub=function(s){o.push(s);var a=s.componentWillUnmount;s.componentWillUnmount=function(){o.splice(o.indexOf(s),1),a&&a.call(s)}}),n.children}};return r.Provider.__=r.Consumer.contextType=r}var sa,L,c_,Oz,na,i_,l_,sl,f_,kz,wi=Du(()=>{sl={},f_=[],kz=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;sa=f_.slice,L={__e:function(e,t,r,n){for(var o,i,s;t=t.__;)if((o=t.__c)&&!o.__)try{if((i=o.constructor)&&i.getDerivedStateFromError!=null&&(o.setState(i.getDerivedStateFromError(e)),s=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,n||{}),s=o.__d),s)return o.__E=o}catch(a){e=a}throw e}},c_=0,Oz=function(e){return e!=null&&e.constructor===void 0},Dt.prototype.setState=function(e,t){var r;r=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Gr({},this.state),typeof e=="function"&&(e=e(Gr({},r),this.props)),e&&Gr(r,e),e!=null&&this.__v&&(t&&this._sb.push(t),Sh(this))},Dt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Sh(this))},Dt.prototype.render=$,na=[],al.__r=0,l_=0});function go(e,t){L.__h&&L.__h(Ee,e,Ei||t),Ei=0;var r=Ee.__H||(Ee.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({__V:ll}),r.__[e]}function j(e){return Ei=1,Nr(k_,e)}function Nr(e,t,r){var n=go(On++,2);if(n.t=e,!n.__c&&(n.__=[r?r(t):k_(void 0,t),function(i){var s=n.__N?n.__N[0]:n.__[0],a=n.t(s,i);s!==a&&(n.__N=[a,n.__[1]],n.__c.setState({}))}],n.__c=Ee,!Ee.u)){Ee.u=!0;var o=Ee.shouldComponentUpdate;Ee.shouldComponentUpdate=function(i,s,a){if(!n.__c.__H)return!0;var u=n.__c.__H.__.filter(function(c){return c.__c});if(u.every(function(c){return!c.__N}))return!o||o.call(this,i,s,a);var l=!1;return u.forEach(function(c){if(c.__N){var f=c.__[0];c.__=c.__N,c.__N=void 0,f!==c.__[0]&&(l=!0)}}),!(!l&&n.__c.props===i)&&(!o||o.call(this,i,s,a))}}return n.__N||n.__}function U(e,t){var r=go(On++,3);!L.__s&&Ah(r.__H,t)&&(r.__=e,r.i=t,Ee.__H.__h.push(r))}function Et(e,t){var r=go(On++,4);!L.__s&&Ah(r.__H,t)&&(r.__=e,r.i=t,Ee.__h.push(r))}function F(e){return Ei=5,ne(function(){return{current:e}},[])}function Oh(e,t,r){Ei=6,Et(function(){return typeof e=="function"?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0},r==null?r:r.concat(e))}function ne(e,t){var r=go(On++,7);return Ah(r.__H,t)?(r.__V=e(),r.i=t,r.__h=e,r.__V):r.__}function Y(e,t){return Ei=8,ne(function(){return e},t)}function Q(e){var t=Ee.context[e.__c],r=go(On++,9);return r.c=e,t?(r.__==null&&(r.__=!0,t.sub(Ee)),t.props.value):e.__}function yo(e,t){L.useDebugValue&&L.useDebugValue(t?t(e):e)}function Dz(e){var t=go(On++,10),r=j();return t.__=e,Ee.componentDidCatch||(Ee.componentDidCatch=function(n,o){t.__&&t.__(n,o),r[1](n)}),[r[0],function(){r[1](void 0)}]}function kh(){var e=go(On++,11);if(!e.__){for(var t=Ee.__v;t!==null&&!t.__m&&t.__!==null;)t=t.__;var r=t.__m||(t.__m=[0,0]);e.__="P"+r[0]+"-"+r[1]++}return e.__}function Pz(){for(var e;e=O_.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(fl),e.__H.__h.forEach(Th),e.__H.__h=[]}catch(t){e.__H.__h=[],L.__e(t,e.__v)}}function Fz(e){var t,r=function(){clearTimeout(n),T_&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,100);T_&&(t=requestAnimationFrame(r))}function fl(e){var t=Ee,r=e.__c;typeof r=="function"&&(e.__c=void 0,r()),Ee=t}function Th(e){var t=Ee;e.__c=e.__(),Ee=t}function Ah(e,t){return!e||e.length!==t.length||t.some(function(r,n){return r!==e[n]})}function k_(e,t){return typeof t=="function"?t(e):t}var On,Ee,Ch,w_,Ei,O_,ll,E_,S_,I_,__,C_,T_,Nh=Du(()=>{wi();Ei=0,O_=[],ll=[],E_=L.__b,S_=L.__r,I_=L.diffed,__=L.__c,C_=L.unmount;L.__b=function(e){Ee=null,E_&&E_(e)},L.__r=function(e){S_&&S_(e),On=0;var t=(Ee=e.__c).__H;t&&(Ch===Ee?(t.__h=[],Ee.__h=[],t.__.forEach(function(r){r.__N&&(r.__=r.__N),r.__V=ll,r.__N=r.i=void 0})):(t.__h.forEach(fl),t.__h.forEach(Th),t.__h=[])),Ch=Ee},L.diffed=function(e){I_&&I_(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(O_.push(t)!==1&&w_===L.requestAnimationFrame||((w_=L.requestAnimationFrame)||Fz)(Pz)),t.__H.__.forEach(function(r){r.i&&(r.__H=r.i),r.__V!==ll&&(r.__=r.__V),r.i=void 0,r.__V=ll})),Ch=Ee=null},L.__c=function(e,t){t.some(function(r){try{r.__h.forEach(fl),r.__h=r.__h.filter(function(n){return!n.__||Th(n)})}catch(n){t.some(function(o){o.__h&&(o.__h=[])}),t=[],L.__e(n,r.__v)}}),__&&__(e,t)},L.unmount=function(e){C_&&C_(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{fl(n)}catch(o){t=o}}),r.__H=void 0,t&&L.__e(t,r.__v))};T_=typeof requestAnimationFrame=="function"});function j_(e,t){for(var r in t)e[r]=t[r];return e}function Dh(e,t){for(var r in e)if(r!=="__source"&&!(r in t))return!0;for(var n in t)if(n!=="__source"&&e[n]!==t[n])return!0;return!1}function Rh(e,t){return e===t&&(e!==0||1/e==1/t)||e!=e&&t!=t}function pl(e){this.props=e}function st(e,t){function r(o){var i=this.props.ref,s=i==o.ref;return!s&&i&&(i.call?i(null):i.current=null),t?!t(this.props,o)||!s:Dh(this.props,o)}function n(o){return this.shouldComponentUpdate=r,H(e,o)}return n.displayName="Memo("+(e.displayName||e.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n}function Z(e){function t(r){var n=j_({},r);return delete n.ref,e(n,r.ref||null)}return t.$$typeof=$z,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}function q_(e,t,r){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),e.__c.__H=null),(e=j_({},e)).__c!=null&&(e.__c.__P===r&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(n){return q_(n,t,r)})),e}function L_(e,t,r){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(n){return L_(n,t,r)}),e.__c&&e.__c.__P===t&&(e.__e&&r.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=r)),e}function aa(){this.__u=0,this.t=null,this.__b=null}function B_(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function z_(e){var t,r,n;function o(i){if(t||(t=e()).then(function(s){r=s.default||s},function(s){n=s}),n)throw n;if(!r)throw t;return H(r,i)}return o.displayName="Lazy",o.__f=!0,o}function Si(){this.u=null,this.o=null}function jz(e){return this.getChildContext=function(){return e.context},e.children}function qz(e){var t=this,r=e.i;t.componentWillUnmount=function(){xi(null,t.l),t.l=null,t.i=null},t.i&&t.i!==r&&t.componentWillUnmount(),e.__v?(t.l||(t.i=r,t.l={nodeType:1,parentNode:r,childNodes:[],appendChild:function(n){this.childNodes.push(n),t.i.appendChild(n)},insertBefore:function(n,o){this.childNodes.push(n),t.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),t.i.removeChild(n)}}),xi(H(jz,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function U_(e,t){var r=H(qz,{__v:e,i:t});return r.containerInfo=t,r}function H_(e,t,r){return t.__k==null&&(t.textContent=""),xi(e,t),typeof r=="function"&&r(),e?e.__c:null}function K_(e,t,r){return _h(e,t),typeof r=="function"&&r(),e?e.__c:null}function Uz(){}function Wz(){return this.cancelBubble}function Hz(){return this.defaultPrevented}function J_(e){return H.bind(null,e)}function Pt(e){return!!e&&e.$$typeof===W_}function Xt(e){return Pt(e)?x_.apply(null,arguments):e}function Z_(e){return!!e.__k&&(xi(null,e),!0)}function Y_(e){return e&&(e.base||e.nodeType===1&&e)||null}function Ph(e){e()}function eC(e){return e}function tC(){return[!1,Ph]}function nC(e,t){var r=t(),n=j({h:{__:r,v:t}}),o=n[0].h,i=n[1];return Et(function(){o.__=r,o.v=t,Rh(o.__,t())||i({h:o})},[e,r,t]),U(function(){return Rh(o.__,o.v())||i({h:o}),e(function(){Rh(o.__,o.v())||i({h:o})})},[e]),r}var A_,$z,N_,Ve,Mz,R_,D_,W_,Lz,Bz,zz,P_,V_,F_,$_,M_,G_,Kz,X_,Rr,Q_,rC,R,Fh=Du(()=>{wi();wi();Nh();Nh();(pl.prototype=new Dt).isPureReactComponent=!0,pl.prototype.shouldComponentUpdate=function(e,t){return Dh(this.props,e)||Dh(this.state,t)};A_=L.__b;L.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),A_&&A_(e)};$z=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;N_=function(e,t){return e==null?null:Ar(Ar(e).map(t))},Ve={map:N_,forEach:N_,count:function(e){return e?Ar(e).length:0},only:function(e){var t=Ar(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:Ar},Mz=L.__e;L.__e=function(e,t,r,n){if(e.then){for(var o,i=t;i=i.__;)if((o=i.__c)&&o.__c)return t.__e==null&&(t.__e=r.__e,t.__k=r.__k),o.__c(e,t)}Mz(e,t,r,n)};R_=L.unmount;L.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),R_&&R_(e)},(aa.prototype=new Dt).__c=function(e,t){var r=t.__c,n=this;n.t==null&&(n.t=[]),n.t.push(r);var o=B_(n.__v),i=!1,s=function(){i||(i=!0,r.__R=null,o?o(a):a())};r.__R=s;var a=function(){if(!--n.__u){if(n.state.__a){var l=n.state.__a;n.__v.__k[0]=L_(l,l.__c.__P,l.__c.__O)}var c;for(n.setState({__a:n.__b=null});c=n.t.pop();)c.forceUpdate()}},u=t.__h===!0;n.__u++||u||n.setState({__a:n.__b=n.__v.__k[0]}),e.then(s,s)},aa.prototype.componentWillUnmount=function(){this.t=[]},aa.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=q_(this.__b,r,n.__O=n.__P)}this.__b=null}var o=t.__a&&H($,null,e.fallback);return o&&(o.__h=null),[H($,null,t.__a?null:e.children),o]};D_=function(e,t,r){if(++r[1]===r[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(r=e.u;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.u=r=r[2]}};(Si.prototype=new Dt).__a=function(e){var t=this,r=B_(t.__v),n=t.o.get(e);return n[0]++,function(o){var i=function(){t.props.revealOrder?(n.push(o),D_(t,e,n)):o()};r?r(i):i()}},Si.prototype.render=function(e){this.u=null,this.o=new Map;var t=Ar(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var r=t.length;r--;)this.o.set(t[r],this.u=[1,0,this.u]);return e.children},Si.prototype.componentDidUpdate=Si.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,r){D_(e,r,t)})};W_=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Lz=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Bz=typeof document<"u",zz=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};Dt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Dt.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});P_=L.event;L.event=function(e){return P_&&(e=P_(e)),e.persist=Uz,e.isPropagationStopped=Wz,e.isDefaultPrevented=Hz,e.nativeEvent=e};F_={configurable:!0,get:function(){return this.class}},$_=L.vnode;L.vnode=function(e){var t=e.type,r=e.props,n=r;if(typeof t=="string"){var o=t.indexOf("-")===-1;for(var i in n={},r){var s=r[i];Bz&&i==="children"&&t==="noscript"||i==="value"&&"defaultValue"in r&&s==null||(i==="defaultValue"&&"value"in r&&r.value==null?i="value":i==="download"&&s===!0?s="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!zz(r.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():o&&Lz.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():s===null&&(s=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),n[i]&&(i="oninputCapture")),n[i]=s)}t=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=Ar(r.children).forEach(function(a){a.props.selected=n.value.indexOf(a.props.value)!=-1})),t=="select"&&n.defaultValue!=null&&(n.value=Ar(r.children).forEach(function(a){a.props.selected=n.multiple?n.defaultValue.indexOf(a.props.value)!=-1:n.defaultValue==a.props.value})),e.props=n,r.class!=r.className&&(F_.enumerable="className"in r,r.className!=null&&(n.class=r.className),Object.defineProperty(n,"className",F_))}e.$$typeof=W_,$_&&$_(e)};M_=L.__r;L.__r=function(e){M_&&M_(e),V_=e.__c};G_={ReactCurrentDispatcher:{current:{readContext:function(e){return V_.__n[e.__c].props.value}}}},Kz="17.0.2";X_=function(e,t){return e(t)},Rr=function(e,t){return e(t)},Q_=$;rC=Et;R={useState:j,useId:kh,useReducer:Nr,useEffect:U,useLayoutEffect:Et,useInsertionEffect:rC,useTransition:tC,useDeferredValue:eC,useSyncExternalStore:nC,startTransition:Ph,useRef:F,useImperativeHandle:Oh,useMemo:ne,useCallback:Y,useContext:Q,useDebugValue:yo,version:"17.0.2",Children:Ve,render:H_,hydrate:K_,unmountComponentAtNode:Z_,createPortal:U_,createElement:H,createContext:qe,createFactory:J_,cloneElement:Xt,createRef:cl,Fragment:$,isValidElement:Pt,findDOMNode:Y_,Component:Dt,PureComponent:pl,memo:st,forwardRef:Z,flushSync:Rr,unstable_batchedUpdates:X_,StrictMode:Q_,Suspense:aa,SuspenseList:Si,lazy:z_,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:G_}});var lr={};Ov(lr,{Children:()=>Ve,Component:()=>Dt,Fragment:()=>$,PureComponent:()=>pl,StrictMode:()=>Q_,Suspense:()=>aa,SuspenseList:()=>Si,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:()=>G_,cloneElement:()=>Xt,createContext:()=>qe,createElement:()=>H,createFactory:()=>J_,createPortal:()=>U_,createRef:()=>cl,default:()=>R,findDOMNode:()=>Y_,flushSync:()=>Rr,forwardRef:()=>Z,hydrate:()=>K_,isValidElement:()=>Pt,lazy:()=>z_,memo:()=>st,render:()=>H_,startTransition:()=>Ph,unmountComponentAtNode:()=>Z_,unstable_batchedUpdates:()=>X_,useCallback:()=>Y,useContext:()=>Q,useDebugValue:()=>yo,useDeferredValue:()=>eC,useEffect:()=>U,useErrorBoundary:()=>Dz,useId:()=>kh,useImperativeHandle:()=>Oh,useInsertionEffect:()=>rC,useLayoutEffect:()=>Et,useMemo:()=>ne,useReducer:()=>Nr,useRef:()=>F,useState:()=>j,useSyncExternalStore:()=>nC,useTransition:()=>tC,version:()=>Kz});var S=Du(()=>{Fh();Fh()});var er=g((HT,KT)=>{"use strict";var Kl=function(e){return e&&e.Math===Math&&e};KT.exports=Kl(typeof globalThis=="object"&&globalThis)||Kl(typeof window=="object"&&window)||Kl(typeof self=="object"&&self)||Kl(typeof global=="object"&&global)||function(){return this}()||HT||Function("return this")()});var ft=g((Lbe,VT)=>{"use strict";VT.exports=function(e){try{return!!e()}catch{return!0}}});var Ia=g((Bbe,GT)=>{"use strict";var V9=ft();GT.exports=!V9(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")})});var QT=g((zbe,XT)=>{"use strict";var G9=Ia(),YT=Function.prototype,JT=YT.apply,ZT=YT.call;XT.exports=typeof Reflect=="object"&&Reflect.apply||(G9?ZT.bind(JT):function(){return ZT.apply(JT,arguments)})});var pt=g((Ube,rO)=>{"use strict";var eO=Ia(),tO=Function.prototype,ug=tO.call,J9=eO&&tO.bind.bind(ug,ug);rO.exports=eO?J9:function(e){return function(){return ug.apply(e,arguments)}}});var Eo=g((Wbe,oO)=>{"use strict";var nO=pt(),Z9=nO({}.toString),Y9=nO("".slice);oO.exports=function(e){return Y9(Z9(e),8,-1)}});var cg=g((Hbe,iO)=>{"use strict";var X9=Eo(),Q9=pt();iO.exports=function(e){if(X9(e)==="Function")return Q9(e)}});var fg=g((Kbe,sO)=>{"use strict";var lg=typeof document=="object"&&document.all,e4=typeof lg>"u"&&lg!==void 0;sO.exports={all:lg,IS_HTMLDDA:e4}});var Je=g((Vbe,uO)=>{"use strict";var aO=fg(),t4=aO.all;uO.exports=aO.IS_HTMLDDA?function(e){return typeof e=="function"||e===t4}:function(e){return typeof e=="function"}});var tr=g((Gbe,cO)=>{"use strict";var r4=ft();cO.exports=!r4(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var Xr=g((Jbe,lO)=>{"use strict";var n4=Ia(),Vl=Function.prototype.call;lO.exports=n4?Vl.bind(Vl):function(){return Vl.apply(Vl,arguments)}});var mO=g(dO=>{"use strict";var fO={}.propertyIsEnumerable,pO=Object.getOwnPropertyDescriptor,o4=pO&&!fO.call({1:2},1);dO.f=o4?function(t){var r=pO(this,t);return!!r&&r.enumerable}:fO});var _a=g((Ybe,hO)=>{"use strict";hO.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}});var dg=g((Xbe,gO)=>{"use strict";var i4=pt(),s4=ft(),a4=Eo(),pg=Object,u4=i4("".split);gO.exports=s4(function(){return!pg("z").propertyIsEnumerable(0)})?function(e){return a4(e)==="String"?u4(e,""):pg(e)}:pg});var Di=g((Qbe,yO)=>{"use strict";yO.exports=function(e){return e==null}});var Ca=g((eve,bO)=>{"use strict";var c4=Di(),l4=TypeError;bO.exports=function(e){if(c4(e))throw l4("Can't call method on "+e);return e}});var Pi=g((tve,vO)=>{"use strict";var f4=dg(),p4=Ca();vO.exports=function(e){return f4(p4(e))}});var fr=g((rve,EO)=>{"use strict";var xO=Je(),wO=fg(),d4=wO.all;EO.exports=wO.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:xO(e)||e===d4}:function(e){return typeof e=="object"?e!==null:xO(e)}});var Ta=g((nve,SO)=>{"use strict";SO.exports={}});var So=g((ove,_O)=>{"use strict";var mg=Ta(),hg=er(),m4=Je(),IO=function(e){return m4(e)?e:void 0};_O.exports=function(e,t){return arguments.length<2?IO(mg[e])||IO(hg[e]):mg[e]&&mg[e][t]||hg[e]&&hg[e][t]}});var Gl=g((ive,CO)=>{"use strict";var h4=pt();CO.exports=h4({}.isPrototypeOf)});var OO=g((sve,TO)=>{"use strict";TO.exports=typeof navigator<"u"&&String(navigator.userAgent)||""});var FO=g((ave,PO)=>{"use strict";var DO=er(),gg=OO(),kO=DO.process,AO=DO.Deno,NO=kO&&kO.versions||AO&&AO.version,RO=NO&&NO.v8,pr,Jl;RO&&(pr=RO.split("."),Jl=pr[0]>0&&pr[0]<4?1:+(pr[0]+pr[1]));!Jl&&gg&&(pr=gg.match(/Edge\/(\d+)/),(!pr||pr[1]>=74)&&(pr=gg.match(/Chrome\/(\d+)/),pr&&(Jl=+pr[1])));PO.exports=Jl});var yg=g((uve,MO)=>{"use strict";var $O=FO(),g4=ft(),y4=er(),b4=y4.String;MO.exports=!!Object.getOwnPropertySymbols&&!g4(function(){var e=Symbol("symbol detection");return!b4(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&$O&&$O<41})});var bg=g((cve,jO)=>{"use strict";var v4=yg();jO.exports=v4&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var vg=g((lve,qO)=>{"use strict";var x4=So(),w4=Je(),E4=Gl(),S4=bg(),I4=Object;qO.exports=S4?function(e){return typeof e=="symbol"}:function(e){var t=x4("Symbol");return w4(t)&&E4(t.prototype,I4(e))}});var Zl=g((fve,LO)=>{"use strict";var _4=String;LO.exports=function(e){try{return _4(e)}catch{return"Object"}}});var Io=g((pve,BO)=>{"use strict";var C4=Je(),T4=Zl(),O4=TypeError;BO.exports=function(e){if(C4(e))return e;throw O4(T4(e)+" is not a function")}});var Yl=g((dve,zO)=>{"use strict";var k4=Io(),A4=Di();zO.exports=function(e,t){var r=e[t];return A4(r)?void 0:k4(r)}});var WO=g((mve,UO)=>{"use strict";var xg=Xr(),wg=Je(),Eg=fr(),N4=TypeError;UO.exports=function(e,t){var r,n;if(t==="string"&&wg(r=e.toString)&&!Eg(n=xg(r,e))||wg(r=e.valueOf)&&!Eg(n=xg(r,e))||t!=="string"&&wg(r=e.toString)&&!Eg(n=xg(r,e)))return n;throw N4("Can't convert object to primitive value")}});var Oa=g((hve,HO)=>{"use strict";HO.exports=!0});var GO=g((gve,VO)=>{"use strict";var KO=er(),R4=Object.defineProperty;VO.exports=function(e,t){try{R4(KO,e,{value:t,configurable:!0,writable:!0})}catch{KO[e]=t}return t}});var Xl=g((yve,ZO)=>{"use strict";var D4=er(),P4=GO(),JO="__core-js_shared__",F4=D4[JO]||P4(JO,{});ZO.exports=F4});var Sg=g((bve,XO)=>{"use strict";var $4=Oa(),YO=Xl();(XO.exports=function(e,t){return YO[e]||(YO[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.32.1",mode:$4?"pure":"global",copyright:"\xA9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.1/LICENSE",source:"https://github.com/zloirock/core-js"})});var Ql=g((vve,QO)=>{"use strict";var M4=Ca(),j4=Object;QO.exports=function(e){return j4(M4(e))}});var Fr=g((xve,ek)=>{"use strict";var q4=pt(),L4=Ql(),B4=q4({}.hasOwnProperty);ek.exports=Object.hasOwn||function(t,r){return B4(L4(t),r)}});var ef=g((wve,tk)=>{"use strict";var z4=pt(),U4=0,W4=Math.random(),H4=z4(1 .toString);tk.exports=function(e){return"Symbol("+(e===void 0?"":e)+")_"+H4(++U4+W4,36)}});var dr=g((Eve,nk)=>{"use strict";var K4=er(),V4=Sg(),rk=Fr(),G4=ef(),J4=yg(),Z4=bg(),Fi=K4.Symbol,Ig=V4("wks"),Y4=Z4?Fi.for||Fi:Fi&&Fi.withoutSetter||G4;nk.exports=function(e){return rk(Ig,e)||(Ig[e]=J4&&rk(Fi,e)?Fi[e]:Y4("Symbol."+e)),Ig[e]}});var ak=g((Sve,sk)=>{"use strict";var X4=Xr(),ok=fr(),ik=vg(),Q4=Yl(),e8=WO(),t8=dr(),r8=TypeError,n8=t8("toPrimitive");sk.exports=function(e,t){if(!ok(e)||ik(e))return e;var r=Q4(e,n8),n;if(r){if(t===void 0&&(t="default"),n=X4(r,e,t),!ok(n)||ik(n))return n;throw r8("Can't convert object to primitive value")}return t===void 0&&(t="number"),e8(e,t)}});var ka=g((Ive,uk)=>{"use strict";var o8=ak(),i8=vg();uk.exports=function(e){var t=o8(e,"string");return i8(t)?t:t+""}});var Cg=g((_ve,lk)=>{"use strict";var s8=er(),ck=fr(),_g=s8.document,a8=ck(_g)&&ck(_g.createElement);lk.exports=function(e){return a8?_g.createElement(e):{}}});var Tg=g((Cve,fk)=>{"use strict";var u8=tr(),c8=ft(),l8=Cg();fk.exports=!u8&&!c8(function(){return Object.defineProperty(l8("div"),"a",{get:function(){return 7}}).a!==7})});var mk=g(dk=>{"use strict";var f8=tr(),p8=Xr(),d8=mO(),m8=_a(),h8=Pi(),g8=ka(),y8=Fr(),b8=Tg(),pk=Object.getOwnPropertyDescriptor;dk.f=f8?pk:function(t,r){if(t=h8(t),r=g8(r),b8)try{return pk(t,r)}catch{}if(y8(t,r))return m8(!p8(d8.f,t,r),t[r])}});var gk=g((Ove,hk)=>{"use strict";var v8=ft(),x8=Je(),w8=/#|\.prototype\./,Aa=function(e,t){var r=S8[E8(e)];return r===_8?!0:r===I8?!1:x8(t)?v8(t):!!t},E8=Aa.normalize=function(e){return String(e).replace(w8,".").toLowerCase()},S8=Aa.data={},I8=Aa.NATIVE="N",_8=Aa.POLYFILL="P";hk.exports=Aa});var Na=g((kve,bk)=>{"use strict";var yk=cg(),C8=Io(),T8=Ia(),O8=yk(yk.bind);bk.exports=function(e,t){return C8(e),t===void 0?e:T8?O8(e,t):function(){return e.apply(t,arguments)}}});var Og=g((Ave,vk)=>{"use strict";var k8=tr(),A8=ft();vk.exports=k8&&A8(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var Rn=g((Nve,xk)=>{"use strict";var N8=fr(),R8=String,D8=TypeError;xk.exports=function(e){if(N8(e))return e;throw D8(R8(e)+" is not an object")}});var Dn=g(Ek=>{"use strict";var P8=tr(),F8=Tg(),$8=Og(),tf=Rn(),wk=ka(),M8=TypeError,kg=Object.defineProperty,j8=Object.getOwnPropertyDescriptor,Ag="enumerable",Ng="configurable",Rg="writable";Ek.f=P8?$8?function(t,r,n){if(tf(t),r=wk(r),tf(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Rg in n&&!n[Rg]){var o=j8(t,r);o&&o[Rg]&&(t[r]=n.value,n={configurable:Ng in n?n[Ng]:o[Ng],enumerable:Ag in n?n[Ag]:o[Ag],writable:!1})}return kg(t,r,n)}:kg:function(t,r,n){if(tf(t),r=wk(r),tf(n),F8)try{return kg(t,r,n)}catch{}if("get"in n||"set"in n)throw M8("Accessors not supported");return"value"in n&&(t[r]=n.value),t}});var _o=g((Dve,Sk)=>{"use strict";var q8=tr(),L8=Dn(),B8=_a();Sk.exports=q8?function(e,t,r){return L8.f(e,t,B8(1,r))}:function(e,t,r){return e[t]=r,e}});var Co=g((Pve,_k)=>{"use strict";var rf=er(),z8=QT(),U8=cg(),W8=Je(),H8=mk().f,K8=gk(),$i=Ta(),V8=Na(),Mi=_o(),Ik=Fr(),G8=function(e){var t=function(r,n,o){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,n)}return new e(r,n,o)}return z8(e,this,arguments)};return t.prototype=e.prototype,t};_k.exports=function(e,t){var r=e.target,n=e.global,o=e.stat,i=e.proto,s=n?rf:o?rf[r]:(rf[r]||{}).prototype,a=n?$i:$i[r]||Mi($i,r,{})[r],u=a.prototype,l,c,f,p,d,h,b,y,v;for(p in t)l=K8(n?p:r+(o?".":"#")+p,e.forced),c=!l&&s&&Ik(s,p),h=a[p],c&&(e.dontCallGetSet?(v=H8(s,p),b=v&&v.value):b=s[p]),d=c&&b?b:t[p],!(c&&typeof h==typeof d)&&(e.bind&&c?y=V8(d,rf):e.wrap&&c?y=G8(d):i&&W8(d)?y=U8(d):y=d,(e.sham||d&&d.sham||h&&h.sham)&&Mi(y,"sham",!0),Mi(a,p,y),i&&(f=r+"Prototype",Ik($i,f)||Mi($i,f,{}),Mi($i[f],p,d),e.real&&u&&(l||!u[p])&&Mi(u,p,d)))}});var Ra=g((Fve,Ck)=>{"use strict";Ck.exports={}});var Ok=g(($ve,Tk)=>{"use strict";var J8=Math.ceil,Z8=Math.floor;Tk.exports=Math.trunc||function(t){var r=+t;return(r>0?Z8:J8)(r)}});var Dg=g((Mve,kk)=>{"use strict";var Y8=Ok();kk.exports=function(e){var t=+e;return t!==t||t===0?0:Y8(t)}});var Pg=g((jve,Ak)=>{"use strict";var X8=Dg(),Q8=Math.max,eU=Math.min;Ak.exports=function(e,t){var r=X8(e);return r<0?Q8(r+t,0):eU(r,t)}});var Rk=g((qve,Nk)=>{"use strict";var tU=Dg(),rU=Math.min;Nk.exports=function(e){return e>0?rU(tU(e),9007199254740991):0}});var Da=g((Lve,Dk)=>{"use strict";var nU=Rk();Dk.exports=function(e){return nU(e.length)}});var $k=g((Bve,Fk)=>{"use strict";var oU=Pi(),iU=Pg(),sU=Da(),Pk=function(e){return function(t,r,n){var o=oU(t),i=sU(o),s=iU(n,i),a;if(e&&r!==r){for(;i>s;)if(a=o[s++],a!==a)return!0}else for(;i>s;s++)if((e||s in o)&&o[s]===r)return e||s||0;return!e&&-1}};Fk.exports={includes:Pk(!0),indexOf:Pk(!1)}});var $g=g((zve,jk)=>{"use strict";var aU=pt(),Fg=Fr(),uU=Pi(),cU=$k().indexOf,lU=Ra(),Mk=aU([].push);jk.exports=function(e,t){var r=uU(e),n=0,o=[],i;for(i in r)!Fg(lU,i)&&Fg(r,i)&&Mk(o,i);for(;t.length>n;)Fg(r,i=t[n++])&&(~cU(o,i)||Mk(o,i));return o}});var nf=g((Uve,qk)=>{"use strict";qk.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var Mg=g(Lk=>{"use strict";var fU=$g(),pU=nf(),dU=pU.concat("length","prototype");Lk.f=Object.getOwnPropertyNames||function(t){return fU(t,dU)}});var zk=g((Hve,Bk)=>{"use strict";var mU=ka(),hU=Dn(),gU=_a();Bk.exports=function(e,t,r){var n=mU(t);n in e?hU.f(e,n,gU(0,r)):e[n]=r}});var Hk=g((Kve,Wk)=>{"use strict";var Uk=Pg(),yU=Da(),bU=zk(),vU=Array,xU=Math.max;Wk.exports=function(e,t,r){for(var n=yU(e),o=Uk(t,n),i=Uk(r===void 0?n:r,n),s=vU(xU(i-o,0)),a=0;o<i;o++,a++)bU(s,a,e[o]);return s.length=a,s}});var Jk=g((Vve,Gk)=>{"use strict";var wU=Eo(),EU=Pi(),Kk=Mg().f,SU=Hk(),Vk=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],IU=function(e){try{return Kk(e)}catch{return SU(Vk)}};Gk.exports.f=function(t){return Vk&&wU(t)==="Window"?IU(t):Kk(EU(t))}});var Yk=g((Gve,Zk)=>{"use strict";var _U=ft();Zk.exports=_U(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})});var eA=g((Jve,Qk)=>{"use strict";var CU=ft(),TU=fr(),OU=Eo(),Xk=Yk(),of=Object.isExtensible,kU=CU(function(){of(1)});Qk.exports=kU||Xk?function(t){return!TU(t)||Xk&&OU(t)==="ArrayBuffer"?!1:of?of(t):!0}:of});var rA=g((Zve,tA)=>{"use strict";var AU=ft();tA.exports=!AU(function(){return Object.isExtensible(Object.preventExtensions({}))})});var Bg=g((Yve,iA)=>{"use strict";var NU=Co(),RU=pt(),DU=Ra(),PU=fr(),jg=Fr(),FU=Dn().f,nA=Mg(),$U=Jk(),qg=eA(),MU=ef(),jU=rA(),oA=!1,Qr=MU("meta"),qU=0,Lg=function(e){FU(e,Qr,{value:{objectID:"O"+qU++,weakData:{}}})},LU=function(e,t){if(!PU(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!jg(e,Qr)){if(!qg(e))return"F";if(!t)return"E";Lg(e)}return e[Qr].objectID},BU=function(e,t){if(!jg(e,Qr)){if(!qg(e))return!0;if(!t)return!1;Lg(e)}return e[Qr].weakData},zU=function(e){return jU&&oA&&qg(e)&&!jg(e,Qr)&&Lg(e),e},UU=function(){WU.enable=function(){},oA=!0;var e=nA.f,t=RU([].splice),r={};r[Qr]=1,e(r).length&&(nA.f=function(n){for(var o=e(n),i=0,s=o.length;i<s;i++)if(o[i]===Qr){t(o,i,1);break}return o},NU({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:$U.f}))},WU=iA.exports={enable:UU,fastKey:LU,getWeakData:BU,onFreeze:zU};DU[Qr]=!0});var Pa=g((Xve,sA)=>{"use strict";sA.exports={}});var uA=g((Qve,aA)=>{"use strict";var HU=dr(),KU=Pa(),VU=HU("iterator"),GU=Array.prototype;aA.exports=function(e){return e!==void 0&&(KU.Array===e||GU[VU]===e)}});var sf=g((e0e,lA)=>{"use strict";var JU=dr(),ZU=JU("toStringTag"),cA={};cA[ZU]="z";lA.exports=String(cA)==="[object z]"});var uf=g((t0e,fA)=>{"use strict";var YU=sf(),XU=Je(),af=Eo(),QU=dr(),eW=QU("toStringTag"),tW=Object,rW=af(function(){return arguments}())==="Arguments",nW=function(e,t){try{return e[t]}catch{}};fA.exports=YU?af:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=nW(t=tW(e),eW))=="string"?r:rW?af(t):(n=af(t))==="Object"&&XU(t.callee)?"Arguments":n}});var zg=g((r0e,dA)=>{"use strict";var oW=uf(),pA=Yl(),iW=Di(),sW=Pa(),aW=dr(),uW=aW("iterator");dA.exports=function(e){if(!iW(e))return pA(e,uW)||pA(e,"@@iterator")||sW[oW(e)]}});var hA=g((n0e,mA)=>{"use strict";var cW=Xr(),lW=Io(),fW=Rn(),pW=Zl(),dW=zg(),mW=TypeError;mA.exports=function(e,t){var r=arguments.length<2?dW(e):t;if(lW(r))return fW(cW(r,e));throw mW(pW(e)+" is not iterable")}});var bA=g((o0e,yA)=>{"use strict";var hW=Xr(),gA=Rn(),gW=Yl();yA.exports=function(e,t,r){var n,o;gA(e);try{if(n=gW(e,"return"),!n){if(t==="throw")throw r;return r}n=hW(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return gA(n),r}});var Fa=g((i0e,EA)=>{"use strict";var yW=Na(),bW=Xr(),vW=Rn(),xW=Zl(),wW=uA(),EW=Da(),vA=Gl(),SW=hA(),IW=zg(),xA=bA(),_W=TypeError,cf=function(e,t){this.stopped=e,this.result=t},wA=cf.prototype;EA.exports=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),s=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),u=yW(t,n),l,c,f,p,d,h,b,y=function(w){return l&&xA(l,"normal",w),new cf(!0,w)},v=function(w){return o?(vW(w),a?u(w[0],w[1],y):u(w[0],w[1])):a?u(w,y):u(w)};if(i)l=e.iterator;else if(s)l=e;else{if(c=IW(e),!c)throw _W(xW(e)+" is not iterable");if(wW(c)){for(f=0,p=EW(e);p>f;f++)if(d=v(e[f]),d&&vA(wA,d))return d;return new cf(!1)}l=SW(e,c)}for(h=i?e.next:l.next;!(b=bW(h,l)).done;){try{d=v(b.value)}catch(w){xA(l,"throw",w)}if(typeof d=="object"&&d&&vA(wA,d))return d}return new cf(!1)}});var Ug=g((s0e,SA)=>{"use strict";var CW=Gl(),TW=TypeError;SA.exports=function(e,t){if(CW(t,e))return e;throw TW("Incorrect invocation")}});var _A=g((a0e,IA)=>{"use strict";var OW=sf(),kW=uf();IA.exports=OW?{}.toString:function(){return"[object "+kW(this)+"]"}});var lf=g((u0e,TA)=>{"use strict";var AW=sf(),NW=Dn().f,RW=_o(),DW=Fr(),PW=_A(),FW=dr(),CA=FW("toStringTag");TA.exports=function(e,t,r,n){if(e){var o=r?e:e.prototype;DW(o,CA)||NW(o,CA,{configurable:!0,value:t}),n&&!AW&&RW(o,"toString",PW)}}});var kA=g((c0e,OA)=>{"use strict";var $W=Eo();OA.exports=Array.isArray||function(t){return $W(t)==="Array"}});var NA=g((l0e,AA)=>{"use strict";var MW=pt(),jW=Je(),Wg=Xl(),qW=MW(Function.toString);jW(Wg.inspectSource)||(Wg.inspectSource=function(e){return qW(e)});AA.exports=Wg.inspectSource});var MA=g((f0e,$A)=>{"use strict";var LW=pt(),BW=ft(),RA=Je(),zW=uf(),UW=So(),WW=NA(),DA=function(){},HW=[],PA=UW("Reflect","construct"),Hg=/^\s*(?:class|function)\b/,KW=LW(Hg.exec),VW=!Hg.exec(DA),$a=function(t){if(!RA(t))return!1;try{return PA(DA,HW,t),!0}catch{return!1}},FA=function(t){if(!RA(t))return!1;switch(zW(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return VW||!!KW(Hg,WW(t))}catch{return!0}};FA.sham=!0;$A.exports=!PA||BW(function(){var e;return $a($a.call)||!$a(Object)||!$a(function(){e=!0})||e})?FA:$a});var BA=g((p0e,LA)=>{"use strict";var jA=kA(),GW=MA(),JW=fr(),ZW=dr(),YW=ZW("species"),qA=Array;LA.exports=function(e){var t;return jA(e)&&(t=e.constructor,GW(t)&&(t===qA||jA(t.prototype))?t=void 0:JW(t)&&(t=t[YW],t===null&&(t=void 0))),t===void 0?qA:t}});var UA=g((d0e,zA)=>{"use strict";var XW=BA();zA.exports=function(e,t){return new(XW(e))(t===0?0:t)}});var KA=g((m0e,HA)=>{"use strict";var QW=Na(),e7=pt(),t7=dg(),r7=Ql(),n7=Da(),o7=UA(),WA=e7([].push),Pn=function(e){var t=e===1,r=e===2,n=e===3,o=e===4,i=e===6,s=e===7,a=e===5||i;return function(u,l,c,f){for(var p=r7(u),d=t7(p),h=QW(l,c),b=n7(d),y=0,v=f||o7,w=t?v(u,b):r||s?v(u,0):void 0,T,M;b>y;y++)if((a||y in d)&&(T=d[y],M=h(T,y,p),e))if(t)w[y]=M;else if(M)switch(e){case 3:return!0;case 5:return T;case 6:return y;case 2:WA(w,T)}else switch(e){case 4:return!1;case 7:WA(w,T)}return i?-1:n||o?o:w}};HA.exports={forEach:Pn(0),map:Pn(1),filter:Pn(2),some:Pn(3),every:Pn(4),find:Pn(5),findIndex:Pn(6),filterReject:Pn(7)}});var JA=g((h0e,GA)=>{"use strict";var i7=er(),s7=Je(),VA=i7.WeakMap;GA.exports=s7(VA)&&/native code/.test(String(VA))});var ff=g((g0e,YA)=>{"use strict";var a7=Sg(),u7=ef(),ZA=a7("keys");YA.exports=function(e){return ZA[e]||(ZA[e]=u7(e))}});var Jg=g((y0e,eN)=>{"use strict";var c7=JA(),QA=er(),l7=fr(),f7=_o(),Kg=Fr(),Vg=Xl(),p7=ff(),d7=Ra(),XA="Object already initialized",Gg=QA.TypeError,m7=QA.WeakMap,pf,Ma,df,h7=function(e){return df(e)?Ma(e):pf(e,{})},g7=function(e){return function(t){var r;if(!l7(t)||(r=Ma(t)).type!==e)throw Gg("Incompatible receiver, "+e+" required");return r}};c7||Vg.state?(mr=Vg.state||(Vg.state=new m7),mr.get=mr.get,mr.has=mr.has,mr.set=mr.set,pf=function(e,t){if(mr.has(e))throw Gg(XA);return t.facade=e,mr.set(e,t),t},Ma=function(e){return mr.get(e)||{}},df=function(e){return mr.has(e)}):(To=p7("state"),d7[To]=!0,pf=function(e,t){if(Kg(e,To))throw Gg(XA);return t.facade=e,f7(e,To,t),t},Ma=function(e){return Kg(e,To)?e[To]:{}},df=function(e){return Kg(e,To)});var mr,To;eN.exports={set:pf,get:Ma,has:df,enforce:h7,getterFor:g7}});var nN=g((b0e,rN)=>{"use strict";var y7=Co(),b7=er(),v7=Bg(),x7=ft(),w7=_o(),E7=Fa(),S7=Ug(),I7=Je(),_7=fr(),C7=Di(),T7=lf(),O7=Dn().f,k7=KA().forEach,A7=tr(),tN=Jg(),N7=tN.set,R7=tN.getterFor;rN.exports=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",s=b7[e],a=s&&s.prototype,u={},l;if(!A7||!I7(s)||!(o||a.forEach&&!x7(function(){new s().entries().next()})))l=r.getConstructor(t,e,n,i),v7.enable();else{l=t(function(p,d){N7(S7(p,c),{type:e,collection:new s}),C7(d)||E7(d,p[i],{that:p,AS_ENTRIES:n})});var c=l.prototype,f=R7(e);k7(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(p){var d=p==="add"||p==="set";p in a&&!(o&&p==="clear")&&w7(c,p,function(h,b){var y=f(this).collection;if(!d&&o&&!_7(h))return p==="get"?void 0:!1;var v=y[p](h===0?0:h,b);return d?this:v})}),o||O7(c,"size",{configurable:!0,get:function(){return f(this).collection.size}})}return T7(l,e,!1,!0),u[e]=l,y7({global:!0,forced:!0},u),o||r.setStrong(l,e,n),l}});var iN=g((v0e,oN)=>{"use strict";var D7=$g(),P7=nf();oN.exports=Object.keys||function(t){return D7(t,P7)}});var aN=g(sN=>{"use strict";var F7=tr(),$7=Og(),M7=Dn(),j7=Rn(),q7=Pi(),L7=iN();sN.f=F7&&!$7?Object.defineProperties:function(t,r){j7(t);for(var n=q7(r),o=L7(r),i=o.length,s=0,a;i>s;)M7.f(t,a=o[s++],n[a]);return t}});var cN=g((w0e,uN)=>{"use strict";var B7=So();uN.exports=B7("document","documentElement")});var ja=g((E0e,gN)=>{"use strict";var z7=Rn(),U7=aN(),lN=nf(),W7=Ra(),H7=cN(),K7=Cg(),V7=ff(),fN=">",pN="<",Yg="prototype",Xg="script",mN=V7("IE_PROTO"),Zg=function(){},hN=function(e){return pN+Xg+fN+e+pN+"/"+Xg+fN},dN=function(e){e.write(hN("")),e.close();var t=e.parentWindow.Object;return e=null,t},G7=function(){var e=K7("iframe"),t="java"+Xg+":",r;return e.style.display="none",H7.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(hN("document.F=Object")),r.close(),r.F},mf,hf=function(){try{mf=new ActiveXObject("htmlfile")}catch{}hf=typeof document<"u"?document.domain&&mf?dN(mf):G7():dN(mf);for(var e=lN.length;e--;)delete hf[Yg][lN[e]];return hf()};W7[mN]=!0;gN.exports=Object.create||function(t,r){var n;return t!==null?(Zg[Yg]=z7(t),n=new Zg,Zg[Yg]=null,n[mN]=t):n=hf(),r===void 0?n:U7.f(n,r)}});var Qg=g((S0e,yN)=>{"use strict";var J7=Dn();yN.exports=function(e,t,r){return J7.f(e,t,r)}});var gf=g((I0e,bN)=>{"use strict";var Z7=_o();bN.exports=function(e,t,r,n){return n&&n.enumerable?e[t]=r:Z7(e,t,r),e}});var xN=g((_0e,vN)=>{"use strict";var Y7=gf();vN.exports=function(e,t,r){for(var n in t)r&&r.unsafe&&e[n]?e[n]=t[n]:Y7(e,n,t[n],r);return e}});var SN=g((C0e,EN)=>{"use strict";var ey=tr(),X7=Fr(),wN=Function.prototype,Q7=ey&&Object.getOwnPropertyDescriptor,ty=X7(wN,"name"),eH=ty&&function(){}.name==="something",tH=ty&&(!ey||ey&&Q7(wN,"name").configurable);EN.exports={EXISTS:ty,PROPER:eH,CONFIGURABLE:tH}});var _N=g((T0e,IN)=>{"use strict";var rH=ft();IN.exports=!rH(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})});var ny=g((O0e,TN)=>{"use strict";var nH=Fr(),oH=Je(),iH=Ql(),sH=ff(),aH=_N(),CN=sH("IE_PROTO"),ry=Object,uH=ry.prototype;TN.exports=aH?ry.getPrototypeOf:function(e){var t=iH(e);if(nH(t,CN))return t[CN];var r=t.constructor;return oH(r)&&t instanceof r?r.prototype:t instanceof ry?uH:null}});var ay=g((k0e,AN)=>{"use strict";var cH=ft(),lH=Je(),fH=fr(),pH=ja(),ON=ny(),dH=gf(),mH=dr(),hH=Oa(),sy=mH("iterator"),kN=!1,en,oy,iy;[].keys&&(iy=[].keys(),"next"in iy?(oy=ON(ON(iy)),oy!==Object.prototype&&(en=oy)):kN=!0);var gH=!fH(en)||cH(function(){var e={};return en[sy].call(e)!==e});gH?en={}:hH&&(en=pH(en));lH(en[sy])||dH(en,sy,function(){return this});AN.exports={IteratorPrototype:en,BUGGY_SAFARI_ITERATORS:kN}});var RN=g((A0e,NN)=>{"use strict";var yH=ay().IteratorPrototype,bH=ja(),vH=_a(),xH=lf(),wH=Pa(),EH=function(){return this};NN.exports=function(e,t,r,n){var o=t+" Iterator";return e.prototype=bH(yH,{next:vH(+!n,r)}),xH(e,o,!1,!0),wH[o]=EH,e}});var PN=g((N0e,DN)=>{"use strict";var SH=pt(),IH=Io();DN.exports=function(e,t,r){try{return SH(IH(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}}});var $N=g((R0e,FN)=>{"use strict";var _H=Je(),CH=String,TH=TypeError;FN.exports=function(e){if(typeof e=="object"||_H(e))return e;throw TH("Can't set "+CH(e)+" as a prototype")}});var jN=g((D0e,MN)=>{"use strict";var OH=PN(),kH=Rn(),AH=$N();MN.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=OH(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return kH(o),AH(i),e?r(o,i):o.__proto__=i,o}}():void 0)});var JN=g((P0e,GN)=>{"use strict";var NH=Co(),RH=Xr(),yf=Oa(),KN=SN(),DH=Je(),PH=RN(),qN=ny(),LN=jN(),FH=lf(),$H=_o(),uy=gf(),MH=dr(),BN=Pa(),VN=ay(),jH=KN.PROPER,qH=KN.CONFIGURABLE,zN=VN.IteratorPrototype,bf=VN.BUGGY_SAFARI_ITERATORS,qa=MH("iterator"),UN="keys",La="values",WN="entries",HN=function(){return this};GN.exports=function(e,t,r,n,o,i,s){PH(r,t,n);var a=function(v){if(v===o&&p)return p;if(!bf&&v in c)return c[v];switch(v){case UN:return function(){return new r(this,v)};case La:return function(){return new r(this,v)};case WN:return function(){return new r(this,v)}}return function(){return new r(this)}},u=t+" Iterator",l=!1,c=e.prototype,f=c[qa]||c["@@iterator"]||o&&c[o],p=!bf&&f||a(o),d=t==="Array"&&c.entries||f,h,b,y;if(d&&(h=qN(d.call(new e)),h!==Object.prototype&&h.next&&(!yf&&qN(h)!==zN&&(LN?LN(h,zN):DH(h[qa])||uy(h,qa,HN)),FH(h,u,!0,!0),yf&&(BN[u]=HN))),jH&&o===La&&f&&f.name!==La&&(!yf&&qH?$H(c,"name",La):(l=!0,p=function(){return RH(f,this)})),o)if(b={values:a(La),keys:i?p:a(UN),entries:a(WN)},s)for(y in b)(bf||l||!(y in c))&&uy(c,y,b[y]);else NH({target:t,proto:!0,forced:bf||l},b);return(!yf||s)&&c[qa]!==p&&uy(c,qa,p,{name:o}),BN[t]=p,b}});var YN=g((F0e,ZN)=>{"use strict";ZN.exports=function(e,t){return{value:e,done:t}}});var eR=g(($0e,QN)=>{"use strict";var LH=So(),BH=Qg(),zH=dr(),UH=tr(),XN=zH("species");QN.exports=function(e){var t=LH(e);UH&&t&&!t[XN]&&BH(t,XN,{configurable:!0,get:function(){return this}})}});var sR=g((M0e,iR)=>{"use strict";var WH=ja(),HH=Qg(),tR=xN(),KH=Na(),VH=Ug(),GH=Di(),JH=Fa(),ZH=JN(),vf=YN(),YH=eR(),Ba=tr(),rR=Bg().fastKey,oR=Jg(),nR=oR.set,cy=oR.getterFor;iR.exports={getConstructor:function(e,t,r,n){var o=e(function(l,c){VH(l,i),nR(l,{type:t,index:WH(null),first:void 0,last:void 0,size:0}),Ba||(l.size=0),GH(c)||JH(c,l[n],{that:l,AS_ENTRIES:r})}),i=o.prototype,s=cy(t),a=function(l,c,f){var p=s(l),d=u(l,c),h,b;return d?d.value=f:(p.last=d={index:b=rR(c,!0),key:c,value:f,previous:h=p.last,next:void 0,removed:!1},p.first||(p.first=d),h&&(h.next=d),Ba?p.size++:l.size++,b!=="F"&&(p.index[b]=d)),l},u=function(l,c){var f=s(l),p=rR(c),d;if(p!=="F")return f.index[p];for(d=f.first;d;d=d.next)if(d.key===c)return d};return tR(i,{clear:function(){for(var c=this,f=s(c),p=f.index,d=f.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete p[d.index],d=d.next;f.first=f.last=void 0,Ba?f.size=0:c.size=0},delete:function(l){var c=this,f=s(c),p=u(c,l);if(p){var d=p.next,h=p.previous;delete f.index[p.index],p.removed=!0,h&&(h.next=d),d&&(d.previous=h),f.first===p&&(f.first=d),f.last===p&&(f.last=h),Ba?f.size--:c.size--}return!!p},forEach:function(c){for(var f=s(this),p=KH(c,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:f.first;)for(p(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(c){return!!u(this,c)}}),tR(i,r?{get:function(c){var f=u(this,c);return f&&f.value},set:function(c,f){return a(this,c===0?0:c,f)}}:{add:function(c){return a(this,c=c===0?0:c,c)}}),Ba&&HH(i,"size",{configurable:!0,get:function(){return s(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=cy(t),i=cy(n);ZH(e,t,function(s,a){nR(this,{type:n,target:s,state:o(s),kind:a,last:void 0})},function(){for(var s=i(this),a=s.kind,u=s.last;u&&u.removed;)u=u.previous;return!s.target||!(s.last=u=u?u.next:s.state.first)?(s.target=void 0,vf(void 0,!0)):vf(a==="keys"?u.key:a==="values"?u.value:[u.key,u.value],!1)},r?"entries":"values",!r,!0),YH(t)}}});var aR=g(()=>{"use strict";var XH=nN(),QH=sR();XH("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},QH)});var uR=g(()=>{"use strict";aR()});var lR=g((z0e,cR)=>{"use strict";cR.exports=function(e,t){return t===1?function(r,n){return r[e](n)}:function(r,n,o){return r[e](n,o)}}});var dR=g((U0e,pR)=>{"use strict";var eK=So(),xf=lR(),fR=eK("Map");pR.exports={Map:fR,set:xf("set",2),get:xf("get",1),has:xf("has",1),remove:xf("delete",1),proto:fR.prototype}});var mR=g(()=>{"use strict";var tK=Co(),rK=pt(),nK=Io(),oK=Ca(),iK=Fa(),wf=dR(),sK=Oa(),aK=wf.Map,uK=wf.has,cK=wf.get,lK=wf.set,fK=rK([].push);tK({target:"Map",stat:!0,forced:sK},{groupBy:function(t,r){oK(t),nK(r);var n=new aK,o=0;return iK(t,function(i){var s=r(i,o++);uK(n,s)?fK(cK(n,s),i):lK(n,s,[i])}),n}})});var yR=g((K0e,gR)=>{"use strict";uR();mR();var pK=Xr(),dK=Je(),mK=Ta(),hR=mK.Map,hK=hR.groupBy;gR.exports=function(t,r,n){return pK(hK,dK(this)?this:hR,t,r,n)}});var vR=g((V0e,bR)=>{"use strict";var gK=yR();bR.exports=gK});var xR=g(()=>{"use strict";var yK=Co(),bK=tr(),vK=ja();yK({target:"Object",stat:!0,sham:!bK},{create:vK})});var wR=g(()=>{"use strict";var xK=Co(),wK=So(),EK=pt(),SK=Io(),IK=Ca(),_K=ka(),CK=Fa(),TK=wK("Object","create"),OK=EK([].push);xK({target:"Object",stat:!0},{groupBy:function(t,r){IK(t),SK(r);var n=TK(null),o=0;return CK(t,function(i){var s=_K(r(i,o++));s in n?OK(n[s],i):n[s]=[i]}),n}})});var SR=g((X0e,ER)=>{"use strict";xR();wR();var kK=Ta();ER.exports=kK.Object.groupBy});var _R=g((Q0e,IR)=>{"use strict";var AK=SR();IR.exports=AK});var HR=g(WR=>{"use strict";var Li=(S(),wd(lr));function VK(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var GK=typeof Object.is=="function"?Object.is:VK,JK=Li.useState,ZK=Li.useEffect,YK=Li.useLayoutEffect,XK=Li.useDebugValue;function QK(e,t){var r=t(),n=JK({inst:{value:r,getSnapshot:t}}),o=n[0].inst,i=n[1];return YK(function(){o.value=r,o.getSnapshot=t,Oy(o)&&i({inst:o})},[e,r,t]),ZK(function(){return Oy(o)&&i({inst:o}),e(function(){Oy(o)&&i({inst:o})})},[e]),XK(r),r}function Oy(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!GK(e,r)}catch{return!0}}function eV(e,t){return t()}var tV=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?eV:QK;WR.useSyncExternalStore=Li.useSyncExternalStore!==void 0?Li.useSyncExternalStore:tV});var VR=g((EEe,KR)=>{"use strict";KR.exports=HR()});var JR=g(GR=>{"use strict";var Ff=(S(),wd(lr)),rV=VR();function nV(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var oV=typeof Object.is=="function"?Object.is:nV,iV=rV.useSyncExternalStore,sV=Ff.useRef,aV=Ff.useEffect,uV=Ff.useMemo,cV=Ff.useDebugValue;GR.useSyncExternalStoreWithSelector=function(e,t,r,n,o){var i=sV(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=uV(function(){function u(d){if(!l){if(l=!0,c=d,d=n(d),o!==void 0&&s.hasValue){var h=s.value;if(o(h,d))return f=h}return f=d}if(h=f,oV(c,d))return h;var b=n(d);return o!==void 0&&o(h,b)?h:(c=d,f=b)}var l=!1,c,f,p=r===void 0?null:r;return[function(){return u(t())},p===null?void 0:function(){return u(p())}]},[t,r,n,o]);var a=iV(e,i[0],i[1]);return aV(function(){s.hasValue=!0,s.value=a},[a]),cV(a),a}});var YR=g((IEe,ZR)=>{"use strict";ZR.exports=JR()});var Ln=g((mke,on)=>{function ib(){return on.exports=ib=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},on.exports.__esModule=!0,on.exports.default=on.exports,ib.apply(this,arguments)}on.exports=ib,on.exports.__esModule=!0,on.exports.default=on.exports});var ep=g((Kke,sn)=>{function db(e){return sn.exports=db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sn.exports.__esModule=!0,sn.exports.default=sn.exports,db(e)}sn.exports=db,sn.exports.__esModule=!0,sn.exports.default=sn.exports});var XP=g((Vke,su)=>{var YP=ep().default;function JJ(e,t){if(YP(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(YP(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}su.exports=JJ,su.exports.__esModule=!0,su.exports.default=su.exports});var QP=g((Gke,au)=>{var ZJ=ep().default,YJ=XP();function XJ(e){var t=YJ(e,"string");return ZJ(t)==="symbol"?t:String(t)}au.exports=XJ,au.exports.__esModule=!0,au.exports.default=au.exports});var eF=g((Jke,uu)=>{var QJ=QP();function eZ(e,t,r){return t=QJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}uu.exports=eZ,uu.exports.__esModule=!0,uu.exports.default=uu.exports});var tF=g((Zke,cu)=>{function tZ(e){if(Array.isArray(e))return e}cu.exports=tZ,cu.exports.__esModule=!0,cu.exports.default=cu.exports});var rF=g((Yke,lu)=>{function rZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,s,a=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(c){l=!0,o=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}lu.exports=rZ,lu.exports.__esModule=!0,lu.exports.default=lu.exports});var nF=g((Xke,fu)=>{function nZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}fu.exports=nZ,fu.exports.__esModule=!0,fu.exports.default=fu.exports});var iF=g((Qke,pu)=>{var oF=nF();function oZ(e,t){if(e){if(typeof e=="string")return oF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oF(e,t)}}pu.exports=oZ,pu.exports.__esModule=!0,pu.exports.default=pu.exports});var sF=g((eAe,du)=>{function iZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}du.exports=iZ,du.exports.__esModule=!0,du.exports.default=du.exports});var aF=g((tAe,mu)=>{var sZ=tF(),aZ=rF(),uZ=iF(),cZ=sF();function lZ(e,t){return sZ(e)||aZ(e,t)||uZ(e,t)||cZ()}mu.exports=lZ,mu.exports.__esModule=!0,mu.exports.default=mu.exports});var cF=g((tp,uF)=>{"use strict";tp.__esModule=!0;tp.default={scheme:"threezerotwofour",author:"jan t. sott (http://github.com/idleberg)",base00:"#090300",base01:"#3a3432",base02:"#4a4543",base03:"#5c5855",base04:"#807d7c",base05:"#a5a2a2",base06:"#d6d5d4",base07:"#f7f7f7",base08:"#db2d20",base09:"#e8bbd0",base0A:"#fded02",base0B:"#01a252",base0C:"#b5e4f4",base0D:"#01a0e4",base0E:"#a16a94",base0F:"#cdab53"};uF.exports=tp.default});var fF=g((rp,lF)=>{"use strict";rp.__esModule=!0;rp.default={scheme:"apathy",author:"jannik siebert (https://github.com/janniks)",base00:"#031A16",base01:"#0B342D",base02:"#184E45",base03:"#2B685E",base04:"#5F9C92",base05:"#81B5AC",base06:"#A7CEC8",base07:"#D2E7E4",base08:"#3E9688",base09:"#3E7996",base0A:"#3E4C96",base0B:"#883E96",base0C:"#963E4C",base0D:"#96883E",base0E:"#4C963E",base0F:"#3E965B"};lF.exports=rp.default});var dF=g((np,pF)=>{"use strict";np.__esModule=!0;np.default={scheme:"ashes",author:"jannik siebert (https://github.com/janniks)",base00:"#1C2023",base01:"#393F45",base02:"#565E65",base03:"#747C84",base04:"#ADB3BA",base05:"#C7CCD1",base06:"#DFE2E5",base07:"#F3F4F5",base08:"#C7AE95",base09:"#C7C795",base0A:"#AEC795",base0B:"#95C7AE",base0C:"#95AEC7",base0D:"#AE95C7",base0E:"#C795AE",base0F:"#C79595"};pF.exports=np.default});var hF=g((op,mF)=>{"use strict";op.__esModule=!0;op.default={scheme:"atelier dune",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/dune)",base00:"#20201d",base01:"#292824",base02:"#6e6b5e",base03:"#7d7a68",base04:"#999580",base05:"#a6a28c",base06:"#e8e4cf",base07:"#fefbec",base08:"#d73737",base09:"#b65611",base0A:"#cfb017",base0B:"#60ac39",base0C:"#1fad83",base0D:"#6684e1",base0E:"#b854d4",base0F:"#d43552"};mF.exports=op.default});var yF=g((ip,gF)=>{"use strict";ip.__esModule=!0;ip.default={scheme:"atelier forest",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/forest)",base00:"#1b1918",base01:"#2c2421",base02:"#68615e",base03:"#766e6b",base04:"#9c9491",base05:"#a8a19f",base06:"#e6e2e0",base07:"#f1efee",base08:"#f22c40",base09:"#df5320",base0A:"#d5911a",base0B:"#5ab738",base0C:"#00ad9c",base0D:"#407ee7",base0E:"#6666ea",base0F:"#c33ff3"};gF.exports=ip.default});var vF=g((sp,bF)=>{"use strict";sp.__esModule=!0;sp.default={scheme:"atelier heath",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/heath)",base00:"#1b181b",base01:"#292329",base02:"#695d69",base03:"#776977",base04:"#9e8f9e",base05:"#ab9bab",base06:"#d8cad8",base07:"#f7f3f7",base08:"#ca402b",base09:"#a65926",base0A:"#bb8a35",base0B:"#379a37",base0C:"#159393",base0D:"#516aec",base0E:"#7b59c0",base0F:"#cc33cc"};bF.exports=sp.default});var wF=g((ap,xF)=>{"use strict";ap.__esModule=!0;ap.default={scheme:"atelier lakeside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/lakeside/)",base00:"#161b1d",base01:"#1f292e",base02:"#516d7b",base03:"#5a7b8c",base04:"#7195a8",base05:"#7ea2b4",base06:"#c1e4f6",base07:"#ebf8ff",base08:"#d22d72",base09:"#935c25",base0A:"#8a8a0f",base0B:"#568c3b",base0C:"#2d8f6f",base0D:"#257fad",base0E:"#5d5db1",base0F:"#b72dd2"};xF.exports=ap.default});var SF=g((up,EF)=>{"use strict";up.__esModule=!0;up.default={scheme:"atelier seaside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/seaside/)",base00:"#131513",base01:"#242924",base02:"#5e6e5e",base03:"#687d68",base04:"#809980",base05:"#8ca68c",base06:"#cfe8cf",base07:"#f0fff0",base08:"#e6193c",base09:"#87711d",base0A:"#c3c322",base0B:"#29a329",base0C:"#1999b3",base0D:"#3d62f5",base0E:"#ad2bee",base0F:"#e619c3"};EF.exports=up.default});var _F=g((cp,IF)=>{"use strict";cp.__esModule=!0;cp.default={scheme:"bespin",author:"jan t. sott",base00:"#28211c",base01:"#36312e",base02:"#5e5d5c",base03:"#666666",base04:"#797977",base05:"#8a8986",base06:"#9d9b97",base07:"#baae9e",base08:"#cf6a4c",base09:"#cf7d34",base0A:"#f9ee98",base0B:"#54be0d",base0C:"#afc4db",base0D:"#5ea6ea",base0E:"#9b859d",base0F:"#937121"};IF.exports=cp.default});var TF=g((lp,CF)=>{"use strict";lp.__esModule=!0;lp.default={scheme:"brewer",author:"timoth\xE9e poisot (http://github.com/tpoisot)",base00:"#0c0d0e",base01:"#2e2f30",base02:"#515253",base03:"#737475",base04:"#959697",base05:"#b7b8b9",base06:"#dadbdc",base07:"#fcfdfe",base08:"#e31a1c",base09:"#e6550d",base0A:"#dca060",base0B:"#31a354",base0C:"#80b1d3",base0D:"#3182bd",base0E:"#756bb1",base0F:"#b15928"};CF.exports=lp.default});var kF=g((fp,OF)=>{"use strict";fp.__esModule=!0;fp.default={scheme:"bright",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#303030",base02:"#505050",base03:"#b0b0b0",base04:"#d0d0d0",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ffffff",base08:"#fb0120",base09:"#fc6d24",base0A:"#fda331",base0B:"#a1c659",base0C:"#76c7b7",base0D:"#6fb3d2",base0E:"#d381c3",base0F:"#be643c"};OF.exports=fp.default});var NF=g((pp,AF)=>{"use strict";pp.__esModule=!0;pp.default={scheme:"chalk",author:"chris kempson (http://chriskempson.com)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#f5f5f5",base08:"#fb9fb1",base09:"#eda987",base0A:"#ddb26f",base0B:"#acc267",base0C:"#12cfc0",base0D:"#6fc2ef",base0E:"#e1a3ee",base0F:"#deaf8f"};AF.exports=pp.default});var DF=g((dp,RF)=>{"use strict";dp.__esModule=!0;dp.default={scheme:"codeschool",author:"brettof86",base00:"#232c31",base01:"#1c3657",base02:"#2a343a",base03:"#3f4944",base04:"#84898c",base05:"#9ea7a6",base06:"#a7cfa3",base07:"#b5d8f6",base08:"#2a5491",base09:"#43820d",base0A:"#a03b1e",base0B:"#237986",base0C:"#b02f30",base0D:"#484d79",base0E:"#c59820",base0F:"#c98344"};RF.exports=dp.default});var FF=g((mp,PF)=>{"use strict";mp.__esModule=!0;mp.default={scheme:"colors",author:"mrmrs (http://clrs.cc)",base00:"#111111",base01:"#333333",base02:"#555555",base03:"#777777",base04:"#999999",base05:"#bbbbbb",base06:"#dddddd",base07:"#ffffff",base08:"#ff4136",base09:"#ff851b",base0A:"#ffdc00",base0B:"#2ecc40",base0C:"#7fdbff",base0D:"#0074d9",base0E:"#b10dc9",base0F:"#85144b"};PF.exports=mp.default});var MF=g((hp,$F)=>{"use strict";hp.__esModule=!0;hp.default={scheme:"default",author:"chris kempson (http://chriskempson.com)",base00:"#181818",base01:"#282828",base02:"#383838",base03:"#585858",base04:"#b8b8b8",base05:"#d8d8d8",base06:"#e8e8e8",base07:"#f8f8f8",base08:"#ab4642",base09:"#dc9656",base0A:"#f7ca88",base0B:"#a1b56c",base0C:"#86c1b9",base0D:"#7cafc2",base0E:"#ba8baf",base0F:"#a16946"};$F.exports=hp.default});var qF=g((gp,jF)=>{"use strict";gp.__esModule=!0;gp.default={scheme:"eighties",author:"chris kempson (http://chriskempson.com)",base00:"#2d2d2d",base01:"#393939",base02:"#515151",base03:"#747369",base04:"#a09f93",base05:"#d3d0c8",base06:"#e8e6df",base07:"#f2f0ec",base08:"#f2777a",base09:"#f99157",base0A:"#ffcc66",base0B:"#99cc99",base0C:"#66cccc",base0D:"#6699cc",base0E:"#cc99cc",base0F:"#d27b53"};jF.exports=gp.default});var BF=g((yp,LF)=>{"use strict";yp.__esModule=!0;yp.default={scheme:"embers",author:"jannik siebert (https://github.com/janniks)",base00:"#16130F",base01:"#2C2620",base02:"#433B32",base03:"#5A5047",base04:"#8A8075",base05:"#A39A90",base06:"#BEB6AE",base07:"#DBD6D1",base08:"#826D57",base09:"#828257",base0A:"#6D8257",base0B:"#57826D",base0C:"#576D82",base0D:"#6D5782",base0E:"#82576D",base0F:"#825757"};LF.exports=yp.default});var UF=g((bp,zF)=>{"use strict";bp.__esModule=!0;bp.default={scheme:"flat",author:"chris kempson (http://chriskempson.com)",base00:"#2C3E50",base01:"#34495E",base02:"#7F8C8D",base03:"#95A5A6",base04:"#BDC3C7",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ECF0F1",base08:"#E74C3C",base09:"#E67E22",base0A:"#F1C40F",base0B:"#2ECC71",base0C:"#1ABC9C",base0D:"#3498DB",base0E:"#9B59B6",base0F:"#be643c"};zF.exports=bp.default});var HF=g((vp,WF)=>{"use strict";vp.__esModule=!0;vp.default={scheme:"google",author:"seth wright (http://sethawright.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#CC342B",base09:"#F96A38",base0A:"#FBA922",base0B:"#198844",base0C:"#3971ED",base0D:"#3971ED",base0E:"#A36AC7",base0F:"#3971ED"};WF.exports=vp.default});var VF=g((xp,KF)=>{"use strict";xp.__esModule=!0;xp.default={scheme:"grayscale",author:"alexandre gavioli (https://github.com/alexx2/)",base00:"#101010",base01:"#252525",base02:"#464646",base03:"#525252",base04:"#ababab",base05:"#b9b9b9",base06:"#e3e3e3",base07:"#f7f7f7",base08:"#7c7c7c",base09:"#999999",base0A:"#a0a0a0",base0B:"#8e8e8e",base0C:"#868686",base0D:"#686868",base0E:"#747474",base0F:"#5e5e5e"};KF.exports=xp.default});var JF=g((wp,GF)=>{"use strict";wp.__esModule=!0;wp.default={scheme:"green screen",author:"chris kempson (http://chriskempson.com)",base00:"#001100",base01:"#003300",base02:"#005500",base03:"#007700",base04:"#009900",base05:"#00bb00",base06:"#00dd00",base07:"#00ff00",base08:"#007700",base09:"#009900",base0A:"#007700",base0B:"#00bb00",base0C:"#005500",base0D:"#009900",base0E:"#00bb00",base0F:"#005500"};GF.exports=wp.default});var YF=g((Ep,ZF)=>{"use strict";Ep.__esModule=!0;Ep.default={scheme:"harmonic16",author:"jannik siebert (https://github.com/janniks)",base00:"#0b1c2c",base01:"#223b54",base02:"#405c79",base03:"#627e99",base04:"#aabcce",base05:"#cbd6e2",base06:"#e5ebf1",base07:"#f7f9fb",base08:"#bf8b56",base09:"#bfbf56",base0A:"#8bbf56",base0B:"#56bf8b",base0C:"#568bbf",base0D:"#8b56bf",base0E:"#bf568b",base0F:"#bf5656"};ZF.exports=Ep.default});var QF=g((Sp,XF)=>{"use strict";Sp.__esModule=!0;Sp.default={scheme:"hopscotch",author:"jan t. sott",base00:"#322931",base01:"#433b42",base02:"#5c545b",base03:"#797379",base04:"#989498",base05:"#b9b5b8",base06:"#d5d3d5",base07:"#ffffff",base08:"#dd464c",base09:"#fd8b19",base0A:"#fdcc59",base0B:"#8fc13e",base0C:"#149b93",base0D:"#1290bf",base0E:"#c85e7c",base0F:"#b33508"};XF.exports=Sp.default});var t$=g((Ip,e$)=>{"use strict";Ip.__esModule=!0;Ip.default={scheme:"isotope",author:"jan t. sott",base00:"#000000",base01:"#404040",base02:"#606060",base03:"#808080",base04:"#c0c0c0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#ff0000",base09:"#ff9900",base0A:"#ff0099",base0B:"#33ff00",base0C:"#00ffff",base0D:"#0066ff",base0E:"#cc00ff",base0F:"#3300ff"};e$.exports=Ip.default});var n$=g((_p,r$)=>{"use strict";_p.__esModule=!0;_p.default={scheme:"marrakesh",author:"alexandre gavioli (http://github.com/alexx2/)",base00:"#201602",base01:"#302e00",base02:"#5f5b17",base03:"#6c6823",base04:"#86813b",base05:"#948e48",base06:"#ccc37a",base07:"#faf0a5",base08:"#c35359",base09:"#b36144",base0A:"#a88339",base0B:"#18974e",base0C:"#75a738",base0D:"#477ca1",base0E:"#8868b3",base0F:"#b3588e"};r$.exports=_p.default});var i$=g((Cp,o$)=>{"use strict";Cp.__esModule=!0;Cp.default={scheme:"mocha",author:"chris kempson (http://chriskempson.com)",base00:"#3B3228",base01:"#534636",base02:"#645240",base03:"#7e705a",base04:"#b8afad",base05:"#d0c8c6",base06:"#e9e1dd",base07:"#f5eeeb",base08:"#cb6077",base09:"#d28b71",base0A:"#f4bc87",base0B:"#beb55b",base0C:"#7bbda4",base0D:"#8ab3b5",base0E:"#a89bb9",base0F:"#bb9584"};o$.exports=Cp.default});var a$=g((Tp,s$)=>{"use strict";Tp.__esModule=!0;Tp.default={scheme:"monokai",author:"wimer hazenberg (http://www.monokai.nl)",base00:"#272822",base01:"#383830",base02:"#49483e",base03:"#75715e",base04:"#a59f85",base05:"#f8f8f2",base06:"#f5f4f1",base07:"#f9f8f5",base08:"#f92672",base09:"#fd971f",base0A:"#f4bf75",base0B:"#a6e22e",base0C:"#a1efe4",base0D:"#66d9ef",base0E:"#ae81ff",base0F:"#cc6633"};s$.exports=Tp.default});var c$=g((Op,u$)=>{"use strict";Op.__esModule=!0;Op.default={scheme:"ocean",author:"chris kempson (http://chriskempson.com)",base00:"#2b303b",base01:"#343d46",base02:"#4f5b66",base03:"#65737e",base04:"#a7adba",base05:"#c0c5ce",base06:"#dfe1e8",base07:"#eff1f5",base08:"#bf616a",base09:"#d08770",base0A:"#ebcb8b",base0B:"#a3be8c",base0C:"#96b5b4",base0D:"#8fa1b3",base0E:"#b48ead",base0F:"#ab7967"};u$.exports=Op.default});var f$=g((kp,l$)=>{"use strict";kp.__esModule=!0;kp.default={scheme:"paraiso",author:"jan t. sott",base00:"#2f1e2e",base01:"#41323f",base02:"#4f424c",base03:"#776e71",base04:"#8d8687",base05:"#a39e9b",base06:"#b9b6b0",base07:"#e7e9db",base08:"#ef6155",base09:"#f99b15",base0A:"#fec418",base0B:"#48b685",base0C:"#5bc4bf",base0D:"#06b6ef",base0E:"#815ba4",base0F:"#e96ba8"};l$.exports=kp.default});var d$=g((Ap,p$)=>{"use strict";Ap.__esModule=!0;Ap.default={scheme:"pop",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#eb008a",base09:"#f29333",base0A:"#f8ca12",base0B:"#37b349",base0C:"#00aabb",base0D:"#0e5a94",base0E:"#b31e8d",base0F:"#7a2d00"};p$.exports=Ap.default});var h$=g((Np,m$)=>{"use strict";Np.__esModule=!0;Np.default={scheme:"railscasts",author:"ryan bates (http://railscasts.com)",base00:"#2b2b2b",base01:"#272935",base02:"#3a4055",base03:"#5a647e",base04:"#d4cfc9",base05:"#e6e1dc",base06:"#f4f1ed",base07:"#f9f7f3",base08:"#da4939",base09:"#cc7833",base0A:"#ffc66d",base0B:"#a5c261",base0C:"#519f50",base0D:"#6d9cbe",base0E:"#b6b3eb",base0F:"#bc9458"};m$.exports=Np.default});var y$=g((Rp,g$)=>{"use strict";Rp.__esModule=!0;Rp.default={scheme:"shapeshifter",author:"tyler benziger (http://tybenz.com)",base00:"#000000",base01:"#040404",base02:"#102015",base03:"#343434",base04:"#555555",base05:"#ababab",base06:"#e0e0e0",base07:"#f9f9f9",base08:"#e92f2f",base09:"#e09448",base0A:"#dddd13",base0B:"#0ed839",base0C:"#23edda",base0D:"#3b48e3",base0E:"#f996e2",base0F:"#69542d"};g$.exports=Rp.default});var v$=g((Dp,b$)=>{"use strict";Dp.__esModule=!0;Dp.default={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"};b$.exports=Dp.default});var w$=g((Pp,x$)=>{"use strict";Pp.__esModule=!0;Pp.default={scheme:"summerfruit",author:"christopher corley (http://cscorley.github.io/)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#B0B0B0",base05:"#D0D0D0",base06:"#E0E0E0",base07:"#FFFFFF",base08:"#FF0086",base09:"#FD8900",base0A:"#ABA800",base0B:"#00C918",base0C:"#1faaaa",base0D:"#3777E6",base0E:"#AD00A1",base0F:"#cc6633"};x$.exports=Pp.default});var S$=g((Fp,E$)=>{"use strict";Fp.__esModule=!0;Fp.default={scheme:"tomorrow",author:"chris kempson (http://chriskempson.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#cc6666",base09:"#de935f",base0A:"#f0c674",base0B:"#b5bd68",base0C:"#8abeb7",base0D:"#81a2be",base0E:"#b294bb",base0F:"#a3685a"};E$.exports=Fp.default});var _$=g(($p,I$)=>{"use strict";$p.__esModule=!0;$p.default={scheme:"london tube",author:"jan t. sott",base00:"#231f20",base01:"#1c3f95",base02:"#5a5758",base03:"#737171",base04:"#959ca1",base05:"#d9d8d8",base06:"#e7e7e8",base07:"#ffffff",base08:"#ee2e24",base09:"#f386a1",base0A:"#ffd204",base0B:"#00853e",base0C:"#85cebc",base0D:"#009ddc",base0E:"#98005d",base0F:"#b06110"};I$.exports=$p.default});var T$=g((Mp,C$)=>{"use strict";Mp.__esModule=!0;Mp.default={scheme:"twilight",author:"david hart (http://hart-dev.com)",base00:"#1e1e1e",base01:"#323537",base02:"#464b50",base03:"#5f5a60",base04:"#838184",base05:"#a7a7a7",base06:"#c3c3c3",base07:"#ffffff",base08:"#cf6a4c",base09:"#cda869",base0A:"#f9ee98",base0B:"#8f9d6a",base0C:"#afc4db",base0D:"#7587a6",base0E:"#9b859d",base0F:"#9b703f"};C$.exports=Mp.default});var O$=g(ie=>{"use strict";ie.__esModule=!0;function se(e){return e&&e.__esModule?e.default:e}var fZ=cF();ie.threezerotwofour=se(fZ);var pZ=fF();ie.apathy=se(pZ);var dZ=dF();ie.ashes=se(dZ);var mZ=hF();ie.atelierDune=se(mZ);var hZ=yF();ie.atelierForest=se(hZ);var gZ=vF();ie.atelierHeath=se(gZ);var yZ=wF();ie.atelierLakeside=se(yZ);var bZ=SF();ie.atelierSeaside=se(bZ);var vZ=_F();ie.bespin=se(vZ);var xZ=TF();ie.brewer=se(xZ);var wZ=kF();ie.bright=se(wZ);var EZ=NF();ie.chalk=se(EZ);var SZ=DF();ie.codeschool=se(SZ);var IZ=FF();ie.colors=se(IZ);var _Z=MF();ie.default=se(_Z);var CZ=qF();ie.eighties=se(CZ);var TZ=BF();ie.embers=se(TZ);var OZ=UF();ie.flat=se(OZ);var kZ=HF();ie.google=se(kZ);var AZ=VF();ie.grayscale=se(AZ);var NZ=JF();ie.greenscreen=se(NZ);var RZ=YF();ie.harmonic=se(RZ);var DZ=QF();ie.hopscotch=se(DZ);var PZ=t$();ie.isotope=se(PZ);var FZ=n$();ie.marrakesh=se(FZ);var $Z=i$();ie.mocha=se($Z);var MZ=a$();ie.monokai=se(MZ);var jZ=c$();ie.ocean=se(jZ);var qZ=f$();ie.paraiso=se(qZ);var LZ=d$();ie.pop=se(LZ);var BZ=h$();ie.railscasts=se(BZ);var zZ=y$();ie.shapeshifter=se(zZ);var UZ=v$();ie.solarized=se(UZ);var WZ=w$();ie.summerfruit=se(WZ);var HZ=S$();ie.tomorrow=se(HZ);var KZ=_$();ie.tube=se(KZ);var VZ=T$();ie.twilight=se(VZ)});var A$=g((nAe,k$)=>{"use strict";k$.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var R$=g((oAe,N$)=>{N$.exports=function(t){return!t||typeof t=="string"?!1:t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&t.constructor.name!=="String")}});var F$=g((iAe,P$)=>{"use strict";var GZ=R$(),JZ=Array.prototype.concat,ZZ=Array.prototype.slice,D$=P$.exports=function(t){for(var r=[],n=0,o=t.length;n<o;n++){var i=t[n];GZ(i)?r=JZ.call(r,ZZ.call(i)):r.push(i)}return r};D$.wrap=function(e){return function(){return e(D$(arguments))}}});var q$=g((sAe,j$)=>{var hu=A$(),gu=F$(),$$=Object.hasOwnProperty,M$=Object.create(null);for(jp in hu)$$.call(hu,jp)&&(M$[hu[jp]]=jp);var jp,Mt=j$.exports={to:{},get:{}};Mt.get=function(e){var t=e.substring(0,3).toLowerCase(),r,n;switch(t){case"hsl":r=Mt.get.hsl(e),n="hsl";break;case"hwb":r=Mt.get.hwb(e),n="hwb";break;default:r=Mt.get.rgb(e),n="rgb";break}return r?{model:n,value:r}:null};Mt.get.rgb=function(e){if(!e)return null;var t=/^#([a-f0-9]{3,4})$/i,r=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,n=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,o=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,i=/^(\w+)$/,s=[0,0,0,1],a,u,l;if(a=e.match(r)){for(l=a[2],a=a[1],u=0;u<3;u++){var c=u*2;s[u]=parseInt(a.slice(c,c+2),16)}l&&(s[3]=parseInt(l,16)/255)}else if(a=e.match(t)){for(a=a[1],l=a[3],u=0;u<3;u++)s[u]=parseInt(a[u]+a[u],16);l&&(s[3]=parseInt(l+l,16)/255)}else if(a=e.match(n)){for(u=0;u<3;u++)s[u]=parseInt(a[u+1],0);a[4]&&(a[5]?s[3]=parseFloat(a[4])*.01:s[3]=parseFloat(a[4]))}else if(a=e.match(o)){for(u=0;u<3;u++)s[u]=Math.round(parseFloat(a[u+1])*2.55);a[4]&&(a[5]?s[3]=parseFloat(a[4])*.01:s[3]=parseFloat(a[4]))}else return(a=e.match(i))?a[1]==="transparent"?[0,0,0,0]:$$.call(hu,a[1])?(s=hu[a[1]],s[3]=1,s):null:null;for(u=0;u<3;u++)s[u]=zn(s[u],0,255);return s[3]=zn(s[3],0,1),s};Mt.get.hsl=function(e){if(!e)return null;var t=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,r=e.match(t);if(r){var n=parseFloat(r[4]),o=(parseFloat(r[1])%360+360)%360,i=zn(parseFloat(r[2]),0,100),s=zn(parseFloat(r[3]),0,100),a=zn(isNaN(n)?1:n,0,1);return[o,i,s,a]}return null};Mt.get.hwb=function(e){if(!e)return null;var t=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,r=e.match(t);if(r){var n=parseFloat(r[4]),o=(parseFloat(r[1])%360+360)%360,i=zn(parseFloat(r[2]),0,100),s=zn(parseFloat(r[3]),0,100),a=zn(isNaN(n)?1:n,0,1);return[o,i,s,a]}return null};Mt.to.hex=function(){var e=gu(arguments);return"#"+qp(e[0])+qp(e[1])+qp(e[2])+(e[3]<1?qp(Math.round(e[3]*255)):"")};Mt.to.rgb=function(){var e=gu(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"};Mt.to.rgb.percent=function(){var e=gu(arguments),t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),n=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+t+"%, "+r+"%, "+n+"%)":"rgba("+t+"%, "+r+"%, "+n+"%, "+e[3]+")"};Mt.to.hsl=function(){var e=gu(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"};Mt.to.hwb=function(){var e=gu(arguments),t="";return e.length>=4&&e[3]!==1&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"};Mt.to.keyword=function(e){return M$[e.slice(0,3)]};function zn(e,t,r){return Math.min(Math.max(t,e),r)}function qp(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}});var B$=g((aAe,L$)=>{"use strict";L$.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var mb=g((uAe,H$)=>{var jo=B$(),W$={};for(Lp in jo)jo.hasOwnProperty(Lp)&&(W$[jo[Lp]]=Lp);var Lp,q=H$.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(mt in q)if(q.hasOwnProperty(mt)){if(!("channels"in q[mt]))throw new Error("missing channels property: "+mt);if(!("labels"in q[mt]))throw new Error("missing channel labels property: "+mt);if(q[mt].labels.length!==q[mt].channels)throw new Error("channel and label counts mismatch: "+mt);z$=q[mt].channels,U$=q[mt].labels,delete q[mt].channels,delete q[mt].labels,Object.defineProperty(q[mt],"channels",{value:z$}),Object.defineProperty(q[mt],"labels",{value:U$})}var z$,U$,mt;q.rgb.hsl=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,o=Math.min(t,r,n),i=Math.max(t,r,n),s=i-o,a,u,l;return i===o?a=0:t===i?a=(r-n)/s:r===i?a=2+(n-t)/s:n===i&&(a=4+(t-r)/s),a=Math.min(a*60,360),a<0&&(a+=360),l=(o+i)/2,i===o?u=0:l<=.5?u=s/(i+o):u=s/(2-i-o),[a,u*100,l*100]};q.rgb.hsv=function(e){var t,r,n,o,i,s=e[0]/255,a=e[1]/255,u=e[2]/255,l=Math.max(s,a,u),c=l-Math.min(s,a,u),f=function(p){return(l-p)/6/c+1/2};return c===0?o=i=0:(i=c/l,t=f(s),r=f(a),n=f(u),s===l?o=n-r:a===l?o=1/3+t-n:u===l&&(o=2/3+r-t),o<0?o+=1:o>1&&(o-=1)),[o*360,i*100,l*100]};q.rgb.hwb=function(e){var t=e[0],r=e[1],n=e[2],o=q.rgb.hsl(e)[0],i=1/255*Math.min(t,Math.min(r,n));return n=1-1/255*Math.max(t,Math.max(r,n)),[o,i*100,n*100]};q.rgb.cmyk=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,o,i,s,a;return a=Math.min(1-t,1-r,1-n),o=(1-t-a)/(1-a)||0,i=(1-r-a)/(1-a)||0,s=(1-n-a)/(1-a)||0,[o*100,i*100,s*100,a*100]};function YZ(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2)}q.rgb.keyword=function(e){var t=W$[e];if(t)return t;var r=1/0,n;for(var o in jo)if(jo.hasOwnProperty(o)){var i=jo[o],s=YZ(e,i);s<r&&(r=s,n=o)}return n};q.keyword.rgb=function(e){return jo[e]};q.rgb.xyz=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;var o=t*.4124+r*.3576+n*.1805,i=t*.2126+r*.7152+n*.0722,s=t*.0193+r*.1192+n*.9505;return[o*100,i*100,s*100]};q.rgb.lab=function(e){var t=q.rgb.xyz(e),r=t[0],n=t[1],o=t[2],i,s,a;return r/=95.047,n/=100,o/=108.883,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,i=116*n-16,s=500*(r-n),a=200*(n-o),[i,s,a]};q.hsl.rgb=function(e){var t=e[0]/360,r=e[1]/100,n=e[2]/100,o,i,s,a,u;if(r===0)return u=n*255,[u,u,u];n<.5?i=n*(1+r):i=n+r-n*r,o=2*n-i,a=[0,0,0];for(var l=0;l<3;l++)s=t+1/3*-(l-1),s<0&&s++,s>1&&s--,6*s<1?u=o+(i-o)*6*s:2*s<1?u=i:3*s<2?u=o+(i-o)*(2/3-s)*6:u=o,a[l]=u*255;return a};q.hsl.hsv=function(e){var t=e[0],r=e[1]/100,n=e[2]/100,o=r,i=Math.max(n,.01),s,a;return n*=2,r*=n<=1?n:2-n,o*=i<=1?i:2-i,a=(n+r)/2,s=n===0?2*o/(i+o):2*r/(n+r),[t,s*100,a*100]};q.hsv.rgb=function(e){var t=e[0]/60,r=e[1]/100,n=e[2]/100,o=Math.floor(t)%6,i=t-Math.floor(t),s=255*n*(1-r),a=255*n*(1-r*i),u=255*n*(1-r*(1-i));switch(n*=255,o){case 0:return[n,u,s];case 1:return[a,n,s];case 2:return[s,n,u];case 3:return[s,a,n];case 4:return[u,s,n];case 5:return[n,s,a]}};q.hsv.hsl=function(e){var t=e[0],r=e[1]/100,n=e[2]/100,o=Math.max(n,.01),i,s,a;return a=(2-r)*n,i=(2-r)*o,s=r*o,s/=i<=1?i:2-i,s=s||0,a/=2,[t,s*100,a*100]};q.hwb.rgb=function(e){var t=e[0]/360,r=e[1]/100,n=e[2]/100,o=r+n,i,s,a,u;o>1&&(r/=o,n/=o),i=Math.floor(6*t),s=1-n,a=6*t-i,i&1&&(a=1-a),u=r+a*(s-r);var l,c,f;switch(i){default:case 6:case 0:l=s,c=u,f=r;break;case 1:l=u,c=s,f=r;break;case 2:l=r,c=s,f=u;break;case 3:l=r,c=u,f=s;break;case 4:l=u,c=r,f=s;break;case 5:l=s,c=r,f=u;break}return[l*255,c*255,f*255]};q.cmyk.rgb=function(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,o=e[3]/100,i,s,a;return i=1-Math.min(1,t*(1-o)+o),s=1-Math.min(1,r*(1-o)+o),a=1-Math.min(1,n*(1-o)+o),[i*255,s*255,a*255]};q.xyz.rgb=function(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,o,i,s;return o=t*3.2406+r*-1.5372+n*-.4986,i=t*-.9689+r*1.8758+n*.0415,s=t*.0557+r*-.204+n*1.057,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o*12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*12.92,o=Math.min(Math.max(0,o),1),i=Math.min(Math.max(0,i),1),s=Math.min(Math.max(0,s),1),[o*255,i*255,s*255]};q.xyz.lab=function(e){var t=e[0],r=e[1],n=e[2],o,i,s;return t/=95.047,r/=100,n/=108.883,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,o=116*r-16,i=500*(t-r),s=200*(r-n),[o,i,s]};q.lab.xyz=function(e){var t=e[0],r=e[1],n=e[2],o,i,s;i=(t+16)/116,o=r/500+i,s=i-n/200;var a=Math.pow(i,3),u=Math.pow(o,3),l=Math.pow(s,3);return i=a>.008856?a:(i-16/116)/7.787,o=u>.008856?u:(o-16/116)/7.787,s=l>.008856?l:(s-16/116)/7.787,o*=95.047,i*=100,s*=108.883,[o,i,s]};q.lab.lch=function(e){var t=e[0],r=e[1],n=e[2],o,i,s;return o=Math.atan2(n,r),i=o*360/2/Math.PI,i<0&&(i+=360),s=Math.sqrt(r*r+n*n),[t,s,i]};q.lch.lab=function(e){var t=e[0],r=e[1],n=e[2],o,i,s;return s=n/360*2*Math.PI,o=r*Math.cos(s),i=r*Math.sin(s),[t,o,i]};q.rgb.ansi16=function(e){var t=e[0],r=e[1],n=e[2],o=1 in arguments?arguments[1]:q.rgb.hsv(e)[2];if(o=Math.round(o/50),o===0)return 30;var i=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(t/255));return o===2&&(i+=60),i};q.hsv.ansi16=function(e){return q.rgb.ansi16(q.hsv.rgb(e),e[2])};q.rgb.ansi256=function(e){var t=e[0],r=e[1],n=e[2];if(t===r&&r===n)return t<8?16:t>248?231:Math.round((t-8)/247*24)+232;var o=16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5);return o};q.ansi16.rgb=function(e){var t=e%10;if(t===0||t===7)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];var r=(~~(e>50)+1)*.5,n=(t&1)*r*255,o=(t>>1&1)*r*255,i=(t>>2&1)*r*255;return[n,o,i]};q.ansi256.rgb=function(e){if(e>=232){var t=(e-232)*10+8;return[t,t,t]}e-=16;var r,n=Math.floor(e/36)/5*255,o=Math.floor((r=e%36)/6)/5*255,i=r%6/5*255;return[n,o,i]};q.rgb.hex=function(e){var t=((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255),r=t.toString(16).toUpperCase();return"000000".substring(r.length)+r};q.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var r=t[0];t[0].length===3&&(r=r.split("").map(function(a){return a+a}).join(""));var n=parseInt(r,16),o=n>>16&255,i=n>>8&255,s=n&255;return[o,i,s]};q.rgb.hcg=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,o=Math.max(Math.max(t,r),n),i=Math.min(Math.min(t,r),n),s=o-i,a,u;return s<1?a=i/(1-s):a=0,s<=0?u=0:o===t?u=(r-n)/s%6:o===r?u=2+(n-t)/s:u=4+(t-r)/s+4,u/=6,u%=1,[u*360,s*100,a*100]};q.hsl.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=1,o=0;return r<.5?n=2*t*r:n=2*t*(1-r),n<1&&(o=(r-.5*n)/(1-n)),[e[0],n*100,o*100]};q.hsv.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=t*r,o=0;return n<1&&(o=(r-n)/(1-n)),[e[0],n*100,o*100]};q.hcg.rgb=function(e){var t=e[0]/360,r=e[1]/100,n=e[2]/100;if(r===0)return[n*255,n*255,n*255];var o=[0,0,0],i=t%1*6,s=i%1,a=1-s,u=0;switch(Math.floor(i)){case 0:o[0]=1,o[1]=s,o[2]=0;break;case 1:o[0]=a,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=s;break;case 3:o[0]=0,o[1]=a,o[2]=1;break;case 4:o[0]=s,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=a}return u=(1-r)*n,[(r*o[0]+u)*255,(r*o[1]+u)*255,(r*o[2]+u)*255]};q.hcg.hsv=function(e){var t=e[1]/100,r=e[2]/100,n=t+r*(1-t),o=0;return n>0&&(o=t/n),[e[0],o*100,n*100]};q.hcg.hsl=function(e){var t=e[1]/100,r=e[2]/100,n=r*(1-t)+.5*t,o=0;return n>0&&n<.5?o=t/(2*n):n>=.5&&n<1&&(o=t/(2*(1-n))),[e[0],o*100,n*100]};q.hcg.hwb=function(e){var t=e[1]/100,r=e[2]/100,n=t+r*(1-t);return[e[0],(n-t)*100,(1-n)*100]};q.hwb.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=1-r,o=n-t,i=0;return o<1&&(i=(n-o)/(1-o)),[e[0],o*100,i*100]};q.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};q.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};q.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};q.gray.hsl=q.gray.hsv=function(e){return[0,0,e[0]]};q.gray.hwb=function(e){return[0,100,e[0]]};q.gray.cmyk=function(e){return[0,0,0,e[0]]};q.gray.lab=function(e){return[e[0],0,0]};q.gray.hex=function(e){var t=Math.round(e[0]/100*255)&255,r=(t<<16)+(t<<8)+t,n=r.toString(16).toUpperCase();return"000000".substring(n.length)+n};q.rgb.gray=function(e){var t=(e[0]+e[1]+e[2])/3;return[t/255*100]}});var V$=g((cAe,K$)=>{var Bp=mb();function XZ(){for(var e={},t=Object.keys(Bp),r=t.length,n=0;n<r;n++)e[t[n]]={distance:-1,parent:null};return e}function QZ(e){var t=XZ(),r=[e];for(t[e].distance=0;r.length;)for(var n=r.pop(),o=Object.keys(Bp[n]),i=o.length,s=0;s<i;s++){var a=o[s],u=t[a];u.distance===-1&&(u.distance=t[n].distance+1,u.parent=n,r.unshift(a))}return t}function eY(e,t){return function(r){return t(e(r))}}function tY(e,t){for(var r=[t[e].parent,e],n=Bp[t[e].parent][e],o=t[e].parent;t[o].parent;)r.unshift(t[o].parent),n=eY(Bp[t[o].parent][o],n),o=t[o].parent;return n.conversion=r,n}K$.exports=function(e){for(var t=QZ(e),r={},n=Object.keys(t),o=n.length,i=0;i<o;i++){var s=n[i],a=t[s];a.parent!==null&&(r[s]=tY(s,t))}return r}});var J$=g((lAe,G$)=>{var hb=mb(),rY=V$(),Gi={},nY=Object.keys(hb);function oY(e){var t=function(r){return r==null?r:(arguments.length>1&&(r=Array.prototype.slice.call(arguments)),e(r))};return"conversion"in e&&(t.conversion=e.conversion),t}function iY(e){var t=function(r){if(r==null)return r;arguments.length>1&&(r=Array.prototype.slice.call(arguments));var n=e(r);if(typeof n=="object")for(var o=n.length,i=0;i<o;i++)n[i]=Math.round(n[i]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}nY.forEach(function(e){Gi[e]={},Object.defineProperty(Gi[e],"channels",{value:hb[e].channels}),Object.defineProperty(Gi[e],"labels",{value:hb[e].labels});var t=rY(e),r=Object.keys(t);r.forEach(function(n){var o=t[n];Gi[e][n]=iY(o),Gi[e][n].raw=oY(o)})});G$.exports=Gi});var X$=g((fAe,Y$)=>{"use strict";var yu=q$(),jt=J$(),bb=[].slice,Z$=["keyword","gray","hex"],gb={};Object.keys(jt).forEach(function(e){gb[bb.call(jt[e].labels).sort().join("")]=e});var zp={};function tt(e,t){if(!(this instanceof tt))return new tt(e,t);if(t&&t in Z$&&(t=null),t&&!(t in jt))throw new Error("Unknown model: "+t);var r,n;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof tt)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if(typeof e=="string"){var o=yu.get(e);if(o===null)throw new Error("Unable to parse color from string: "+e);this.model=o.model,n=jt[this.model].channels,this.color=o.value.slice(0,n),this.valpha=typeof o.value[n]=="number"?o.value[n]:1}else if(e.length){this.model=t||"rgb",n=jt[this.model].channels;var i=bb.call(e,0,n);this.color=yb(i,n),this.valpha=typeof e[n]=="number"?e[n]:1}else if(typeof e=="number")e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,e&255],this.valpha=1;else{this.valpha=1;var s=Object.keys(e);"alpha"in e&&(s.splice(s.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);var a=s.sort().join("");if(!(a in gb))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=gb[a];var u=jt[this.model].labels,l=[];for(r=0;r<u.length;r++)l.push(e[u[r]]);this.color=yb(l)}if(zp[this.model])for(n=jt[this.model].channels,r=0;r<n;r++){var c=zp[this.model][r];c&&(this.color[r]=c(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}tt.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in yu.to?this:this.rgb();t=t.round(typeof e=="number"?e:1);var r=t.valpha===1?t.color:t.color.concat(this.valpha);return yu.to[t.model](r)},percentString:function(e){var t=this.rgb().round(typeof e=="number"?e:1),r=t.valpha===1?t.color:t.color.concat(this.valpha);return yu.to.rgb.percent(r)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=jt[this.model].channels,r=jt[this.model].labels,n=0;n<t;n++)e[r[n]]=this.color[n];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new tt(this.color.map(aY(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new tt(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:Ne("rgb",0,ze(255)),green:Ne("rgb",1,ze(255)),blue:Ne("rgb",2,ze(255)),hue:Ne(["hsl","hsv","hsl","hwb","hcg"],0,function(e){return(e%360+360)%360}),saturationl:Ne("hsl",1,ze(100)),lightness:Ne("hsl",2,ze(100)),saturationv:Ne("hsv",1,ze(100)),value:Ne("hsv",2,ze(100)),chroma:Ne("hcg",1,ze(100)),gray:Ne("hcg",2,ze(100)),white:Ne("hwb",1,ze(100)),wblack:Ne("hwb",2,ze(100)),cyan:Ne("cmyk",0,ze(100)),magenta:Ne("cmyk",1,ze(100)),yellow:Ne("cmyk",2,ze(100)),black:Ne("cmyk",3,ze(100)),x:Ne("xyz",0,ze(100)),y:Ne("xyz",1,ze(100)),z:Ne("xyz",2,ze(100)),l:Ne("lab",0,ze(100)),a:Ne("lab",1),b:Ne("lab",2),keyword:function(e){return arguments.length?new tt(e):jt[this.model].keyword(this.color)},hex:function(e){return arguments.length?new tt(e):yu.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity:function(){for(var e=this.rgb().color,t=[],r=0;r<e.length;r++){var n=e[r]/255;t[r]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return .2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),r=e.luminosity();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color,t=(e[0]*299+e[1]*587+e[2]*114)/1e3;return t<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=e[0]*.3+e[1]*.59+e[2]*.11;return tt.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),r=t.color[0];return r=(r+e)%360,r=r<0?360+r:r,t.color[0]=r,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var r=e.rgb(),n=this.rgb(),o=t===void 0?.5:t,i=2*o-1,s=r.alpha()-n.alpha(),a=((i*s===-1?i:(i+s)/(1+i*s))+1)/2,u=1-a;return tt.rgb(a*r.red()+u*n.red(),a*r.green()+u*n.green(),a*r.blue()+u*n.blue(),r.alpha()*o+n.alpha()*(1-o))}};Object.keys(jt).forEach(function(e){if(Z$.indexOf(e)===-1){var t=jt[e].channels;tt.prototype[e]=function(){if(this.model===e)return new tt(this);if(arguments.length)return new tt(arguments,e);var r=typeof arguments[t]=="number"?t:this.valpha;return new tt(uY(jt[this.model][e].raw(this.color)).concat(r),e)},tt[e]=function(r){return typeof r=="number"&&(r=yb(bb.call(arguments),t)),new tt(r,e)}}});function sY(e,t){return Number(e.toFixed(t))}function aY(e){return function(t){return sY(t,e)}}function Ne(e,t,r){return e=Array.isArray(e)?e:[e],e.forEach(function(n){(zp[n]||(zp[n]=[]))[t]=r}),e=e[0],function(n){var o;return arguments.length?(r&&(n=r(n)),o=this[e](),o.color[t]=n,o):(o=this[e]().color[t],r&&(o=r(o)),o)}}function ze(e){return function(t){return Math.max(0,Math.min(e,t))}}function uY(e){return Array.isArray(e)?e:[e]}function yb(e,t){for(var r=0;r<t;r++)typeof e[r]!="number"&&(e[r]=0);return e}Y$.exports=tt});var y2=g((pAe,g2)=>{var cY="Expected a function",Q$="__lodash_placeholder__",Lo=1,Wp=2,lY=4,qo=8,bu=16,Ji=32,vu=64,s2=128,fY=256,a2=512,e2=1/0,pY=9007199254740991,dY=17976931348623157e292,t2=0/0,mY=[["ary",s2],["bind",Lo],["bindKey",Wp],["curry",qo],["curryRight",bu],["flip",a2],["partial",Ji],["partialRight",vu],["rearg",fY]],hY="[object Function]",gY="[object GeneratorFunction]",yY="[object Symbol]",bY=/[\\^$.*+?()[\]{}|]/g,vY=/^\s+|\s+$/g,xY=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,wY=/\{\n\/\* \[wrapped with (.+)\] \*/,EY=/,? & /,SY=/^[-+]0x[0-9a-f]+$/i,IY=/^0b[01]+$/i,_Y=/^\[object .+?Constructor\]$/,CY=/^0o[0-7]+$/i,TY=/^(?:0|[1-9]\d*)$/,OY=parseInt,kY=typeof global=="object"&&global&&global.Object===Object&&global,AY=typeof self=="object"&&self&&self.Object===Object&&self,wu=kY||AY||Function("return this")();function u2(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function NY(e,t){for(var r=-1,n=e?e.length:0;++r<n&&t(e[r],r,e)!==!1;);return e}function RY(e,t){var r=e?e.length:0;return!!r&&PY(e,t,0)>-1}function DY(e,t,r,n){for(var o=e.length,i=r+(n?1:-1);n?i--:++i<o;)if(t(e[i],i,e))return i;return-1}function PY(e,t,r){if(t!==t)return DY(e,FY,r);for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}function FY(e){return e!==e}function $Y(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&n++;return n}function MY(e,t){return e?.[t]}function jY(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function c2(e,t){for(var r=-1,n=e.length,o=0,i=[];++r<n;){var s=e[r];(s===t||s===Q$)&&(e[r]=Q$,i[o++]=r)}return i}var qY=Function.prototype,l2=Object.prototype,vb=wu["__core-js_shared__"],r2=function(){var e=/[^.]+$/.exec(vb&&vb.keys&&vb.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),f2=qY.toString,LY=l2.hasOwnProperty,p2=l2.toString,BY=RegExp("^"+f2.call(LY).replace(bY,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zY=Object.create,Up=Math.max,UY=Math.min,n2=function(){var e=o2(Object,"defineProperty"),t=o2.name;return t&&t.length>2?e:void 0}();function WY(e){return Zi(e)?zY(e):{}}function HY(e){if(!Zi(e)||rX(e))return!1;var t=sX(e)||jY(e)?BY:_Y;return t.test(oX(e))}function KY(e,t,r,n){for(var o=-1,i=e.length,s=r.length,a=-1,u=t.length,l=Up(i-s,0),c=Array(u+l),f=!n;++a<u;)c[a]=t[a];for(;++o<s;)(f||o<i)&&(c[r[o]]=e[o]);for(;l--;)c[a++]=e[o++];return c}function VY(e,t,r,n){for(var o=-1,i=e.length,s=-1,a=r.length,u=-1,l=t.length,c=Up(i-a,0),f=Array(c+l),p=!n;++o<c;)f[o]=e[o];for(var d=o;++u<l;)f[d+u]=t[u];for(;++s<a;)(p||o<i)&&(f[d+r[s]]=e[o++]);return f}function GY(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function JY(e,t,r){var n=t&Lo,o=xu(e);function i(){var s=this&&this!==wu&&this instanceof i?o:e;return s.apply(n?r:this,arguments)}return i}function xu(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=WY(e.prototype),n=e.apply(r,t);return Zi(n)?n:r}}function ZY(e,t,r){var n=xu(e);function o(){for(var i=arguments.length,s=Array(i),a=i,u=m2(o);a--;)s[a]=arguments[a];var l=i<3&&s[0]!==u&&s[i-1]!==u?[]:c2(s,u);if(i-=l.length,i<r)return d2(e,t,xb,o.placeholder,void 0,s,l,void 0,void 0,r-i);var c=this&&this!==wu&&this instanceof o?n:e;return u2(c,this,s)}return o}function xb(e,t,r,n,o,i,s,a,u,l){var c=t&s2,f=t&Lo,p=t&Wp,d=t&(qo|bu),h=t&a2,b=p?void 0:xu(e);function y(){for(var v=arguments.length,w=Array(v),T=v;T--;)w[T]=arguments[T];if(d)var M=m2(y),V=$Y(w,M);if(n&&(w=KY(w,n,o,d)),i&&(w=VY(w,i,s,d)),v-=V,d&&v<l){var J=c2(w,M);return d2(e,t,xb,y.placeholder,r,w,J,a,u,l-v)}var G=f?r:this,K=p?G[e]:e;return v=w.length,a?w=nX(w,a):h&&v>1&&w.reverse(),c&&u<v&&(w.length=u),this&&this!==wu&&this instanceof y&&(K=b||xu(K)),K.apply(G,w)}return y}function YY(e,t,r,n){var o=t&Lo,i=xu(e);function s(){for(var a=-1,u=arguments.length,l=-1,c=n.length,f=Array(c+u),p=this&&this!==wu&&this instanceof s?i:e;++l<c;)f[l]=n[l];for(;u--;)f[l++]=arguments[++a];return u2(p,o?r:this,f)}return s}function d2(e,t,r,n,o,i,s,a,u,l){var c=t&qo,f=c?s:void 0,p=c?void 0:s,d=c?i:void 0,h=c?void 0:i;t|=c?Ji:vu,t&=~(c?vu:Ji),t&lY||(t&=~(Lo|Wp));var b=r(e,t,o,d,f,h,p,a,u,l);return b.placeholder=n,h2(b,e,t)}function XY(e,t,r,n,o,i,s,a){var u=t&Wp;if(!u&&typeof e!="function")throw new TypeError(cY);var l=n?n.length:0;if(l||(t&=~(Ji|vu),n=o=void 0),s=s===void 0?s:Up(i2(s),0),a=a===void 0?a:i2(a),l-=o?o.length:0,t&vu){var c=n,f=o;n=o=void 0}var p=[e,t,r,n,o,c,f,i,s,a];if(e=p[0],t=p[1],r=p[2],n=p[3],o=p[4],a=p[9]=p[9]==null?u?0:e.length:Up(p[9]-l,0),!a&&t&(qo|bu)&&(t&=~(qo|bu)),!t||t==Lo)var d=JY(e,t,r);else t==qo||t==bu?d=ZY(e,t,a):(t==Ji||t==(Lo|Ji))&&!o.length?d=YY(e,t,r,n):d=xb.apply(void 0,p);return h2(d,e,t)}function m2(e){var t=e;return t.placeholder}function o2(e,t){var r=MY(e,t);return HY(r)?r:void 0}function QY(e){var t=e.match(wY);return t?t[1].split(EY):[]}function eX(e,t){var r=t.length,n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(xY,`{
/* [wrapped with `+t+`] */
`)}function tX(e,t){return t=t??pY,!!t&&(typeof e=="number"||TY.test(e))&&e>-1&&e%1==0&&e<t}function rX(e){return!!r2&&r2 in e}function nX(e,t){for(var r=e.length,n=UY(t.length,r),o=GY(e);n--;){var i=t[n];e[n]=tX(i,r)?o[i]:void 0}return e}var h2=n2?function(e,t,r){var n=t+"";return n2(e,"toString",{configurable:!0,enumerable:!1,value:fX(eX(n,iX(QY(n),r)))})}:pX;function oX(e){if(e!=null){try{return f2.call(e)}catch{}try{return e+""}catch{}}return""}function iX(e,t){return NY(mY,function(r){var n="_."+r[0];t&r[1]&&!RY(e,n)&&e.push(n)}),e.sort()}function wb(e,t,r){t=r?void 0:t;var n=XY(e,qo,void 0,void 0,void 0,void 0,void 0,t);return n.placeholder=wb.placeholder,n}function sX(e){var t=Zi(e)?p2.call(e):"";return t==hY||t==gY}function Zi(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function aX(e){return!!e&&typeof e=="object"}function uX(e){return typeof e=="symbol"||aX(e)&&p2.call(e)==yY}function cX(e){if(!e)return e===0?e:0;if(e=lX(e),e===e2||e===-e2){var t=e<0?-1:1;return t*dY}return e===e?e:0}function i2(e){var t=cX(e),r=t%1;return t===t?r?t-r:t:0}function lX(e){if(typeof e=="number")return e;if(uX(e))return t2;if(Zi(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Zi(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(vY,"");var r=IY.test(e);return r||CY.test(e)?OY(e.slice(2),r?2:8):SY.test(e)?t2:+e}function fX(e){return function(){return e}}function pX(e){return e}wb.placeholder={};g2.exports=wb});var hee={};Ov(hee,{default:()=>be});module.exports=wd(hee);function Nv(e){var t=new WeakMap;return r=>t.has(r)?t.get(r):yj(t,r,e(r,t))}function yj(e,t,r){return e.set(t,r),r}function Rv(e){return e&&typeof e=="object"?JSON.parse(JSON.stringify(e)):e}var jr=typeof queueMicrotask=="function"?queueMicrotask:(e=>t=>e.then(t))(Promise.resolve());function Dv(e){let t=Promise.resolve(e);return(r,n)=>r||n?(typeof n>"u"&&(n=console.error),t=t.then(r,n)):t}function Pv(){let e,t,r=new Promise((n,o)=>{e=n,t=o});return{resolve:e,reject:t,promise:r}}var Tee=require("obsidian"),rt;(function(e){Object.assign(e,require("obsidian"))})(rt||(rt={}));var Ed="use.me",Sd="use.factory",Vo,ls,Id=function(){return Object.defineProperties(e(),{this:{get(){if(Vo)return Vo;throw new TypeError("No current context")}},me:{value:Ed},factory:{value:Sd}});function e(o){let i=new Map;i.prev=o;let s=Object.assign(o?u=>{let l=i.get(u);if(!l){for(let d=i.prev;d;d=d.prev)if(l=d.get(u)){l=Object.assign(Object.assign({},l),{s:l.s||1});break}l=l||{s:2,v:r},i.set(u,l)}let c,f,p;for(;;)switch(l.s){case 0:return Vo===s&&ls&&ls.push(u),l.v;case 1:if(c=l.d,!c||a(()=>c.k.every(d=>s(d)===c.c(d)))){l.s=0;break}l.v=c.f;case 2:l.s=4;try{t(i,u,0,a(f=l.v,u,p=[])),p.length&&(l.d={c:s,f,k:p});break}catch(d){l.s=3,l.v=d,l.d=null}case 3:throw l.v;case 4:throw new Error(`Factory ${String(l.v)} didn't resolve ${String(u)}`)}}:u=>Id.this(u),{def(u,l){return t(i,u,2,l),s},set(u,l){return t(i,u,1,l),s},fork(u){let l=e(i);return u!=null?l(u):l}});return o?s.use=s:s;function a(u,l,c){let f=Vo,p=ls;try{return Vo=s,ls=c,u(l)}finally{Vo=f,ls=p}}}function t(o,i,s,a){if(o.has(i)){let u=o.get(i);if(!u.s)throw new Error(`Already read: ${String(i)}`);u.s=s,u.v=a,u.d=null}else o.set(i,{s,v:a})}function r(o){if(typeof o[Ed]=="function")return o[Ed](o);if(n(o))return typeof o.prototype[Sd]=="function"?o.prototype[Sd]():new o;throw new ReferenceError(`No config for ${String(o)}`)}function n(o){return typeof o=="function"&&o.prototype!==void 0&&(Object.getPrototypeOf(o.prototype)!==Object.prototype||Object.getOwnPropertyNames(o.prototype).length>1||o.toString().startsWith("class"))}}();var bj,Go=(e=>(e.service=function(t){return e(Pu).addChild(t),e.this},e.plugin=function(t){if(!qr)bj=t.app,qr=e.fork(),qr.set(rt.Plugin,t),qr.set(t.constructor,t),t.addChild(qr.use(Pu));else if(t!==qr.use(rt.Plugin))throw new TypeError("use.plugin() called on multiple plugins");return qr},e.def(rt.Plugin,()=>{throw new Error("Plugin not created yet")}),e.def(rt.App,()=>e(rt.Plugin).app),e))(Id),qr;function _d(e){if(e?.use)return e.use;if(qr)return qr;if(e instanceof rt.Plugin)return e.use=Go.plugin(e);throw new Error("No context available: did you forget to `use.plugin()`?")}var ue=class extends rt.Component{constructor(){super(...arguments),this.use=Go.service(this)}},Pu=class extends rt.Component{constructor(){super(...arguments),this.children=new Set([this])}onload(){this.loaded=!0}onunload(){this.loaded=!1,this.children.clear()}addChild(t){return this.children.has(t)||(this.children.add(t),this.loaded?jr(()=>super.addChild(t)):super.addChild(t)),t}};function vj(e,t){jr(()=>e.removeChild(t))}function Fv(e,t){let r=new rt.Component;r.onload=()=>{vj(e,r),e=null,t()},e.addChild(r)}function $u(){throw new Error("Cycle detected")}function Mu(){if(ln>1){ln--;return}let e,t=!1;for(;fs!==void 0;){let r=fs;for(fs=void 0,Cd++;r!==void 0;){let n=r.o;if(r.o=void 0,r.f&=-3,!(8&r.f)&&qv(r))try{r.c()}catch(o){t||(e=o,t=!0)}r=n}}if(Cd=0,ln--,t)throw e}function $v(e){if(ln>0)return e();ln++;try{return e()}finally{Mu()}}var ke,fs;var ln=0,Cd=0,Fu=0;function Mv(e){if(ke===void 0)return;let t=e.n;if(t===void 0||t.t!==ke)return t={i:0,S:e,p:ke.s,n:void 0,t:ke,e:void 0,x:void 0,r:t},ke.s!==void 0&&(ke.s.n=t),ke.s=t,e.n=t,32&ke.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=ke.s,t.n=void 0,ke.s.n=t,ke.s=t),t}function ht(e){this.v=e,this.i=0,this.n=void 0,this.t=void 0}ht.prototype.h=function(){return!0};ht.prototype.S=function(e){this.t!==e&&e.e===void 0&&(e.x=this.t,this.t!==void 0&&(this.t.e=e),this.t=e)};ht.prototype.U=function(e){if(this.t!==void 0){let t=e.e,r=e.x;t!==void 0&&(t.x=r,e.e=void 0),r!==void 0&&(r.e=t,e.x=void 0),e===this.t&&(this.t=r)}};ht.prototype.subscribe=function(e){let t=this;return Od(function(){let r=t.value,n=32&this.f;this.f&=-33;try{e(r)}finally{this.f|=n}})};ht.prototype.valueOf=function(){return this.value};ht.prototype.toString=function(){return this.value+""};ht.prototype.toJSON=function(){return this.value};ht.prototype.peek=function(){return this.v};Object.defineProperty(ht.prototype,"value",{get(){let e=Mv(this);return e!==void 0&&(e.i=this.i),this.v},set(e){if(ke instanceof fn&&function(){throw new Error("Computed cannot have side-effects")}(),e!==this.v){Cd>100&&$u(),this.v=e,this.i++,Fu++,ln++;try{for(let t=this.t;t!==void 0;t=t.x)t.t.N()}finally{Mu()}}}});function jv(e){return new ht(e)}function qv(e){for(let t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Lv(e){for(let t=e.s;t!==void 0;t=t.n){let r=t.S.n;if(r!==void 0&&(t.r=r),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function Bv(e){let t,r=e.s;for(;r!==void 0;){let n=r.p;r.i===-1?(r.S.U(r),n!==void 0&&(n.n=r.n),r.n!==void 0&&(r.n.p=n)):t=r,r.S.n=r.r,r.r!==void 0&&(r.r=void 0),r=n}e.s=t}function fn(e){ht.call(this,void 0),this.x=e,this.s=void 0,this.g=Fu-1,this.f=4}(fn.prototype=new ht).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Fu))return!0;if(this.g=Fu,this.f|=1,this.i>0&&!qv(this))return this.f&=-2,!0;let e=ke;try{Lv(this),ke=this;let t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(t){this.v=t,this.f|=16,this.i++}return ke=e,Bv(this),this.f&=-2,!0};fn.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(let t=this.s;t!==void 0;t=t.n)t.S.S(t)}ht.prototype.S.call(this,e)};fn.prototype.U=function(e){if(this.t!==void 0&&(ht.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(let t=this.s;t!==void 0;t=t.n)t.S.U(t)}};fn.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(let e=this.t;e!==void 0;e=e.x)e.t.N()}};fn.prototype.peek=function(){if(this.h()||$u(),16&this.f)throw this.v;return this.v};Object.defineProperty(fn.prototype,"value",{get(){1&this.f&&$u();let e=Mv(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function ju(e){return new fn(e)}function zv(e){let t=e.u;if(e.u=void 0,typeof t=="function"){ln++;let r=ke;ke=void 0;try{t()}catch(n){throw e.f&=-2,e.f|=8,Td(e),n}finally{ke=r,Mu()}}}function Td(e){for(let t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,zv(e)}function xj(e){if(ke!==this)throw new Error("Out-of-order effect");Bv(this),ke=e,this.f&=-2,8&this.f&&Td(this),Mu()}function ps(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}ps.prototype.c=function(){let e=this.S();try{if(8&this.f||this.x===void 0)return;let t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};ps.prototype.S=function(){1&this.f&&$u(),this.f|=1,this.f&=-9,zv(this),Lv(this),ln++;let e=ke;return ke=this,xj.bind(this,e)};ps.prototype.N=function(){2&this.f||(this.f|=2,this.o=fs,fs=this)};ps.prototype.d=function(){this.f|=8,1&this.f||Td(this)};function Od(e){let t=new ps(e);try{t.c()}catch(r){throw t.d(),r}return t.d.bind(t)}function kd(e){let t=ju(e);return()=>t.value}function Uv(e){let t=jv(e);function r(){return t.value,e}return r.set=function(n){e!==n&&(ms.size||jr(wj),ms.set(t,e=n))},r}var ms=new Map;function wj(){ms.size&&$v(()=>{for(let[e,t]of ms.entries())ms.delete(e),e.value=t})}var Ej=Nv(function(e){return{}});function pe(e,t,r){let n=r.get;return{...r,get(){var o,i;return((o=(i=Ej(this))[t])!==null&&o!==void 0?o:i[t]=kd(n.bind(this)))()}}}var ds;function Le(e){let t=Od(function(){let r=ds,n=ds=[];try{let o=e.call(this);if(o&&n.push(o),n.length)return n.length===1?n.pop():function(){for(;n.length;)try{n.shift()()}catch(i){Promise.reject(i)}}}finally{ds=r}});return ds&&ds.push(t),t}function Lt(e,t){let r=Object.keys(t).map(n=>Sj(e,n,t[n]));return r.length===1?r[0]:function(){r.forEach(n=>n())}}function Sj(e,t,r){let n=e[t],o=e.hasOwnProperty(t),i=r(n);return n&&Object.setPrototypeOf(i,n),Object.setPrototypeOf(s,i),e[t]=s,a;function s(...u){return i===n&&e[t]===s&&a(),i.apply(this,u)}function a(){e[t]===s&&(o?e[t]=n:delete e[t]),i!==n&&(i=n,Object.setPrototypeOf(s,n||Function))}}var qu=e=>{if(typeof e!="object"||e===null)return!1;let t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Ij=new Set(["__proto__","prototype","constructor"]),Ad=(e,t)=>{if(!qu(t))return e;e||(e={});for(let[r,n]of Object.entries(t)){if(Ij.has(r))continue;let o=e[r];if(qu(o)&&qu(n))e[r]=Ad(o,n);else{if(n===void 0)continue;qu(n)?e[r]=Ad({},n):Array.isArray(n)?e[r]=[...n]:e[r]=n}}return e};function Lu(e={},t={}){return Ad({...t},{...e})}var Bu=class extends ue{get current(){return this.cloned()}addDefaults(t){this.data=Lu(this.data,t)}constructor(){super(),this.plugin=this.use(rt.Plugin),this.queue=Dv(),this.data={},this.version=Uv(0),this.cloned=kd(()=>this.version()?Rv(this.data):null),this.queue(async()=>{var t;await new Promise(r=>Fv(this.plugin,r)),this.data=Lu((t=await this.plugin.loadData())!==null&&t!==void 0?t:{},this.data),this.version.set(this.version()+1)},console.error)}once(t,r){let n=this.each(o=>{n(),t.call(r,o)});return n}each(t,r){return Le(()=>{this.current&&jr(t.bind(r,this.current))})}onChange(t,r){return this.each(t,r)}update(t){return this.queue(async()=>{var r;let n=this.data,o=JSON.stringify(n);try{var i=JSON.parse(o);i=(r=t(i))!==null&&r!==void 0?r:i;let s=JSON.stringify(i);o!==s&&(this.data=i,this.version.set(this.version()+1),await this.plugin.saveData(JSON.parse(s)).catch(console.error))}catch(s){console.error(s)}return this.data})}};function Wv(e,t,r,n){let{resolve:o,promise:i}=Pv(),s=new class extends rt.FuzzySuggestModal{getItemText(a){var u;return(u=t?.(a))!==null&&u!==void 0?u:""+a}getItems(){return e}onChooseItem(a,u){o({item:a,event:u})}onClose(){super.onClose(),jr(()=>o({item:null,event:null}))}}(app);return r&&s.setPlaceholder(r),n?.(s),s.open(),i}var lj=require("obsidian");var Hv=e=>`obsidian-zotero:${e}`;var Bt=({key:e,groupID:t,parentItem:r},n=!1)=>{let o=[e];return!n&&r&&o.push(`a${r}`),typeof t=="number"&&o.push(`g${t}`),o.join("")},Kv=(e,t,r=!0)=>(n,...o)=>{let i="";for(let s=0;s<n.length;s++)s>0&&(i+=e(o[s-1])),i+=(r?n.raw:n)[s];return t(i)},Dd=(e=!0,t)=>Kv(r=>r,r=>new RegExp(e?"^"+r+"$":r,t),!0),Nd=String.raw`[23456789ABCDEFGHIJKLMNPQRSTUVWXYZ]{8}`,Rd=String.raw`\d+`,Vv=e=>{let t={annotKey:Nd,parentKey:Nd,groupID:Rd,page:Rd};if(e)for(let r in t)t[r]=`(${t[r]})`;return Kv(r=>t[r],r=>r)`${"annotKey"}a${"parentKey"}(?:g${"groupID"})?(?:p${"page"})?`},Gv=Dd()`${Nd}(?:g${Rd})?`,Jv=Dd()`${Vv(!0)}`,Zv=Dd()`(?:${Vv(!1)}n?)+`,Jo=(e,t)=>{if(e===null)return null;let r;return typeof e=="number"?r=e:r=parseInt(e,10),Number.isInteger(r)?t?r+1:r:null};var Yv=(e,t,{getLogger:r,configure:n})=>{let o=Hv(e);return n({appenders:{out:{type:"console"}},categories:{default:{appenders:["out"],level:t},[o]:{appenders:["out"],level:t}}}),r(o)},Xv={ALL:"ALL",TRACE:"TRACE",DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",FATAL:"FATAL",MARK:"MARK",OFF:"OFF"};var pn=()=>(...e)=>e;var Qv=e=>`better-sqlite3-${e}.node`;var il=me(vS(),1);var wh=me(xn(),1),Tn=require("obsidian"),r_=me(SS(),1);var g1=require("http");var QL=me(xn(),1),eB=me(Im(),1),_m=me(Im(),1);var US=pn()("open","export","update");var zS=(e,t)=>{let r=new RegExp(`^${t}\\[(\\d+)\\]$`);return Object.entries(e).filter(([n])=>r.test(n)).sort(([n],[o])=>Number(n.match(r)[1])-Number(o.match(r)[1])).map(([,n])=>JSON.parse(n))},xc=e=>{if(e.type==="item")return{version:e.version,type:e.type,items:zS(e,"items")};if(e.type==="annotation")return{version:e.version,type:e.type,annots:zS(e,"annots"),parent:JSON.parse(e.parent)};throw new TypeError("Unrecognized query type: "+e.type)};var Cm=/^<!--merge:(\d+)-->/;var Ec=require("obsidian");var wc=require("path");var KS=require("path/posix");var Om=require("obsidian");var WS={"103":{darwin:["arm64","x64"],linux:["x64"],win32:["x64","ia32","arm64"]},"109":{darwin:["arm64","x64"],linux:["x64"],win32:["x64","ia32","arm64"]},"110":{darwin:["arm64","x64"],linux:["x64"],win32:["x64","ia32","arm64"]},"114":{darwin:["arm64","x64"],linux:["x64"],win32:["x64","ia32","arm64"]},"116":{darwin:["arm64","x64"],linux:["x64"],win32:["x64","ia32","arm64"]}};var HS=Om.Platform.isDesktopApp?require("@electron/remote").app.getPath("userData"):null,{arch:sie,platform:aie,versions:{modules:rB,electron:uie}}=process,Tm=WS,VS=({modules:e})=>{if(e in Tm)return 0;let r=Object.keys(Tm).map(o=>parseInt(o,10)).sort((o,i)=>o-i);return parseInt(e,10)>r[r.length-1]?1:-1},GS=({platform:e,arch:t})=>!!Tm[rB][e]?.includes(t),JS=()=>Om.Platform.isDesktopApp?{arch:process.arch,platform:process.platform,modules:process.versions.modules,electron:process.versions.electron}:null,km=e=>e.versions?.["better-sqlite3"],ai=e=>{if(!HS)return null;let t=km(e);return t?(0,KS.join)(HS,Qv(t)):null};var ZS={citationEditorSuggester:!0,showCitekeyInSuggester:!1};var YS={literatureNoteFolder:"LiteratureNotes"};var XS={enableServer:!1,serverPort:9091,serverHostname:"127.0.0.1"};var Am=require("path/posix");var QS=`[!note] Page <%= it.pageLabel %>

<%= it.imgEmbed %><%= it.text %>
<% if (it.comment) { %>
---
<%= it.comment %>
<% } %>`;var e1=`<% for (const annotation of it) { %>
<%~ include("annotation", annotation) %>
<% } %>`;var t1='[<%= it.map(lit => `@${lit.citekey}`).join("; ") %>]';var r1='<%= it.map(lit => `@${lit.citekey}`).join("; ") %>';var n1=`<mark style="
<%- if (it.color) { _%> color: <%= it.color %>; <%_ } -%>
<%- if (it.bgColor) { _%> background-color: <%= it.bgColor %>; <%_ } -%>
"><%= it.content %></mark>`;var o1=`title: "<%= it.title %>"
citekey: "<%= it.citekey %>"`;var i1=`# <%= it.title %>

[Zotero](<%= it.backlink %>) <%= it.fileLink %>
<%~ include("annots", it.annotations) %>`;var ot={Ejectable:{note:i1,field:o1,annots:e1,annotation:QS,cite:t1,cite2:r1,colored:n1},Embeded:{filename:"<%= it.citekey ?? it.DOI ?? it.title ?? it.key %>.md"}},_r={Ejectable:Object.keys(ot.Ejectable),Embeded:Object.keys(ot.Embeded),All:Object.keys(ot.Ejectable).concat(Object.keys(ot.Embeded))};function Nm(e){return Object.hasOwn(ot.Embeded,e)?`zt-${e}.eta.md`:Object.hasOwn(ot.Ejectable,e)?e==="annotation"?"zt-annot.eta.md":`zt-${e}.eta.md`:null}function so(e,t){return(0,Am.join)(t,Nm(e))}function ct(e,t){let r=_r.Embeded.find(o=>(0,Am.join)(t,`zt-${o}.eta.md`)===e);if(r)return{type:"embeded",name:r};let n=_r.Ejectable.find(o=>so(o,t)===e);return n?{type:"ejectable",name:n}:null}var s1={template:{folder:"ZtTemplates",templates:ot.Embeded},updateAnnotBlock:!1,updateOverwrite:!1,autoPairEta:!1,autoTrim:[!1,!1]};var a1={autoRefresh:!0};var u1=require("os"),c1=require("path"),l1=()=>({zoteroDataDir:(0,c1.join)((0,u1.homedir)(),"Zotero"),citationLibrary:1});var f1=require("obsidian"),p1={imgExcerptImport:f1.Platform.isWin?"copy":"symlink",imgExcerptPath:"ZtImgExcerpt"};var d1=()=>({...m1,...ZS,...YS,...XS,...s1,...a1,...l1(),...p1});function Qe(e,t,r=!1){let n=0;return(...o)=>{if(t(),n++>(r?1:0))return e(...o)}}var de=class extends Bu{#e=this.use(be);#t;get nativeBinding(){if(this.#t)return this.#t;let t=ai(this.#e.manifest);if(t)return this.#t=t,this.#t;throw new Error("Failed to get native binding path")}get templateDir(){return this.current?.template?.folder}get libId(){return this.current?.citationLibrary}get simpleTemplates(){return this.current?.template?.templates}get zoteroDbPath(){return(0,wc.join)(this.current?.zoteroDataDir,"zotero.sqlite")}get betterBibTexDbPath(){return(0,wc.join)(this.current?.zoteroDataDir,"better-bibtex-search.sqlite")}get zoteroCacheDirPath(){return(0,wc.join)(this.current?.zoteroDataDir,"cache")}get dbConnParams(){return[{zotero:this.zoteroDbPath,bbt:this.betterBibTexDbPath},{nativeBinding:this.nativeBinding}]}};fe([pe],de.prototype,"templateDir",1),fe([pe],de.prototype,"libId",1),fe([pe],de.prototype,"simpleTemplates",1),fe([pe],de.prototype,"zoteroDbPath",1),fe([pe],de.prototype,"betterBibTexDbPath",1),fe([pe],de.prototype,"zoteroCacheDirPath",1),fe([pe],de.prototype,"dbConnParams",1);function h1(e){let t=_d(e)(de);return t.addDefaults(d1()),t}var lB=new Set(["notify"]),fB=new Set([...US.map(e=>`zotero/${e}`)]),Ur=class extends ue{#e=new Ec.Events;settings=this.use(de);plugin=this.use(be);server=null;get port(){return this.settings.current?.serverPort}get hostname(){return this.settings.current?.serverHostname}get enableServer(){return this.settings.current?.enableServer}onload(){this.register(Le(Qe(()=>{this.enableServer?this.initServer():this.closeServer()},()=>this.enableServer))),this.register(Le(Qe(()=>{this.reloadPort(),new Ec.Notice("Server port is saved and applied.")},()=>(this.port,this.hostname),!0))),this.registerObsidianProtocolHandler()}onunload(){this.closeServer(),this.server=null}registerObsidianProtocolHandler(){let t=r=>{let{action:n,...o}=r;this.trigger(n,o)};for(let r of fB)this.plugin.registerObsidianProtocolHandler(r,t)}#t(){this.server??=(0,g1.createServer)((t,r)=>{this.requestListener(t,r)})}#r(){this.server?.listening||this.server?.listen(this.port,this.hostname,()=>this.listeningListener())}initServer(){this.#t(),this.#r()}closeServer(){this.server?.close()}reloadPort(){this.enableServer&&(this.closeServer(),this.#t(),this.#r())}requestListener(t,r){if(!t.url){W.error("Request without url"),r.statusCode=400,r.end();return}W.trace("server recieved req",t.url,t.rawHeaders);let{pathname:n,searchParams:o}=new URL(t.url,`http://${t.headers.host}`),i=n.substring(1),s=`bg:${n.substring(1)}`;if(lB.has(i)){let a=Object.fromEntries(o.entries());t.headers["content-type"]==="application/json"?new Promise((u,l)=>{let c="";t.on("data",f=>c+=f),t.on("error",f=>l(f)),t.on("end",()=>{try{u(JSON.parse(c))}catch(f){l(f)}})}).then(u=>{this.trigger(s,a,u),r.end()}):(this.trigger(s,a),r.end())}else r.statusCode=404,r.end()}listeningListener(){this.server&&W.info(`Server is listening at ${pB(this.server)}`)}on(t,r,n){return this.#e.on(t,r,n)}off(t,r){return this.#e.off(t,r)}offref(t){return this.#e.offref(t)}trigger(t,...r){return W.trace(`server trigger ${t}`,...r),this.#e.trigger(t,...r)}tryTrigger(t,r){return this.#e.tryTrigger(t,r)}};fe([pe],Ur.prototype,"port",1),fe([pe],Ur.prototype,"hostname",1),fe([pe],Ur.prototype,"enableServer",1);function pB(e){let t=e.address();return t?typeof t=="string"?t:`${t.address}:${t.port}`:"?"}var y1=me(xn(),1),b1=require("obsidian");function v1(e,t={}){return qs({...t,register:r=>e.metadataCache.on("initialized",r),unregister:r=>e.metadataCache.offref(r),escape:()=>e.metadataCache.initialized,timeout:t.timeout??null})}function Rm(e,t={}){return qs({...t,register:r=>e.vault.on("zotero:db-refresh",r),unregister:r=>e.vault.offref(r)})}function ui(e,t={}){return qs({...t,unregister:r=>e.app.vault.offref(r),escape:()=>e.dbWorker.status===2,register:r=>{let n=e.dbWorker.status;if(n===0)return e.app.vault.on("zotero:db-ready",r);if(n===1)return e.app.vault.on("zotero:db-refresh",r);if(n===2)throw new Error("should not be called when db is ready");(0,y1.assertNever)(n)}})}var x1=e=>new Promise(t=>{e.workspace.onLayoutReady(t)}),qs=({register:e,unregister:t,escape:r,timeout:n=1e4,waitAfterEvent:o,debounce:i=1e3})=>{let s=null;return[new Promise((u,l)=>{if(r?.()){u();return}s=function(){t(p),l(new js)};function c(){t(p),u()}async function f(){o!==void 0&&await sleep(o),c()}let p=e(i?(0,b1.debounce)(f,i,!0):f);n!==null&&sleep(n).then(()=>{t(p),r?.()?c():l(new Ms(n))})}),s]},Ms=class extends Error{constructor(r){super(`Timeout after ${r}ms`);this.timeout=r}},js=class extends Error{constructor(){super("Manually cancelled")}};var mB=e=>{let t=new Blob([e],{type:"text/javascript"});return URL.createObjectURL(t)},w1=(e,t)=>{let r=mB(e),n=new Worker(r,t);return URL.revokeObjectURL(r),n};var Dm=class extends Error{},xe=e=>{throw new Dm(e)},Pm=class extends Error{},ge=e=>{throw new Pm(e)};var wn=(e,t)=>De(e)===t,De=e=>{let t=typeof e;return t==="object"?e===null?"null":"object":t==="function"?"object":t},Fm={bigint:"a bigint",boolean:"boolean",null:"null",number:"a number",object:"an object",string:"a string",symbol:"a symbol",undefined:"undefined"};var Gt=(e,t)=>e in t,E1=e=>Object.entries(e),we=e=>Object.keys(e),ao=e=>{let t=[];for(;e!==Object.prototype&&e!==null&&e!==void 0;){for(let r of Object.getOwnPropertyNames(e))t.includes(r)||t.push(r);for(let r of Object.getOwnPropertySymbols(e))t.includes(r)||t.push(r);e=Object.getPrototypeOf(e)}return t},ci=(e,t)=>{let r=e?.[t];return r!=null};var S1=e=>Object.keys(e).length,Ls=e=>wn(e,"object")?Object.keys(e).length!==0:!1,ase=Symbol("id");var Cr=e=>Array.isArray(e)?e:[e];var We=class extends Array{static fromString(t,r="/"){return t===r?new We:new We(...t.split(r))}toString(t="/"){return this.length?this.join(t):t}},I1=(e,t)=>{let r=e;for(let n of t){if(typeof r!="object"||r===null)return;r=r[n]}return r};var $m=/^(?!^-0$)-?(?:0|[1-9]\d*)(?:\.\d*[1-9])?$/,hB=e=>$m.test(e),gB=/^-?\d*\.?\d*$/,yB=e=>e.length!==0&&gB.test(e),Sc=/^(?:0|(?:-?[1-9]\d*))$/,Bs=e=>Sc.test(e),zs=/^(?:0|(?:[1-9]\d*))$/,_1=/^-?\d+$/,bB=e=>_1.test(e),C1={number:"a number",bigint:"a bigint",integer:"an integer"},T1=(e,t)=>`'${e}' was parsed as ${C1[t]} but could not be narrowed to a literal value. Avoid unnecessary leading or trailing zeros and other abnormal notation`,vB=(e,t)=>t==="number"?hB(e):Bs(e),xB=(e,t)=>t==="number"?Number(e):Number.parseInt(e),wB=(e,t)=>t==="number"?yB(e):bB(e),Us=(e,t)=>O1(e,"number",t),Ic=(e,t)=>O1(e,"integer",t),O1=(e,t,r)=>{let n=xB(e,t);if(!Number.isNaN(n)){if(vB(e,t))return n;if(wB(e,t))return ge(T1(e,t))}return r?ge(r===!0?`Failed to parse ${C1[t]} from '${e}'`:r):void 0},Mm=e=>{if(e[e.length-1]!=="n")return;let t=e.slice(0,-1),r;try{r=BigInt(t)}catch{return}if(Sc.test(t))return r;if(_1.test(t))return ge(T1(e,"bigint"))};var Te=(e,t)=>{switch(De(e)){case"object":return JSON.stringify(jm(e,_c,[]),null,t);case"symbol":return _c.onSymbol(e);default:return qm(e)}},_c={onCycle:()=>"(cycle)",onSymbol:e=>`(symbol${e.description&&` ${e.description}`})`,onFunction:e=>`(function${e.name&&` ${e.name}`})`},jm=(e,t,r)=>{switch(De(e)){case"object":if(typeof e=="function")return _c.onFunction(e);if(r.includes(e))return"(cycle)";let n=[...r,e];if(Array.isArray(e))return e.map(i=>jm(i,t,n));let o={};for(let i in e)o[i]=jm(e[i],t,n);return o;case"symbol":return _c.onSymbol(e);case"bigint":return`${e}n`;case"undefined":return"undefined";default:return e}},qm=e=>typeof e=="string"?`'${e}'`:typeof e=="bigint"?`${e}n`:`${e}`;function EB(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SB(e,t){return t.get?t.get.call(e):t.value}function IB(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function A1(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function k1(e,t){var r=A1(e,t,"get");return SB(e,r)}function _B(e,t,r){EB(e,t),t.set(e,r)}function CB(e,t,r){var n=A1(e,t,"set");return IB(e,n,r),r}function Cc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Jt=e=>(t,r,n)=>t===void 0?r===void 0?xe(kc):r:r===void 0?t:e(t,r,n),kc="Unexpected operation two undefined operands",Lm={domain:({l:e,r:t})=>`${e.join(", ")} and ${t.join(", ")}`,range:({l:e,r:t})=>`${Oc(e)} and ${Oc(t)}`,class:({l:e,r:t})=>`classes ${typeof e=="string"?e:e.name} and ${typeof t=="string"?t:t.name}`,tupleLength:({l:e,r:t})=>`tuples of length ${e} and ${t}`,value:({l:e,r:t})=>`literal values ${Te(e)} and ${Te(t)}`,leftAssignability:({l:e,r:t})=>`literal value ${Te(e.value)} and ${Te(t)}`,rightAssignability:({l:e,r:t})=>`literal value ${Te(t.value)} and ${Te(e)}`,union:({l:e,r:t})=>`branches ${Te(e)} and branches ${Te(t)}`},Oc=e=>"limit"in e?`the range of exactly ${e.limit}`:e.min?e.max?`the range bounded by ${e.min.comparator}${e.min.limit} and ${e.max.comparator}${e.max.limit}`:`${e.min.comparator}${e.min.limit}`:e.max?`${e.max.comparator}${e.max.limit}`:"the unbounded range",Tc=new WeakMap,En=class{get disjoints(){return k1(this,Tc)}addDisjoint(t,r,n){return k1(this,Tc)[`${this.path}`]={kind:t,l:r,r:n},Ac}constructor(t,r){Cc(this,"type",void 0),Cc(this,"lastOperator",void 0),Cc(this,"path",void 0),Cc(this,"domain",void 0),_B(this,Tc,{writable:!0,value:void 0}),this.type=t,this.lastOperator=r,this.path=new We,CB(this,Tc,{})}},Ac=Symbol("empty"),N1=()=>Ac,ur=e=>e===Ac,R1=Symbol("equal"),He=()=>R1,Zt=e=>e===R1,li=(e,t)=>(r,n,o)=>{let i={},s=we({...r,...n}),a=!0,u=!0;for(let l of s){let c=typeof e=="function"?e(l,r[l],n[l],o):e[l](r[l],n[l],o);if(Zt(c))r[l]!==void 0&&(i[l]=r[l]);else if(ur(c))if(t.onEmpty==="omit")a=!1,u=!1;else return Ac;else c!==void 0&&(i[l]=c),a&&(a=c===r[l]),u&&(u=c===n[l])}return a?u?He():r:u?n:i};var D1=e=>{let t=we(e);if(t.length===1){let n=t[0];return`${n==="/"?"":`At ${n}: `}Intersection of ${Lm[e[n].kind](e[n])} results in an unsatisfiable type`}let r=`
        "Intersection results in unsatisfiable types at the following paths:
`;for(let n in e)r+=`  ${n}: ${Lm[e[n].kind](e[n])}
`;return r},Nc=(e,t,r)=>`${e.length?`At ${e}: `:""}${t} ${r?`${r} `:""}results in an unsatisfiable type`;var Ws={Array,Date,Error,Function,Map,RegExp,Set,Object,String,Number,Boolean,WeakMap,WeakSet,Promise},fi=(e,t)=>{if(De(e)!=="object")return;let r=t??Ws,n=Object.getPrototypeOf(e);for(;n?.constructor&&(!r[n.constructor.name]||!(e instanceof r[n.constructor.name]));)n=Object.getPrototypeOf(n);return n?.constructor?.name};var Sn=e=>Array.isArray(e),Bm={Object:"an object",Array:"an array",Function:"a function",Date:"a Date",RegExp:"a RegExp",Error:"an Error",Map:"a Map",Set:"a Set",String:"a String object",Number:"a Number object",Boolean:"a Boolean object",Promise:"a Promise",WeakMap:"a WeakMap",WeakSet:"a WeakSet"},Rc=e=>{let t=Object(e).name;return t&&Gt(t,Ws)&&Ws[t]===e?t:void 0};var P1=Jt((e,t,r)=>e===t?He():e instanceof t?e:t instanceof e?t:r.addDisjoint("class",e,t)),F1=(e,t)=>typeof e=="string"?fi(t.data)===e||!t.problems.add("class",e):t.data instanceof e||!t.problems.add("class",e);var Dc=(e,t)=>{if(Array.isArray(e)){if(Array.isArray(t)){let r=TB(e,t);return r.length===e.length?r.length===t.length?He():e:r.length===t.length?t:r}return e.includes(t)?e:[...e,t]}return Array.isArray(t)?t.includes(e)?t:[...t,e]:e===t?He():[e,t]},TB=(e,t)=>{let r=[...e];for(let n of t)e.includes(n)||r.push(n);return r};var $1=Jt((e,t)=>e===t?He():Math.abs(e*t/OB(e,t))),OB=(e,t)=>{let r,n=e,o=t;for(;o!==0;)r=o,o=n%o,n=r;return n},M1=(e,t)=>t.data%e===0||!t.problems.add("divisor",e);var Hs=e=>e[0]==="?",Pc=e=>e[0]==="!",Or={index:"[index]"},In=e=>Hs(e)||Pc(e)?e[1]:e,kB=e=>{if(typeof e.length=="object"&&Pc(e.length)&&typeof e.length[1]!="string"&&$c(e.length[1],"number"))return e.length[1].number.value},j1=Jt((e,t,r)=>{let n=AB(e,t,r);if(typeof n=="symbol")return n;let o=kB(n);if(o===void 0||!(Or.index in n))return n;let{[Or.index]:i,...s}=n,a=In(i);for(let u=0;u<o;u++){if(!s[u]){s[u]=a;continue}let l=In(s[u]);r.path.push(`${u}`);let c=Fc(l,a,r);if(r.path.pop(),ur(c))return c;!Zt(c)&&c!==l&&(s[u]=c)}return s}),AB=li((e,t,r,n)=>{if(t===void 0)return r===void 0?He():r;if(r===void 0)return t;n.path.push(e);let o=Fc(In(t),In(r),n);n.path.pop();let i=Hs(t)&&Hs(r);return ur(o)&&i?{}:o},{onEmpty:"bubble"}),q1=(e,t,r)=>{let n=r.type.config?.keys??r.type.scope.config.keys;return n==="loose"?NB(e,t,r):RB(n,e,t,r)},NB=(e,t,r)=>{for(let n in t){let o=t[n];r.path.push(n),n===Or.index?e.push(["indexProp",Tr(In(o),r)]):Hs(o)?e.push(["optionalProp",[n,Tr(o[1],r)]]):Pc(o)?e.push(["prerequisiteProp",[n,Tr(o[1],r)]]):e.push(["requiredProp",[n,Tr(o,r)]]),r.path.pop()}},RB=(e,t,r,n)=>{let o={required:{},optional:{}};for(let i in r){let s=r[i];n.path.push(i),i===Or.index?o.index=Tr(In(s),n):Hs(s)?o.optional[i]=Tr(s[1],n):Pc(s)?t.push(["prerequisiteProp",[i,Tr(s[1],n)]]):o.required[i]=Tr(s,n),n.path.pop()}t.push([`${e}Props`,o])};function DB(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var zm=e=>typeof e=="string"||Array.isArray(e)?e.length:typeof e=="number"?e:0,PB=e=>typeof e=="string"?"characters":Array.isArray(e)?"items long":"",Mc=class{toString(){return Te(this.value)}get domain(){return De(this.value)}get size(){return zm(this.value)}get units(){return PB(this.value)}get className(){return Object(this.value).constructor.name}constructor(t){DB(this,"value",void 0),this.value=t}};var jc={">":!0,">=":!0},Um={"<":!0,"<=":!0},Ks=e=>"comparator"in e,B1=Jt((e,t,r)=>{if(Ks(e))return Ks(t)?e.limit===t.limit?He():r.addDisjoint("range",e,t):L1(t,e.limit)?e:r.addDisjoint("range",e,t);if(Ks(t))return L1(e,t.limit)?t:r.addDisjoint("range",e,t);let n=pi("min",e.min,t.min),o=pi("max",e.max,t.max);return n==="l"?o==="r"?pi("min",e.min,t.max)==="l"?r.addDisjoint("range",e,t):{min:e.min,max:t.max}:e:n==="r"?o==="l"?pi("max",e.max,t.min)==="l"?r.addDisjoint("range",e,t):{min:t.min,max:e.max}:t:o==="l"?e:o==="r"?t:He()}),L1=(e,t)=>Ks(e)?t===e.limit:FB(e.min,t)&&$B(e.max,t),FB=(e,t)=>!e||t>e.limit||t===e.limit&&!Vs(e.comparator),$B=(e,t)=>!e||t<e.limit||t===e.limit&&!Vs(e.comparator),z1=(e,t,r)=>{let n=r.lastDomain==="string"?"characters":r.lastDomain==="object"?"items long":void 0;if(Ks(t))return e.push(["bound",n?{...t,units:n}:t]);t.min&&e.push(["bound",n?{...t.min,units:n}:t.min]),t.max&&e.push(["bound",n?{...t.max,units:n}:t.max])},U1=(e,t)=>MB[e.comparator](zm(t.data),e.limit)||!t.problems.add("bound",e),MB={"<":(e,t)=>e<t,">":(e,t)=>e>t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e===t},pi=(e,t,r)=>t?r?t.limit===r.limit?Vs(t.comparator)?Vs(r.comparator)?"=":"l":Vs(r.comparator)?"r":"=":e==="min"?t.limit>r.limit?"l":"r":t.limit<r.limit?"l":"r":"l":r?"r":"=",Vs=e=>e.length===1;var Wm={},Hm=e=>(Wm[e]||(Wm[e]=new RegExp(e)),Wm[e]),W1=(e,t)=>Hm(e).test(t.data)||!t.problems.add("regex",`/${e}/`),H1=Jt(Dc);var V1=(e,t,r)=>"value"in e?"value"in t?e.value===t.value?He():r.addDisjoint("value",e.value,t.value):K1(e.value,t,r)?e:r.addDisjoint("leftAssignability",e,t):"value"in t?K1(t.value,e,r)?t:r.addDisjoint("rightAssignability",e,t):qB(e,t,r),jB=Jt(Dc),qB=li({divisor:$1,regex:H1,props:j1,class:P1,range:B1,narrow:jB},{onEmpty:"bubble"}),Km=(e,t)=>{let r=[],n;for(n in e)LB[n](r,e[n],t);return r.sort((o,i)=>Gs[o[0]]-Gs[i[0]])},LB={regex:(e,t)=>{for(let r of Cr(t))e.push(["regex",r])},divisor:(e,t)=>{e.push(["divisor",t])},range:z1,class:(e,t)=>{e.push(["class",t])},props:q1,narrow:(e,t)=>{for(let r of Cr(t))e.push(["narrow",r])},value:(e,t)=>{e.push(["value",t])}},Gs={config:-1,domain:0,value:0,domains:0,branches:0,switch:0,alias:0,class:0,regex:1,divisor:1,bound:1,prerequisiteProp:2,distilledProps:3,strictProps:3,requiredProp:3,optionalProp:3,indexProp:3,narrow:4,morph:5},K1=(e,t,r)=>!r.type.scope.type(["node",{[r.domain]:t}])(e).problems;var Vm=e=>e?.lBranches!==void 0,J1=(e,t,r)=>{let n={lBranches:e,rBranches:t,lExtendsR:[],rExtendsL:[],equalities:[],distinctIntersections:[]},o=t.map(i=>({condition:i,distinct:[]}));return e.forEach((i,s)=>{let a=!1,u=o.map((l,c)=>{if(a||!l.distinct)return null;let f=l.condition,p=Zs(i,f,r);return ur(p)?null:p===i?(n.lExtendsR.push(s),a=!0,null):p===f?(n.rExtendsL.push(c),l.distinct=null,null):Zt(p)?(n.equalities.push([s,c]),a=!0,l.distinct=null,null):wn(p,"object")?p:xe(`Unexpected predicate intersection result of type '${De(p)}'`)});if(!a)for(let l=0;l<o.length;l++)u[l]&&o[l].distinct?.push(u[l])}),n.distinctIntersections=o.flatMap(i=>i.distinct??[]),n},Gm=e=>"rules"in e,Js=(e,t)=>{if(Gm(e)){let r=Km(e.rules,t);if(e.morph)if(typeof e.morph=="function")r.push(["morph",e.morph]);else for(let n of e.morph)r.push(["morph",n]);return r}return Km(e,t)},G1=e=>e.rules??e,Zs=(e,t,r)=>{let n=G1(e),o=G1(t),i=V1(n,o,r);return"morph"in e?"morph"in t?e.morph===t.morph?Zt(i)||ur(i)?i:{rules:i,morph:e.morph}:r.lastOperator==="&"?ge(Nc(r.path,"Intersection","of morphs")):{}:ur(i)?i:{rules:Zt(i)?e.rules:i,morph:e.morph}:"morph"in t?ur(i)?i:{rules:Zt(i)?t.rules:i,morph:t.morph}:i};var Z1=e=>`${e==="/"?"A":`At ${e}, a`} union including one or more morphs must be discriminatable`;var X1=(e,t)=>{let r=zB(e,t),n=e.map((o,i)=>i);return Q1(e,n,r,t)},Q1=(e,t,r,n)=>{if(t.length===1)return Js(e[t[0]],n);let o=WB(t,r);if(!o)return[["branches",t.map(s=>Zm(e[s],n.type.scope)?ge(Z1(`${n.path}`)):Js(e[s],n))]];let i={};for(let s in o.indexCases){let a=o.indexCases[s];i[s]=Q1(e,a,r,n),s!=="default"&&Ys(i[s],o.path,o,n)}return[["switch",{path:o.path,kind:o.kind,cases:i}]]},Ys=(e,t,r,n)=>{for(let o=0;o<e.length;o++){let[i,s]=e[o];if(t.length){if((i==="requiredProp"||i==="prerequisiteProp"||i==="optionalProp")&&s[0]===t[0]){if(typeof s[1]=="string"){if(r.kind!=="domain")return Jm(r);e.splice(o,1);return}Ys(s[1],t.slice(1),r,n),s[1].length===0&&e.splice(o,1);return}}else if(r.kind==="domain"){if(i==="domain"||i==="domains"){e.splice(o,1);return}else if(i==="class"||i==="value")return}else if(r.kind===i){e.splice(o,1);return}if(i==="domains"){if(S1(s)!==1||!s.object)return Jm(r);Ys(s.object,t,r,n);return}else if(i==="switch"){for(let a in s.cases)Ys(s.cases[a],t,r,n);return}else if(i==="branches"){for(let a of s)Ys(a,t,r,n);return}}return Jm(r)},Jm=e=>xe(`Unexpectedly failed to discriminate ${e.kind} at path '${e.path}'`),BB={domain:!0,class:!0,value:!0},zB=(e,t)=>{let r={disjointsByPair:{},casesByDisjoint:{}};for(let n=0;n<e.length-1;n++)for(let o=n+1;o<e.length;o++){let i=`${n}/${o}`,s=[];r.disjointsByPair[i]=s;let a=new En(t.type,"|");Zs(e[n],e[o],a);for(let u in a.disjoints){if(u.includes(Or.index))continue;let{l,r:c,kind:f}=a.disjoints[u];if(!Gt(f,BB))continue;let p=Y1(f,l),d=Y1(f,c);if(p===void 0||d===void 0)continue;let h=u==="/"?f:`${u}/${f}`;if(s.push(h),!r.casesByDisjoint[h]){r.casesByDisjoint[h]={[p]:[n],[d]:[o]};continue}let b=r.casesByDisjoint[h],y=b[p];y?y.includes(n)||y.push(n):b[p]=[n];let v=b[d];v?v.includes(o)||v.push(o):b[d]=[o]}}return r},UB=e=>{let t=We.fromString(e);return[t,t.pop()]},WB=(e,t)=>{let r;for(let n=0;n<e.length-1;n++){let o=e[n];for(let i=n+1;i<e.length;i++){let s=e[i],a=t.disjointsByPair[`${o}/${s}`];for(let u of a){let l=t.casesByDisjoint[u],c={},f=[...e],p=0;for(let h in l){let b=l[h].filter(y=>{let v=e.indexOf(y);if(v!==-1)return delete f[v],!0});b.length!==0&&(c[h]=b,p++)}let d=we(f);if(d.length&&(c.default=d.map(h=>parseInt(h))),!r||p>r.score){let[h,b]=UB(u);if(r={path:h,kind:b,indexCases:c,score:p},p===e.length)return r}}}}return r},Y1=(e,t)=>{switch(e){case"value":return eI(t);case"domain":return t;case"class":return Rc(t);default:return}},eI=e=>{let t=De(e);return t==="object"||t==="symbol"?void 0:qm(e)},HB={value:e=>eI(e)??"default",class:e=>fi(e)??"default",domain:De},tI=(e,t)=>HB[e](t),Zm=(e,t)=>"morph"in e?!0:"props"in e?Object.values(e.props).some(r=>KB(In(r),t)):!1,KB=(e,t)=>typeof e=="string"?t.resolve(e).includesMorph:Object.values(t.resolveTypeNode(e)).some(r=>r===!0?!1:Sn(r)?r.some(n=>Zm(n,t)):Zm(r,t));var di=e=>e===!0?{}:e,rI=(e,t,r)=>{if(e===!0&&t===!0)return He();if(!Sn(e)&&!Sn(t)){let s=Zs(di(e),di(t),r);return s===e?e:s===t?t:s}let n=Cr(di(e)),o=Cr(di(t)),i=J1(n,o,r);return i.equalities.length===n.length&&i.equalities.length===o.length?He():i.lExtendsR.length+i.equalities.length===n.length?e:i.rExtendsL.length+i.equalities.length===o.length?t:i},nI=(e,t,r,n)=>{n.domain=e;let o=rI(t,r,n);if(!Vm(o))return o;let i=[...o.distinctIntersections,...o.equalities.map(s=>o.lBranches[s[0]]),...o.lExtendsR.map(s=>o.lBranches[s]),...o.rExtendsL.map(s=>o.rBranches[s])];return i.length===0&&n.addDisjoint("union",o.lBranches,o.rBranches),i.length===1?i[0]:i},oI=(e,t,r,n)=>{let o=new En(n,"|"),i=rI(t,r,o);if(!Vm(i))return Zt(i)||i===t?r:i===r?t:e==="boolean"?!0:[di(t),di(r)];let s=[...i.lBranches.filter((a,u)=>!i.lExtendsR.includes(u)&&!i.equalities.some(l=>l[0]===u)),...i.rBranches.filter((a,u)=>!i.rExtendsL.includes(u)&&!i.equalities.some(l=>l[1]===u))];return s.length===1?s[0]:s},Ym=(e,t)=>e===!0?[]:Sn(e)?X1(e,t):Js(e,t),iI=e=>typeof e=="object"&&"value"in e;var Xs=e=>"config"in e,Fc=(e,t,r)=>{r.domain=void 0;let n=r.type.scope.resolveTypeNode(e),o=r.type.scope.resolveTypeNode(t),i=VB(n,o,r);return typeof i=="object"&&!Ls(i)?Ls(r.disjoints)?N1():r.addDisjoint("domain",we(n),we(o)):i===n?e:i===o?t:i},VB=li((e,t,r,n)=>{if(t===void 0)return r===void 0?xe(kc):void 0;if(r!==void 0)return nI(e,t,r,n)},{onEmpty:"omit"}),_n=(e,t,r)=>{let n=new En(r,"&"),o=Fc(e,t,n);return ur(o)?ge(D1(n.disjoints)):Zt(o)?e:o},qc=(e,t,r)=>{let n=r.scope.resolveTypeNode(e),o=r.scope.resolveTypeNode(t),i={},s=we({...n,...o});for(let a of s)i[a]=ci(n,a)?ci(o,a)?oI(a,n[a],o[a],r):n[a]:ci(o,a)?o[a]:xe(kc);return i},GB=e=>e[0]&&(e[0][0]==="value"||e[0][0]==="class"),Xm=e=>{let t={type:e,path:new We,lastDomain:"undefined"};return Tr(e.node,t)},Tr=(e,t)=>{if(typeof e=="string")return t.type.scope.resolve(e).flat;let r=Xs(e),n=JB(r?e.node:e,t);return r?[["config",{config:E1(e.config),node:n}]]:n},JB=(e,t)=>{let r=we(e);if(r.length===1){let o=r[0],i=e[o];if(i===!0)return o;t.lastDomain=o;let s=Ym(i,t);return GB(s)?s:[["domain",o],...s]}let n={};for(let o of r)t.lastDomain=o,n[o]=Ym(e[o],t);return[["domains",n]]},$c=(e,t)=>ZB(e,t)&&iI(e[t]),ZB=(e,t)=>{let r=we(e);return r.length===1&&r[0]===t},mi=e=>({object:{class:Array,props:{[Or.index]:e}}});function Qm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Oe=class{shift(){return this.chars[this.i++]??""}get lookahead(){return this.chars[this.i]??""}shiftUntil(t){let r="";for(;this.lookahead;){if(t(this,r))if(r[r.length-1]===Oe.escapeToken)r=r.slice(0,-1);else break;r+=this.shift()}return r}shiftUntilNextTerminator(){return this.shiftUntil(Oe.lookaheadIsNotWhitespace),this.shiftUntil(Oe.lookaheadIsTerminator)}get unscanned(){return this.chars.slice(this.i,this.chars.length).join("")}lookaheadIs(t){return this.lookahead===t}lookaheadIsIn(t){return this.lookahead in t}constructor(t){Qm(this,"chars",void 0),Qm(this,"i",void 0),Qm(this,"finalized",!1),this.chars=[...t],this.i=0}};(function(e){var t=e.lookaheadIsTerminator=p=>p.lookahead in o,r=e.lookaheadIsNotWhitespace=p=>p.lookahead!==f,n=e.comparatorStartChars={"<":!0,">":!0,"=":!0},o=e.terminatingChars={...n,"|":!0,"&":!0,")":!0,"[":!0,"%":!0," ":!0},i=e.comparators={"<":!0,">":!0,"<=":!0,">=":!0,"==":!0},s=e.oneCharComparators={"<":!0,">":!0},a=e.comparatorDescriptions={"<":"less than",">":"more than","<=":"at most",">=":"at least","==":"exactly"},u=e.invertedComparators={"<":">",">":"<","<=":">=",">=":"<=","==":"=="},l=e.branchTokens={"|":!0,"&":!0},c=e.escapeToken="\\",f=e.whiteSpaceToken=" "})(Oe||(Oe={}));function YB(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XB(e,t){return t.get?t.get.call(e):t.value}function QB(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function sI(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Lc(e,t){var r=sI(e,t,"get");return XB(e,r)}function e6(e,t,r){YB(e,t),t.set(e,r)}function t6(e,t,r){var n=sI(e,t,"set");return QB(e,n,r),r}function Wr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var th=class extends TypeError{constructor(t){super(`${t}`),Wr(this,"cause",void 0),this.cause=t}},lo=class{toString(){return this.message}get message(){return this.writers.addContext(this.reason,this.path)}get reason(){return this.writers.writeReason(this.mustBe,new Mc(this.data))}get mustBe(){return typeof this.writers.mustBe=="string"?this.writers.mustBe:this.writers.mustBe(this.source)}constructor(t,r,n,o,i){Wr(this,"code",void 0),Wr(this,"path",void 0),Wr(this,"data",void 0),Wr(this,"source",void 0),Wr(this,"writers",void 0),Wr(this,"parts",void 0),this.code=t,this.path=r,this.data=n,this.source=o,this.writers=i,this.code==="multi"&&(this.parts=this.source)}},hi=new WeakMap,rh=class extends Array{mustBe(t,r){return this.add("custom",t,r)}add(t,r,n){let o=We.from(n?.path??Lc(this,hi).path),i=n&&"data"in n?n.data:Lc(this,hi).data,s=new lo(t,o,i,r,Lc(this,hi).getProblemConfig(t));return this.addProblem(s),s}addProblem(t){let r=`${t.path}`,n=this.byPath[r];if(n)if(n.parts)n.parts.push(t);else{let o=new lo("multi",n.path,n.data,[n,t],Lc(this,hi).getProblemConfig("multi")),i=this.indexOf(n);this[i===-1?this.length:i]=o,this.byPath[r]=o}else this.byPath[r]=t,this.push(t);this.count++}get summary(){return`${this}`}toString(){return this.join(`
`)}throw(){throw new th(this)}constructor(t){super(),Wr(this,"byPath",{}),Wr(this,"count",0),e6(this,hi,{writable:!0,value:void 0}),t6(this,hi,t)}},Bc=rh,r6=e=>e[0].toUpperCase()+e.slice(1),nh=e=>e.map(t=>Fm[t]),aI=e=>e.map(t=>Bm[t]),eh=e=>{if(e.length===0)return"never";if(e.length===1)return e[0];let t="";for(let r=0;r<e.length-1;r++)t+=e[r],r<e.length-2&&(t+=", ");return t+=` or ${e[e.length-1]}`,t},uo=(e,t)=>`must be ${e}${t&&` (was ${t})`}`,uI=(e,t)=>t.length===0?r6(e):t.length===1&&Bs(t[0])?`Item at index ${t[0]} ${e}`:`${t} ${e}`,co={divisor:{mustBe:e=>e===1?"an integer":`a multiple of ${e}`},class:{mustBe:e=>{let t=Rc(e);return t?Bm[t]:`an instance of ${e.name}`},writeReason:(e,t)=>uo(e,t.className)},domain:{mustBe:e=>Fm[e],writeReason:(e,t)=>uo(e,t.domain)},missing:{mustBe:()=>"defined",writeReason:e=>uo(e,"")},extraneous:{mustBe:()=>"removed",writeReason:e=>uo(e,"")},bound:{mustBe:e=>`${Oe.comparatorDescriptions[e.comparator]} ${e.limit}${e.units?` ${e.units}`:""}`,writeReason:(e,t)=>uo(e,`${t.size}`)},regex:{mustBe:e=>`a string matching ${e}`},value:{mustBe:Te},branches:{mustBe:e=>eh(e.map(t=>`${t.path} must be ${t.parts?eh(t.parts.map(r=>r.mustBe)):t.mustBe}`)),writeReason:(e,t)=>`${e} (was ${t})`,addContext:(e,t)=>t.length?`At ${t}, ${e}`:e},multi:{mustBe:e=>"\u2022 "+e.map(t=>t.mustBe).join(`
\u2022 `),writeReason:(e,t)=>`${t} must be...
${e}`,addContext:(e,t)=>t.length?`At ${t}, ${e}`:e},custom:{mustBe:e=>e},cases:{mustBe:e=>eh(e)}},cI=we(co),n6=()=>{let e={},t;for(t of cI)e[t]={mustBe:co[t].mustBe,writeReason:co[t].writeReason??uo,addContext:co[t].addContext??uI};return e},o6=n6(),lI=e=>{if(!e)return o6;let t={};for(let r of cI)t[r]={mustBe:e[r]?.mustBe??co[r].mustBe,writeReason:e[r]?.writeReason??co[r].writeReason??e.writeReason??uo,addContext:e[r]?.addContext??co[r].addContext??e.addContext??uI};return t};function i6(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s6(e,t){return t.get?t.get.call(e):t.value}function a6(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function dI(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function oh(e,t){var r=dI(e,t,"get");return s6(e,r)}function u6(e,t,r){i6(e,t),t.set(e,r)}function c6(e,t,r){var n=dI(e,t,"set");return a6(e,n,r),r}function kr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l6=()=>({mustBe:[],writeReason:[],addContext:[],keys:[]}),f6=["mustBe","writeReason","addContext"],mI=(e,t)=>{let r=new ih(t,e);zc(e.flat,r);let n=new hI(r);if(r.problems.count)n.problems=r.problems;else{for(let[o,i]of r.entriesToPrune)delete o[i];n.data=r.data}return n},hI=class{constructor(){kr(this,"data",void 0),kr(this,"problems",void 0)}},Qs=new WeakMap,ih=class{getProblemConfig(t){let r={};for(let n of f6)r[n]=this.traversalConfig[n][0]??this.rootScope.config.codes[t][n];return r}traverseConfig(t,r){for(let o of t)this.traversalConfig[o[0]].unshift(o[1]);let n=zc(r,this);for(let o of t)this.traversalConfig[o[0]].shift();return n}traverseKey(t,r){let n=this.data;this.data=this.data[t],this.path.push(t);let o=zc(r,this);return this.path.pop(),n[t]!==this.data&&(n[t]=this.data),this.data=n,o}traverseResolution(t){let r=this.type.scope.resolve(t),n=r.qualifiedName,o=this.data,i=wn(o,"object");if(i){let u=oh(this,Qs)[n];if(u){if(u.includes(o))return!0;u.push(o)}else oh(this,Qs)[n]=[o]}let s=this.type;this.type=r;let a=zc(r.flat,this);return this.type=s,i&&oh(this,Qs)[n].pop(),a}traverseBranches(t){let r=this.failFast;this.failFast=!0;let n=this.problems,o=new Bc(this);this.problems=o;let i=this.path,s=this.entriesToPrune,a=!1;for(let u of t)if(this.path=new We,this.entriesToPrune=[],Uc(u,this)){a=!0,s.push(...this.entriesToPrune);break}return this.path=i,this.entriesToPrune=s,this.problems=n,this.failFast=r,a||!this.problems.add("branches",o)}constructor(t,r){kr(this,"data",void 0),kr(this,"type",void 0),kr(this,"path",void 0),kr(this,"problems",void 0),kr(this,"entriesToPrune",void 0),kr(this,"failFast",void 0),kr(this,"traversalConfig",void 0),kr(this,"rootScope",void 0),u6(this,Qs,{writable:!0,value:void 0}),this.data=t,this.type=r,this.path=new We,this.problems=new Bc(this),this.entriesToPrune=[],this.failFast=!1,this.traversalConfig=l6(),c6(this,Qs,{}),this.rootScope=r.scope}},zc=(e,t)=>typeof e=="string"?De(t.data)===e||!t.problems.add("domain",e):Uc(e,t),Uc=(e,t)=>{let r=!0;for(let n=0;n<e.length;n++){let[o,i]=e[n],s=p6[o](i,t);if(r&&(r=s),!r&&(t.failFast||n<e.length-1&&Gs[o]<Gs[e[n+1][0]]))return!1}return r},fI=(e,t)=>e[0]in t.data?t.traverseKey(e[0],e[1]):(t.problems.add("missing",void 0,{path:t.path.concat(e[0]),data:void 0}),!1),pI=e=>(t,r)=>{let n=!0,o={...t.required};for(let s in r.data)if(t.required[s]?(n=r.traverseKey(s,t.required[s])&&n,delete o[s]):t.optional[s]?n=r.traverseKey(s,t.optional[s])&&n:t.index&&Sc.test(s)?n=r.traverseKey(s,t.index)&&n:e==="distilledProps"?r.failFast?r.entriesToPrune.push([r.data,s]):delete r.data[s]:(n=!1,r.problems.add("extraneous",r.data[s],{path:r.path.concat(s)})),!n&&r.failFast)return!1;let i=Object.keys(o);if(i.length){for(let s of i)r.problems.add("missing",void 0,{path:r.path.concat(s)});return!1}return n},p6={regex:W1,divisor:M1,domains:(e,t)=>{let r=e[De(t.data)];return r?Uc(r,t):!t.problems.add("cases",nh(we(e)))},domain:(e,t)=>De(t.data)===e||!t.problems.add("domain",e),bound:U1,optionalProp:(e,t)=>e[0]in t.data?t.traverseKey(e[0],e[1]):!0,requiredProp:fI,prerequisiteProp:fI,indexProp:(e,t)=>{if(!Array.isArray(t.data))return t.problems.add("class",Array),!1;let r=!0;for(let n=0;n<t.data.length;n++)if(r=t.traverseKey(`${n}`,e)&&r,!r&&t.failFast)return!1;return r},branches:(e,t)=>t.traverseBranches(e),switch:(e,t)=>{let r=I1(t.data,e.path),n=tI(e.kind,r);if(ci(e.cases,n))return Uc(e.cases[n],t);let o=we(e.cases),i=t.path.concat(e.path),s=e.kind==="value"?o:e.kind==="domain"?nh(o):e.kind==="class"?aI(o):xe(`Unexpectedly encountered rule kind '${e.kind}' during traversal`);return t.problems.add("cases",s,{path:i,data:r}),!1},alias:(e,t)=>t.traverseResolution(e),class:F1,narrow:(e,t)=>{let r=t.problems.count,n=e(t.data,t.problems);return!n&&t.problems.count===r&&t.problems.mustBe(e.name?`valid according to ${e.name}`:"valid"),n},config:({config:e,node:t},r)=>r.traverseConfig(e,t),value:(e,t)=>t.data===e||!t.problems.add("value",e),morph:(e,t)=>{let r=e(t.data,t.problems);if(t.problems.length)return!1;if(r instanceof lo)return t.problems.addProblem(r),!1;if(r instanceof hI){if(r.problems){for(let n of r.problems)t.problems.addProblem(n);return!1}return t.data=r.data,!0}return t.data=r,!0},distilledProps:pI("distilledProps"),strictProps:pI("strictProps")};var Cn=new Proxy(()=>Cn,{get:()=>Cn});var sh=(e,t,r,n)=>{let o={node:e,flat:[["alias",e]],allows:a=>!i(a).problems,assert:a=>{let u=i(a);return u.problems?u.problems.throw():u.data},infer:Cn,inferIn:Cn,qualifiedName:d6(e)?n.getAnonymousQualifiedName(e):`${n.name}.${e}`,definition:t,scope:n,includesMorph:!1,config:r},i={[e]:a=>mI(i,a)}[e];return Object.assign(i,o)},ah=e=>e?.infer===Cn,d6=e=>e[0]==="\u03BB";var gI=e=>{let t=e.scanner.shiftUntilNextTerminator();e.setRoot(m6(e,t))},m6=(e,t)=>e.ctx.type.scope.addParsedReferenceIfResolvable(t,e.ctx)?t:h6(t)??e.error(t===""?uh(e):g6(t)),h6=e=>{let t=Us(e);if(t!==void 0)return{number:{value:t}};let r=Mm(e);if(r!==void 0)return{bigint:{value:r}}},g6=e=>`'${e}' is unresolvable`,uh=e=>{let t=e.previousOperator();return t?ch(t,e.scanner.unscanned):y6(e.scanner.unscanned)},ch=(e,t)=>`Token '${e}' requires a right operand${t?` before '${t}'`:""}`,y6=e=>`Expected an expression${e?` before '${e}'`:""}`;var lh=(e,t)=>({node:t.type.scope.resolveTypeNode(Ke(e[0],t)),config:e[2]});var Yt=e=>Object.isFrozen(e)?e:Array.isArray(e)?Object.freeze(e.map(Yt)):b6(e),b6=e=>{for(let t in e)Yt(e[t]);return e};var v6=Yt({regex:zs.source}),x6=Yt({range:{min:{comparator:">=",limit:0}},divisor:1}),yI=(e,t)=>{let r=t.type.scope.resolveNode(Ke(e[1],t)),n=we(r).map(c=>E6(c,r[c])),o=bI(n);if(!o.length)return Nc(t.path,"keyof");let i={};for(let c of o){let f=typeof c;if(f==="string"||f==="number"||f==="symbol"){var s,a;(s=i)[a=f]??(s[a]=[]),i[f].push({value:c})}else if(c===zs){var u,l;(u=i).string??(u.string=[]),i.string.push(v6),(l=i).number??(l.number=[]),i.number.push(x6)}else return xe(`Unexpected keyof key '${Te(c)}'`)}return Object.fromEntries(Object.entries(i).map(([c,f])=>[c,f.length===1?f[0]:f]))},w6={bigint:ao(0n),boolean:ao(!1),null:[],number:ao(0),object:[],string:ao(""),symbol:ao(Symbol()),undefined:[]},E6=(e,t)=>e!=="object"||t===!0?w6[e]:bI(Cr(t).map(r=>S6(r))),bI=e=>{if(!e.length)return[];let t=e[0];for(let r=1;r<e.length;r++)t=t.filter(n=>e[r].includes(n));return t},S6=e=>{let t=[];if("props"in e)for(let r of Object.keys(e.props))r===Or.index?t.push(zs):t.includes(r)||(t.push(r),zs.test(r)&&t.push(Ic(r,`Unexpectedly failed to parse an integer from key '${r}'`)));if("class"in e){let r=typeof e.class=="string"?Ws[e.class]:e.class;for(let n of ao(r.prototype))t.includes(n)||t.push(n)}return t};var xI=(e,t)=>{if(typeof e[2]!="function")return ge(I6(e[2]));let r=Ke(e[0],t),n=t.type.scope.resolveTypeNode(r),o=e[2];t.type.includesMorph=!0;let i,s={};for(i in n){let a=n[i];a===!0?s[i]={rules:{},morph:o}:typeof a=="object"?s[i]=Sn(a)?a.map(u=>vI(u,o)):vI(a,o):xe(`Unexpected predicate value for domain '${i}': ${Te(a)}`)}return s},vI=(e,t)=>Gm(e)?{...e,morph:e.morph?Array.isArray(e.morph)?[...e.morph,t]:[e.morph,t]:t}:{rules:e,morph:t},I6=e=>`Morph expression requires a function following '|>' (was ${typeof e})`;var wI=e=>`Expected a Function or Record<Domain, Function> operand (${Te(e)} was invalid)`,EI=(e,t,r,n)=>{let o=we(t);if(!wn(e,"object"))return ge(wI(e));let i={};if(typeof e=="function"){let s={[n]:e};for(let a of o)i[a]=s}else for(let s of o){if(e[s]===void 0)continue;let a={[n]:e[s]};if(typeof a[n]!="function")return ge(wI(a));i[s]=a}return i};var SI=(e,t)=>{let r=Ke(e[0],t),n=t.type.scope.resolveNode(r),o=Xs(n),i=o?n.node:n,s=_n(r,EI(e[2],i,t,"narrow"),t.type);return o?{config:n.config,node:s}:s};var _I=(e,t)=>{if(C6(e))return CI[e[1]](e,t);if(T6(e))return TI[e[0]](e,t);let r={length:["!",{number:{value:e.length}}]};for(let n=0;n<e.length;n++)t.path.push(`${n}`),r[n]=Ke(e[n],t),t.path.pop();return{object:{class:Array,props:r}}},II=(e,t)=>{if(e[2]===void 0)return ge(ch(e[1],""));let r=Ke(e[0],t),n=Ke(e[2],t);return e[1]==="&"?_n(r,n,t.type):qc(r,n,t.type)},_6=(e,t)=>mi(Ke(e[0],t));var C6=e=>CI[e[1]]!==void 0,CI={"|":II,"&":II,"[]":_6,"=>":SI,"|>":xI,":":lh},TI={keyof:yI,instanceof:e=>typeof e[1]!="function"?ge(`Expected a constructor following 'instanceof' operator (was ${typeof e[1]}).`):{object:{class:e[1]}},"===":e=>({[De(e[1])]:{value:e[1]}}),node:e=>e[1]},T6=e=>TI[e[0]]!==void 0;var OI=(e,t)=>{let r={};for(let n in e){let o=n,i=!1;n[n.length-1]==="?"&&(n[n.length-2]===Oe.escapeToken?o=`${n.slice(0,-2)}?`:(o=n.slice(0,-1),i=!0)),t.path.push(o);let s=Ke(e[n],t);t.path.pop(),r[o]=i?["?",s]:s}return{object:{props:r}}};var kI=e=>`Unmatched )${e===""?"":` before ${e}`}`,AI="Missing )",NI=(e,t)=>`Left bounds are only valid when paired with right bounds (try ...${t}${e})`,Wc=e=>`Left-bounded expressions must specify their limits using < or <= (was ${e})`,RI=(e,t,r,n)=>`An expression may have at most one left bound (parsed ${e}${Oe.invertedComparators[t]}, ${r}${Oe.invertedComparators[n]})`;function ea(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Hc=class{error(t){return ge(t)}hasRoot(){return this.root!==void 0}resolveRoot(){return this.assertHasRoot(),this.ctx.type.scope.resolveTypeNode(this.root)}rootToString(){return this.assertHasRoot(),Te(this.root)}ejectRootIfLimit(){this.assertHasRoot();let t=typeof this.root=="string"?this.ctx.type.scope.resolveNode(this.root):this.root;if($c(t,"number")){let r=t.number.value;return this.root=void 0,r}}ejectRangeIfOpen(){if(this.branches.range){let t=this.branches.range;return delete this.branches.range,t}}assertHasRoot(){if(this.root===void 0)return xe("Unexpected interaction with unset root")}assertUnsetRoot(){if(this.root!==void 0)return xe("Unexpected attempt to overwrite root")}setRoot(t){this.assertUnsetRoot(),this.root=t}rootToArray(){this.root=mi(this.ejectRoot())}intersect(t){this.root=_n(this.ejectRoot(),t,this.ctx.type)}ejectRoot(){this.assertHasRoot();let t=this.root;return this.root=void 0,t}ejectFinalizedRoot(){this.assertHasRoot();let t=this.root;return this.root=O6,t}finalize(){if(this.groups.length)return this.error(AI);this.finalizeBranches(),this.scanner.finalized=!0}reduceLeftBound(t,r){let n=Oe.invertedComparators[r];if(!Gt(n,jc))return this.error(Wc(r));if(this.branches.range)return this.error(RI(`${this.branches.range.limit}`,this.branches.range.comparator,`${t}`,n));this.branches.range={limit:t,comparator:n}}finalizeBranches(){this.assertRangeUnset(),this.branches.union?(this.pushRootToBranch("|"),this.setRoot(this.branches.union)):this.branches.intersection&&this.setRoot(_n(this.branches.intersection,this.ejectRoot(),this.ctx.type))}finalizeGroup(){this.finalizeBranches();let t=this.groups.pop();if(!t)return this.error(kI(this.scanner.unscanned));this.branches=t}pushRootToBranch(t){this.assertRangeUnset(),this.branches.intersection=this.branches.intersection?_n(this.branches.intersection,this.ejectRoot(),this.ctx.type):this.ejectRoot(),t==="|"&&(this.branches.union=this.branches.union?qc(this.branches.union,this.branches.intersection,this.ctx.type):this.branches.intersection,delete this.branches.intersection)}assertRangeUnset(){if(this.branches.range)return this.error(NI(`${this.branches.range.limit}`,this.branches.range.comparator))}reduceGroupOpen(){this.groups.push(this.branches),this.branches={}}previousOperator(){return this.branches.range?.comparator??this.branches.intersection?"&":this.branches.union?"|":void 0}shiftedByOne(){return this.scanner.shift(),this}constructor(t,r){ea(this,"ctx",void 0),ea(this,"scanner",void 0),ea(this,"root",void 0),ea(this,"branches",void 0),ea(this,"groups",void 0),this.ctx=r,this.branches={},this.groups=[],this.scanner=new Oe(t)}},O6=new Proxy({},{get:()=>xe("Unexpected attempt to access ejected attributes")});var DI=(e,t)=>{let r=e.scanner.shiftUntil(k6[t]);if(e.scanner.lookahead==="")return e.error(N6(r,t));e.scanner.shift()==="/"?(Hm(r),e.setRoot({string:{regex:r}})):e.setRoot({string:{value:r}})},PI={"'":1,'"':1,"/":1},k6={"'":e=>e.lookahead==="'",'"':e=>e.lookahead==='"',"/":e=>e.lookahead==="/"},A6={'"':"double-quote","'":"single-quote","/":"forward slash"},N6=(e,t)=>`${t}${e} requires a closing ${A6[t]}`;var Kc=e=>e.scanner.lookahead===""?e.error(uh(e)):e.scanner.lookahead==="("?e.shiftedByOne().reduceGroupOpen():e.scanner.lookaheadIsIn(PI)?DI(e,e.scanner.shift()):e.scanner.lookahead===" "?Kc(e.shiftedByOne()):gI(e);var FI=e=>`Bounded expression ${e} must be a number, string or array`;var $I=(e,t)=>{let r=R6(e,t),n=e.ejectRootIfLimit();return n===void 0?P6(e,r):e.reduceLeftBound(n,r)},R6=(e,t)=>e.scanner.lookaheadIs("=")?`${t}${e.scanner.shift()}`:Gt(t,Oe.oneCharComparators)?t:e.error(D6),D6="= is not a valid comparator. Use == to check for equality",P6=(e,t)=>{let r=e.scanner.shiftUntilNextTerminator(),n=Us(r,M6(t,r+e.scanner.unscanned)),o=e.ejectRangeIfOpen(),i={comparator:t,limit:n},s=o?fh(i,Um)?pi("min",o,i)==="l"?e.error(j6({min:o,max:i})):{min:o,max:i}:e.error(Wc(t)):$6(i,"==")?i:fh(i,jc)?{min:i}:fh(i,Um)?{max:i}:xe(`Unexpected comparator '${i.comparator}'`);e.intersect(F6(s,e))},F6=(e,t)=>{let r=t.resolveRoot(),n=we(r),o={},i={range:e};return n.every(a=>{switch(a){case"string":return o.string=i,!0;case"number":return o.number=i,!0;case"object":return o.object=i,r.object===!0?!1:Cr(r.object).every(u=>"class"in u&&u.class===Array);default:return!1}})||t.error(FI(t.rootToString())),o},$6=(e,t)=>e.comparator===t,fh=(e,t)=>e.comparator in t,M6=(e,t)=>`Comparator ${e} must be followed by a number literal (was '${t}')`,j6=e=>`${Oc(e)} is empty`;var MI=e=>`Divisibility operand ${e} must be a number`;var qI=e=>{let t=e.scanner.shiftUntilNextTerminator(),r=Ic(t,jI(t));r===0&&e.error(jI(0));let n=we(e.resolveRoot());n.length===1&&n[0]==="number"?e.intersect({number:{divisor:r}}):e.error(MI(e.rootToString()))},jI=e=>`% operator must be followed by a non-zero integer literal (was ${e})`;var ph=e=>{let t=e.scanner.shift();return t===""?e.finalize():t==="["?e.scanner.shift()==="]"?e.rootToArray():e.error(L6):Gt(t,Oe.branchTokens)?e.pushRootToBranch(t):t===")"?e.finalizeGroup():Gt(t,Oe.comparatorStartChars)?$I(e,t):t==="%"?qI(e):t===" "?ph(e):xe(q6(t))},q6=e=>`Unexpected character '${e}'`,L6="Missing expected ']'";var LI=(e,t)=>t.type.scope.parseCache.get(e)??t.type.scope.parseCache.set(e,B6(e,t)??z6(e,t)),B6=(e,t)=>{if(t.type.scope.addParsedReferenceIfResolvable(e,t))return e;if(e.endsWith("[]")){let r=e.slice(0,-2);if(t.type.scope.addParsedReferenceIfResolvable(e,t))return mi(r)}},z6=(e,t)=>{let r=new Hc(e,t);return Kc(r),U6(r)},U6=e=>{for(;!e.scanner.finalized;)W6(e);return e.ejectFinalizedRoot()},W6=e=>e.hasRoot()?ph(e):Kc(e);var Ke=(e,t)=>{let r=De(e);if(r==="string")return LI(e,t);if(r!=="object")return ge(dh(r));let n=fi(e);switch(n){case"Object":return OI(e,t);case"Array":return _I(e,t);case"RegExp":return{string:{regex:e.source}};case"Function":if(ah(e))return t.type.scope.addAnonymousTypeReference(e,t);if(H6(e)){let o=e();if(ah(o))return t.type.scope.addAnonymousTypeReference(o,t)}return ge(dh("Function"));default:return ge(dh(n??Te(e)))}},Hce=Symbol("as"),H6=e=>typeof e=="function"&&e.length===0,dh=e=>`Type definitions must be strings or objects (was ${e})`;function K6(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var gi=class{get root(){return this.cache}has(t){return t in this.cache}get(t){return this.cache[t]}set(t,r){return this.cache[t]=r,r}constructor(){K6(this,"cache",{})}},Vc=class extends gi{set(t,r){return this.cache[t]=Yt(r),r}};function HI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function V6(e,t){return t.get?t.get.call(e):t.value}function G6(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function KI(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Kr(e,t){var r=KI(e,t,"get");return V6(e,r)}function BI(e,t,r){HI(e,t),t.set(e,r)}function zI(e,t,r){var n=KI(e,t,"set");return G6(e,n,r),r}function Hr(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Gc(e,t){HI(e,t),t.add(e)}function xt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var J6=e=>({codes:lI(e.codes),keys:e.keys??"loose"}),Z6=0,UI={},mh={};var fo=new WeakMap,yi=new WeakMap,WI=new WeakSet,Jc=new WeakSet,gh=new WeakSet,Zc=new WeakSet,yh=class{getAnonymousQualifiedName(t){let r=0,n=t;for(;this.isResolvable(n);)n=`${t}${r++}`;return`${this.name}.${n}`}addAnonymousTypeReference(t,r){var n;return(n=r.type).includesMorph||(n.includesMorph=t.includesMorph),t.node}get infer(){return Cn}compile(){if(!mh[this.name]){for(let t in this.aliases)this.resolve(t);mh[this.name]=Kr(this,yi).root}return Kr(this,yi).root}addParsedReferenceIfResolvable(t,r){var n;let o=Hr(this,Zc,bh).call(this,t,"undefined",[t]);return o?((n=r.type).includesMorph||(n.includesMorph=o.includesMorph),!0):!1}resolve(t){return Hr(this,Zc,bh).call(this,t,"throw",[t])}resolveNode(t){return typeof t=="string"?this.resolveNode(this.resolve(t).node):t}resolveTypeNode(t){let r=this.resolveNode(t);return Xs(r)?r.node:r}isResolvable(t){return Kr(this,fo).has(t)||this.aliases[t]}constructor(t,r={}){Gc(this,WI),Gc(this,Jc),Gc(this,gh),Gc(this,Zc),xt(this,"aliases",void 0),xt(this,"name",void 0),xt(this,"config",void 0),xt(this,"parseCache",void 0),BI(this,fo,{writable:!0,value:void 0}),BI(this,yi,{writable:!0,value:void 0}),xt(this,"expressions",void 0),xt(this,"intersection",void 0),xt(this,"union",void 0),xt(this,"arrayOf",void 0),xt(this,"keyOf",void 0),xt(this,"valueOf",void 0),xt(this,"instanceOf",void 0),xt(this,"narrow",void 0),xt(this,"morph",void 0),xt(this,"type",void 0),this.aliases=t,this.parseCache=new Vc,zI(this,fo,new gi),zI(this,yi,new gi),this.expressions={intersection:(n,o,i)=>this.type([n,"&",o],i),union:(n,o,i)=>this.type([n,"|",o],i),arrayOf:(n,o)=>this.type([n,"[]"],o),keyOf:(n,o)=>this.type(["keyof",n],o),node:(n,o)=>this.type(["node",n],o),instanceOf:(n,o)=>this.type(["instanceof",n],o),valueOf:(n,o)=>this.type(["===",n],o),narrow:(n,o,i)=>this.type([n,"=>",o],i),morph:(n,o,i)=>this.type([n,"|>",o],i)},this.intersection=this.expressions.intersection,this.union=this.expressions.union,this.arrayOf=this.expressions.arrayOf,this.keyOf=this.expressions.keyOf,this.valueOf=this.expressions.valueOf,this.instanceOf=this.expressions.instanceOf,this.narrow=this.expressions.narrow,this.morph=this.expressions.morph,this.type=Object.assign((n,o={})=>{let i=sh("\u03BBtype",n,o,this),s=Hr(this,gh,VI).call(this,i),a=Ke(n,s);return i.node=Yt(Ls(o)?{config:o,node:this.resolveTypeNode(a)}:a),i.flat=Yt(Xm(i)),i},{from:this.expressions.node}),this.name=Hr(this,WI,Y6).call(this,r),r.standard!==!1&&Hr(this,Jc,hh).call(this,[mh.standard],"imports"),r.imports&&Hr(this,Jc,hh).call(this,r.imports,"imports"),r.includes&&Hr(this,Jc,hh).call(this,r.includes,"includes"),this.config=J6(r)}};function Y6(e){let t=e.name?UI[e.name]?ge(`A scope named '${e.name}' already exists`):e.name:`scope${++Z6}`;return UI[t]=this,t}function hh(e,t){for(let r of e)for(let n in r)(Kr(this,fo).has(n)||n in this.aliases)&&ge(Q6(n)),Kr(this,fo).set(n,r[n]),t==="includes"&&Kr(this,yi).set(n,r[n])}function VI(e){return{type:e,path:new We}}function bh(e,t,r){let n=Kr(this,fo).get(e);if(n)return n;let o=this.aliases[e];if(!o)return t==="throw"?xe(`Unexpectedly failed to resolve alias '${e}'`):void 0;let i=sh(e,o,{},this),s=Hr(this,gh,VI).call(this,i);Kr(this,fo).set(e,i),Kr(this,yi).set(e,i);let a=Ke(o,s);if(typeof a=="string"){if(r.includes(a))return ge(X6(e,r));r.push(a),a=Hr(this,Zc,bh).call(this,a,"throw",r).node}return i.node=Yt(a),i.flat=Yt(Xm(i)),i}var wt=(e,t={})=>new yh(e,t),vh=wt({},{name:"root",standard:!1}),cr=vh.type,X6=(e,t)=>`Alias '${e}' has a shallow resolution cycle: ${[...t,e].join("=>")}`,Q6=e=>`Alias '${e}' is already defined`;var Yc=wt({Function:["node",{object:{class:Function}}],Date:["node",{object:{class:Date}}],Error:["node",{object:{class:Error}}],Map:["node",{object:{class:Map}}],RegExp:["node",{object:{class:RegExp}}],Set:["node",{object:{class:Set}}],WeakMap:["node",{object:{class:WeakMap}}],WeakSet:["node",{object:{class:WeakSet}}],Promise:["node",{object:{class:Promise}}]},{name:"jsObjects",standard:!1}),GI=Yc.compile();var JI={bigint:!0,boolean:!0,null:!0,number:!0,object:!0,string:!0,symbol:!0,undefined:!0},Xc=wt({any:["node",JI],bigint:["node",{bigint:!0}],boolean:["node",{boolean:!0}],false:["node",{boolean:{value:!1}}],never:["node",{}],null:["node",{null:!0}],number:["node",{number:!0}],object:["node",{object:!0}],string:["node",{string:!0}],symbol:["node",{symbol:!0}],true:["node",{boolean:{value:!0}}],unknown:["node",JI],void:["node",{undefined:!0}],undefined:["node",{undefined:!0}]},{name:"ts",standard:!1}),po=Xc.compile();var ez=e=>{let t=e.replace(/[- ]+/g,""),r=0,n,o,i;for(let s=t.length-1;s>=0;s--)n=t.substring(s,s+1),o=parseInt(n,10),i?(o*=2,o>=10?r+=o%10+1:r+=o):r+=o,i=!i;return!!(r%10===0&&t)},tz=/^(?:4[0-9]{12}(?:[0-9]{3,6})?|5[1-5][0-9]{14}|(222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}|6(?:011|5[0-9][0-9])[0-9]{12,15}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11}|6[27][0-9]{14}|^(81[0-9]{14,17}))$/,ZI=cr([tz,"=>",(e,t)=>ez(e)||!t.mustBe("a valid credit card number")],{mustBe:"a valid credit card number"});var rz=/^[./-]$/,nz=/^([+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T]((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([.,]\d+(?!:))?)?(\17[0-5]\d([.,]\d+)?)?([zZ]|([+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,oz=e=>!isNaN(e),Qc=e=>`a ${e}-formatted date`,iz=(e,t)=>{if(!t?.format){let a=new Date(e);return oz(a)?a:"a valid date"}if(t.format==="iso8601")return nz.test(e)?new Date(e):Qc("iso8601");let r=e.split(rz),n=e[r[0].length],o=n?t.format.split(n):[t.format];if(r.length!==o.length)return Qc(t.format);let i={};for(let a=0;a<o.length;a++){if(r[a].length!==o[a].length&&!(o[a].length===1&&r[a].length===2))return Qc(t.format);i[o[a][0]]=r[a]}let s=new Date(`${i.m}/${i.d}/${i.y}`);return`${s.getDate()}`===i.d?s:Qc(t.format)},YI=cr([po.string,"|>",(e,t)=>{let r=iz(e);return typeof r=="string"?t.mustBe(r):r}]);var sz=cr([$m,"|>",e=>parseFloat(e)],{mustBe:"a well-formed numeric string"}),az=cr([po.string,"|>",(e,t)=>{if(!Bs(e))return t.mustBe("a well-formed integer string");let r=parseInt(e);return Number.isSafeInteger(r)?r:t.mustBe("an integer in the range Number.MIN_SAFE_INTEGER to Number.MAX_SAFE_INTEGER")}]),uz=cr(/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/,{mustBe:"a valid email"}),cz=cr(/^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$/,{mustBe:"a valid UUID"}),lz=cr(/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/,{mustBe:"a valid semantic version (see https://semver.org/)"}),fz=cr([po.string,"|>",e=>JSON.parse(e)],{mustBe:"a JSON-parsable string"}),el=wt({alpha:[/^[A-Za-z]*$/,":",{mustBe:"only letters"}],alphanumeric:[/^[A-Za-z\d]*$/,":",{mustBe:"only letters and digits"}],lowercase:[/^[a-z]*$/,":",{mustBe:"only lowercase letters"}],uppercase:[/^[A-Z]*$/,":",{mustBe:"only uppercase letters"}],creditCard:ZI,email:uz,uuid:cz,parsedNumber:sz,parsedInteger:az,parsedDate:YI,semver:lz,json:fz,integer:["node",{number:{divisor:1}}]},{name:"validation",standard:!1}),XI=el.compile();var tl=wt({},{name:"standard",includes:[po,GI,XI],standard:!1}),pz=tl.compile(),Vr={root:vh,tsKeywords:Xc,jsObjects:Yc,validation:el,ark:tl};var ta=tl.type;var dz=Vr.ark.intersection,mz=Vr.ark.union,hz=Vr.ark.arrayOf,gz=Vr.ark.keyOf,yz=Vr.ark.instanceOf,bz=Vr.ark.valueOf,vz=Vr.ark.narrow,xz=Vr.ark.morph;var{DataRequest:jle,DataResponse:QI}=wt({DataRequest:{id:"number",method:"string",params:"any[]"},DataResponse:{id:"number","eventName?":"string",payload:"any",error:"any"}}).compile(),rl="__METHODS__",nl="__EVAL__";var e_=()=>({events:{},emit(e,...t){let r=this.events[e]||[];for(let n=0,o=r.length;n<o;n++)r[n](...t)},on(e,t){return this.events[e]?.push(t)||(this.events[e]=[t]),()=>{this.events[e]=this.events[e]?.filter(r=>t!==r)}}});function mo(){let e=e_();return e.once=(t,r)=>{let n=(...i)=>{o(),r(...i)},o=e.on(t,n);return o},e}function wz(e){return Object.assign(new Error,e)}var ho=class{pending=new Map;terminateState=!1;terminationHandler=null;lastId=0;worker;constructor(){this.worker=this.setupWorker(),this.worker.onMessage(t=>this.onMessage(t.data)),this.worker.onError(t=>this.onError(t.error))}internal=mo();evt=mo();task=mo();onMessage(t){if(this.terminateState==="finished")return;if(t==="ready"){this.internal.emit("ready");return}let{data:r,problems:n}=QI(t);if(n)throw new Error(n.toString());if(r.eventName){this.evt.emit(r.eventName,r.payload);return}this.task.emit(r.id,r.payload,r.error),this.terminateState==="requested"&&this.terminate()}onError(t){for(let r of this.pending.values())r.abort(t);this.pending.clear(),this.worker.terminate()}methods(){return this.invoke(rl)}eval(t,r,n){let o=[t,...r];return this.invoke(nl,o,{transfer:n})}send({id:t,method:r,params:n,transfer:o,timeout:i},s=new AbortController){let a=s.signal;return this.pending.set(t,s),new Promise((u,l)=>{this.worker.send({id:t,method:r,params:n},{transfer:o});let c=-1,f=()=>{l(a?.reason),p(),window.clearTimeout(c)};i!==void 0&&(c=window.setTimeout(()=>{s.abort(new DOMException(`Timeout after ${i}ms`,"TimeoutError"))},i)),a?.addEventListener("abort",f);let p=this.task.once(t,(d,h)=>{a?.removeEventListener("abort",f),h?l(wz(h)):u(d)})}).catch(u=>{if(u instanceof DOMException&&["AbortError","TimeoutError"].includes(u.name))return this.terminate(!0).then(()=>{throw u});throw u}).finally(()=>{this.pending.delete(t)})}async invoke(t,r=[],{controller:n,transfer:o}={}){if(this.terminateState!==!1)throw new Error("Worker is terminated");let i=++this.lastId;return await this.worker.readyPromise,await this.send({id:i,method:t,params:r,transfer:o},n)}busy(){return this.pending.size>0}terminate(t=!1,r){if(t){for(let n of this.pending.values())n.abort(new Error("Worker terminated"));this.pending.clear()}if(this.busy()){this.terminateState="requested";let n=new Promise(o=>{this.internal.once("terminate",o)});return r!==void 0?Promise.race([n,Ez(r)]).then():n}return this.worker.terminate(),Promise.resolve()}};function Ez(e){return new Promise(t=>setTimeout(()=>t(new DOMException(`Timeout after ${e}ms`,"TimeoutError")),e))}var bi=class extends ho{setupWorker(){let t=this,r=Object.assign(this.initWebWorker(),{readyPromise:new Promise(n=>t.internal.once("ready",()=>n(!0))),killed:!1,send(n,o){r.postMessage(n,o)},onMessage(n){return r.addEventListener("message",n),()=>r.removeEventListener("message",n)},onError(n){return r.addEventListener("error",n),()=>r.removeEventListener("error",n)}});return Lt(r,{terminate:n=>function(){r.killed||(n.call(this),r.killed=!0,t.internal.emit("terminate")),t.terminateState="finished"}}),r}};var vi=class{workers=[];tasks=[];pending=new Map;emitter=mo();#e=mo();maxQueueSize=1/0;maxWorkers=Math.max((this.getMaxConcurrency()||4)-1,1);minWorkers=0;getMaxConcurrency(){return navigator.hardwareConcurrency}constructor(t={}){if(t.maxQueueSize!==void 0&&(this.maxQueueSize=Iz.assert(t.maxQueueSize)),t.maxWorkers!==void 0&&(this.maxWorkers=Sz.assert(t.maxWorkers)),t.minWorkers!==void 0){let o=_z.assert(t.minWorkers);o==="max"?this.minWorkers=this.maxWorkers:(this.minWorkers=o,this.maxWorkers=Math.max(this.minWorkers,this.maxWorkers)),this.ensureMinWorkers()}let r={},n=o=>r[o]??=(...i)=>this.invoke(o,i);this.proxy=new Proxy(r,{get:(o,i)=>!Reflect.has(o,i)&&typeof i=="string"?n(i):Reflect.get(o,i)}),this.methods().then(o=>o.forEach(n))}eval(t,r,n={}){return this.invoke(nl,[typeof t=="string"?t:t.toString(),r],n)}invoke(t,r=[],n={}){if(this.tasks.length>=this.maxQueueSize)throw new Error("Max queue size of "+this.maxQueueSize+" reached");let o={method:t,params:r,transfer:n.transfer};return this.tasks.push(o),this.pending.set(o,n.controller??new AbortController),this.next(),new Promise((i,s)=>{let a=[this.#e.on("complete",(u,l)=>{o===u&&(a.forEach(c=>c()),i(l))}),this.#e.on("error",(u,l)=>{o===u&&(a.forEach(c=>c()),s(l))})]})}methods(){return this.invoke(rl)}proxy;next(){if(this.tasks.length===0)return;let t=this.getWorker();if(!t)return;let r=this.tasks.shift();if(!this.pending.has(r))return this.next();let n=this.pending.get(r);t.invoke(r.method,r.params,{transfer:r.transfer,timeout:r.timeout,controller:n}).then(o=>{this.#e.emit("complete",r,o)}).catch(o=>{this.#e.emit("error",r,o),t.terminateState==="finished"&&this.removeWorker(t)}).finally(()=>{this.pending.delete(r),this.next()})}getWorker(){for(let t of this.workers)if(!t.busy())return t;if(this.workers.length<this.maxWorkers){let t=this.initWorker();return this.workers.push(t),t}return null}async removeWorker(t){return this.removeWorkerFromList(t),this.ensureMinWorkers(),await t.terminate(!1),this.emitter.emit("worker-terminate"),t}removeWorkerFromList(t){let r=this.workers.indexOf(t);r!==-1&&this.workers.splice(r,1)}terminate(t=!1,r){for(let n of this.pending.values())n.abort(new Error("Pool terminated"));return this.tasks.length=0,this.pending.clear(),Promise.all(this.workers.slice().map(async n=>{try{await n.terminate(t,r),this.removeWorkerFromList(n)}finally{this.emitter.emit("worker-terminate")}})).then()}get stats(){let t=this.workers.length,r=this.workers.filter(function(n){return n.busy()}).length;return{totalWorkers:t,busyWorkers:r,idleWorkers:t-r,pendingTasks:this.tasks.length,activeTasks:r}}ensureMinWorkers(){if(this.minWorkers)for(let t=this.workers.length;t<this.minWorkers;t++)this.workers.push(this.initWorker())}initWorker(){let t=this.workerCtor();return this.emitter.emit("worker-create"),t}},Sz=ta("integer>=1"),Iz=ta("integer>=1"),_z=ta('integer>=0|"max"');var t_='"use strict";var Jg=Object.create;var hu=Object.defineProperty;var Vg=Object.getOwnPropertyDescriptor;var Hg=Object.getOwnPropertyNames;var Yg=Object.getPrototypeOf,Zg=Object.prototype.hasOwnProperty;var D=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Qg=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Hg(t))!Zg.call(e,o)&&o!==r&&hu(e,o,{get:()=>t[o],enumerable:!(n=Vg(t,o))||n.enumerable});return e};var Fr=(e,t,r)=>(r=e!=null?Jg(Yg(e)):{},Qg(t||!e||!e.__esModule?hu(r,"default",{value:e,enumerable:!0}):r,e));var Ws=D((cf,zs)=>{(function(e){if(typeof cf=="object"&&typeof zs<"u")zs.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t=this,t.localforage=e()}})(function(){var e,t,r;return function n(o,i,s){function a(f,d){if(!i[f]){if(!o[f]){var l=typeof require=="function"&&require;if(!d&&l)return l(f,!0);if(u)return u(f,!0);var g=new Error("Cannot find module \'"+f+"\'");throw g.code="MODULE_NOT_FOUND",g}var w=i[f]={exports:{}};o[f][0].call(w.exports,function(x){var S=o[f][1][x];return a(S||x)},w,w.exports,n,o,i,s)}return i[f].exports}for(var u=typeof require=="function"&&require,m=0;m<s.length;m++)a(s[m]);return a}({1:[function(n,o,i){(function(s){"use strict";var a=s.MutationObserver||s.WebKitMutationObserver,u;if(a){var m=0,f=new a(x),d=s.document.createTextNode("");f.observe(d,{characterData:!0}),u=function(){d.data=m=++m%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var l=new s.MessageChannel;l.port1.onmessage=x,u=function(){l.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?u=function(){var N=s.document.createElement("script");N.onreadystatechange=function(){x(),N.onreadystatechange=null,N.parentNode.removeChild(N),N=null},s.document.documentElement.appendChild(N)}:u=function(){setTimeout(x,0)};var g,w=[];function x(){g=!0;for(var N,q,k=w.length;k;){for(q=w,w=[],N=-1;++N<k;)q[N]();k=w.length}g=!1}o.exports=S;function S(N){w.push(N)===1&&!g&&u()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,o,i){"use strict";var s=n(1);function a(){}var u={},m=["REJECTED"],f=["FULFILLED"],d=["PENDING"];o.exports=l;function l(R){if(typeof R!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,R!==a&&S(this,R)}l.prototype.catch=function(R){return this.then(null,R)},l.prototype.then=function(R,B){if(typeof R!="function"&&this.state===f||typeof B!="function"&&this.state===m)return this;var L=new this.constructor(a);if(this.state!==d){var A=this.state===f?R:B;w(L,A,this.outcome)}else this.queue.push(new g(L,R,B));return L};function g(R,B,L){this.promise=R,typeof B=="function"&&(this.onFulfilled=B,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}g.prototype.callFulfilled=function(R){u.resolve(this.promise,R)},g.prototype.otherCallFulfilled=function(R){w(this.promise,this.onFulfilled,R)},g.prototype.callRejected=function(R){u.reject(this.promise,R)},g.prototype.otherCallRejected=function(R){w(this.promise,this.onRejected,R)};function w(R,B,L){s(function(){var A;try{A=B(L)}catch(M){return u.reject(R,M)}A===R?u.reject(R,new TypeError("Cannot resolve promise with itself")):u.resolve(R,A)})}u.resolve=function(R,B){var L=N(x,B);if(L.status==="error")return u.reject(R,L.value);var A=L.value;if(A)S(R,A);else{R.state=f,R.outcome=B;for(var M=-1,O=R.queue.length;++M<O;)R.queue[M].callFulfilled(B)}return R},u.reject=function(R,B){R.state=m,R.outcome=B;for(var L=-1,A=R.queue.length;++L<A;)R.queue[L].callRejected(B);return R};function x(R){var B=R&&R.then;if(R&&(typeof R=="object"||typeof R=="function")&&typeof B=="function")return function(){B.apply(R,arguments)}}function S(R,B){var L=!1;function A(F){L||(L=!0,u.reject(R,F))}function M(F){L||(L=!0,u.resolve(R,F))}function O(){B(M,A)}var P=N(O);P.status==="error"&&A(P.value)}function N(R,B){var L={};try{L.value=R(B),L.status="success"}catch(A){L.status="error",L.value=A}return L}l.resolve=q;function q(R){return R instanceof this?R:u.resolve(new this(a),R)}l.reject=k;function k(R){var B=new this(a);return u.reject(B,R)}l.all=ee;function ee(R){var B=this;if(Object.prototype.toString.call(R)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=R.length,A=!1;if(!L)return this.resolve([]);for(var M=new Array(L),O=0,P=-1,F=new this(a);++P<L;)U(R[P],P);return F;function U(j,W){B.resolve(j).then(K,function(X){A||(A=!0,u.reject(F,X))});function K(X){M[W]=X,++O===L&&!A&&(A=!0,u.resolve(F,M))}}}l.race=xe;function xe(R){var B=this;if(Object.prototype.toString.call(R)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=R.length,A=!1;if(!L)return this.resolve([]);for(var M=-1,O=new this(a);++M<L;)P(R[M]);return O;function P(F){B.resolve(F).then(function(U){A||(A=!0,u.resolve(O,U))},function(U){A||(A=!0,u.reject(O,U))})}}},{1:1}],3:[function(n,o,i){(function(s){"use strict";typeof s.Promise!="function"&&(s.Promise=n(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,o,i){"use strict";var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c};function a(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")}function u(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var m=u();function f(){try{if(!m||!m.open)return!1;var c=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),h=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!c||h)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(c,h){c=c||[],h=h||{};try{return new Blob(c,h)}catch(y){if(y.name!=="TypeError")throw y;for(var p=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,v=new p,b=0;b<c.length;b+=1)v.append(c[b]);return v.getBlob(h.type)}}typeof Promise>"u"&&n(3);var l=Promise;function g(c,h){h&&c.then(function(p){h(null,p)},function(p){h(p)})}function w(c,h,p){typeof h=="function"&&c.then(h),typeof p=="function"&&c.catch(p)}function x(c){return typeof c!="string"&&(console.warn(c+" used as a key, but it is not a string."),c=String(c)),c}function S(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var N="local-forage-detect-blob-support",q=void 0,k={},ee=Object.prototype.toString,xe="readonly",R="readwrite";function B(c){for(var h=c.length,p=new ArrayBuffer(h),v=new Uint8Array(p),b=0;b<h;b++)v[b]=c.charCodeAt(b);return p}function L(c){return new l(function(h){var p=c.transaction(N,R),v=d([""]);p.objectStore(N).put(v,"key"),p.onabort=function(b){b.preventDefault(),b.stopPropagation(),h(!1)},p.oncomplete=function(){var b=navigator.userAgent.match(/Chrome\\/(\\d+)/),y=navigator.userAgent.match(/Edge\\//);h(y||!b||parseInt(b[1],10)>=43)}}).catch(function(){return!1})}function A(c){return typeof q=="boolean"?l.resolve(q):L(c).then(function(h){return q=h,q})}function M(c){var h=k[c.name],p={};p.promise=new l(function(v,b){p.resolve=v,p.reject=b}),h.deferredOperations.push(p),h.dbReady?h.dbReady=h.dbReady.then(function(){return p.promise}):h.dbReady=p.promise}function O(c){var h=k[c.name],p=h.deferredOperations.pop();if(p)return p.resolve(),p.promise}function P(c,h){var p=k[c.name],v=p.deferredOperations.pop();if(v)return v.reject(h),v.promise}function F(c,h){return new l(function(p,v){if(k[c.name]=k[c.name]||Ha(),c.db)if(h)M(c),c.db.close();else return p(c.db);var b=[c.name];h&&b.push(c.version);var y=m.open.apply(m,b);h&&(y.onupgradeneeded=function(E){var I=y.result;try{I.createObjectStore(c.storeName),E.oldVersion<=1&&I.createObjectStore(N)}catch(_){if(_.name==="ConstraintError")console.warn(\'The database "\'+c.name+\'" has been upgraded from version \'+E.oldVersion+" to version "+E.newVersion+\', but the storage "\'+c.storeName+\'" already exists.\');else throw _}}),y.onerror=function(E){E.preventDefault(),v(y.error)},y.onsuccess=function(){var E=y.result;E.onversionchange=function(I){I.target.close()},p(E),O(c)}})}function U(c){return F(c,!1)}function j(c){return F(c,!0)}function W(c,h){if(!c.db)return!0;var p=!c.db.objectStoreNames.contains(c.storeName),v=c.version<c.db.version,b=c.version>c.db.version;if(v&&(c.version!==h&&console.warn(\'The database "\'+c.name+`" can\'t be downgraded from version `+c.db.version+" to version "+c.version+"."),c.version=c.db.version),b||p){if(p){var y=c.db.version+1;y>c.version&&(c.version=y)}return!0}return!1}function K(c){return new l(function(h,p){var v=new FileReader;v.onerror=p,v.onloadend=function(b){var y=btoa(b.target.result||"");h({__local_forage_encoded_blob:!0,data:y,type:c.type})},v.readAsBinaryString(c)})}function X(c){var h=B(atob(c.data));return d([h],{type:c.type})}function V(c){return c&&c.__local_forage_encoded_blob}function Gn(c){var h=this,p=h._initReady().then(function(){var v=k[h._dbInfo.name];if(v&&v.dbReady)return v.dbReady});return w(p,c,c),p}function Hh(c){M(c);for(var h=k[c.name],p=h.forages,v=0;v<p.length;v++){var b=p[v];b._dbInfo.db&&(b._dbInfo.db.close(),b._dbInfo.db=null)}return c.db=null,U(c).then(function(y){return c.db=y,W(c)?j(c):y}).then(function(y){c.db=h.db=y;for(var E=0;E<p.length;E++)p[E]._dbInfo.db=y}).catch(function(y){throw P(c,y),y})}function ft(c,h,p,v){v===void 0&&(v=1);try{var b=c.db.transaction(c.storeName,h);p(null,b)}catch(y){if(v>0&&(!c.db||y.name==="InvalidStateError"||y.name==="NotFoundError"))return l.resolve().then(function(){if(!c.db||y.name==="NotFoundError"&&!c.db.objectStoreNames.contains(c.storeName)&&c.version<=c.db.version)return c.db&&(c.version=c.db.version+1),j(c)}).then(function(){return Hh(c).then(function(){ft(c,h,p,v-1)})}).catch(p);p(y)}}function Ha(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Yh(c){var h=this,p={db:null};if(c)for(var v in c)p[v]=c[v];var b=k[p.name];b||(b=Ha(),k[p.name]=b),b.forages.push(h),h._initReady||(h._initReady=h.ready,h.ready=Gn);var y=[];function E(){return l.resolve()}for(var I=0;I<b.forages.length;I++){var _=b.forages[I];_!==h&&y.push(_._initReady().catch(E))}var T=b.forages.slice(0);return l.all(y).then(function(){return p.db=b.db,U(p)}).then(function(C){return p.db=C,W(p,h._defaultConfig.version)?j(p):C}).then(function(C){p.db=b.db=C,h._dbInfo=p;for(var $=0;$<T.length;$++){var z=T[$];z!==h&&(z._dbInfo.db=p.db,z._dbInfo.version=p.version)}})}function Zh(c,h){var p=this;c=x(c);var v=new l(function(b,y){p.ready().then(function(){ft(p._dbInfo,xe,function(E,I){if(E)return y(E);try{var _=I.objectStore(p._dbInfo.storeName),T=_.get(c);T.onsuccess=function(){var C=T.result;C===void 0&&(C=null),V(C)&&(C=X(C)),b(C)},T.onerror=function(){y(T.error)}}catch(C){y(C)}})}).catch(y)});return g(v,h),v}function Qh(c,h){var p=this,v=new l(function(b,y){p.ready().then(function(){ft(p._dbInfo,xe,function(E,I){if(E)return y(E);try{var _=I.objectStore(p._dbInfo.storeName),T=_.openCursor(),C=1;T.onsuccess=function(){var $=T.result;if($){var z=$.value;V(z)&&(z=X(z));var H=c(z,$.key,C++);H!==void 0?b(H):$.continue()}else b()},T.onerror=function(){y(T.error)}}catch($){y($)}})}).catch(y)});return g(v,h),v}function Xh(c,h,p){var v=this;c=x(c);var b=new l(function(y,E){var I;v.ready().then(function(){return I=v._dbInfo,ee.call(h)==="[object Blob]"?A(I.db).then(function(_){return _?h:K(h)}):h}).then(function(_){ft(v._dbInfo,R,function(T,C){if(T)return E(T);try{var $=C.objectStore(v._dbInfo.storeName);_===null&&(_=void 0);var z=$.put(_,c);C.oncomplete=function(){_===void 0&&(_=null),y(_)},C.onabort=C.onerror=function(){var H=z.error?z.error:z.transaction.error;E(H)}}catch(H){E(H)}})}).catch(E)});return g(b,p),b}function eg(c,h){var p=this;c=x(c);var v=new l(function(b,y){p.ready().then(function(){ft(p._dbInfo,R,function(E,I){if(E)return y(E);try{var _=I.objectStore(p._dbInfo.storeName),T=_.delete(c);I.oncomplete=function(){b()},I.onerror=function(){y(T.error)},I.onabort=function(){var C=T.error?T.error:T.transaction.error;y(C)}}catch(C){y(C)}})}).catch(y)});return g(v,h),v}function tg(c){var h=this,p=new l(function(v,b){h.ready().then(function(){ft(h._dbInfo,R,function(y,E){if(y)return b(y);try{var I=E.objectStore(h._dbInfo.storeName),_=I.clear();E.oncomplete=function(){v()},E.onabort=E.onerror=function(){var T=_.error?_.error:_.transaction.error;b(T)}}catch(T){b(T)}})}).catch(b)});return g(p,c),p}function rg(c){var h=this,p=new l(function(v,b){h.ready().then(function(){ft(h._dbInfo,xe,function(y,E){if(y)return b(y);try{var I=E.objectStore(h._dbInfo.storeName),_=I.count();_.onsuccess=function(){v(_.result)},_.onerror=function(){b(_.error)}}catch(T){b(T)}})}).catch(b)});return g(p,c),p}function ng(c,h){var p=this,v=new l(function(b,y){if(c<0){b(null);return}p.ready().then(function(){ft(p._dbInfo,xe,function(E,I){if(E)return y(E);try{var _=I.objectStore(p._dbInfo.storeName),T=!1,C=_.openKeyCursor();C.onsuccess=function(){var $=C.result;if(!$){b(null);return}c===0||T?b($.key):(T=!0,$.advance(c))},C.onerror=function(){y(C.error)}}catch($){y($)}})}).catch(y)});return g(v,h),v}function og(c){var h=this,p=new l(function(v,b){h.ready().then(function(){ft(h._dbInfo,xe,function(y,E){if(y)return b(y);try{var I=E.objectStore(h._dbInfo.storeName),_=I.openKeyCursor(),T=[];_.onsuccess=function(){var C=_.result;if(!C){v(T);return}T.push(C.key),C.continue()},_.onerror=function(){b(_.error)}}catch(C){b(C)}})}).catch(b)});return g(p,c),p}function ig(c,h){h=S.apply(this,arguments);var p=this.config();c=typeof c!="function"&&c||{},c.name||(c.name=c.name||p.name,c.storeName=c.storeName||p.storeName);var v=this,b;if(!c.name)b=l.reject("Invalid arguments");else{var y=c.name===p.name&&v._dbInfo.db,E=y?l.resolve(v._dbInfo.db):U(c).then(function(I){var _=k[c.name],T=_.forages;_.db=I;for(var C=0;C<T.length;C++)T[C]._dbInfo.db=I;return I});c.storeName?b=E.then(function(I){if(I.objectStoreNames.contains(c.storeName)){var _=I.version+1;M(c);var T=k[c.name],C=T.forages;I.close();for(var $=0;$<C.length;$++){var z=C[$];z._dbInfo.db=null,z._dbInfo.version=_}var H=new l(function(Y,le){var ue=m.open(c.name,_);ue.onerror=function(ke){var Rr=ue.result;Rr.close(),le(ke)},ue.onupgradeneeded=function(){var ke=ue.result;ke.deleteObjectStore(c.storeName)},ue.onsuccess=function(){var ke=ue.result;ke.close(),Y(ke)}});return H.then(function(Y){T.db=Y;for(var le=0;le<C.length;le++){var ue=C[le];ue._dbInfo.db=Y,O(ue._dbInfo)}}).catch(function(Y){throw(P(c,Y)||l.resolve()).catch(function(){}),Y})}}):b=E.then(function(I){M(c);var _=k[c.name],T=_.forages;I.close();for(var C=0;C<T.length;C++){var $=T[C];$._dbInfo.db=null}var z=new l(function(H,Y){var le=m.deleteDatabase(c.name);le.onerror=function(){var ue=le.result;ue&&ue.close(),Y(le.error)},le.onblocked=function(){console.warn(\'dropInstance blocked for database "\'+c.name+\'" until all open connections are closed\')},le.onsuccess=function(){var ue=le.result;ue&&ue.close(),H(ue)}});return z.then(function(H){_.db=H;for(var Y=0;Y<T.length;Y++){var le=T[Y];O(le._dbInfo)}}).catch(function(H){throw(P(c,H)||l.resolve()).catch(function(){}),H})})}return g(b,h),b}var sg={_driver:"asyncStorage",_initStorage:Yh,_support:f(),iterate:Qh,getItem:Zh,setItem:Xh,removeItem:eg,clear:tg,length:rg,key:ng,keys:og,dropInstance:ig};function ag(){return typeof openDatabase=="function"}var yt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ug="~~local_forage_type~",Ya=/^~~local_forage_type~([^~]+)~/,Jn="__lfsc__:",ji=Jn.length,Mi="arbf",Li="blob",Za="si08",Qa="ui08",Xa="uic8",eu="si16",tu="si32",ru="ur16",nu="ui32",ou="fl32",iu="fl64",su=ji+Mi.length,au=Object.prototype.toString;function uu(c){var h=c.length*.75,p=c.length,v,b=0,y,E,I,_;c[c.length-1]==="="&&(h--,c[c.length-2]==="="&&h--);var T=new ArrayBuffer(h),C=new Uint8Array(T);for(v=0;v<p;v+=4)y=yt.indexOf(c[v]),E=yt.indexOf(c[v+1]),I=yt.indexOf(c[v+2]),_=yt.indexOf(c[v+3]),C[b++]=y<<2|E>>4,C[b++]=(E&15)<<4|I>>2,C[b++]=(I&3)<<6|_&63;return T}function Bi(c){var h=new Uint8Array(c),p="",v;for(v=0;v<h.length;v+=3)p+=yt[h[v]>>2],p+=yt[(h[v]&3)<<4|h[v+1]>>4],p+=yt[(h[v+1]&15)<<2|h[v+2]>>6],p+=yt[h[v+2]&63];return h.length%3===2?p=p.substring(0,p.length-1)+"=":h.length%3===1&&(p=p.substring(0,p.length-2)+"=="),p}function cg(c,h){var p="";if(c&&(p=au.call(c)),c&&(p==="[object ArrayBuffer]"||c.buffer&&au.call(c.buffer)==="[object ArrayBuffer]")){var v,b=Jn;c instanceof ArrayBuffer?(v=c,b+=Mi):(v=c.buffer,p==="[object Int8Array]"?b+=Za:p==="[object Uint8Array]"?b+=Qa:p==="[object Uint8ClampedArray]"?b+=Xa:p==="[object Int16Array]"?b+=eu:p==="[object Uint16Array]"?b+=ru:p==="[object Int32Array]"?b+=tu:p==="[object Uint32Array]"?b+=nu:p==="[object Float32Array]"?b+=ou:p==="[object Float64Array]"?b+=iu:h(new Error("Failed to get type for BinaryArray"))),h(b+Bi(v))}else if(p==="[object Blob]"){var y=new FileReader;y.onload=function(){var E=ug+c.type+"~"+Bi(this.result);h(Jn+Li+E)},y.readAsArrayBuffer(c)}else try{h(JSON.stringify(c))}catch(E){console.error("Couldn\'t convert value into a JSON string: ",c),h(null,E)}}function fg(c){if(c.substring(0,ji)!==Jn)return JSON.parse(c);var h=c.substring(su),p=c.substring(ji,su),v;if(p===Li&&Ya.test(h)){var b=h.match(Ya);v=b[1],h=h.substring(b[0].length)}var y=uu(h);switch(p){case Mi:return y;case Li:return d([y],{type:v});case Za:return new Int8Array(y);case Qa:return new Uint8Array(y);case Xa:return new Uint8ClampedArray(y);case eu:return new Int16Array(y);case ru:return new Uint16Array(y);case tu:return new Int32Array(y);case nu:return new Uint32Array(y);case ou:return new Float32Array(y);case iu:return new Float64Array(y);default:throw new Error("Unkown type: "+p)}}var Ui={serialize:cg,deserialize:fg,stringToBuffer:uu,bufferToString:Bi};function cu(c,h,p,v){c.executeSql("CREATE TABLE IF NOT EXISTS "+h.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],p,v)}function lg(c){var h=this,p={db:null};if(c)for(var v in c)p[v]=typeof c[v]!="string"?c[v].toString():c[v];var b=new l(function(y,E){try{p.db=openDatabase(p.name,String(p.version),p.description,p.size)}catch(I){return E(I)}p.db.transaction(function(I){cu(I,p,function(){h._dbInfo=p,y()},function(_,T){E(T)})},E)});return p.serializer=Ui,b}function vt(c,h,p,v,b,y){c.executeSql(p,v,b,function(E,I){I.code===I.SYNTAX_ERR?E.executeSql("SELECT name FROM sqlite_master WHERE type=\'table\' AND name = ?",[h.storeName],function(_,T){T.rows.length?y(_,I):cu(_,h,function(){_.executeSql(p,v,b,y)},y)},y):y(E,I)},y)}function pg(c,h){var p=this;c=x(c);var v=new l(function(b,y){p.ready().then(function(){var E=p._dbInfo;E.db.transaction(function(I){vt(I,E,"SELECT * FROM "+E.storeName+" WHERE key = ? LIMIT 1",[c],function(_,T){var C=T.rows.length?T.rows.item(0).value:null;C&&(C=E.serializer.deserialize(C)),b(C)},function(_,T){y(T)})})}).catch(y)});return g(v,h),v}function mg(c,h){var p=this,v=new l(function(b,y){p.ready().then(function(){var E=p._dbInfo;E.db.transaction(function(I){vt(I,E,"SELECT * FROM "+E.storeName,[],function(_,T){for(var C=T.rows,$=C.length,z=0;z<$;z++){var H=C.item(z),Y=H.value;if(Y&&(Y=E.serializer.deserialize(Y)),Y=c(Y,H.key,z+1),Y!==void 0){b(Y);return}}b()},function(_,T){y(T)})})}).catch(y)});return g(v,h),v}function fu(c,h,p,v){var b=this;c=x(c);var y=new l(function(E,I){b.ready().then(function(){h===void 0&&(h=null);var _=h,T=b._dbInfo;T.serializer.serialize(h,function(C,$){$?I($):T.db.transaction(function(z){vt(z,T,"INSERT OR REPLACE INTO "+T.storeName+" (key, value) VALUES (?, ?)",[c,C],function(){E(_)},function(H,Y){I(Y)})},function(z){if(z.code===z.QUOTA_ERR){if(v>0){E(fu.apply(b,[c,_,p,v-1]));return}I(z)}})})}).catch(I)});return g(y,p),y}function dg(c,h,p){return fu.apply(this,[c,h,p,1])}function hg(c,h){var p=this;c=x(c);var v=new l(function(b,y){p.ready().then(function(){var E=p._dbInfo;E.db.transaction(function(I){vt(I,E,"DELETE FROM "+E.storeName+" WHERE key = ?",[c],function(){b()},function(_,T){y(T)})})}).catch(y)});return g(v,h),v}function gg(c){var h=this,p=new l(function(v,b){h.ready().then(function(){var y=h._dbInfo;y.db.transaction(function(E){vt(E,y,"DELETE FROM "+y.storeName,[],function(){v()},function(I,_){b(_)})})}).catch(b)});return g(p,c),p}function yg(c){var h=this,p=new l(function(v,b){h.ready().then(function(){var y=h._dbInfo;y.db.transaction(function(E){vt(E,y,"SELECT COUNT(key) as c FROM "+y.storeName,[],function(I,_){var T=_.rows.item(0).c;v(T)},function(I,_){b(_)})})}).catch(b)});return g(p,c),p}function vg(c,h){var p=this,v=new l(function(b,y){p.ready().then(function(){var E=p._dbInfo;E.db.transaction(function(I){vt(I,E,"SELECT key FROM "+E.storeName+" WHERE id = ? LIMIT 1",[c+1],function(_,T){var C=T.rows.length?T.rows.item(0).key:null;b(C)},function(_,T){y(T)})})}).catch(y)});return g(v,h),v}function bg(c){var h=this,p=new l(function(v,b){h.ready().then(function(){var y=h._dbInfo;y.db.transaction(function(E){vt(E,y,"SELECT key FROM "+y.storeName,[],function(I,_){for(var T=[],C=0;C<_.rows.length;C++)T.push(_.rows.item(C).key);v(T)},function(I,_){b(_)})})}).catch(b)});return g(p,c),p}function wg(c){return new l(function(h,p){c.transaction(function(v){v.executeSql("SELECT name FROM sqlite_master WHERE type=\'table\' AND name <> \'__WebKitDatabaseInfoTable__\'",[],function(b,y){for(var E=[],I=0;I<y.rows.length;I++)E.push(y.rows.item(I).name);h({db:c,storeNames:E})},function(b,y){p(y)})},function(v){p(v)})})}function xg(c,h){h=S.apply(this,arguments);var p=this.config();c=typeof c!="function"&&c||{},c.name||(c.name=c.name||p.name,c.storeName=c.storeName||p.storeName);var v=this,b;return c.name?b=new l(function(y){var E;c.name===p.name?E=v._dbInfo.db:E=openDatabase(c.name,"","",0),c.storeName?y({db:E,storeNames:[c.storeName]}):y(wg(E))}).then(function(y){return new l(function(E,I){y.db.transaction(function(_){function T(H){return new l(function(Y,le){_.executeSql("DROP TABLE IF EXISTS "+H,[],function(){Y()},function(ue,ke){le(ke)})})}for(var C=[],$=0,z=y.storeNames.length;$<z;$++)C.push(T(y.storeNames[$]));l.all(C).then(function(){E()}).catch(function(H){I(H)})},function(_){I(_)})})}):b=l.reject("Invalid arguments"),g(b,h),b}var Eg={_driver:"webSQLStorage",_initStorage:lg,_support:ag(),iterate:mg,getItem:pg,setItem:dg,removeItem:hg,clear:gg,length:yg,key:vg,keys:bg,dropInstance:xg};function Ig(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function lu(c,h){var p=c.name+"/";return c.storeName!==h.storeName&&(p+=c.storeName+"/"),p}function Sg(){var c="_localforage_support_test";try{return localStorage.setItem(c,!0),localStorage.removeItem(c),!1}catch{return!0}}function Og(){return!Sg()||localStorage.length>0}function Dg(c){var h=this,p={};if(c)for(var v in c)p[v]=c[v];return p.keyPrefix=lu(c,h._defaultConfig),Og()?(h._dbInfo=p,p.serializer=Ui,l.resolve()):l.reject()}function _g(c){var h=this,p=h.ready().then(function(){for(var v=h._dbInfo.keyPrefix,b=localStorage.length-1;b>=0;b--){var y=localStorage.key(b);y.indexOf(v)===0&&localStorage.removeItem(y)}});return g(p,c),p}function Tg(c,h){var p=this;c=x(c);var v=p.ready().then(function(){var b=p._dbInfo,y=localStorage.getItem(b.keyPrefix+c);return y&&(y=b.serializer.deserialize(y)),y});return g(v,h),v}function Ng(c,h){var p=this,v=p.ready().then(function(){for(var b=p._dbInfo,y=b.keyPrefix,E=y.length,I=localStorage.length,_=1,T=0;T<I;T++){var C=localStorage.key(T);if(C.indexOf(y)===0){var $=localStorage.getItem(C);if($&&($=b.serializer.deserialize($)),$=c($,C.substring(E),_++),$!==void 0)return $}}});return g(v,h),v}function Cg(c,h){var p=this,v=p.ready().then(function(){var b=p._dbInfo,y;try{y=localStorage.key(c)}catch{y=null}return y&&(y=y.substring(b.keyPrefix.length)),y});return g(v,h),v}function Rg(c){var h=this,p=h.ready().then(function(){for(var v=h._dbInfo,b=localStorage.length,y=[],E=0;E<b;E++){var I=localStorage.key(E);I.indexOf(v.keyPrefix)===0&&y.push(I.substring(v.keyPrefix.length))}return y});return g(p,c),p}function Fg(c){var h=this,p=h.keys().then(function(v){return v.length});return g(p,c),p}function Ag(c,h){var p=this;c=x(c);var v=p.ready().then(function(){var b=p._dbInfo;localStorage.removeItem(b.keyPrefix+c)});return g(v,h),v}function Pg(c,h,p){var v=this;c=x(c);var b=v.ready().then(function(){h===void 0&&(h=null);var y=h;return new l(function(E,I){var _=v._dbInfo;_.serializer.serialize(h,function(T,C){if(C)I(C);else try{localStorage.setItem(_.keyPrefix+c,T),E(y)}catch($){($.name==="QuotaExceededError"||$.name==="NS_ERROR_DOM_QUOTA_REACHED")&&I($),I($)}})})});return g(b,p),b}function $g(c,h){if(h=S.apply(this,arguments),c=typeof c!="function"&&c||{},!c.name){var p=this.config();c.name=c.name||p.name,c.storeName=c.storeName||p.storeName}var v=this,b;return c.name?b=new l(function(y){c.storeName?y(lu(c,v._defaultConfig)):y(c.name+"/")}).then(function(y){for(var E=localStorage.length-1;E>=0;E--){var I=localStorage.key(E);I.indexOf(y)===0&&localStorage.removeItem(I)}}):b=l.reject("Invalid arguments"),g(b,h),b}var kg={_driver:"localStorageWrapper",_initStorage:Dg,_support:Ig(),iterate:Ng,getItem:Tg,setItem:Pg,removeItem:Ag,clear:_g,length:Fg,key:Cg,keys:Rg,dropInstance:$g},qg=function(h,p){return h===p||typeof h=="number"&&typeof p=="number"&&isNaN(h)&&isNaN(p)},jg=function(h,p){for(var v=h.length,b=0;b<v;){if(qg(h[b],p))return!0;b++}return!1},pu=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"},Cr={},mu={},tr={INDEXEDDB:sg,WEBSQL:Eg,LOCALSTORAGE:kg},Mg=[tr.INDEXEDDB._driver,tr.WEBSQL._driver,tr.LOCALSTORAGE._driver],Vn=["dropInstance"],zi=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Vn),Lg={description:"",driver:Mg.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Bg(c,h){c[h]=function(){var p=arguments;return c.ready().then(function(){return c[h].apply(c,p)})}}function Wi(){for(var c=1;c<arguments.length;c++){var h=arguments[c];if(h)for(var p in h)h.hasOwnProperty(p)&&(pu(h[p])?arguments[0][p]=h[p].slice():arguments[0][p]=h[p])}return arguments[0]}var Ug=function(){function c(h){a(this,c);for(var p in tr)if(tr.hasOwnProperty(p)){var v=tr[p],b=v._driver;this[p]=b,Cr[b]||this.defineDriver(v)}this._defaultConfig=Wi({},Lg),this._config=Wi({},this._defaultConfig,h),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return c.prototype.config=function(p){if((typeof p>"u"?"undefined":s(p))==="object"){if(this._ready)return new Error("Can\'t call config() after localforage has been used.");for(var v in p){if(v==="storeName"&&(p[v]=p[v].replace(/\\W/g,"_")),v==="version"&&typeof p[v]!="number")return new Error("Database version must be a number.");this._config[v]=p[v]}return"driver"in p&&p.driver?this.setDriver(this._config.driver):!0}else return typeof p=="string"?this._config[p]:this._config},c.prototype.defineDriver=function(p,v,b){var y=new l(function(E,I){try{var _=p._driver,T=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!p._driver){I(T);return}for(var C=zi.concat("_initStorage"),$=0,z=C.length;$<z;$++){var H=C[$],Y=!jg(Vn,H);if((Y||p[H])&&typeof p[H]!="function"){I(T);return}}var le=function(){for(var Rr=function(Kg){return function(){var Gg=new Error("Method "+Kg+" is not implemented by the current driver"),du=l.reject(Gg);return g(du,arguments[arguments.length-1]),du}},Ki=0,Wg=Vn.length;Ki<Wg;Ki++){var Gi=Vn[Ki];p[Gi]||(p[Gi]=Rr(Gi))}};le();var ue=function(Rr){Cr[_]&&console.info("Redefining LocalForage driver: "+_),Cr[_]=p,mu[_]=Rr,E()};"_support"in p?p._support&&typeof p._support=="function"?p._support().then(ue,I):ue(!!p._support):ue(!0)}catch(ke){I(ke)}});return w(y,v,b),y},c.prototype.driver=function(){return this._driver||null},c.prototype.getDriver=function(p,v,b){var y=Cr[p]?l.resolve(Cr[p]):l.reject(new Error("Driver not found."));return w(y,v,b),y},c.prototype.getSerializer=function(p){var v=l.resolve(Ui);return w(v,p),v},c.prototype.ready=function(p){var v=this,b=v._driverSet.then(function(){return v._ready===null&&(v._ready=v._initDriver()),v._ready});return w(b,p,p),b},c.prototype.setDriver=function(p,v,b){var y=this;pu(p)||(p=[p]);var E=this._getSupportedDrivers(p);function I(){y._config.driver=y.driver()}function _($){return y._extend($),I(),y._ready=y._initStorage(y._config),y._ready}function T($){return function(){var z=0;function H(){for(;z<$.length;){var Y=$[z];return z++,y._dbInfo=null,y._ready=null,y.getDriver(Y).then(_).catch(H)}I();var le=new Error("No available storage method found.");return y._driverSet=l.reject(le),y._driverSet}return H()}}var C=this._driverSet!==null?this._driverSet.catch(function(){return l.resolve()}):l.resolve();return this._driverSet=C.then(function(){var $=E[0];return y._dbInfo=null,y._ready=null,y.getDriver($).then(function(z){y._driver=z._driver,I(),y._wrapLibraryMethodsWithReady(),y._initDriver=T(E)})}).catch(function(){I();var $=new Error("No available storage method found.");return y._driverSet=l.reject($),y._driverSet}),w(this._driverSet,v,b),this._driverSet},c.prototype.supports=function(p){return!!mu[p]},c.prototype._extend=function(p){Wi(this,p)},c.prototype._getSupportedDrivers=function(p){for(var v=[],b=0,y=p.length;b<y;b++){var E=p[b];this.supports(E)&&v.push(E)}return v},c.prototype._wrapLibraryMethodsWithReady=function(){for(var p=0,v=zi.length;p<v;p++)Bg(this,zi[p])},c.prototype.createInstance=function(p){return new c(p)},c}(),zg=new Ug;o.exports=zg},{3:3}]},{},[4])(4)})});var lf=D((BC,ff)=>{var mr=1e3,dr=mr*60,hr=dr*60,Lt=hr*24,Pb=Lt*7,$b=Lt*365.25;ff.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return kb(e);if(r==="number"&&isFinite(e))return t.long?jb(e):qb(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function kb(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*$b;case"weeks":case"week":case"w":return r*Pb;case"days":case"day":case"d":return r*Lt;case"hours":case"hour":case"hrs":case"hr":case"h":return r*hr;case"minutes":case"minute":case"mins":case"min":case"m":return r*dr;case"seconds":case"second":case"secs":case"sec":case"s":return r*mr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function qb(e){var t=Math.abs(e);return t>=Lt?Math.round(e/Lt)+"d":t>=hr?Math.round(e/hr)+"h":t>=dr?Math.round(e/dr)+"m":t>=mr?Math.round(e/mr)+"s":e+"ms"}function jb(e){var t=Math.abs(e);return t>=Lt?Mo(e,t,Lt,"day"):t>=hr?Mo(e,t,hr,"hour"):t>=dr?Mo(e,t,dr,"minute"):t>=mr?Mo(e,t,mr,"second"):e+" ms"}function Mo(e,t,r,n){var o=t>=r*1.5;return Math.round(e/r)+" "+n+(o?"s":"")}});var mf=D((UC,pf)=>{function Mb(e){r.debug=r,r.default=r,r.coerce=u,r.disable=i,r.enable=o,r.enabled=s,r.humanize=lf(),r.destroy=m,Object.keys(e).forEach(f=>{r[f]=e[f]}),r.names=[],r.skips=[],r.formatters={};function t(f){let d=0;for(let l=0;l<f.length;l++)d=(d<<5)-d+f.charCodeAt(l),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=t;function r(f){let d,l=null,g,w;function x(...S){if(!x.enabled)return;let N=x,q=Number(new Date),k=q-(d||q);N.diff=k,N.prev=d,N.curr=q,d=q,S[0]=r.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let ee=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(R,B)=>{if(R==="%%")return"%";ee++;let L=r.formatters[B];if(typeof L=="function"){let A=S[ee];R=L.call(N,A),S.splice(ee,1),ee--}return R}),r.formatArgs.call(N,S),(N.log||r.log).apply(N,S)}return x.namespace=f,x.useColors=r.useColors(),x.color=r.selectColor(f),x.extend=n,x.destroy=r.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(g!==r.namespaces&&(g=r.namespaces,w=r.enabled(f)),w),set:S=>{l=S}}),typeof r.init=="function"&&r.init(x),x}function n(f,d){let l=r(this.namespace+(typeof d>"u"?":":d)+f);return l.log=this.log,l}function o(f){r.save(f),r.namespaces=f,r.names=[],r.skips=[];let d,l=(typeof f=="string"?f:"").split(/[\\s,]+/),g=l.length;for(d=0;d<g;d++)l[d]&&(f=l[d].replace(/\\*/g,".*?"),f[0]==="-"?r.skips.push(new RegExp("^"+f.slice(1)+"$")):r.names.push(new RegExp("^"+f+"$")))}function i(){let f=[...r.names.map(a),...r.skips.map(a).map(d=>"-"+d)].join(",");return r.enable(""),f}function s(f){if(f[f.length-1]==="*")return!0;let d,l;for(d=0,l=r.skips.length;d<l;d++)if(r.skips[d].test(f))return!1;for(d=0,l=r.names.length;d<l;d++)if(r.names[d].test(f))return!0;return!1}function a(f){return f.toString().substring(2,f.toString().length-2).replace(/\\.\\*\\?$/,"*")}function u(f){return f instanceof Error?f.stack||f.message:f}function m(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}pf.exports=Mb});var we=D((Ae,Lo)=>{Ae.formatArgs=Bb;Ae.save=Ub;Ae.load=zb;Ae.useColors=Lb;Ae.storage=Wb();Ae.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Ae.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Lb(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/)}function Bb(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Lo.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(r++,o==="%c"&&(n=r))}),e.splice(n,0,t)}Ae.log=console.debug||console.log||(()=>{});function Ub(e){try{e?Ae.storage.setItem("debug",e):Ae.storage.removeItem("debug")}catch{}}function zb(){let e;try{e=Ae.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function Wb(){try{return localStorage}catch{}}Lo.exports=mf()(Ae);var{formatters:Kb}=Lo.exports;Kb.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var hf=D((zC,df)=>{"use strict";df.exports=Gb;function gr(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function Gb(e){if(e=e||{},e.circles)return Jb(e);return e.proto?n:r;function t(o,i){for(var s=Object.keys(o),a=new Array(s.length),u=0;u<s.length;u++){var m=s[u],f=o[m];typeof f!="object"||f===null?a[m]=f:f instanceof Date?a[m]=new Date(f):ArrayBuffer.isView(f)?a[m]=gr(f):a[m]=i(f)}return a}function r(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return t(o,r);if(o instanceof Map)return new Map(t(Array.from(o),r));if(o instanceof Set)return new Set(t(Array.from(o),r));var i={};for(var s in o)if(Object.hasOwnProperty.call(o,s)!==!1){var a=o[s];typeof a!="object"||a===null?i[s]=a:a instanceof Date?i[s]=new Date(a):a instanceof Map?i[s]=new Map(t(Array.from(a),r)):a instanceof Set?i[s]=new Set(t(Array.from(a),r)):ArrayBuffer.isView(a)?i[s]=gr(a):i[s]=r(a)}return i}function n(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return t(o,n);if(o instanceof Map)return new Map(t(Array.from(o),n));if(o instanceof Set)return new Set(t(Array.from(o),n));var i={};for(var s in o){var a=o[s];typeof a!="object"||a===null?i[s]=a:a instanceof Date?i[s]=new Date(a):a instanceof Map?i[s]=new Map(t(Array.from(a),n)):a instanceof Set?i[s]=new Set(t(Array.from(a),n)):ArrayBuffer.isView(a)?i[s]=gr(a):i[s]=n(a)}return i}}function Jb(e){var t=[],r=[];return e.proto?i:o;function n(s,a){for(var u=Object.keys(s),m=new Array(u.length),f=0;f<u.length;f++){var d=u[f],l=s[d];if(typeof l!="object"||l===null)m[d]=l;else if(l instanceof Date)m[d]=new Date(l);else if(ArrayBuffer.isView(l))m[d]=gr(l);else{var g=t.indexOf(l);g!==-1?m[d]=r[g]:m[d]=a(l)}}return m}function o(s){if(typeof s!="object"||s===null)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return n(s,o);if(s instanceof Map)return new Map(n(Array.from(s),o));if(s instanceof Set)return new Set(n(Array.from(s),o));var a={};t.push(s),r.push(a);for(var u in s)if(Object.hasOwnProperty.call(s,u)!==!1){var m=s[u];if(typeof m!="object"||m===null)a[u]=m;else if(m instanceof Date)a[u]=new Date(m);else if(m instanceof Map)a[u]=new Map(n(Array.from(m),o));else if(m instanceof Set)a[u]=new Set(n(Array.from(m),o));else if(ArrayBuffer.isView(m))a[u]=gr(m);else{var f=t.indexOf(m);f!==-1?a[u]=r[f]:a[u]=o(m)}}return t.pop(),r.pop(),a}function i(s){if(typeof s!="object"||s===null)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return n(s,i);if(s instanceof Map)return new Map(n(Array.from(s),i));if(s instanceof Set)return new Set(n(Array.from(s),i));var a={};t.push(s),r.push(a);for(var u in s){var m=s[u];if(typeof m!="object"||m===null)a[u]=m;else if(m instanceof Date)a[u]=new Date(m);else if(m instanceof Map)a[u]=new Map(n(Array.from(m),i));else if(m instanceof Set)a[u]=new Set(n(Array.from(m),i));else if(ArrayBuffer.isView(m))a[u]=gr(m);else{var f=t.indexOf(m);f!==-1?a[u]=r[f]:a[u]=i(m)}}return t.pop(),r.pop(),a}}});var Ut=D((WC,bf)=>{var Vb=require("util"),Bt=we()("log4js:configuration"),Bo=[],Uo=[],gf=e=>!e,yf=e=>e&&typeof e=="object"&&!Array.isArray(e),Hb=e=>/^[A-Za-z][A-Za-z0-9_]*$/g.test(e),Yb=e=>e&&typeof e=="number"&&Number.isInteger(e),Zb=e=>{Uo.push(e),Bt(`Added listener, now ${Uo.length} listeners`)},Qb=e=>{Bo.push(e),Bt(`Added pre-processing listener, now ${Bo.length} listeners`)},vf=(e,t,r)=>{(Array.isArray(t)?t:[t]).forEach(o=>{if(o)throw new Error(`Problem with log4js configuration: (${Vb.inspect(e,{depth:5})}) - ${r}`)})},Xb=e=>{Bt("New configuration to be validated: ",e),vf(e,gf(yf(e)),"must be an object."),Bt(`Calling pre-processing listeners (${Bo.length})`),Bo.forEach(t=>t(e)),Bt("Configuration pre-processing finished."),Bt(`Calling configuration listeners (${Uo.length})`),Uo.forEach(t=>t(e)),Bt("Configuration finished.")};bf.exports={configure:Xb,addListener:Zb,addPreProcessingListener:Qb,throwExceptionIf:vf,anObject:yf,anInteger:Yb,validIdentifier:Hb,not:gf}});var zo=D((KC,ze)=>{"use strict";function wf(e,t){for(var r=e.toString();r.length<t;)r="0"+r;return r}function zt(e){return wf(e,2)}function ew(e){var t=Math.abs(e),r=String(Math.floor(t/60)),n=String(t%60);return r=("0"+r).slice(-2),n=("0"+n).slice(-2),e===0?"Z":(e<0?"+":"-")+r+":"+n}function xf(e,t){typeof e!="string"&&(t=e,e=ze.exports.ISO8601_FORMAT),t||(t=ze.exports.now());var r=zt(t.getDate()),n=zt(t.getMonth()+1),o=zt(t.getFullYear()),i=zt(o.substring(2,4)),s=e.indexOf("yyyy")>-1?o:i,a=zt(t.getHours()),u=zt(t.getMinutes()),m=zt(t.getSeconds()),f=wf(t.getMilliseconds(),3),d=ew(t.getTimezoneOffset()),l=e.replace(/dd/g,r).replace(/MM/g,n).replace(/y{1,4}/g,s).replace(/hh/g,a).replace(/mm/g,u).replace(/ss/g,m).replace(/SSS/g,f).replace(/O/g,d);return l}function Ot(e,t,r,n){e["set"+(n?"":"UTC")+t](r)}function tw(e,t,r){var n=e.indexOf("O")<0,o=!1,i=[{pattern:/y{1,4}/,regexp:"\\\\d{1,4}",fn:function(d,l){Ot(d,"FullYear",l,n)}},{pattern:/MM/,regexp:"\\\\d{1,2}",fn:function(d,l){Ot(d,"Month",l-1,n),d.getMonth()!==l-1&&(o=!0)}},{pattern:/dd/,regexp:"\\\\d{1,2}",fn:function(d,l){o&&Ot(d,"Month",d.getMonth()-1,n),Ot(d,"Date",l,n)}},{pattern:/hh/,regexp:"\\\\d{1,2}",fn:function(d,l){Ot(d,"Hours",l,n)}},{pattern:/mm/,regexp:"\\\\d\\\\d",fn:function(d,l){Ot(d,"Minutes",l,n)}},{pattern:/ss/,regexp:"\\\\d\\\\d",fn:function(d,l){Ot(d,"Seconds",l,n)}},{pattern:/SSS/,regexp:"\\\\d\\\\d\\\\d",fn:function(d,l){Ot(d,"Milliseconds",l,n)}},{pattern:/O/,regexp:"[+-]\\\\d{1,2}:?\\\\d{2}?|Z",fn:function(d,l){l==="Z"?l=0:l=l.replace(":","");var g=Math.abs(l),w=(l>0?-1:1)*(g%100+Math.floor(g/100)*60);d.setUTCMinutes(d.getUTCMinutes()+w)}}],s=i.reduce(function(d,l){return l.pattern.test(d.regexp)?(l.index=d.regexp.match(l.pattern).index,d.regexp=d.regexp.replace(l.pattern,"("+l.regexp+")")):l.index=-1,d},{regexp:e,index:[]}),a=i.filter(function(d){return d.index>-1});a.sort(function(d,l){return d.index-l.index});var u=new RegExp(s.regexp),m=u.exec(t);if(m){var f=r||ze.exports.now();return a.forEach(function(d,l){d.fn(f,m[l+1])}),f}throw new Error("String \'"+t+"\' could not be parsed as \'"+e+"\'")}function rw(e,t,r){if(!e)throw new Error("pattern must be supplied");return tw(e,t,r)}function nw(){return new Date}ze.exports=xf;ze.exports.asString=xf;ze.exports.parse=rw;ze.exports.now=nw;ze.exports.ISO8601_FORMAT="yyyy-MM-ddThh:mm:ss.SSS";ze.exports.ISO8601_WITH_TZ_OFFSET_FORMAT="yyyy-MM-ddThh:mm:ss.SSSO";ze.exports.DATETIME_FORMAT="dd MM yyyy hh:mm:ss.SSS";ze.exports.ABSOLUTETIME_FORMAT="hh:mm:ss.SSS"});var Gs=D((GC,Af)=>{var Dt=zo(),Ef=require("os"),dn=require("util"),mn=require("path"),If=require("url"),Sf=we()("log4js:layouts"),Of={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[90,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[91,39],yellow:[33,39]};function Df(e){return e?`\\x1B[${Of[e][0]}m`:""}function _f(e){return e?`\\x1B[${Of[e][1]}m`:""}function ow(e,t){return Df(t)+e+_f(t)}function Tf(e,t){return ow(dn.format("[%s] [%s] %s - ",Dt.asString(e.startTime),e.level.toString(),e.categoryName),t)}function Nf(e){return Tf(e)+dn.format(...e.data)}function Wo(e){return Tf(e,e.level.colour)+dn.format(...e.data)}function Cf(e){return dn.format(...e.data)}function Rf(e){return e.data[0]}function Ff(e,t){let r="%r %p %c - %m%n",n=/%(-?[0-9]+)?(\\.?-?[0-9]+)?([[\\]cdhmnprzxXyflos%])(\\{([^}]+)\\})?|([^%]+)/;e=e||r;function o(O,P){let F=O.categoryName;if(P){let U=parseInt(P,10),j=F.split(".");U<j.length&&(F=j.slice(j.length-U).join("."))}return F}function i(O,P){let F=Dt.ISO8601_FORMAT;if(P)switch(F=P,F){case"ISO8601":case"ISO8601_FORMAT":F=Dt.ISO8601_FORMAT;break;case"ISO8601_WITH_TZ_OFFSET":case"ISO8601_WITH_TZ_OFFSET_FORMAT":F=Dt.ISO8601_WITH_TZ_OFFSET_FORMAT;break;case"ABSOLUTE":process.emitWarning("Pattern %d{ABSOLUTE} is deprecated in favor of %d{ABSOLUTETIME}. Please use %d{ABSOLUTETIME} instead.","DeprecationWarning","log4js-node-DEP0003"),Sf("[log4js-node-DEP0003]","DEPRECATION: Pattern %d{ABSOLUTE} is deprecated and replaced by %d{ABSOLUTETIME}.");case"ABSOLUTETIME":case"ABSOLUTETIME_FORMAT":F=Dt.ABSOLUTETIME_FORMAT;break;case"DATE":process.emitWarning("Pattern %d{DATE} is deprecated due to the confusion it causes when used. Please use %d{DATETIME} instead.","DeprecationWarning","log4js-node-DEP0004"),Sf("[log4js-node-DEP0004]","DEPRECATION: Pattern %d{DATE} is deprecated and replaced by %d{DATETIME}.");case"DATETIME":case"DATETIME_FORMAT":F=Dt.DATETIME_FORMAT;break}return Dt.asString(F,O.startTime)}function s(){return Ef.hostname().toString()}function a(O){return dn.format(...O.data)}function u(){return Ef.EOL}function m(O){return O.level.toString()}function f(O){return Dt.asString("hh:mm:ss",O.startTime)}function d(O){return Df(O.level.colour)}function l(O){return _f(O.level.colour)}function g(){return"%"}function w(O){return O&&O.pid?O.pid.toString():process.pid.toString()}function x(){return w()}function S(O,P){return typeof t[P]<"u"?typeof t[P]=="function"?t[P](O):t[P]:null}function N(O,P){let F=O.context[P];return typeof F<"u"?typeof F=="function"?F(O):F:null}function q(O,P){let F=O.fileName||"";if(F=function(j){let W="file://";return j.startsWith(W)&&(typeof If.fileURLToPath=="function"?j=If.fileURLToPath(j):(j=mn.normalize(j.replace(new RegExp(`^${W}`),"")),process.platform==="win32"&&(j.startsWith("\\\\")?j=j.slice(1):j=mn.sep+mn.sep+j))),j}(F),P){let j=parseInt(P,10),W=F.split(mn.sep);W.length>j&&(F=W.slice(-j).join(mn.sep))}return F}function k(O){return O.lineNumber?`${O.lineNumber}`:""}function ee(O){return O.columnNumber?`${O.columnNumber}`:""}function xe(O){return O.callStack||""}let R={c:o,d:i,h:s,m:a,n:u,p:m,r:f,"[":d,"]":l,y:x,z:w,"%":g,x:S,X:N,f:q,l:k,o:ee,s:xe};function B(O,P,F){return R[O](P,F)}function L(O,P){let F;return O?(F=parseInt(O.slice(1),10),F>0?P.slice(0,F):P.slice(F)):P}function A(O,P){let F;if(O)if(O.charAt(0)==="-")for(F=parseInt(O.slice(1),10);P.length<F;)P+=" ";else for(F=parseInt(O,10);P.length<F;)P=` ${P}`;return P}function M(O,P,F){let U=O;return U=L(P,U),U=A(F,U),U}return function(O){let P="",F,U=e;for(;(F=n.exec(U))!==null;){let j=F[1],W=F[2],K=F[3],X=F[5],V=F[6];if(V)P+=V.toString();else{let Gn=B(K,O,X);P+=M(Gn,W,j)}U=U.slice(F.index+F[0].length)}return P}}var Ks={messagePassThrough(){return Cf},basic(){return Nf},colored(){return Wo},coloured(){return Wo},pattern(e){return Ff(e&&e.pattern,e&&e.tokens)},dummy(){return Rf}};Af.exports={basicLayout:Nf,messagePassThroughLayout:Cf,patternLayout:Ff,colouredLayout:Wo,coloredLayout:Wo,dummyLayout:Rf,addLayout(e,t){Ks[e]=t},layout(e,t){return Ks[e]&&Ks[e](t)}}});var Wt=D((JC,$f)=>{var pe=Ut(),Pf=["white","grey","black","blue","cyan","green","magenta","red","yellow"],me=class{constructor(t,r,n){this.level=t,this.levelStr=r,this.colour=n}toString(){return this.levelStr}static getLevel(t,r){return t?t instanceof me?t:(t instanceof Object&&t.levelStr&&(t=t.levelStr),me[t.toString().toUpperCase()]||r):r}static addLevels(t){t&&(Object.keys(t).forEach(n=>{let o=n.toUpperCase();me[o]=new me(t[n].value,o,t[n].colour);let i=me.levels.findIndex(s=>s.levelStr===o);i>-1?me.levels[i]=me[o]:me.levels.push(me[o])}),me.levels.sort((n,o)=>n.level-o.level))}isLessThanOrEqualTo(t){return typeof t=="string"&&(t=me.getLevel(t)),this.level<=t.level}isGreaterThanOrEqualTo(t){return typeof t=="string"&&(t=me.getLevel(t)),this.level>=t.level}isEqualTo(t){return typeof t=="string"&&(t=me.getLevel(t)),this.level===t.level}};me.levels=[];me.addLevels({ALL:{value:Number.MIN_VALUE,colour:"grey"},TRACE:{value:5e3,colour:"blue"},DEBUG:{value:1e4,colour:"cyan"},INFO:{value:2e4,colour:"green"},WARN:{value:3e4,colour:"yellow"},ERROR:{value:4e4,colour:"red"},FATAL:{value:5e4,colour:"magenta"},MARK:{value:9007199254740992,colour:"grey"},OFF:{value:Number.MAX_VALUE,colour:"grey"}});pe.addListener(e=>{let t=e.levels;t&&(pe.throwExceptionIf(e,pe.not(pe.anObject(t)),"levels must be an object"),Object.keys(t).forEach(n=>{pe.throwExceptionIf(e,pe.not(pe.validIdentifier(n)),`level name "${n}" is not a valid identifier (must start with a letter, only contain A-Z,a-z,0-9,_)`),pe.throwExceptionIf(e,pe.not(pe.anObject(t[n])),`level "${n}" must be an object`),pe.throwExceptionIf(e,pe.not(t[n].value),`level "${n}" must have a \'value\' property`),pe.throwExceptionIf(e,pe.not(pe.anInteger(t[n].value)),`level "${n}".value must have an integer value`),pe.throwExceptionIf(e,pe.not(t[n].colour),`level "${n}" must have a \'colour\' property`),pe.throwExceptionIf(e,pe.not(Pf.indexOf(t[n].colour)>-1),`level "${n}".colour must be one of ${Pf.join(", ")}`)}))});pe.addListener(e=>{me.addLevels(e.levels)});$f.exports=me});var Kf=D(gn=>{"use strict";var{parse:jf,stringify:Mf}=JSON,{keys:iw}=Object,hn=String,Lf="string",kf={},Ko="object",Bf=(e,t)=>t,sw=e=>e instanceof hn?hn(e):e,aw=(e,t)=>typeof t===Lf?new hn(t):t,Uf=(e,t,r,n)=>{let o=[];for(let i=iw(r),{length:s}=i,a=0;a<s;a++){let u=i[a],m=r[u];if(m instanceof hn){let f=e[m];typeof f===Ko&&!t.has(f)?(t.add(f),r[u]=kf,o.push({k:u,a:[e,t,f,n]})):r[u]=n.call(r,u,f)}else r[u]!==kf&&(r[u]=n.call(r,u,m))}for(let{length:i}=o,s=0;s<i;s++){let{k:a,a:u}=o[s];r[a]=n.call(r,a,Uf.apply(null,u))}return r},qf=(e,t,r)=>{let n=hn(t.push(r)-1);return e.set(r,n),n},zf=(e,t)=>{let r=jf(e,aw).map(sw),n=r[0],o=t||Bf,i=typeof n===Ko&&n?Uf(r,new Set,n,o):n;return o.call({"":i},"",i)};gn.parse=zf;var Wf=(e,t,r)=>{let n=t&&typeof t===Ko?(f,d)=>f===""||-1<t.indexOf(f)?d:void 0:t||Bf,o=new Map,i=[],s=[],a=+qf(o,i,n.call({"":e},"",e)),u=!a;for(;a<i.length;)u=!0,s[a]=Mf(i[a++],m,r);return"["+s.join(",")+"]";function m(f,d){if(u)return u=!u,d;let l=n.call(this,f,d);switch(typeof l){case Ko:if(l===null)return l;case Lf:return o.get(l)||qf(o,i,l)}return l}};gn.stringify=Wf;var uw=e=>jf(Wf(e));gn.toJSON=uw;var cw=e=>zf(Mf(e));gn.fromJSON=cw});var Js=D((HC,Vf)=>{var Gf=Kf(),Jf=Wt(),yr=class{constructor(t,r,n,o,i){this.startTime=new Date,this.categoryName=t,this.data=n,this.level=r,this.context=Object.assign({},o),this.pid=process.pid,i&&(this.functionName=i.functionName,this.fileName=i.fileName,this.lineNumber=i.lineNumber,this.columnNumber=i.columnNumber,this.callStack=i.callStack)}serialise(){return Gf.stringify(this,(t,r)=>(r&&r.message&&r.stack?r=Object.assign({message:r.message,stack:r.stack},r):typeof r=="number"&&(Number.isNaN(r)||!Number.isFinite(r))?r=r.toString():typeof r>"u"&&(r=typeof r),r))}static deserialise(t){let r;try{let n=Gf.parse(t,(o,i)=>{if(i&&i.message&&i.stack){let s=new Error(i);Object.keys(i).forEach(a=>{s[a]=i[a]}),i=s}return i});n.location={functionName:n.functionName,fileName:n.fileName,lineNumber:n.lineNumber,columnNumber:n.columnNumber,callStack:n.callStack},r=new yr(n.categoryName,Jf.getLevel(n.level.levelStr),n.data,n.context,n.location),r.startTime=new Date(n.startTime),r.pid=n.pid,r.cluster=n.cluster}catch(n){r=new yr("log4js",Jf.ERROR,["Unable to parse log:",t,"because: ",n])}return r}};Vf.exports=yr});var Jo=D((YC,Zf)=>{var We=we()("log4js:clustering"),fw=Js(),lw=Ut(),vr=!1,Ke=null;try{Ke=require("cluster")}catch{We("cluster module not present"),vr=!0}var Hs=[],vn=!1,yn="NODE_APP_INSTANCE",Hf=()=>vn&&process.env[yn]==="0",Vs=()=>vr||Ke&&Ke.isMaster||Hf(),Yf=e=>{Hs.forEach(t=>t(e))},Go=(e,t)=>{if(We("cluster message received from worker ",e,": ",t),e.topic&&e.data&&(t=e,e=void 0),t&&t.topic&&t.topic==="log4js:message"){We("received message: ",t.data);let r=fw.deserialise(t.data);Yf(r)}};vr||lw.addListener(e=>{Hs.length=0,{pm2:vn,disableClustering:vr,pm2InstanceVar:yn="NODE_APP_INSTANCE"}=e,We(`clustering disabled ? ${vr}`),We(`cluster.isMaster ? ${Ke&&Ke.isMaster}`),We(`pm2 enabled ? ${vn}`),We(`pm2InstanceVar = ${yn}`),We(`process.env[${yn}] = ${process.env[yn]}`),vn&&process.removeListener("message",Go),Ke&&Ke.removeListener&&Ke.removeListener("message",Go),vr||e.disableClustering?We("Not listening for cluster messages, because clustering disabled."):Hf()?(We("listening for PM2 broadcast messages"),process.on("message",Go)):Ke&&Ke.isMaster?(We("listening for cluster messages"),Ke.on("message",Go)):We("not listening for messages, because we are not a master process")});Zf.exports={onlyOnMaster:(e,t)=>Vs()?e():t,isMaster:Vs,send:e=>{Vs()?Yf(e):(vn||(e.cluster={workerId:Ke.worker.id,worker:process.pid}),process.send({topic:"log4js:message",data:e.serialise()}))},onMessage:e=>{Hs.push(e)}}});var el=D((ZC,Xf)=>{function pw(e){if(typeof e=="number"&&Number.isInteger(e))return e;let t={K:1024,M:1024*1024,G:1024*1024*1024},r=Object.keys(t),n=e.slice(-1).toLocaleUpperCase(),o=e.slice(0,-1).trim();if(r.indexOf(n)<0||!Number.isInteger(Number(o)))throw Error(`maxLogSize: "${e}" is invalid`);return o*t[n]}function mw(e,t){let r=Object.assign({},t);return Object.keys(e).forEach(n=>{r[n]&&(r[n]=e[n](t[n]))}),r}function Ys(e){return mw({maxLogSize:pw},e)}var Qf={dateFile:Ys,file:Ys,fileSync:Ys};Xf.exports.modifyConfig=e=>Qf[e.type]?Qf[e.type](e):e});var rl=D((QC,tl)=>{var dw=console.log.bind(console);function hw(e,t){return r=>{dw(e(r,t))}}function gw(e,t){let r=t.colouredLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),hw(r,e.timezoneOffset)}tl.exports.configure=gw});var ol=D(nl=>{function yw(e,t){return r=>{process.stdout.write(`${e(r,t)}\n`)}}function vw(e,t){let r=t.colouredLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),yw(r,e.timezoneOffset)}nl.configure=vw});var sl=D((eR,il)=>{function bw(e,t){return r=>{process.stderr.write(`${e(r,t)}\n`)}}function ww(e,t){let r=t.colouredLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),bw(r,e.timezoneOffset)}il.exports.configure=ww});var ul=D((tR,al)=>{function xw(e,t,r,n){let o=n.getLevel(e),i=n.getLevel(t,n.FATAL);return s=>{let a=s.level;o.isLessThanOrEqualTo(a)&&i.isGreaterThanOrEqualTo(a)&&r(s)}}function Ew(e,t,r,n){let o=r(e.appender);return xw(e.level,e.maxLevel,o,n)}al.exports.configure=Ew});var ll=D((rR,fl)=>{var cl=we()("log4js:categoryFilter");function Iw(e,t){return typeof e=="string"&&(e=[e]),r=>{cl(`Checking ${r.categoryName} against ${e}`),e.indexOf(r.categoryName)===-1&&(cl("Not excluded, sending to appender"),t(r))}}function Sw(e,t,r){let n=r(e.appender);return Iw(e.exclude,n)}fl.exports.configure=Sw});var dl=D((nR,ml)=>{var pl=we()("log4js:noLogFilter");function Ow(e){return e.filter(r=>r!=null&&r!=="")}function Dw(e,t){return r=>{pl(`Checking data: ${r.data} against filters: ${e}`),typeof e=="string"&&(e=[e]),e=Ow(e);let n=new RegExp(e.join("|"),"i");(e.length===0||r.data.findIndex(o=>n.test(o))<0)&&(pl("Not excluded, sending to appender"),t(r))}}function _w(e,t,r){let n=r(e.appender);return Dw(e.exclude,n)}ml.exports.configure=_w});var Ce=D(Zs=>{"use strict";Zs.fromCallback=function(e){return Object.defineProperty(function(){if(typeof arguments[arguments.length-1]=="function")e.apply(this,arguments);else return new Promise((t,r)=>{arguments[arguments.length]=(n,o)=>{if(n)return r(n);t(o)},arguments.length++,e.apply(this,arguments)})},"name",{value:e.name})};Zs.fromPromise=function(e){return Object.defineProperty(function(){let t=arguments[arguments.length-1];if(typeof t!="function")return e.apply(this,arguments);e.apply(this,arguments).then(r=>t(null,r),t)},"name",{value:e.name})}});var gl=D((iR,hl)=>{var _t=require("constants"),Tw=process.cwd,Vo=null,Nw=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Vo||(Vo=Tw.call(process)),Vo};try{process.cwd()}catch{}typeof process.chdir=="function"&&(Qs=process.chdir,process.chdir=function(e){Vo=null,Qs.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Qs));var Qs;hl.exports=Cw;function Cw(e){_t.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\\.6\\.[0-2]|^v0\\.5\\./)&&t(e),e.lutimes||r(e),e.chown=i(e.chown),e.fchown=i(e.fchown),e.lchown=i(e.lchown),e.chmod=n(e.chmod),e.fchmod=n(e.fchmod),e.lchmod=n(e.lchmod),e.chownSync=s(e.chownSync),e.fchownSync=s(e.fchownSync),e.lchownSync=s(e.lchownSync),e.chmodSync=o(e.chmodSync),e.fchmodSync=o(e.fchmodSync),e.lchmodSync=o(e.lchmodSync),e.stat=a(e.stat),e.fstat=a(e.fstat),e.lstat=a(e.lstat),e.statSync=u(e.statSync),e.fstatSync=u(e.fstatSync),e.lstatSync=u(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(f,d,l){l&&process.nextTick(l)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(f,d,l,g){g&&process.nextTick(g)},e.lchownSync=function(){}),Nw==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(f){function d(l,g,w){var x=Date.now(),S=0;f(l,g,function N(q){if(q&&(q.code==="EACCES"||q.code==="EPERM"||q.code==="EBUSY")&&Date.now()-x<6e4){setTimeout(function(){e.stat(g,function(k,ee){k&&k.code==="ENOENT"?f(l,g,N):w(q)})},S),S<100&&(S+=10);return}w&&w(q)})}return Object.setPrototypeOf&&Object.setPrototypeOf(d,f),d}(e.rename)),e.read=typeof e.read!="function"?e.read:function(f){function d(l,g,w,x,S,N){var q;if(N&&typeof N=="function"){var k=0;q=function(ee,xe,R){if(ee&&ee.code==="EAGAIN"&&k<10)return k++,f.call(e,l,g,w,x,S,q);N.apply(this,arguments)}}return f.call(e,l,g,w,x,S,q)}return Object.setPrototypeOf&&Object.setPrototypeOf(d,f),d}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(f){return function(d,l,g,w,x){for(var S=0;;)try{return f.call(e,d,l,g,w,x)}catch(N){if(N.code==="EAGAIN"&&S<10){S++;continue}throw N}}}(e.readSync);function t(f){f.lchmod=function(d,l,g){f.open(d,_t.O_WRONLY|_t.O_SYMLINK,l,function(w,x){if(w){g&&g(w);return}f.fchmod(x,l,function(S){f.close(x,function(N){g&&g(S||N)})})})},f.lchmodSync=function(d,l){var g=f.openSync(d,_t.O_WRONLY|_t.O_SYMLINK,l),w=!0,x;try{x=f.fchmodSync(g,l),w=!1}finally{if(w)try{f.closeSync(g)}catch{}else f.closeSync(g)}return x}}function r(f){_t.hasOwnProperty("O_SYMLINK")&&f.futimes?(f.lutimes=function(d,l,g,w){f.open(d,_t.O_SYMLINK,function(x,S){if(x){w&&w(x);return}f.futimes(S,l,g,function(N){f.close(S,function(q){w&&w(N||q)})})})},f.lutimesSync=function(d,l,g){var w=f.openSync(d,_t.O_SYMLINK),x,S=!0;try{x=f.futimesSync(w,l,g),S=!1}finally{if(S)try{f.closeSync(w)}catch{}else f.closeSync(w)}return x}):f.futimes&&(f.lutimes=function(d,l,g,w){w&&process.nextTick(w)},f.lutimesSync=function(){})}function n(f){return f&&function(d,l,g){return f.call(e,d,l,function(w){m(w)&&(w=null),g&&g.apply(this,arguments)})}}function o(f){return f&&function(d,l){try{return f.call(e,d,l)}catch(g){if(!m(g))throw g}}}function i(f){return f&&function(d,l,g,w){return f.call(e,d,l,g,function(x){m(x)&&(x=null),w&&w.apply(this,arguments)})}}function s(f){return f&&function(d,l,g){try{return f.call(e,d,l,g)}catch(w){if(!m(w))throw w}}}function a(f){return f&&function(d,l,g){typeof l=="function"&&(g=l,l=null);function w(x,S){S&&(S.uid<0&&(S.uid+=4294967296),S.gid<0&&(S.gid+=4294967296)),g&&g.apply(this,arguments)}return l?f.call(e,d,l,w):f.call(e,d,w)}}function u(f){return f&&function(d,l){var g=l?f.call(e,d,l):f.call(e,d);return g&&(g.uid<0&&(g.uid+=4294967296),g.gid<0&&(g.gid+=4294967296)),g}}function m(f){if(!f||f.code==="ENOSYS")return!0;var d=!process.getuid||process.getuid()!==0;return!!(d&&(f.code==="EINVAL"||f.code==="EPERM"))}}});var bl=D((sR,vl)=>{var yl=require("stream").Stream;vl.exports=Rw;function Rw(e){return{ReadStream:t,WriteStream:r};function t(n,o){if(!(this instanceof t))return new t(n,o);yl.call(this);var i=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,o=o||{};for(var s=Object.keys(o),a=0,u=s.length;a<u;a++){var m=s[a];this[m]=o[m]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){i._read()});return}e.open(this.path,this.flags,this.mode,function(f,d){if(f){i.emit("error",f),i.readable=!1;return}i.fd=d,i.emit("open",d),i._read()})}function r(n,o){if(!(this instanceof r))return new r(n,o);yl.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,o=o||{};for(var i=Object.keys(o),s=0,a=i.length;s<a;s++){var u=i[s];this[u]=o[u]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var xl=D((aR,wl)=>{"use strict";wl.exports=Aw;var Fw=Object.getPrototypeOf||function(e){return e.__proto__};function Aw(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:Fw(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}});var de=D((uR,ta)=>{var se=require("fs"),Pw=gl(),$w=bl(),kw=xl(),Ho=require("util"),Ee,Zo;typeof Symbol=="function"&&typeof Symbol.for=="function"?(Ee=Symbol.for("graceful-fs.queue"),Zo=Symbol.for("graceful-fs.previous")):(Ee="___graceful-fs.queue",Zo="___graceful-fs.previous");function qw(){}function Sl(e,t){Object.defineProperty(e,Ee,{get:function(){return t}})}var Kt=qw;Ho.debuglog?Kt=Ho.debuglog("gfs4"):/\\bgfs4\\b/i.test(process.env.NODE_DEBUG||"")&&(Kt=function(){var e=Ho.format.apply(Ho,arguments);e="GFS4: "+e.split(/\\n/).join(`\nGFS4: `),console.error(e)});se[Ee]||(El=global[Ee]||[],Sl(se,El),se.close=function(e){function t(r,n){return e.call(se,r,function(o){o||Il(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(t,Zo,{value:e}),t}(se.close),se.closeSync=function(e){function t(r){e.apply(se,arguments),Il()}return Object.defineProperty(t,Zo,{value:e}),t}(se.closeSync),/\\bgfs4\\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Kt(se[Ee]),require("assert").equal(se[Ee].length,0)}));var El;global[Ee]||Sl(global,se[Ee]);ta.exports=Xs(kw(se));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!se.__patched&&(ta.exports=Xs(se),se.__patched=!0);function Xs(e){Pw(e),e.gracefulify=Xs,e.createReadStream=xe,e.createWriteStream=R;var t=e.readFile;e.readFile=r;function r(A,M,O){return typeof M=="function"&&(O=M,M=null),P(A,M,O);function P(F,U,j,W){return t(F,U,function(K){K&&(K.code==="EMFILE"||K.code==="ENFILE")?br([P,[F,U,j],K,W||Date.now(),Date.now()]):typeof j=="function"&&j.apply(this,arguments)})}}var n=e.writeFile;e.writeFile=o;function o(A,M,O,P){return typeof O=="function"&&(P=O,O=null),F(A,M,O,P);function F(U,j,W,K,X){return n(U,j,W,function(V){V&&(V.code==="EMFILE"||V.code==="ENFILE")?br([F,[U,j,W,K],V,X||Date.now(),Date.now()]):typeof K=="function"&&K.apply(this,arguments)})}}var i=e.appendFile;i&&(e.appendFile=s);function s(A,M,O,P){return typeof O=="function"&&(P=O,O=null),F(A,M,O,P);function F(U,j,W,K,X){return i(U,j,W,function(V){V&&(V.code==="EMFILE"||V.code==="ENFILE")?br([F,[U,j,W,K],V,X||Date.now(),Date.now()]):typeof K=="function"&&K.apply(this,arguments)})}}var a=e.copyFile;a&&(e.copyFile=u);function u(A,M,O,P){return typeof O=="function"&&(P=O,O=0),F(A,M,O,P);function F(U,j,W,K,X){return a(U,j,W,function(V){V&&(V.code==="EMFILE"||V.code==="ENFILE")?br([F,[U,j,W,K],V,X||Date.now(),Date.now()]):typeof K=="function"&&K.apply(this,arguments)})}}var m=e.readdir;e.readdir=d;var f=/^v[0-5]\\./;function d(A,M,O){typeof M=="function"&&(O=M,M=null);var P=f.test(process.version)?function(j,W,K,X){return m(j,F(j,W,K,X))}:function(j,W,K,X){return m(j,W,F(j,W,K,X))};return P(A,M,O);function F(U,j,W,K){return function(X,V){X&&(X.code==="EMFILE"||X.code==="ENFILE")?br([P,[U,j,W],X,K||Date.now(),Date.now()]):(V&&V.sort&&V.sort(),typeof W=="function"&&W.call(this,X,V))}}}if(process.version.substr(0,4)==="v0.8"){var l=$w(e);N=l.ReadStream,k=l.WriteStream}var g=e.ReadStream;g&&(N.prototype=Object.create(g.prototype),N.prototype.open=q);var w=e.WriteStream;w&&(k.prototype=Object.create(w.prototype),k.prototype.open=ee),Object.defineProperty(e,"ReadStream",{get:function(){return N},set:function(A){N=A},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return k},set:function(A){k=A},enumerable:!0,configurable:!0});var x=N;Object.defineProperty(e,"FileReadStream",{get:function(){return x},set:function(A){x=A},enumerable:!0,configurable:!0});var S=k;Object.defineProperty(e,"FileWriteStream",{get:function(){return S},set:function(A){S=A},enumerable:!0,configurable:!0});function N(A,M){return this instanceof N?(g.apply(this,arguments),this):N.apply(Object.create(N.prototype),arguments)}function q(){var A=this;L(A.path,A.flags,A.mode,function(M,O){M?(A.autoClose&&A.destroy(),A.emit("error",M)):(A.fd=O,A.emit("open",O),A.read())})}function k(A,M){return this instanceof k?(w.apply(this,arguments),this):k.apply(Object.create(k.prototype),arguments)}function ee(){var A=this;L(A.path,A.flags,A.mode,function(M,O){M?(A.destroy(),A.emit("error",M)):(A.fd=O,A.emit("open",O))})}function xe(A,M){return new e.ReadStream(A,M)}function R(A,M){return new e.WriteStream(A,M)}var B=e.open;e.open=L;function L(A,M,O,P){return typeof O=="function"&&(P=O,O=null),F(A,M,O,P);function F(U,j,W,K,X){return B(U,j,W,function(V,Gn){V&&(V.code==="EMFILE"||V.code==="ENFILE")?br([F,[U,j,W,K],V,X||Date.now(),Date.now()]):typeof K=="function"&&K.apply(this,arguments)})}}return e}function br(e){Kt("ENQUEUE",e[0].name,e[1]),se[Ee].push(e),ea()}var Yo;function Il(){for(var e=Date.now(),t=0;t<se[Ee].length;++t)se[Ee][t].length>2&&(se[Ee][t][3]=e,se[Ee][t][4]=e);ea()}function ea(){if(clearTimeout(Yo),Yo=void 0,se[Ee].length!==0){var e=se[Ee].shift(),t=e[0],r=e[1],n=e[2],o=e[3],i=e[4];if(o===void 0)Kt("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-o>=6e4){Kt("TIMEOUT",t.name,r);var s=r.pop();typeof s=="function"&&s.call(null,n)}else{var a=Date.now()-i,u=Math.max(i-o,1),m=Math.min(u*1.2,100);a>=m?(Kt("RETRY",t.name,r),t.apply(null,r.concat([o]))):se[Ee].push(e)}Yo===void 0&&(Yo=setTimeout(ea,0))}}});var ra=D(Gt=>{"use strict";var Ol=Ce().fromCallback,Ge=de(),jw=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","lchmod","link","lstat","mkdir","mkdtemp","open","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>typeof Ge[e]=="function");Object.keys(Ge).forEach(e=>{e!=="promises"&&(Gt[e]=Ge[e])});jw.forEach(e=>{Gt[e]=Ol(Ge[e])});Gt.exists=function(e,t){return typeof t=="function"?Ge.exists(e,t):new Promise(r=>Ge.exists(e,r))};Gt.read=function(e,t,r,n,o,i){return typeof i=="function"?Ge.read(e,t,r,n,o,i):new Promise((s,a)=>{Ge.read(e,t,r,n,o,(u,m,f)=>{if(u)return a(u);s({bytesRead:m,buffer:f})})})};Gt.write=function(e,t,...r){return typeof r[r.length-1]=="function"?Ge.write(e,t,...r):new Promise((n,o)=>{Ge.write(e,t,...r,(i,s,a)=>{if(i)return o(i);n({bytesWritten:s,buffer:a})})})};typeof Ge.realpath.native=="function"&&(Gt.realpath.native=Ol(Ge.realpath.native))});var oa=D((fR,_l)=>{"use strict";var na=require("path");function Dl(e){return e=na.normalize(na.resolve(e)).split(na.sep),e.length>0?e[0]:null}var Mw=/[<>:"|?*]/;function Lw(e){let t=Dl(e);return e=e.replace(t,""),Mw.test(e)}_l.exports={getRootPath:Dl,invalidWin32Path:Lw}});var Nl=D((lR,Tl)=>{"use strict";var Bw=de(),ia=require("path"),Uw=oa().invalidWin32Path,zw=parseInt("0777",8);function sa(e,t,r,n){if(typeof t=="function"?(r=t,t={}):(!t||typeof t!="object")&&(t={mode:t}),process.platform==="win32"&&Uw(e)){let s=new Error(e+" contains invalid WIN32 path characters.");return s.code="EINVAL",r(s)}let o=t.mode,i=t.fs||Bw;o===void 0&&(o=zw&~process.umask()),n||(n=null),r=r||function(){},e=ia.resolve(e),i.mkdir(e,o,s=>{if(!s)return n=n||e,r(null,n);switch(s.code){case"ENOENT":if(ia.dirname(e)===e)return r(s);sa(ia.dirname(e),t,(a,u)=>{a?r(a,u):sa(e,t,r,u)});break;default:i.stat(e,(a,u)=>{a||!u.isDirectory()?r(s,n):r(null,n)});break}})}Tl.exports=sa});var Rl=D((pR,Cl)=>{"use strict";var Ww=de(),aa=require("path"),Kw=oa().invalidWin32Path,Gw=parseInt("0777",8);function ua(e,t,r){(!t||typeof t!="object")&&(t={mode:t});let n=t.mode,o=t.fs||Ww;if(process.platform==="win32"&&Kw(e)){let i=new Error(e+" contains invalid WIN32 path characters.");throw i.code="EINVAL",i}n===void 0&&(n=Gw&~process.umask()),r||(r=null),e=aa.resolve(e);try{o.mkdirSync(e,n),r=r||e}catch(i){if(i.code==="ENOENT"){if(aa.dirname(e)===e)throw i;r=ua(aa.dirname(e),t,r),ua(e,t,r)}else{let s;try{s=o.statSync(e)}catch{throw i}if(!s.isDirectory())throw i}}return r}Cl.exports=ua});var Pe=D((mR,Fl)=>{"use strict";var Jw=Ce().fromCallback,ca=Jw(Nl()),fa=Rl();Fl.exports={mkdirs:ca,mkdirsSync:fa,mkdirp:ca,mkdirpSync:fa,ensureDir:ca,ensureDirSync:fa}});var la=D((dR,Pl)=>{"use strict";var Se=de(),Al=require("os"),Qo=require("path");function Vw(){let e=Qo.join("millis-test-sync"+Date.now().toString()+Math.random().toString().slice(2));e=Qo.join(Al.tmpdir(),e);let t=new Date(1435410243862);Se.writeFileSync(e,"https://github.com/jprichardson/node-fs-extra/pull/141");let r=Se.openSync(e,"r+");return Se.futimesSync(r,t,t),Se.closeSync(r),Se.statSync(e).mtime>1435410243e3}function Hw(e){let t=Qo.join("millis-test"+Date.now().toString()+Math.random().toString().slice(2));t=Qo.join(Al.tmpdir(),t);let r=new Date(1435410243862);Se.writeFile(t,"https://github.com/jprichardson/node-fs-extra/pull/141",n=>{if(n)return e(n);Se.open(t,"r+",(o,i)=>{if(o)return e(o);Se.futimes(i,r,r,s=>{if(s)return e(s);Se.close(i,a=>{if(a)return e(a);Se.stat(t,(u,m)=>{if(u)return e(u);e(null,m.mtime>1435410243e3)})})})})})}function Yw(e){if(typeof e=="number")return Math.floor(e/1e3)*1e3;if(e instanceof Date)return new Date(Math.floor(e.getTime()/1e3)*1e3);throw new Error("fs-extra: timeRemoveMillis() unknown parameter type")}function Zw(e,t,r,n){Se.open(e,"r+",(o,i)=>{if(o)return n(o);Se.futimes(i,t,r,s=>{Se.close(i,a=>{n&&n(s||a)})})})}function Qw(e,t,r){let n=Se.openSync(e,"r+");return Se.futimesSync(n,t,r),Se.closeSync(n)}Pl.exports={hasMillisRes:Hw,hasMillisResSync:Vw,timeRemoveMillis:Yw,utimesMillis:Zw,utimesMillisSync:Qw}});var xn=D((hR,Ll)=>{"use strict";var Je=de(),Re=require("path"),$l=10,kl=5,Xw=0,ma=process.versions.node.split("."),ql=Number.parseInt(ma[0],10),jl=Number.parseInt(ma[1],10),ex=Number.parseInt(ma[2],10);function bn(){if(ql>$l)return!0;if(ql===$l){if(jl>kl)return!0;if(jl===kl&&ex>=Xw)return!0}return!1}function tx(e,t,r){bn()?Je.stat(e,{bigint:!0},(n,o)=>{if(n)return r(n);Je.stat(t,{bigint:!0},(i,s)=>i?i.code==="ENOENT"?r(null,{srcStat:o,destStat:null}):r(i):r(null,{srcStat:o,destStat:s}))}):Je.stat(e,(n,o)=>{if(n)return r(n);Je.stat(t,(i,s)=>i?i.code==="ENOENT"?r(null,{srcStat:o,destStat:null}):r(i):r(null,{srcStat:o,destStat:s}))})}function rx(e,t){let r,n;bn()?r=Je.statSync(e,{bigint:!0}):r=Je.statSync(e);try{bn()?n=Je.statSync(t,{bigint:!0}):n=Je.statSync(t)}catch(o){if(o.code==="ENOENT")return{srcStat:r,destStat:null};throw o}return{srcStat:r,destStat:n}}function nx(e,t,r,n){tx(e,t,(o,i)=>{if(o)return n(o);let{srcStat:s,destStat:a}=i;return a&&a.ino&&a.dev&&a.ino===s.ino&&a.dev===s.dev?n(new Error("Source and destination must not be the same.")):s.isDirectory()&&da(e,t)?n(new Error(wn(e,t,r))):n(null,{srcStat:s,destStat:a})})}function ox(e,t,r){let{srcStat:n,destStat:o}=rx(e,t);if(o&&o.ino&&o.dev&&o.ino===n.ino&&o.dev===n.dev)throw new Error("Source and destination must not be the same.");if(n.isDirectory()&&da(e,t))throw new Error(wn(e,t,r));return{srcStat:n,destStat:o}}function pa(e,t,r,n,o){let i=Re.resolve(Re.dirname(e)),s=Re.resolve(Re.dirname(r));if(s===i||s===Re.parse(s).root)return o();bn()?Je.stat(s,{bigint:!0},(a,u)=>a?a.code==="ENOENT"?o():o(a):u.ino&&u.dev&&u.ino===t.ino&&u.dev===t.dev?o(new Error(wn(e,r,n))):pa(e,t,s,n,o)):Je.stat(s,(a,u)=>a?a.code==="ENOENT"?o():o(a):u.ino&&u.dev&&u.ino===t.ino&&u.dev===t.dev?o(new Error(wn(e,r,n))):pa(e,t,s,n,o))}function Ml(e,t,r,n){let o=Re.resolve(Re.dirname(e)),i=Re.resolve(Re.dirname(r));if(i===o||i===Re.parse(i).root)return;let s;try{bn()?s=Je.statSync(i,{bigint:!0}):s=Je.statSync(i)}catch(a){if(a.code==="ENOENT")return;throw a}if(s.ino&&s.dev&&s.ino===t.ino&&s.dev===t.dev)throw new Error(wn(e,r,n));return Ml(e,t,i,n)}function da(e,t){let r=Re.resolve(e).split(Re.sep).filter(o=>o),n=Re.resolve(t).split(Re.sep).filter(o=>o);return r.reduce((o,i,s)=>o&&n[s]===i,!0)}function wn(e,t,r){return`Cannot ${r} \'${e}\' to a subdirectory of itself, \'${t}\'.`}Ll.exports={checkPaths:nx,checkPathsSync:ox,checkParentPaths:pa,checkParentPathsSync:Ml,isSrcSubdir:da}});var Ul=D((gR,Bl)=>{"use strict";Bl.exports=function(e){if(typeof Buffer.allocUnsafe=="function")try{return Buffer.allocUnsafe(e)}catch{return new Buffer(e)}return new Buffer(e)}});var Jl=D((yR,Gl)=>{"use strict";var ne=de(),En=require("path"),ix=Pe().mkdirsSync,sx=la().utimesMillisSync,In=xn();function ax(e,t,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269`);let{srcStat:n,destStat:o}=In.checkPathsSync(e,t,"copy");return In.checkParentPathsSync(e,n,t,"copy"),ux(o,e,t,r)}function ux(e,t,r,n){if(n.filter&&!n.filter(t,r))return;let o=En.dirname(r);return ne.existsSync(o)||ix(o),zl(e,t,r,n)}function zl(e,t,r,n){if(!(n.filter&&!n.filter(t,r)))return cx(e,t,r,n)}function cx(e,t,r,n){let i=(n.dereference?ne.statSync:ne.lstatSync)(t);if(i.isDirectory())return mx(i,e,t,r,n);if(i.isFile()||i.isCharacterDevice()||i.isBlockDevice())return fx(i,e,t,r,n);if(i.isSymbolicLink())return gx(e,t,r,n)}function fx(e,t,r,n,o){return t?lx(e,r,n,o):Wl(e,r,n,o)}function lx(e,t,r,n){if(n.overwrite)return ne.unlinkSync(r),Wl(e,t,r,n);if(n.errorOnExist)throw new Error(`\'${r}\' already exists`)}function Wl(e,t,r,n){return typeof ne.copyFileSync=="function"?(ne.copyFileSync(t,r),ne.chmodSync(r,e.mode),n.preserveTimestamps?sx(r,e.atime,e.mtime):void 0):px(e,t,r,n)}function px(e,t,r,n){let i=Ul()(65536),s=ne.openSync(t,"r"),a=ne.openSync(r,"w",e.mode),u=0;for(;u<e.size;){let m=ne.readSync(s,i,0,65536,u);ne.writeSync(a,i,0,m),u+=m}n.preserveTimestamps&&ne.futimesSync(a,e.atime,e.mtime),ne.closeSync(s),ne.closeSync(a)}function mx(e,t,r,n,o){if(!t)return dx(e,r,n,o);if(t&&!t.isDirectory())throw new Error(`Cannot overwrite non-directory \'${n}\' with directory \'${r}\'.`);return Kl(r,n,o)}function dx(e,t,r,n){return ne.mkdirSync(r),Kl(t,r,n),ne.chmodSync(r,e.mode)}function Kl(e,t,r){ne.readdirSync(e).forEach(n=>hx(n,e,t,r))}function hx(e,t,r,n){let o=En.join(t,e),i=En.join(r,e),{destStat:s}=In.checkPathsSync(o,i,"copy");return zl(s,o,i,n)}function gx(e,t,r,n){let o=ne.readlinkSync(t);if(n.dereference&&(o=En.resolve(process.cwd(),o)),e){let i;try{i=ne.readlinkSync(r)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return ne.symlinkSync(o,r);throw s}if(n.dereference&&(i=En.resolve(process.cwd(),i)),In.isSrcSubdir(o,i))throw new Error(`Cannot copy \'${o}\' to a subdirectory of itself, \'${i}\'.`);if(ne.statSync(r).isDirectory()&&In.isSrcSubdir(i,o))throw new Error(`Cannot overwrite \'${i}\' with \'${o}\'.`);return yx(o,r)}else return ne.symlinkSync(o,r)}function yx(e,t){return ne.unlinkSync(t),ne.symlinkSync(e,t)}Gl.exports=ax});var ha=D((vR,Vl)=>{"use strict";Vl.exports={copySync:Jl()}});var ot=D((bR,Yl)=>{"use strict";var vx=Ce().fromPromise,Hl=ra();function bx(e){return Hl.access(e).then(()=>!0).catch(()=>!1)}Yl.exports={pathExists:vx(bx),pathExistsSync:Hl.existsSync}});var ip=D((wR,op)=>{"use strict";var Ie=de(),Sn=require("path"),wx=Pe().mkdirs,xx=ot().pathExists,Ex=la().utimesMillis,On=xn();function Ix(e,t,r,n){typeof r=="function"&&!n?(n=r,r={}):typeof r=="function"&&(r={filter:r}),n=n||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269`),On.checkPaths(e,t,"copy",(o,i)=>{if(o)return n(o);let{srcStat:s,destStat:a}=i;On.checkParentPaths(e,s,t,"copy",u=>u?n(u):r.filter?Xl(Zl,a,e,t,r,n):Zl(a,e,t,r,n))})}function Zl(e,t,r,n,o){let i=Sn.dirname(r);xx(i,(s,a)=>{if(s)return o(s);if(a)return ga(e,t,r,n,o);wx(i,u=>u?o(u):ga(e,t,r,n,o))})}function Xl(e,t,r,n,o,i){Promise.resolve(o.filter(r,n)).then(s=>s?e(t,r,n,o,i):i(),s=>i(s))}function ga(e,t,r,n,o){return n.filter?Xl(Ql,e,t,r,n,o):Ql(e,t,r,n,o)}function Ql(e,t,r,n,o){(n.dereference?Ie.stat:Ie.lstat)(t,(s,a)=>{if(s)return o(s);if(a.isDirectory())return _x(a,e,t,r,n,o);if(a.isFile()||a.isCharacterDevice()||a.isBlockDevice())return Sx(a,e,t,r,n,o);if(a.isSymbolicLink())return Cx(e,t,r,n,o)})}function Sx(e,t,r,n,o,i){return t?Ox(e,r,n,o,i):ep(e,r,n,o,i)}function Ox(e,t,r,n,o){if(n.overwrite)Ie.unlink(r,i=>i?o(i):ep(e,t,r,n,o));else return n.errorOnExist?o(new Error(`\'${r}\' already exists`)):o()}function ep(e,t,r,n,o){return typeof Ie.copyFile=="function"?Ie.copyFile(t,r,i=>i?o(i):tp(e,r,n,o)):Dx(e,t,r,n,o)}function Dx(e,t,r,n,o){let i=Ie.createReadStream(t);i.on("error",s=>o(s)).once("open",()=>{let s=Ie.createWriteStream(r,{mode:e.mode});s.on("error",a=>o(a)).on("open",()=>i.pipe(s)).once("close",()=>tp(e,r,n,o))})}function tp(e,t,r,n){Ie.chmod(t,e.mode,o=>o?n(o):r.preserveTimestamps?Ex(t,e.atime,e.mtime,n):n())}function _x(e,t,r,n,o,i){return t?t&&!t.isDirectory()?i(new Error(`Cannot overwrite non-directory \'${n}\' with directory \'${r}\'.`)):rp(r,n,o,i):Tx(e,r,n,o,i)}function Tx(e,t,r,n,o){Ie.mkdir(r,i=>{if(i)return o(i);rp(t,r,n,s=>s?o(s):Ie.chmod(r,e.mode,o))})}function rp(e,t,r,n){Ie.readdir(e,(o,i)=>o?n(o):np(i,e,t,r,n))}function np(e,t,r,n,o){let i=e.pop();return i?Nx(e,i,t,r,n,o):o()}function Nx(e,t,r,n,o,i){let s=Sn.join(r,t),a=Sn.join(n,t);On.checkPaths(s,a,"copy",(u,m)=>{if(u)return i(u);let{destStat:f}=m;ga(f,s,a,o,d=>d?i(d):np(e,r,n,o,i))})}function Cx(e,t,r,n,o){Ie.readlink(t,(i,s)=>{if(i)return o(i);if(n.dereference&&(s=Sn.resolve(process.cwd(),s)),e)Ie.readlink(r,(a,u)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?Ie.symlink(s,r,o):o(a):(n.dereference&&(u=Sn.resolve(process.cwd(),u)),On.isSrcSubdir(s,u)?o(new Error(`Cannot copy \'${s}\' to a subdirectory of itself, \'${u}\'.`)):e.isDirectory()&&On.isSrcSubdir(u,s)?o(new Error(`Cannot overwrite \'${u}\' with \'${s}\'.`)):Rx(s,r,o)));else return Ie.symlink(s,r,o)})}function Rx(e,t,r){Ie.unlink(t,n=>n?r(n):Ie.symlink(e,t,r))}op.exports=Ix});var ya=D((xR,sp)=>{"use strict";var Fx=Ce().fromCallback;sp.exports={copy:Fx(ip())}});var hp=D((ER,dp)=>{"use strict";var ap=de(),lp=require("path"),G=require("assert"),Dn=process.platform==="win32";function pp(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{e[r]=e[r]||ap[r],r=r+"Sync",e[r]=e[r]||ap[r]}),e.maxBusyTries=e.maxBusyTries||3}function va(e,t,r){let n=0;typeof t=="function"&&(r=t,t={}),G(e,"rimraf: missing path"),G.strictEqual(typeof e,"string","rimraf: path should be a string"),G.strictEqual(typeof r,"function","rimraf: callback function required"),G(t,"rimraf: invalid options argument provided"),G.strictEqual(typeof t,"object","rimraf: options should be object"),pp(t),up(e,t,function o(i){if(i){if((i.code==="EBUSY"||i.code==="ENOTEMPTY"||i.code==="EPERM")&&n<t.maxBusyTries){n++;let s=n*100;return setTimeout(()=>up(e,t,o),s)}i.code==="ENOENT"&&(i=null)}r(i)})}function up(e,t,r){G(e),G(t),G(typeof r=="function"),t.lstat(e,(n,o)=>{if(n&&n.code==="ENOENT")return r(null);if(n&&n.code==="EPERM"&&Dn)return cp(e,t,n,r);if(o&&o.isDirectory())return Xo(e,t,n,r);t.unlink(e,i=>{if(i){if(i.code==="ENOENT")return r(null);if(i.code==="EPERM")return Dn?cp(e,t,i,r):Xo(e,t,i,r);if(i.code==="EISDIR")return Xo(e,t,i,r)}return r(i)})})}function cp(e,t,r,n){G(e),G(t),G(typeof n=="function"),r&&G(r instanceof Error),t.chmod(e,438,o=>{o?n(o.code==="ENOENT"?null:r):t.stat(e,(i,s)=>{i?n(i.code==="ENOENT"?null:r):s.isDirectory()?Xo(e,t,r,n):t.unlink(e,n)})})}function fp(e,t,r){let n;G(e),G(t),r&&G(r instanceof Error);try{t.chmodSync(e,438)}catch(o){if(o.code==="ENOENT")return;throw r}try{n=t.statSync(e)}catch(o){if(o.code==="ENOENT")return;throw r}n.isDirectory()?ei(e,t,r):t.unlinkSync(e)}function Xo(e,t,r,n){G(e),G(t),r&&G(r instanceof Error),G(typeof n=="function"),t.rmdir(e,o=>{o&&(o.code==="ENOTEMPTY"||o.code==="EEXIST"||o.code==="EPERM")?Ax(e,t,n):o&&o.code==="ENOTDIR"?n(r):n(o)})}function Ax(e,t,r){G(e),G(t),G(typeof r=="function"),t.readdir(e,(n,o)=>{if(n)return r(n);let i=o.length,s;if(i===0)return t.rmdir(e,r);o.forEach(a=>{va(lp.join(e,a),t,u=>{if(!s){if(u)return r(s=u);--i===0&&t.rmdir(e,r)}})})})}function mp(e,t){let r;t=t||{},pp(t),G(e,"rimraf: missing path"),G.strictEqual(typeof e,"string","rimraf: path should be a string"),G(t,"rimraf: missing options"),G.strictEqual(typeof t,"object","rimraf: options should be object");try{r=t.lstatSync(e)}catch(n){if(n.code==="ENOENT")return;n.code==="EPERM"&&Dn&&fp(e,t,n)}try{r&&r.isDirectory()?ei(e,t,null):t.unlinkSync(e)}catch(n){if(n.code==="ENOENT")return;if(n.code==="EPERM")return Dn?fp(e,t,n):ei(e,t,n);if(n.code!=="EISDIR")throw n;ei(e,t,n)}}function ei(e,t,r){G(e),G(t),r&&G(r instanceof Error);try{t.rmdirSync(e)}catch(n){if(n.code==="ENOTDIR")throw r;if(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")Px(e,t);else if(n.code!=="ENOENT")throw n}}function Px(e,t){if(G(e),G(t),t.readdirSync(e).forEach(r=>mp(lp.join(e,r),t)),Dn){let r=Date.now();do try{return t.rmdirSync(e,t)}catch{}while(Date.now()-r<500)}else return t.rmdirSync(e,t)}dp.exports=va;va.sync=mp});var _n=D((IR,yp)=>{"use strict";var $x=Ce().fromCallback,gp=hp();yp.exports={remove:$x(gp),removeSync:gp.sync}});var Op=D((SR,Sp)=>{"use strict";var kx=Ce().fromCallback,wp=de(),xp=require("path"),Ep=Pe(),Ip=_n(),vp=kx(function(t,r){r=r||function(){},wp.readdir(t,(n,o)=>{if(n)return Ep.mkdirs(t,r);o=o.map(s=>xp.join(t,s)),i();function i(){let s=o.pop();if(!s)return r();Ip.remove(s,a=>{if(a)return r(a);i()})}})});function bp(e){let t;try{t=wp.readdirSync(e)}catch{return Ep.mkdirsSync(e)}t.forEach(r=>{r=xp.join(e,r),Ip.removeSync(r)})}Sp.exports={emptyDirSync:bp,emptydirSync:bp,emptyDir:vp,emptydir:vp}});var Np=D((OR,Tp)=>{"use strict";var qx=Ce().fromCallback,Dp=require("path"),Tn=de(),_p=Pe(),jx=ot().pathExists;function Mx(e,t){function r(){Tn.writeFile(e,"",n=>{if(n)return t(n);t()})}Tn.stat(e,(n,o)=>{if(!n&&o.isFile())return t();let i=Dp.dirname(e);jx(i,(s,a)=>{if(s)return t(s);if(a)return r();_p.mkdirs(i,u=>{if(u)return t(u);r()})})})}function Lx(e){let t;try{t=Tn.statSync(e)}catch{}if(t&&t.isFile())return;let r=Dp.dirname(e);Tn.existsSync(r)||_p.mkdirsSync(r),Tn.writeFileSync(e,"")}Tp.exports={createFile:qx(Mx),createFileSync:Lx}});var Pp=D((DR,Ap)=>{"use strict";var Bx=Ce().fromCallback,Rp=require("path"),Jt=de(),Fp=Pe(),Cp=ot().pathExists;function Ux(e,t,r){function n(o,i){Jt.link(o,i,s=>{if(s)return r(s);r(null)})}Cp(t,(o,i)=>{if(o)return r(o);if(i)return r(null);Jt.lstat(e,s=>{if(s)return s.message=s.message.replace("lstat","ensureLink"),r(s);let a=Rp.dirname(t);Cp(a,(u,m)=>{if(u)return r(u);if(m)return n(e,t);Fp.mkdirs(a,f=>{if(f)return r(f);n(e,t)})})})})}function zx(e,t){if(Jt.existsSync(t))return;try{Jt.lstatSync(e)}catch(i){throw i.message=i.message.replace("lstat","ensureLink"),i}let n=Rp.dirname(t);return Jt.existsSync(n)||Fp.mkdirsSync(n),Jt.linkSync(e,t)}Ap.exports={createLink:Bx(Ux),createLinkSync:zx}});var kp=D((_R,$p)=>{"use strict";var Tt=require("path"),Nn=de(),Wx=ot().pathExists;function Kx(e,t,r){if(Tt.isAbsolute(e))return Nn.lstat(e,n=>n?(n.message=n.message.replace("lstat","ensureSymlink"),r(n)):r(null,{toCwd:e,toDst:e}));{let n=Tt.dirname(t),o=Tt.join(n,e);return Wx(o,(i,s)=>i?r(i):s?r(null,{toCwd:o,toDst:e}):Nn.lstat(e,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),r(a)):r(null,{toCwd:e,toDst:Tt.relative(n,e)})))}}function Gx(e,t){let r;if(Tt.isAbsolute(e)){if(r=Nn.existsSync(e),!r)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}else{let n=Tt.dirname(t),o=Tt.join(n,e);if(r=Nn.existsSync(o),r)return{toCwd:o,toDst:e};if(r=Nn.existsSync(e),!r)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:Tt.relative(n,e)}}}$p.exports={symlinkPaths:Kx,symlinkPathsSync:Gx}});var Mp=D((TR,jp)=>{"use strict";var qp=de();function Jx(e,t,r){if(r=typeof t=="function"?t:r,t=typeof t=="function"?!1:t,t)return r(null,t);qp.lstat(e,(n,o)=>{if(n)return r(null,"file");t=o&&o.isDirectory()?"dir":"file",r(null,t)})}function Vx(e,t){let r;if(t)return t;try{r=qp.lstatSync(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}jp.exports={symlinkType:Jx,symlinkTypeSync:Vx}});var Gp=D((NR,Kp)=>{"use strict";var Hx=Ce().fromCallback,Bp=require("path"),wr=de(),Up=Pe(),Yx=Up.mkdirs,Zx=Up.mkdirsSync,zp=kp(),Qx=zp.symlinkPaths,Xx=zp.symlinkPathsSync,Wp=Mp(),e0=Wp.symlinkType,t0=Wp.symlinkTypeSync,Lp=ot().pathExists;function r0(e,t,r,n){n=typeof r=="function"?r:n,r=typeof r=="function"?!1:r,Lp(t,(o,i)=>{if(o)return n(o);if(i)return n(null);Qx(e,t,(s,a)=>{if(s)return n(s);e=a.toDst,e0(a.toCwd,r,(u,m)=>{if(u)return n(u);let f=Bp.dirname(t);Lp(f,(d,l)=>{if(d)return n(d);if(l)return wr.symlink(e,t,m,n);Yx(f,g=>{if(g)return n(g);wr.symlink(e,t,m,n)})})})})})}function n0(e,t,r){if(wr.existsSync(t))return;let o=Xx(e,t);e=o.toDst,r=t0(o.toCwd,r);let i=Bp.dirname(t);return wr.existsSync(i)||Zx(i),wr.symlinkSync(e,t,r)}Kp.exports={createSymlink:Hx(r0),createSymlinkSync:n0}});var Vp=D((CR,Jp)=>{"use strict";var ti=Np(),ri=Pp(),ni=Gp();Jp.exports={createFile:ti.createFile,createFileSync:ti.createFileSync,ensureFile:ti.createFile,ensureFileSync:ti.createFileSync,createLink:ri.createLink,createLinkSync:ri.createLinkSync,ensureLink:ri.createLink,ensureLinkSync:ri.createLinkSync,createSymlink:ni.createSymlink,createSymlinkSync:ni.createSymlinkSync,ensureSymlink:ni.createSymlink,ensureSymlinkSync:ni.createSymlinkSync}});var Qp=D((RR,Zp)=>{var xr;try{xr=de()}catch{xr=require("fs")}function o0(e,t,r){r==null&&(r=t,t={}),typeof t=="string"&&(t={encoding:t}),t=t||{};var n=t.fs||xr,o=!0;"throws"in t&&(o=t.throws),n.readFile(e,t,function(i,s){if(i)return r(i);s=Yp(s);var a;try{a=JSON.parse(s,t?t.reviver:null)}catch(u){return o?(u.message=e+": "+u.message,r(u)):r(null,null)}r(null,a)})}function i0(e,t){t=t||{},typeof t=="string"&&(t={encoding:t});var r=t.fs||xr,n=!0;"throws"in t&&(n=t.throws);try{var o=r.readFileSync(e,t);return o=Yp(o),JSON.parse(o,t.reviver)}catch(i){if(n)throw i.message=e+": "+i.message,i;return null}}function Hp(e,t){var r,n=`\n`;typeof t=="object"&&t!==null&&(t.spaces&&(r=t.spaces),t.EOL&&(n=t.EOL));var o=JSON.stringify(e,t?t.replacer:null,r);return o.replace(/\\n/g,n)+n}function s0(e,t,r,n){n==null&&(n=r,r={}),r=r||{};var o=r.fs||xr,i="";try{i=Hp(t,r)}catch(s){n&&n(s,null);return}o.writeFile(e,i,r,n)}function a0(e,t,r){r=r||{};var n=r.fs||xr,o=Hp(t,r);return n.writeFileSync(e,o,r)}function Yp(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e=e.replace(/^\\uFEFF/,""),e}var u0={readFile:o0,readFileSync:i0,writeFile:s0,writeFileSync:a0};Zp.exports=u0});var ii=D((FR,em)=>{"use strict";var Xp=Ce().fromCallback,oi=Qp();em.exports={readJson:Xp(oi.readFile),readJsonSync:oi.readFileSync,writeJson:Xp(oi.writeFile),writeJsonSync:oi.writeFileSync}});var nm=D((AR,rm)=>{"use strict";var c0=require("path"),f0=Pe(),l0=ot().pathExists,tm=ii();function p0(e,t,r,n){typeof r=="function"&&(n=r,r={});let o=c0.dirname(e);l0(o,(i,s)=>{if(i)return n(i);if(s)return tm.writeJson(e,t,r,n);f0.mkdirs(o,a=>{if(a)return n(a);tm.writeJson(e,t,r,n)})})}rm.exports=p0});var im=D((PR,om)=>{"use strict";var m0=de(),d0=require("path"),h0=Pe(),g0=ii();function y0(e,t,r){let n=d0.dirname(e);m0.existsSync(n)||h0.mkdirsSync(n),g0.writeJsonSync(e,t,r)}om.exports=y0});var am=D(($R,sm)=>{"use strict";var v0=Ce().fromCallback,De=ii();De.outputJson=v0(nm());De.outputJsonSync=im();De.outputJSON=De.outputJson;De.outputJSONSync=De.outputJsonSync;De.writeJSON=De.writeJson;De.writeJSONSync=De.writeJsonSync;De.readJSON=De.readJson;De.readJSONSync=De.readJsonSync;sm.exports=De});var mm=D((kR,pm)=>{"use strict";var fm=de(),b0=require("path"),w0=ha().copySync,lm=_n().removeSync,x0=Pe().mkdirpSync,um=xn();function E0(e,t,r){r=r||{};let n=r.overwrite||r.clobber||!1,{srcStat:o}=um.checkPathsSync(e,t,"move");return um.checkParentPathsSync(e,o,t,"move"),x0(b0.dirname(t)),I0(e,t,n)}function I0(e,t,r){if(r)return lm(t),cm(e,t,r);if(fm.existsSync(t))throw new Error("dest already exists.");return cm(e,t,r)}function cm(e,t,r){try{fm.renameSync(e,t)}catch(n){if(n.code!=="EXDEV")throw n;return S0(e,t,r)}}function S0(e,t,r){return w0(e,t,{overwrite:r,errorOnExist:!0}),lm(e)}pm.exports=E0});var hm=D((qR,dm)=>{"use strict";dm.exports={moveSync:mm()}});var wm=D((jR,bm)=>{"use strict";var O0=de(),D0=require("path"),_0=ya().copy,vm=_n().remove,T0=Pe().mkdirp,N0=ot().pathExists,gm=xn();function C0(e,t,r,n){typeof r=="function"&&(n=r,r={});let o=r.overwrite||r.clobber||!1;gm.checkPaths(e,t,"move",(i,s)=>{if(i)return n(i);let{srcStat:a}=s;gm.checkParentPaths(e,a,t,"move",u=>{if(u)return n(u);T0(D0.dirname(t),m=>m?n(m):R0(e,t,o,n))})})}function R0(e,t,r,n){if(r)return vm(t,o=>o?n(o):ym(e,t,r,n));N0(t,(o,i)=>o?n(o):i?n(new Error("dest already exists.")):ym(e,t,r,n))}function ym(e,t,r,n){O0.rename(e,t,o=>o?o.code!=="EXDEV"?n(o):F0(e,t,r,n):n())}function F0(e,t,r,n){_0(e,t,{overwrite:r,errorOnExist:!0},i=>i?n(i):vm(e,n))}bm.exports=C0});var Em=D((MR,xm)=>{"use strict";var A0=Ce().fromCallback;xm.exports={move:A0(wm())}});var Dm=D((LR,Om)=>{"use strict";var P0=Ce().fromCallback,Cn=de(),Im=require("path"),Sm=Pe(),$0=ot().pathExists;function k0(e,t,r,n){typeof r=="function"&&(n=r,r="utf8");let o=Im.dirname(e);$0(o,(i,s)=>{if(i)return n(i);if(s)return Cn.writeFile(e,t,r,n);Sm.mkdirs(o,a=>{if(a)return n(a);Cn.writeFile(e,t,r,n)})})}function q0(e,...t){let r=Im.dirname(e);if(Cn.existsSync(r))return Cn.writeFileSync(e,...t);Sm.mkdirsSync(r),Cn.writeFileSync(e,...t)}Om.exports={outputFile:P0(k0),outputFileSync:q0}});var wa=D((BR,ba)=>{"use strict";ba.exports=Object.assign({},ra(),ha(),ya(),Op(),Vp(),am(),Pe(),hm(),Em(),Dm(),ot(),_n());var _m=require("fs");Object.getOwnPropertyDescriptor(_m,"promises")&&Object.defineProperty(ba.exports,"promises",{get(){return _m.promises}})});var Nm=D((UR,Tm)=>{Tm.exports=()=>new Date});var Rm=D((zR,Cm)=>{var j0=we()("streamroller:fileNameFormatter"),M0=require("path"),L0=".gz",B0=".";Cm.exports=({file:e,keepFileExt:t,needsIndex:r,alwaysIncludeDate:n,compress:o,fileNameSep:i})=>{let s=i||B0,a=M0.join(e.dir,e.name),u=g=>g+e.ext,m=(g,w,x)=>(r||!x)&&w?g+s+w:g,f=(g,w,x)=>(w>0||n)&&x?g+s+x:g,d=(g,w)=>w&&o?g+L0:g,l=t?[f,m,u,d]:[u,f,m,d];return({date:g,index:w})=>(j0(`_formatFileName: date=${g}, index=${w}`),l.reduce((x,S)=>S(x,w,g),a))}});var $m=D((WR,Pm)=>{var Vt=we()("streamroller:fileNameParser"),Fm=".gz",Am=zo(),U0=".";Pm.exports=({file:e,keepFileExt:t,pattern:r,fileNameSep:n})=>{let o=n||U0,i=(l,g)=>l.endsWith(Fm)?(Vt("it is gzipped"),g.isCompressed=!0,l.slice(0,-1*Fm.length)):l,s="__NOT_MATCHING__",d=[i,t?l=>l.startsWith(e.name)&&l.endsWith(e.ext)?(Vt("it starts and ends with the right things"),l.slice(e.name.length+1,-1*e.ext.length)):s:l=>l.startsWith(e.base)?(Vt("it starts with the right things"),l.slice(e.base.length+1)):s,r?(l,g)=>{let w=l.split(o),x=w[w.length-1];Vt("items: ",w,", indexStr: ",x);let S=l;x!==void 0&&x.match(/^\\d+$/)?(S=l.slice(0,-1*(x.length+1)),Vt(`dateStr is ${S}`),r&&!S&&(S=x,x="0")):x="0";try{let N=Am.parse(r,S,new Date(0,0));return Am.asString(r,N)!==S?l:(g.index=parseInt(x,10),g.date=S,g.timestamp=N.getTime(),"")}catch(N){return Vt(`Problem parsing ${S} as ${r}, error was: `,N),l}}:(l,g)=>l.match(/^\\d+$/)?(Vt("it has an index"),g.index=parseInt(l,10),""):l];return l=>{let g={filename:l,index:0,isCompressed:!1};return d.reduce((x,S)=>S(x,g),l)?null:g}}});var qm=D((KR,km)=>{var Fe=we()("streamroller:moveAndMaybeCompressFile"),ht=wa(),z0=require("zlib"),W0=function(e){let t={mode:parseInt("0600",8),compress:!1},r=Object.assign({},t,e);return Fe(`_parseOption: moveAndMaybeCompressFile called with option=${JSON.stringify(r)}`),r},K0=async(e,t,r)=>{if(r=W0(r),e===t){Fe("moveAndMaybeCompressFile: source and target are the same, not doing anything");return}if(await ht.pathExists(e))if(Fe(`moveAndMaybeCompressFile: moving file from ${e} to ${t} ${r.compress?"with":"without"} compress`),r.compress)await new Promise((n,o)=>{let i=!1,s=ht.createWriteStream(t,{mode:r.mode,flags:"wx"}).on("open",()=>{i=!0;let a=ht.createReadStream(e).on("open",()=>{a.pipe(z0.createGzip()).pipe(s)}).on("error",u=>{Fe(`moveAndMaybeCompressFile: error reading ${e}`,u),s.destroy(u)})}).on("finish",()=>{Fe(`moveAndMaybeCompressFile: finished compressing ${t}, deleting ${e}`),ht.unlink(e).then(n).catch(a=>{Fe(`moveAndMaybeCompressFile: error deleting ${e}, truncating instead`,a),ht.truncate(e).then(n).catch(u=>{Fe(`moveAndMaybeCompressFile: error truncating ${e}`,u),o(u)})})}).on("error",a=>{i?(Fe(`moveAndMaybeCompressFile: error writing ${t}, deleting`,a),ht.unlink(t).then(()=>{o(a)}).catch(u=>{Fe(`moveAndMaybeCompressFile: error deleting ${t}`,u),o(u)})):(Fe(`moveAndMaybeCompressFile: error creating ${t}`,a),o(a))})}).catch(()=>{});else{Fe(`moveAndMaybeCompressFile: renaming ${e} to ${t}`);try{await ht.move(e,t,{overwrite:!0})}catch(n){if(Fe(`moveAndMaybeCompressFile: error renaming ${e} to ${t}`,n),n.code!=="ENOENT"){Fe("moveAndMaybeCompressFile: trying copy+truncate instead");try{await ht.copy(e,t,{overwrite:!0}),await ht.truncate(e)}catch(o){Fe("moveAndMaybeCompressFile: error copy+truncate",o)}}}}};km.exports=K0});var ui=D((GR,jm)=>{var $e=we()("streamroller:RollingFileWriteStream"),Yt=wa(),Ht=require("path"),G0=require("os"),si=Nm(),ai=zo(),{Writable:J0}=require("stream"),V0=Rm(),H0=$m(),Y0=qm(),Z0=e=>($e(`deleteFiles: files to delete: ${e}`),Promise.all(e.map(t=>Yt.unlink(t).catch(r=>{$e(`deleteFiles: error when unlinking ${t}, ignoring. Error was ${r}`)})))),xa=class extends J0{constructor(t,r){if($e(`constructor: creating RollingFileWriteStream. path=${t}`),typeof t!="string"||t.length===0)throw new Error(`Invalid filename: ${t}`);if(t.endsWith(Ht.sep))throw new Error(`Filename is a directory: ${t}`);t.indexOf(`~${Ht.sep}`)===0&&(t=t.replace("~",G0.homedir())),super(r),this.options=this._parseOption(r),this.fileObject=Ht.parse(t),this.fileObject.dir===""&&(this.fileObject=Ht.parse(Ht.join(process.cwd(),t))),this.fileFormatter=V0({file:this.fileObject,alwaysIncludeDate:this.options.alwaysIncludePattern,needsIndex:this.options.maxSize<Number.MAX_SAFE_INTEGER,compress:this.options.compress,keepFileExt:this.options.keepFileExt,fileNameSep:this.options.fileNameSep}),this.fileNameParser=H0({file:this.fileObject,keepFileExt:this.options.keepFileExt,pattern:this.options.pattern,fileNameSep:this.options.fileNameSep}),this.state={currentSize:0},this.options.pattern&&(this.state.currentDate=ai(this.options.pattern,si())),this.filename=this.fileFormatter({index:0,date:this.state.currentDate}),["a","a+","as","as+"].includes(this.options.flags)&&this._setExistingSizeAndDate(),$e(`constructor: create new file ${this.filename}, state=${JSON.stringify(this.state)}`),this._renewWriteStream()}_setExistingSizeAndDate(){try{let t=Yt.statSync(this.filename);this.state.currentSize=t.size,this.options.pattern&&(this.state.currentDate=ai(this.options.pattern,t.mtime))}catch{return}}_parseOption(t){let r={maxSize:0,numToKeep:Number.MAX_SAFE_INTEGER,encoding:"utf8",mode:parseInt("0600",8),flags:"a",compress:!1,keepFileExt:!1,alwaysIncludePattern:!1},n=Object.assign({},r,t);if(!n.maxSize)delete n.maxSize;else if(n.maxSize<=0)throw new Error(`options.maxSize (${n.maxSize}) should be > 0`);if(n.numBackups||n.numBackups===0){if(n.numBackups<0)throw new Error(`options.numBackups (${n.numBackups}) should be >= 0`);if(n.numBackups>=Number.MAX_SAFE_INTEGER)throw new Error(`options.numBackups (${n.numBackups}) should be < Number.MAX_SAFE_INTEGER`);n.numToKeep=n.numBackups+1}else if(n.numToKeep<=0)throw new Error(`options.numToKeep (${n.numToKeep}) should be > 0`);return $e(`_parseOption: creating stream with option=${JSON.stringify(n)}`),n}_final(t){this.currentFileStream.end("",this.options.encoding,t)}_write(t,r,n){this._shouldRoll().then(()=>{$e(`_write: writing chunk. file=${this.currentFileStream.path} state=${JSON.stringify(this.state)} chunk=${t}`),this.currentFileStream.write(t,r,o=>{this.state.currentSize+=t.length,n(o)})})}async _shouldRoll(){(this._dateChanged()||this._tooBig())&&($e(`_shouldRoll: rolling because dateChanged? ${this._dateChanged()} or tooBig? ${this._tooBig()}`),await this._roll())}_dateChanged(){return this.state.currentDate&&this.state.currentDate!==ai(this.options.pattern,si())}_tooBig(){return this.state.currentSize>=this.options.maxSize}_roll(){return $e("_roll: closing the current stream"),new Promise((t,r)=>{this.currentFileStream.end("",this.options.encoding,()=>{this._moveOldFiles().then(t).catch(r)})})}async _moveOldFiles(){let t=await this._getExistingFiles(),r=this.state.currentDate?t.filter(n=>n.date===this.state.currentDate):t;for(let n=r.length;n>=0;n--){$e(`_moveOldFiles: i = ${n}`);let o=this.fileFormatter({date:this.state.currentDate,index:n}),i=this.fileFormatter({date:this.state.currentDate,index:n+1}),s={compress:this.options.compress&&n===0,mode:this.options.mode};await Y0(o,i,s)}this.state.currentSize=0,this.state.currentDate=this.state.currentDate?ai(this.options.pattern,si()):null,$e(`_moveOldFiles: finished rolling files. state=${JSON.stringify(this.state)}`),this._renewWriteStream(),await new Promise((n,o)=>{this.currentFileStream.write("","utf8",()=>{this._clean().then(n).catch(o)})})}async _getExistingFiles(){let t=await Yt.readdir(this.fileObject.dir).catch(()=>[]);$e(`_getExistingFiles: files=${t}`);let r=t.map(o=>this.fileNameParser(o)).filter(o=>o),n=o=>(o.timestamp?o.timestamp:si().getTime())-o.index;return r.sort((o,i)=>n(o)-n(i)),r}_renewWriteStream(){let t=this.fileFormatter({date:this.state.currentDate,index:0}),r=i=>{try{return Yt.mkdirSync(i,{recursive:!0})}catch(s){if(s.code==="ENOENT")return r(Ht.dirname(i)),r(i);if(s.code!=="EEXIST"&&s.code!=="EROFS")throw s;try{if(Yt.statSync(i).isDirectory())return i;throw s}catch{throw s}}};r(this.fileObject.dir);let n={flags:this.options.flags,encoding:this.options.encoding,mode:this.options.mode},o=function(i,s,a){return i[a]=i[s],delete i[s],i};Yt.appendFileSync(t,"",o({...n},"flags","flag")),this.currentFileStream=Yt.createWriteStream(t,n),this.currentFileStream.on("error",i=>{this.emit("error",i)})}async _clean(){let t=await this._getExistingFiles();if($e(`_clean: numToKeep = ${this.options.numToKeep}, existingFiles = ${t.length}`),$e("_clean: existing files are: ",t),this._tooManyFiles(t.length)){let r=t.slice(0,t.length-this.options.numToKeep).map(n=>Ht.format({dir:this.fileObject.dir,base:n.filename}));await Z0(r)}}_tooManyFiles(t){return this.options.numToKeep>0&&t>this.options.numToKeep}};jm.exports=xa});var Lm=D((JR,Mm)=>{var Q0=ui(),Ea=class extends Q0{constructor(t,r,n,o){o||(o={}),r&&(o.maxSize=r),!o.numBackups&&o.numBackups!==0&&(!n&&n!==0&&(n=1),o.numBackups=n),super(t,o),this.backups=o.numBackups,this.size=this.options.maxSize}get theStream(){return this.currentFileStream}};Mm.exports=Ea});var Um=D((VR,Bm)=>{var X0=ui(),Ia=class extends X0{constructor(t,r,n){r&&typeof r=="object"&&(n=r,r=null),n||(n={}),r||(r="yyyy-MM-dd"),n.pattern=r,!n.numBackups&&n.numBackups!==0?(!n.daysToKeep&&n.daysToKeep!==0?n.daysToKeep=1:process.emitWarning("options.daysToKeep is deprecated due to the confusion it causes when used together with file size rolling. Please use options.numBackups instead.","DeprecationWarning","streamroller-DEP0001"),n.numBackups=n.daysToKeep):n.daysToKeep=n.numBackups,super(t,n),this.mode=this.options.mode}get theStream(){return this.currentFileStream}};Bm.exports=Ia});var Sa=D((HR,zm)=>{zm.exports={RollingFileWriteStream:ui(),RollingFileStream:Lm(),DateRollingFileStream:Um()}});var Vm=D((YR,Jm)=>{var Wm=we()("log4js:file"),Oa=require("path"),eE=Sa(),Gm=require("os"),tE=Gm.EOL,ci=!1,fi=new Set;function Km(){fi.forEach(e=>{e.sighupHandler()})}function rE(e,t,r,n,o,i){if(typeof e!="string"||e.length===0)throw new Error(`Invalid filename: ${e}`);if(e.endsWith(Oa.sep))throw new Error(`Filename is a directory: ${e}`);e=e.replace(new RegExp(`^~(?=${Oa.sep}.+)`),Gm.homedir()),e=Oa.normalize(e),n=!n&&n!==0?5:n,Wm("Creating file appender (",e,", ",r,", ",n,", ",o,", ",i,")");function s(m,f,d,l){let g=new eE.RollingFileStream(m,f,d,l);return g.on("error",w=>{console.error("log4js.fileAppender - Writing to file %s, error happened ",m,w)}),g.on("drain",()=>{process.emit("log4js:pause",!1)}),g}let a=s(e,r,n,o),u=function(m){if(a.writable){if(o.removeColor===!0){let f=/\\x1b[[0-9;]*m/g;m.data=m.data.map(d=>typeof d=="string"?d.replace(f,""):d)}a.write(t(m,i)+tE,"utf8")||process.emit("log4js:pause",!0)}};return u.reopen=function(){a.end(()=>{a=s(e,r,n,o)})},u.sighupHandler=function(){Wm("SIGHUP handler called."),u.reopen()},u.shutdown=function(m){fi.delete(u),fi.size===0&&ci&&(process.removeListener("SIGHUP",Km),ci=!1),a.end("","utf-8",m)},fi.add(u),ci||(process.on("SIGHUP",Km),ci=!0),u}function nE(e,t){let r=t.basicLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),e.mode=e.mode||384,rE(e.filename,r,e.maxLogSize,e.backups,e,e.timezoneOffset)}Jm.exports.configure=nE});var Ym=D((ZR,Hm)=>{var oE=Sa(),iE=require("os"),sE=iE.EOL;function aE(e,t,r){let n=new oE.DateRollingFileStream(e,t,r);return n.on("error",o=>{console.error("log4js.dateFileAppender - Writing to file %s, error happened ",e,o)}),n.on("drain",()=>{process.emit("log4js:pause",!1)}),n}function uE(e,t,r,n,o){n.maxSize=n.maxLogSize;let i=aE(e,t,n),s=function(a){i.writable&&(i.write(r(a,o)+sE,"utf8")||process.emit("log4js:pause",!0))};return s.shutdown=function(a){i.end("","utf-8",a)},s}function cE(e,t){let r=t.basicLayout;return e.layout&&(r=t.layout(e.layout.type,e.layout)),e.alwaysIncludePattern||(e.alwaysIncludePattern=!1),e.mode=e.mode||384,uE(e.filename,e.pattern,r,e,e.timezoneOffset)}Hm.exports.configure=cE});var ed=D((QR,Xm)=>{var gt=we()("log4js:fileSync"),st=require("path"),it=require("fs"),Zm=require("os"),fE=Zm.EOL;function Qm(e,t){let r=n=>{try{return it.mkdirSync(n,{recursive:!0})}catch(o){if(o.code==="ENOENT")return r(st.dirname(n)),r(n);if(o.code!=="EEXIST"&&o.code!=="EROFS")throw o;try{if(it.statSync(n).isDirectory())return n;throw o}catch{throw o}}};r(st.dirname(e)),it.appendFileSync(e,"",{mode:t.mode,flag:t.flags})}var Da=class{constructor(t,r,n,o){if(gt("In RollingFileStream"),r<0)throw new Error(`maxLogSize (${r}) should be > 0`);this.filename=t,this.size=r,this.backups=n,this.options=o,this.currentSize=0;function i(s){let a=0;try{a=it.statSync(s).size}catch{Qm(s,o)}return a}this.currentSize=i(this.filename)}shouldRoll(){return gt("should roll with current size %d, and max size %d",this.currentSize,this.size),this.currentSize>=this.size}roll(t){let r=this,n=new RegExp(`^${st.basename(t)}`);function o(m){return n.test(m)}function i(m){return parseInt(m.slice(`${st.basename(t)}.`.length),10)||0}function s(m,f){return i(m)-i(f)}function a(m){let f=i(m);if(gt(`Index of ${m} is ${f}`),r.backups===0)it.truncateSync(t,0);else if(f<r.backups){try{it.unlinkSync(`${t}.${f+1}`)}catch{}gt(`Renaming ${m} -> ${t}.${f+1}`),it.renameSync(st.join(st.dirname(t),m),`${t}.${f+1}`)}}function u(){gt("Renaming the old files"),it.readdirSync(st.dirname(t)).filter(o).sort(s).reverse().forEach(a)}gt("Rolling, rolling, rolling"),u()}write(t,r){let n=this;function o(){gt("writing the chunk to the file"),n.currentSize+=t.length,it.appendFileSync(n.filename,t)}gt("in write"),this.shouldRoll()&&(this.currentSize=0,this.roll(this.filename)),o()}};function lE(e,t,r,n,o,i){if(typeof e!="string"||e.length===0)throw new Error(`Invalid filename: ${e}`);if(e.endsWith(st.sep))throw new Error(`Filename is a directory: ${e}`);e=e.replace(new RegExp(`^~(?=${st.sep}.+)`),Zm.homedir()),e=st.normalize(e),n=!n&&n!==0?5:n,gt("Creating fileSync appender (",e,", ",r,", ",n,", ",o,", ",i,")");function s(u,m,f){let d;return m?d=new Da(u,m,f,o):d=(l=>(Qm(l,o),{write(g){it.appendFileSync(l,g)}}))(u),d}let a=s(e,r,n);return u=>{a.write(t(u,i)+fE)}}function pE(e,t){let r=t.basicLayout;e.layout&&(r=t.layout(e.layout.type,e.layout));let n={flags:e.flags||"a",encoding:e.encoding||"utf8",mode:e.mode||384};return lE(e.filename,r,e.maxLogSize,e.backups,n,e.timezoneOffset)}Xm.exports.configure=pE});var rd=D((XR,td)=>{var at=we()("log4js:tcp"),mE=require("net");function dE(e,t){let r=!1,n=[],o,i=3,s="__LOG4JS__";function a(d){at("Writing log event to socket"),r=o.write(`${t(d)}${s}`,"utf8")}function u(){let d;for(at("emptying buffer");d=n.shift();)a(d)}function m(){at(`appender creating socket to ${e.host||"localhost"}:${e.port||5e3}`),s=`${e.endMsg||"__LOG4JS__"}`,o=mE.createConnection(e.port||5e3,e.host||"localhost"),o.on("connect",()=>{at("socket connected"),u(),r=!0}),o.on("drain",()=>{at("drain event received, emptying buffer"),r=!0,u()}),o.on("timeout",o.end.bind(o)),o.on("error",d=>{at("connection error",d),r=!1,u()}),o.on("close",m)}m();function f(d){r?a(d):(at("buffering log event because it cannot write at the moment"),n.push(d))}return f.shutdown=function(d){at("shutdown called"),n.length&&i?(at("buffer has items, waiting 100ms to empty"),i-=1,setTimeout(()=>{f.shutdown(d)},100)):(o.removeAllListeners("close"),o.end(d))},f}function hE(e,t){at(`configure with config = ${e}`);let r=function(n){return n.serialise()};return e.layout&&(r=t.layout(e.layout.type,e.layout)),dE(e,r)}td.exports.configure=hE});var Na=D((eF,Ta)=>{var _a=require("path"),Nt=we()("log4js:appenders"),Ve=Ut(),nd=Jo(),gE=Wt(),yE=Gs(),vE=el(),Qe=new Map;Qe.set("console",rl());Qe.set("stdout",ol());Qe.set("stderr",sl());Qe.set("logLevelFilter",ul());Qe.set("categoryFilter",ll());Qe.set("noLogFilter",dl());Qe.set("file",Vm());Qe.set("dateFile",Ym());Qe.set("fileSync",ed());Qe.set("tcp",rd());var Rn=new Map,li=(e,t)=>{let r;try{let n=`${e}.cjs`;r=require.resolve(n),Nt("Loading module from ",n)}catch{r=e,Nt("Loading module from ",e)}try{return require(r)}catch(n){Ve.throwExceptionIf(t,n.code!=="MODULE_NOT_FOUND",`appender "${e}" could not be loaded (error was: ${n})`);return}},bE=(e,t)=>Qe.get(e)||li(`./${e}`,t)||li(e,t)||require.main&&require.main.filename&&li(_a.join(_a.dirname(require.main.filename),e),t)||li(_a.join(process.cwd(),e),t),pi=new Set,od=(e,t)=>{if(Rn.has(e))return Rn.get(e);if(!t.appenders[e])return!1;if(pi.has(e))throw new Error(`Dependency loop detected for appender ${e}.`);pi.add(e),Nt(`Creating appender ${e}`);let r=wE(e,t);return pi.delete(e),Rn.set(e,r),r},wE=(e,t)=>{let r=t.appenders[e],n=r.type.configure?r.type:bE(r.type,t);return Ve.throwExceptionIf(t,Ve.not(n),`appender "${e}" is not valid (type "${r.type}" could not be found)`),n.appender&&(process.emitWarning(`Appender ${r.type} exports an appender function.`,"DeprecationWarning","log4js-node-DEP0001"),Nt("[log4js-node-DEP0001]",`DEPRECATION: Appender ${r.type} exports an appender function.`)),n.shutdown&&(process.emitWarning(`Appender ${r.type} exports a shutdown function.`,"DeprecationWarning","log4js-node-DEP0002"),Nt("[log4js-node-DEP0002]",`DEPRECATION: Appender ${r.type} exports a shutdown function.`)),Nt(`${e}: clustering.isMaster ? ${nd.isMaster()}`),Nt(`${e}: appenderModule is ${require("util").inspect(n)}`),nd.onlyOnMaster(()=>(Nt(`calling appenderModule.configure for ${e} / ${r.type}`),n.configure(vE.modifyConfig(r),yE,o=>od(o,t),gE)),()=>{})},id=e=>{if(Rn.clear(),pi.clear(),!e)return;let t=[];Object.values(e.categories).forEach(r=>{t.push(...r.appenders)}),Object.keys(e.appenders).forEach(r=>{(t.includes(r)||e.appenders[r].type==="tcp-server"||e.appenders[r].type==="multiprocess")&&od(r,e)})},sd=()=>{id()};sd();Ve.addListener(e=>{Ve.throwExceptionIf(e,Ve.not(Ve.anObject(e.appenders)),\'must have a property "appenders" of type object.\');let t=Object.keys(e.appenders);Ve.throwExceptionIf(e,Ve.not(t.length),"must define at least one appender."),t.forEach(r=>{Ve.throwExceptionIf(e,Ve.not(e.appenders[r].type),`appender "${r}" is not valid (must be an object with property "type")`)})});Ve.addListener(id);Ta.exports=Rn;Ta.exports.init=sd});var Fa=D((tF,mi)=>{var Fn=we()("log4js:categories"),ae=Ut(),Ca=Wt(),ad=Na(),Ct=new Map;function ud(e,t,r){if(t.inherit===!1)return;let n=r.lastIndexOf(".");if(n<0)return;let o=r.slice(0,n),i=e.categories[o];i||(i={inherit:!0,appenders:[]}),ud(e,i,o),!e.categories[o]&&i.appenders&&i.appenders.length&&i.level&&(e.categories[o]=i),t.appenders=t.appenders||[],t.level=t.level||i.level,i.appenders.forEach(s=>{t.appenders.includes(s)||t.appenders.push(s)}),t.parent=i}function xE(e){if(!e.categories)return;Object.keys(e.categories).forEach(r=>{let n=e.categories[r];ud(e,n,r)})}ae.addPreProcessingListener(e=>xE(e));ae.addListener(e=>{ae.throwExceptionIf(e,ae.not(ae.anObject(e.categories)),\'must have a property "categories" of type object.\');let t=Object.keys(e.categories);ae.throwExceptionIf(e,ae.not(t.length),"must define at least one category."),t.forEach(r=>{let n=e.categories[r];ae.throwExceptionIf(e,[ae.not(n.appenders),ae.not(n.level)],`category "${r}" is not valid (must be an object with properties "appenders" and "level")`),ae.throwExceptionIf(e,ae.not(Array.isArray(n.appenders)),`category "${r}" is not valid (appenders must be an array of appender names)`),ae.throwExceptionIf(e,ae.not(n.appenders.length),`category "${r}" is not valid (appenders must contain at least one appender name)`),Object.prototype.hasOwnProperty.call(n,"enableCallStack")&&ae.throwExceptionIf(e,typeof n.enableCallStack!="boolean",`category "${r}" is not valid (enableCallStack must be boolean type)`),n.appenders.forEach(o=>{ae.throwExceptionIf(e,ae.not(ad.get(o)),`category "${r}" is not valid (appender "${o}" is not defined)`)}),ae.throwExceptionIf(e,ae.not(Ca.getLevel(n.level)),`category "${r}" is not valid (level "${n.level}" not recognised; valid levels are ${Ca.levels.join(", ")})`)}),ae.throwExceptionIf(e,ae.not(e.categories.default),\'must define a "default" category.\')});var Ra=e=>{if(Ct.clear(),!e)return;Object.keys(e.categories).forEach(r=>{let n=e.categories[r],o=[];n.appenders.forEach(i=>{o.push(ad.get(i)),Fn(`Creating category ${r}`),Ct.set(r,{appenders:o,level:Ca.getLevel(n.level),enableCallStack:n.enableCallStack||!1})})})},cd=()=>{Ra()};cd();ae.addListener(Ra);var Er=e=>{if(Fn(`configForCategory: searching for config for ${e}`),Ct.has(e))return Fn(`configForCategory: ${e} exists in config, returning it`),Ct.get(e);let t;return e.indexOf(".")>0?(Fn(`configForCategory: ${e} has hierarchy, cloning from parents`),t={...Er(e.slice(0,e.lastIndexOf(".")))}):(Ct.has("default")||Ra({categories:{default:{appenders:["out"],level:"OFF"}}}),Fn("configForCategory: cloning default category"),t={...Ct.get("default")}),Ct.set(e,t),t},EE=e=>Er(e).appenders,IE=e=>Er(e).level,SE=(e,t)=>{Er(e).level=t},OE=e=>Er(e).enableCallStack===!0,DE=(e,t)=>{Er(e).enableCallStack=t};mi.exports=Ct;mi.exports=Object.assign(mi.exports,{appendersForCategory:EE,getLevelForCategory:IE,setLevelForCategory:SE,getEnableCallStackForCategory:OE,setEnableCallStackForCategory:DE,init:cd})});var dd=D((rF,md)=>{var fd=we()("log4js:logger"),_E=Js(),ut=Wt(),TE=Jo(),di=Fa(),ld=Ut(),NE=/at (?:(.+)\\s+\\()?(?:(.+?):(\\d+)(?::(\\d+))?|([^)]+))\\)?/;function CE(e,t=4){try{let r=e.stack.split(`\n`).slice(t),n=NE.exec(r[0]);if(n&&n.length===6)return{functionName:n[1],fileName:n[2],lineNumber:parseInt(n[3],10),columnNumber:parseInt(n[4],10),callStack:r.join(`\n`)};console.error("log4js.logger - defaultParseCallStack error")}catch(r){console.error("log4js.logger - defaultParseCallStack error",r)}return null}var An=class{constructor(t){if(!t)throw new Error("No category provided.");this.category=t,this.context={},this.parseCallStack=CE,fd(`Logger created (${this.category}, ${this.level})`)}get level(){return ut.getLevel(di.getLevelForCategory(this.category),ut.OFF)}set level(t){di.setLevelForCategory(this.category,ut.getLevel(t,this.level))}get useCallStack(){return di.getEnableCallStackForCategory(this.category)}set useCallStack(t){di.setEnableCallStackForCategory(this.category,t===!0)}log(t,...r){let n=ut.getLevel(t);n?this.isLevelEnabled(n)&&this._log(n,r):ld.validIdentifier(t)&&r.length>0?(this.log(ut.WARN,"log4js:logger.log: valid log-level not found as first parameter given:",t),this.log(ut.INFO,`[${t}]`,...r)):this.log(ut.INFO,t,...r)}isLevelEnabled(t){return this.level.isLessThanOrEqualTo(t)}_log(t,r){fd(`sending log data (${t}) to appenders`);let n=new _E(this.category,t,r,this.context,this.useCallStack&&this.parseCallStack(new Error));TE.send(n)}addContext(t,r){this.context[t]=r}removeContext(t){delete this.context[t]}clearContext(){this.context={}}setParseCallStackFunction(t){this.parseCallStack=t}};function pd(e){let t=ut.getLevel(e),n=t.toString().toLowerCase().replace(/_([a-z])/g,i=>i[1].toUpperCase()),o=n[0].toUpperCase()+n.slice(1);An.prototype[`is${o}Enabled`]=function(){return this.isLevelEnabled(t)},An.prototype[n]=function(...i){this.log(t,...i)}}ut.levels.forEach(pd);ld.addListener(()=>{ut.levels.forEach(pd)});md.exports=An});var yd=D((nF,gd)=>{var Ir=Wt(),RE=\':remote-addr - - ":method :url HTTP/:http-version" :status :content-length ":referrer" ":user-agent"\';function FE(e){return e.originalUrl||e.url}function AE(e,t,r){let n=i=>{let s=i.concat();for(let a=0;a<s.length;++a)for(let u=a+1;u<s.length;++u)s[a].token==s[u].token&&s.splice(u--,1);return s},o=[];return o.push({token:":url",replacement:FE(e)}),o.push({token:":protocol",replacement:e.protocol}),o.push({token:":hostname",replacement:e.hostname}),o.push({token:":method",replacement:e.method}),o.push({token:":status",replacement:t.__statusCode||t.statusCode}),o.push({token:":response-time",replacement:t.responseTime}),o.push({token:":date",replacement:new Date().toUTCString()}),o.push({token:":referrer",replacement:e.headers.referer||e.headers.referrer||""}),o.push({token:":http-version",replacement:`${e.httpVersionMajor}.${e.httpVersionMinor}`}),o.push({token:":remote-addr",replacement:e.headers["x-forwarded-for"]||e.ip||e._remoteAddress||e.socket&&(e.socket.remoteAddress||e.socket.socket&&e.socket.socket.remoteAddress)}),o.push({token:":user-agent",replacement:e.headers["user-agent"]}),o.push({token:":content-length",replacement:t.getHeader("content-length")||t.__headers&&t.__headers["Content-Length"]||"-"}),o.push({token:/:req\\[([^\\]]+)]/g,replacement(i,s){return e.headers[s.toLowerCase()]}}),o.push({token:/:res\\[([^\\]]+)]/g,replacement(i,s){return t.getHeader(s.toLowerCase())||t.__headers&&t.__headers[s]}}),n(r.concat(o))}function hd(e,t){for(let r=0;r<t.length;r++)e=e.replace(t[r].token,t[r].replacement);return e}function PE(e){let t=null;if(e instanceof RegExp&&(t=e),typeof e=="string"&&(t=new RegExp(e)),Array.isArray(e)){let r=e.map(n=>n.source?n.source:n);t=new RegExp(r.join("|"))}return t}function $E(e,t,r){let n=t;if(r){let o=r.find(i=>{let s=!1;return i.from&&i.to?s=e>=i.from&&e<=i.to:s=i.codes.indexOf(e)!==-1,s});o&&(n=Ir.getLevel(o.level,n))}return n}gd.exports=function(t,r){typeof r=="string"||typeof r=="function"?r={format:r}:r=r||{};let n=t,o=Ir.getLevel(r.level,Ir.INFO),i=r.format||RE;return(s,a,u)=>{if(s._logging!==void 0)return u();if(typeof r.nolog!="function"){let m=PE(r.nolog);if(m&&m.test(s.originalUrl))return u()}if(n.isLevelEnabled(o)||r.level==="auto"){let m=new Date,{writeHead:f}=a;s._logging=!0,a.writeHead=(g,w)=>{a.writeHead=f,a.writeHead(g,w),a.__statusCode=g,a.__headers=w||{}};let d=!1,l=()=>{if(d)return;if(d=!0,typeof r.nolog=="function"&&r.nolog(s,a)===!0){s._logging=!1;return}a.responseTime=new Date-m,a.statusCode&&r.level==="auto"&&(o=Ir.INFO,a.statusCode>=300&&(o=Ir.WARN),a.statusCode>=400&&(o=Ir.ERROR)),o=$E(a.statusCode,o,r.statusRules);let g=AE(s,a,r.tokens||[]);if(r.context&&n.addContext("res",a),typeof i=="function"){let w=i(s,a,x=>hd(x,g));w&&n.log(o,w)}else n.log(o,hd(i,g));r.context&&n.removeContext("res")};a.on("end",l),a.on("finish",l),a.on("error",l),a.on("close",l)}return u()}}});var Ed=D((oF,xd)=>{var vd=we()("log4js:recording"),hi=[];function kE(){return function(e){vd(`received logEvent, number of events now ${hi.length+1}`),vd("log event was ",e),hi.push(e)}}function bd(){return hi.slice()}function wd(){hi.length=0}xd.exports={configure:kE,replay:bd,playback:bd,reset:wd,erase:wd}});var Nd=D((iF,Td)=>{var Rt=we()("log4js:main"),qE=require("fs"),jE=hf()({proto:!0}),ME=Ut(),LE=Gs(),BE=Wt(),Id=Na(),Sd=Fa(),UE=dd(),zE=Jo(),WE=yd(),KE=Ed(),Pn=!1;function GE(e){if(!Pn)return;Rt("Received log event ",e),Sd.appendersForCategory(e.categoryName).forEach(r=>{r(e)})}function JE(e){Rt(`Loading configuration from ${e}`);try{return JSON.parse(qE.readFileSync(e,"utf8"))}catch(t){throw new Error(`Problem reading config from file "${e}". Error was ${t.message}`,t)}}function Od(e){Pn&&Dd();let t=e;return typeof t=="string"&&(t=JE(e)),Rt(`Configuration is ${t}`),ME.configure(jE(t)),zE.onMessage(GE),Pn=!0,_d}function VE(){return KE}function Dd(e){Rt("Shutdown called. Disabling all log writing."),Pn=!1;let t=Array.from(Id.values());Id.init(),Sd.init();let r=t.reduceRight((s,a)=>a.shutdown?s+1:s,0);if(r===0)return Rt("No appenders with shutdown functions found."),e!==void 0&&e();let n=0,o;Rt(`Found ${r} appenders with shutdown functions.`);function i(s){o=o||s,n+=1,Rt(`Appender shutdowns complete: ${n} / ${r}`),n>=r&&(Rt("All shutdown functions completed."),e&&e(o))}return t.filter(s=>s.shutdown).forEach(s=>s.shutdown(i)),null}function HE(e){return Pn||Od(process.env.LOG4JS_CONFIG||{appenders:{out:{type:"stdout"}},categories:{default:{appenders:["out"],level:"OFF"}}}),new UE(e||"default")}var _d={getLogger:HE,configure:Od,shutdown:Dd,connectLogger:WE,levels:BE,addLayout:LE.addLayout,recording:VE};Td.exports=_d});var ct=D(yi=>{"use strict";yi.getBooleanOption=(e,t)=>{let r=!1;if(t in e&&typeof(r=e[t])!="boolean")throw new TypeError(`Expected the "${t}" option to be a boolean`);return r};yi.cppdb=Symbol();yi.inspect=Symbol.for("nodejs.util.inspect.custom")});var $a=D((cF,Fd)=>{"use strict";var Pa={value:"SqliteError",writable:!0,enumerable:!1,configurable:!0};function Zt(e,t){if(new.target!==Zt)return new Zt(e,t);if(typeof t!="string")throw new TypeError("Expected second argument to be a string");Error.call(this,e),Pa.value=""+e,Object.defineProperty(this,"message",Pa),Error.captureStackTrace(this,Zt),this.code=t}Object.setPrototypeOf(Zt,Error);Object.setPrototypeOf(Zt.prototype,Error.prototype);Object.defineProperty(Zt.prototype,"name",Pa);Fd.exports=Zt});var Pd=D((fF,Ad)=>{var vi=require("path").sep||"/";Ad.exports=ZE;function ZE(e){if(typeof e!="string"||e.length<=7||e.substring(0,7)!="file://")throw new TypeError("must pass in a file:// URI to convert to a file path");var t=decodeURI(e.substring(7)),r=t.indexOf("/"),n=t.substring(0,r),o=t.substring(r+1);return n=="localhost"&&(n=""),n&&(n=vi+vi+n),o=o.replace(/^(.+)\\|/,"$1:"),vi=="\\\\"&&(o=o.replace(/\\//g,"\\\\")),/^.+\\:/.test(o)||(o=vi+o),n+o}});var jd=D((Sr,qd)=>{var ka=require("fs"),wi=require("path"),QE=Pd(),bi=wi.join,XE=wi.dirname,$d=ka.accessSync&&function(e){try{ka.accessSync(e)}catch{return!1}return!0}||ka.existsSync||wi.existsSync,kd={arrow:process.env.NODE_BINDINGS_ARROW||" \\u2192 ",compiled:process.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:process.platform,arch:process.arch,nodePreGyp:"node-v"+process.versions.modules+"-"+process.platform+"-"+process.arch,version:process.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"],["module_root","addon-build","release","install-root","bindings"],["module_root","addon-build","debug","install-root","bindings"],["module_root","addon-build","default","install-root","bindings"],["module_root","lib","binding","nodePreGyp","bindings"]]};function eI(e){typeof e=="string"?e={bindings:e}:e||(e={}),Object.keys(kd).map(function(u){u in e||(e[u]=kd[u])}),e.module_root||(e.module_root=Sr.getRoot(Sr.getFileName())),wi.extname(e.bindings)!=".node"&&(e.bindings+=".node");for(var t=typeof __webpack_require__=="function"?__non_webpack_require__:require,r=[],n=0,o=e.try.length,i,s,a;n<o;n++){i=bi.apply(null,e.try[n].map(function(u){return e[u]||u})),r.push(i);try{return s=e.path?t.resolve(i):t(i),e.path||(s.path=i),s}catch(u){if(u.code!=="MODULE_NOT_FOUND"&&u.code!=="QUALIFIED_PATH_RESOLUTION_FAILED"&&!/not find/i.test(u.message))throw u}}throw a=new Error(`Could not locate the bindings file. Tried:\n`+r.map(function(u){return e.arrow+u}).join(`\n`)),a.tries=r,a}qd.exports=Sr=eI;Sr.getFileName=function(t){var r=Error.prepareStackTrace,n=Error.stackTraceLimit,o={},i;Error.stackTraceLimit=10,Error.prepareStackTrace=function(a,u){for(var m=0,f=u.length;m<f;m++)if(i=u[m].getFileName(),i!==__filename)if(t){if(i!==t)return}else return},Error.captureStackTrace(o),o.stack,Error.prepareStackTrace=r,Error.stackTraceLimit=n;var s="file://";return i.indexOf(s)===0&&(i=QE(i)),i};Sr.getRoot=function(t){for(var r=XE(t),n;;){if(r==="."&&(r=process.cwd()),$d(bi(r,"package.json"))||$d(bi(r,"node_modules")))return r;if(n===r)throw new Error(\'Could not find module root given file: "\'+t+\'". Do you have a `package.json` file? \');n=r,r=bi(r,"..")}}});var Md=D(Ft=>{"use strict";var{cppdb:Xe}=ct();Ft.prepare=function(t){return this[Xe].prepare(t,this,!1)};Ft.exec=function(t){return this[Xe].exec(t),this};Ft.close=function(){return this[Xe].close(),this};Ft.loadExtension=function(...t){return this[Xe].loadExtension(...t),this};Ft.defaultSafeIntegers=function(...t){return this[Xe].defaultSafeIntegers(...t),this};Ft.unsafeMode=function(...t){return this[Xe].unsafeMode(...t),this};Ft.getters={name:{get:function(){return this[Xe].name},enumerable:!0},open:{get:function(){return this[Xe].open},enumerable:!0},inTransaction:{get:function(){return this[Xe].inTransaction},enumerable:!0},readonly:{get:function(){return this[Xe].readonly},enumerable:!0},memory:{get:function(){return this[Xe].memory},enumerable:!0}}});var Ud=D((pF,Bd)=>{"use strict";var{cppdb:tI}=ct(),Ld=new WeakMap;Bd.exports=function(t){if(typeof t!="function")throw new TypeError("Expected first argument to be a function");let r=this[tI],n=rI(r,this),{apply:o}=Function.prototype,i={default:{value:xi(o,t,r,n.default)},deferred:{value:xi(o,t,r,n.deferred)},immediate:{value:xi(o,t,r,n.immediate)},exclusive:{value:xi(o,t,r,n.exclusive)},database:{value:this,enumerable:!0}};return Object.defineProperties(i.default.value,i),Object.defineProperties(i.deferred.value,i),Object.defineProperties(i.immediate.value,i),Object.defineProperties(i.exclusive.value,i),i.default.value};var rI=(e,t)=>{let r=Ld.get(e);if(!r){let n={commit:e.prepare("COMMIT",t,!1),rollback:e.prepare("ROLLBACK",t,!1),savepoint:e.prepare("SAVEPOINT `	_bs3.	`",t,!1),release:e.prepare("RELEASE `	_bs3.	`",t,!1),rollbackTo:e.prepare("ROLLBACK TO `	_bs3.	`",t,!1)};Ld.set(e,r={default:Object.assign({begin:e.prepare("BEGIN",t,!1)},n),deferred:Object.assign({begin:e.prepare("BEGIN DEFERRED",t,!1)},n),immediate:Object.assign({begin:e.prepare("BEGIN IMMEDIATE",t,!1)},n),exclusive:Object.assign({begin:e.prepare("BEGIN EXCLUSIVE",t,!1)},n)})}return r},xi=(e,t,r,{begin:n,commit:o,rollback:i,savepoint:s,release:a,rollbackTo:u})=>function(){let f,d,l;r.inTransaction?(f=s,d=a,l=u):(f=n,d=o,l=i),f.run();try{let g=e.call(t,this,arguments);return d.run(),g}catch(g){throw r.inTransaction&&(l.run(),l!==i&&d.run()),g}}});var Wd=D((mF,zd)=>{"use strict";var{getBooleanOption:nI,cppdb:oI}=ct();zd.exports=function(t,r){if(r==null&&(r={}),typeof t!="string")throw new TypeError("Expected first argument to be a string");if(typeof r!="object")throw new TypeError("Expected second argument to be an options object");let n=nI(r,"simple"),o=this[oI].prepare(`PRAGMA ${t}`,this,!0);return n?o.pluck().get():o.all()}});var Jd=D((dF,Gd)=>{"use strict";var iI=require("fs"),sI=require("path"),{promisify:aI}=require("util"),{cppdb:uI}=ct(),Kd=aI(iI.access);Gd.exports=async function(t,r){if(r==null&&(r={}),typeof t!="string")throw new TypeError("Expected first argument to be a string");if(typeof r!="object")throw new TypeError("Expected second argument to be an options object");t=t.trim();let n="attached"in r?r.attached:"main",o="progress"in r?r.progress:null;if(!t)throw new TypeError("Backup filename cannot be an empty string");if(t===":memory:")throw new TypeError(\'Invalid backup filename ":memory:"\');if(typeof n!="string")throw new TypeError(\'Expected the "attached" option to be a string\');if(!n)throw new TypeError(\'The "attached" option cannot be an empty string\');if(o!=null&&typeof o!="function")throw new TypeError(\'Expected the "progress" option to be a function\');await Kd(sI.dirname(t)).catch(()=>{throw new TypeError("Cannot save backup because the directory does not exist")});let i=await Kd(t).then(()=>!1,()=>!0);return cI(this[uI].backup(this,n,t,i),o||null)};var cI=(e,t)=>{let r=0,n=!0;return new Promise((o,i)=>{setImmediate(function s(){try{let a=e.transfer(r);if(!a.remainingPages){e.close(),o(a);return}if(n&&(n=!1,r=100),t){let u=t(a);if(u!==void 0)if(typeof u=="number"&&u===u)r=Math.max(0,Math.min(2147483647,Math.round(u)));else throw new TypeError("Expected progress callback to return a number or undefined")}setImmediate(s)}catch(a){e.close(),i(a)}})})}});var Hd=D((hF,Vd)=>{"use strict";var{cppdb:fI}=ct();Vd.exports=function(t){if(t==null&&(t={}),typeof t!="object")throw new TypeError("Expected first argument to be an options object");let r="attached"in t?t.attached:"main";if(typeof r!="string")throw new TypeError(\'Expected the "attached" option to be a string\');if(!r)throw new TypeError(\'The "attached" option cannot be an empty string\');return this[fI].serialize(r)}});var Zd=D((gF,Yd)=>{"use strict";var{getBooleanOption:Ei,cppdb:lI}=ct();Yd.exports=function(t,r,n){if(r==null&&(r={}),typeof r=="function"&&(n=r,r={}),typeof t!="string")throw new TypeError("Expected first argument to be a string");if(typeof n!="function")throw new TypeError("Expected last argument to be a function");if(typeof r!="object")throw new TypeError("Expected second argument to be an options object");if(!t)throw new TypeError("User-defined function name cannot be an empty string");let o="safeIntegers"in r?+Ei(r,"safeIntegers"):2,i=Ei(r,"deterministic"),s=Ei(r,"directOnly"),a=Ei(r,"varargs"),u=-1;if(!a){if(u=n.length,!Number.isInteger(u)||u<0)throw new TypeError("Expected function.length to be a positive integer");if(u>100)throw new RangeError("User-defined functions cannot have more than 100 arguments")}return this[lI].function(n,t,u,o,i,s),this}});var eh=D((yF,Xd)=>{"use strict";var{getBooleanOption:Ii,cppdb:pI}=ct();Xd.exports=function(t,r){if(typeof t!="string")throw new TypeError("Expected first argument to be a string");if(typeof r!="object"||r===null)throw new TypeError("Expected second argument to be an options object");if(!t)throw new TypeError("User-defined function name cannot be an empty string");let n="start"in r?r.start:null,o=qa(r,"step",!0),i=qa(r,"inverse",!1),s=qa(r,"result",!1),a="safeIntegers"in r?+Ii(r,"safeIntegers"):2,u=Ii(r,"deterministic"),m=Ii(r,"directOnly"),f=Ii(r,"varargs"),d=-1;if(!f&&(d=Math.max(Qd(o),i?Qd(i):0),d>0&&(d-=1),d>100))throw new RangeError("User-defined functions cannot have more than 100 arguments");return this[pI].aggregate(n,o,i,s,t,d,a,u,m),this};var qa=(e,t,r)=>{let n=t in e?e[t]:null;if(typeof n=="function")return n;if(n!=null)throw new TypeError(`Expected the "${t}" option to be a function`);if(r)throw new TypeError(`Missing required option "${t}"`);return null},Qd=({length:e})=>{if(Number.isInteger(e)&&e>=0)return e;throw new TypeError("Expected function.length to be a positive integer")}});var oh=D((vF,nh)=>{"use strict";var{cppdb:mI}=ct();nh.exports=function(t,r){if(typeof t!="string")throw new TypeError("Expected first argument to be a string");if(!t)throw new TypeError("Virtual table module name cannot be an empty string");let n=!1;if(typeof r=="object"&&r!==null)n=!0,r=xI(rh(r,"used",t));else{if(typeof r!="function")throw new TypeError("Expected second argument to be a function or a table definition object");r=dI(r)}return this[mI].table(r,t,n),this};function dI(e){return function(r,n,o,...i){let s={module:r,database:n,table:o},a=bI.call(e,s,i);if(typeof a!="object"||a===null)throw new TypeError(`Virtual table module "${r}" did not return a table definition object`);return rh(a,"returned",r)}}function rh(e,t,r){if(!$n.call(e,"rows"))throw new TypeError(`Virtual table module "${r}" ${t} a table definition without a "rows" property`);if(!$n.call(e,"columns"))throw new TypeError(`Virtual table module "${r}" ${t} a table definition without a "columns" property`);let n=e.rows;if(typeof n!="function"||Object.getPrototypeOf(n)!==wI)throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "rows" property (should be a generator function)`);let o=e.columns;if(!Array.isArray(o)||!(o=[...o]).every(m=>typeof m=="string"))throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "columns" property (should be an array of strings)`);if(o.length!==new Set(o).size)throw new TypeError(`Virtual table module "${r}" ${t} a table definition with duplicate column names`);if(!o.length)throw new RangeError(`Virtual table module "${r}" ${t} a table definition with zero columns`);let i;if($n.call(e,"parameters")){if(i=e.parameters,!Array.isArray(i)||!(i=[...i]).every(m=>typeof m=="string"))throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "parameters" property (should be an array of strings)`)}else i=vI(n);if(i.length!==new Set(i).size)throw new TypeError(`Virtual table module "${r}" ${t} a table definition with duplicate parameter names`);if(i.length>32)throw new RangeError(`Virtual table module "${r}" ${t} a table definition with more than the maximum number of 32 parameters`);for(let m of i)if(o.includes(m))throw new TypeError(`Virtual table module "${r}" ${t} a table definition with column "${m}" which was ambiguously defined as both a column and parameter`);let s=2;if($n.call(e,"safeIntegers")){let m=e.safeIntegers;if(typeof m!="boolean")throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "safeIntegers" property (should be a boolean)`);s=+m}let a=!1;if($n.call(e,"directOnly")&&(a=e.directOnly,typeof a!="boolean"))throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "directOnly" property (should be a boolean)`);return[`CREATE TABLE x(${[...i.map(th).map(m=>`${m} HIDDEN`),...o.map(th)].join(", ")});`,hI(n,new Map(o.map((m,f)=>[m,i.length+f])),r),i,s,a]}function hI(e,t,r){return function*(...o){let i=o.map(s=>Buffer.isBuffer(s)?Buffer.from(s):s);for(let s=0;s<t.size;++s)i.push(null);for(let s of e(...o))if(Array.isArray(s))gI(s,i,t.size,r),yield i;else if(typeof s=="object"&&s!==null)yI(s,i,t,r),yield i;else throw new TypeError(`Virtual table module "${r}" yielded something that isn\'t a valid row object`)}}function gI(e,t,r,n){if(e.length!==r)throw new TypeError(`Virtual table module "${n}" yielded a row with an incorrect number of columns`);let o=t.length-r;for(let i=0;i<r;++i)t[i+o]=e[i]}function yI(e,t,r,n){let o=0;for(let i of Object.keys(e)){let s=r.get(i);if(s===void 0)throw new TypeError(`Virtual table module "${n}" yielded a row with an undeclared column "${i}"`);t[s]=e[i],o+=1}if(o!==r.size)throw new TypeError(`Virtual table module "${n}" yielded a row with missing columns`)}function vI({length:e}){if(!Number.isInteger(e)||e<0)throw new TypeError("Expected function.length to be a positive integer");let t=[];for(let r=0;r<e;++r)t.push(`$${r+1}`);return t}var{hasOwnProperty:$n}=Object.prototype,{apply:bI}=Function.prototype,wI=Object.getPrototypeOf(function*(){}),th=e=>`"${e.replace(/"/g,\'""\')}"`,xI=e=>()=>e});var sh=D((bF,ih)=>{"use strict";var EI=function(){};ih.exports=function(t,r){return Object.assign(new EI,this)}});var fh=D((wF,ch)=>{"use strict";var II=require("fs"),ah=require("path"),kn=ct(),SI=$a(),uh;function Oe(e,t){if(new.target==null)return new Oe(e,t);let r;if(Buffer.isBuffer(e)&&(r=e,e=":memory:"),e==null&&(e=""),t==null&&(t={}),typeof e!="string")throw new TypeError("Expected first argument to be a string");if(typeof t!="object")throw new TypeError("Expected second argument to be an options object");if("readOnly"in t)throw new TypeError(\'Misspelled option "readOnly" should be "readonly"\');if("memory"in t)throw new TypeError(\'Option "memory" was removed in v7.0.0 (use ":memory:" filename instead)\');let n=e.trim(),o=n===""||n===":memory:",i=kn.getBooleanOption(t,"readonly"),s=kn.getBooleanOption(t,"fileMustExist"),a=kn.getBooleanOption(t,"uriPath"),u="timeout"in t?t.timeout:5e3,m="verbose"in t?t.verbose:null,f="nativeBinding"in t?t.nativeBinding:null;if(i&&o&&!r)throw new TypeError("In-memory/temporary databases cannot be readonly");if(!Number.isInteger(u)||u<0)throw new TypeError(\'Expected the "timeout" option to be a positive integer\');if(u>2147483647)throw new RangeError(\'Option "timeout" cannot be greater than 2147483647\');if(m!=null&&typeof m!="function")throw new TypeError(\'Expected the "verbose" option to be a function\');if(f!=null&&typeof f!="string")throw new TypeError(\'Expected the "nativeBinding" option to be a string\');let d;if(f==null?d=uh||(uh=jd()("better_sqlite3.node")):d=require(ah.resolve(f).replace(/(\\.node)?$/,".node")),d.isInitialized||(d.setErrorConstructor(SI),d.isInitialized=!0),!o&&!a&&!II.existsSync(ah.dirname(n)))throw new TypeError("Cannot open database because the directory does not exist");Object.defineProperties(this,{[kn.cppdb]:{value:new d.Database(n,e,o,i,s,a,u,m||null,r||null)},...Qt.getters})}var Qt=Md();Oe.prototype.prepare=Qt.prepare;Oe.prototype.transaction=Ud();Oe.prototype.pragma=Wd();Oe.prototype.backup=Jd();Oe.prototype.serialize=Hd();Oe.prototype.function=Zd();Oe.prototype.aggregate=eh();Oe.prototype.table=oh();Oe.prototype.loadExtension=Qt.loadExtension;Oe.prototype.exec=Qt.exec;Oe.prototype.close=Qt.close;Oe.prototype.defaultSafeIntegers=Qt.defaultSafeIntegers;Oe.prototype.unsafeMode=Qt.unsafeMode;Oe.prototype[kn.inspect]=sh();ch.exports=Oe});var lh=D((xF,ja)=>{"use strict";ja.exports=fh();ja.exports.SqliteError=$a()});var gh=D(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:!0});function hh(e,t){if(t)return e;throw new Error("Unhandled discriminated union member: "+JSON.stringify(e))}Oi.assertNever=hh;Oi.default=hh});var Ji=class extends Error{},te=e=>{throw new Ji(e)},Vi=class extends Error{},Z=e=>{throw new Vi(e)};var bt=(e,t)=>ce(e)===t,ce=e=>{let t=typeof e;return t==="object"?e===null?"null":"object":t==="function"?"object":t},Hi={bigint:"a bigint",boolean:"boolean",null:"null",number:"a number",object:"an object",string:"a string",symbol:"a symbol",undefined:"undefined"};var qe=(e,t)=>e in t,gu=e=>Object.entries(e),re=e=>Object.keys(e),At=e=>{let t=[];for(;e!==Object.prototype&&e!==null&&e!==void 0;){for(let r of Object.getOwnPropertyNames(e))t.includes(r)||t.push(r);for(let r of Object.getOwnPropertySymbols(e))t.includes(r)||t.push(r);e=Object.getPrototypeOf(e)}return t},rr=(e,t)=>{let r=e?.[t];return r!=null};var yu=e=>Object.keys(e).length,Ar=e=>bt(e,"object")?Object.keys(e).length!==0:!1,GI=Symbol("id");var et=e=>Array.isArray(e)?e:[e];var ge=class extends Array{static fromString(t,r="/"){return t===r?new ge:new ge(...t.split(r))}toString(t="/"){return this.length?this.join(t):t}},vu=(e,t)=>{let r=e;for(let n of t){if(typeof r!="object"||r===null)return;r=r[n]}return r};var Yi=/^(?!^-0$)-?(?:0|[1-9]\\d*)(?:\\.\\d*[1-9])?$/,Xg=e=>Yi.test(e),ey=/^-?\\d*\\.?\\d*$/,ty=e=>e.length!==0&&ey.test(e),Hn=/^(?:0|(?:-?[1-9]\\d*))$/,Pr=e=>Hn.test(e),$r=/^(?:0|(?:[1-9]\\d*))$/,bu=/^-?\\d+$/,ry=e=>bu.test(e),wu={number:"a number",bigint:"a bigint",integer:"an integer"},xu=(e,t)=>`\'${e}\' was parsed as ${wu[t]} but could not be narrowed to a literal value. Avoid unnecessary leading or trailing zeros and other abnormal notation`,ny=(e,t)=>t==="number"?Xg(e):Pr(e),oy=(e,t)=>t==="number"?Number(e):Number.parseInt(e),iy=(e,t)=>t==="number"?ty(e):ry(e),kr=(e,t)=>Eu(e,"number",t),Yn=(e,t)=>Eu(e,"integer",t),Eu=(e,t,r)=>{let n=oy(e,t);if(!Number.isNaN(n)){if(ny(e,t))return n;if(iy(e,t))return Z(xu(e,t))}return r?Z(r===!0?`Failed to parse ${wu[t]} from \'${e}\'`:r):void 0},Zi=e=>{if(e[e.length-1]!=="n")return;let t=e.slice(0,-1),r;try{r=BigInt(t)}catch{return}if(Hn.test(t))return r;if(bu.test(t))return Z(xu(e,"bigint"))};var oe=(e,t)=>{switch(ce(e)){case"object":return JSON.stringify(Qi(e,Zn,[]),null,t);case"symbol":return Zn.onSymbol(e);default:return Xi(e)}},Zn={onCycle:()=>"(cycle)",onSymbol:e=>`(symbol${e.description&&` ${e.description}`})`,onFunction:e=>`(function${e.name&&` ${e.name}`})`},Qi=(e,t,r)=>{switch(ce(e)){case"object":if(typeof e=="function")return Zn.onFunction(e);if(r.includes(e))return"(cycle)";let n=[...r,e];if(Array.isArray(e))return e.map(i=>Qi(i,t,n));let o={};for(let i in e)o[i]=Qi(e[i],t,n);return o;case"symbol":return Zn.onSymbol(e);case"bigint":return`${e}n`;case"undefined":return"undefined";default:return e}},Xi=e=>typeof e=="string"?`\'${e}\'`:typeof e=="bigint"?`${e}n`:`${e}`;function sy(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ay(e,t){return t.get?t.get.call(e):t.value}function uy(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Su(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Iu(e,t){var r=Su(e,t,"get");return ay(e,r)}function cy(e,t,r){sy(e,t),t.set(e,r)}function fy(e,t,r){var n=Su(e,t,"set");return uy(e,n,r),r}function Qn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var je=e=>(t,r,n)=>t===void 0?r===void 0?te(to):r:r===void 0?t:e(t,r,n),to="Unexpected operation two undefined operands",es={domain:({l:e,r:t})=>`${e.join(", ")} and ${t.join(", ")}`,range:({l:e,r:t})=>`${eo(e)} and ${eo(t)}`,class:({l:e,r:t})=>`classes ${typeof e=="string"?e:e.name} and ${typeof t=="string"?t:t.name}`,tupleLength:({l:e,r:t})=>`tuples of length ${e} and ${t}`,value:({l:e,r:t})=>`literal values ${oe(e)} and ${oe(t)}`,leftAssignability:({l:e,r:t})=>`literal value ${oe(e.value)} and ${oe(t)}`,rightAssignability:({l:e,r:t})=>`literal value ${oe(t.value)} and ${oe(e)}`,union:({l:e,r:t})=>`branches ${oe(e)} and branches ${oe(t)}`},eo=e=>"limit"in e?`the range of exactly ${e.limit}`:e.min?e.max?`the range bounded by ${e.min.comparator}${e.min.limit} and ${e.max.comparator}${e.max.limit}`:`${e.min.comparator}${e.min.limit}`:e.max?`${e.max.comparator}${e.max.limit}`:"the unbounded range",Xn=new WeakMap,wt=class{get disjoints(){return Iu(this,Xn)}addDisjoint(t,r,n){return Iu(this,Xn)[`${this.path}`]={kind:t,l:r,r:n},ro}constructor(t,r){Qn(this,"type",void 0),Qn(this,"lastOperator",void 0),Qn(this,"path",void 0),Qn(this,"domain",void 0),cy(this,Xn,{writable:!0,value:void 0}),this.type=t,this.lastOperator=r,this.path=new ge,fy(this,Xn,{})}},ro=Symbol("empty"),Ou=()=>ro,Ye=e=>e===ro,Du=Symbol("equal"),ye=()=>Du,Me=e=>e===Du,nr=(e,t)=>(r,n,o)=>{let i={},s=re({...r,...n}),a=!0,u=!0;for(let m of s){let f=typeof e=="function"?e(m,r[m],n[m],o):e[m](r[m],n[m],o);if(Me(f))r[m]!==void 0&&(i[m]=r[m]);else if(Ye(f))if(t.onEmpty==="omit")a=!1,u=!1;else return ro;else f!==void 0&&(i[m]=f),a&&(a=f===r[m]),u&&(u=f===n[m])}return a?u?ye():r:u?n:i};var _u=e=>{let t=re(e);if(t.length===1){let n=t[0];return`${n==="/"?"":`At ${n}: `}Intersection of ${es[e[n].kind](e[n])} results in an unsatisfiable type`}let r=`\n        "Intersection results in unsatisfiable types at the following paths:\n`;for(let n in e)r+=`  ${n}: ${es[e[n].kind](e[n])}\n`;return r},no=(e,t,r)=>`${e.length?`At ${e}: `:""}${t} ${r?`${r} `:""}results in an unsatisfiable type`;var qr={Array,Date,Error,Function,Map,RegExp,Set,Object,String,Number,Boolean,WeakMap,WeakSet,Promise},or=(e,t)=>{if(ce(e)!=="object")return;let r=t??qr,n=Object.getPrototypeOf(e);for(;n?.constructor&&(!r[n.constructor.name]||!(e instanceof r[n.constructor.name]));)n=Object.getPrototypeOf(n);return n?.constructor?.name};var xt=e=>Array.isArray(e),ts={Object:"an object",Array:"an array",Function:"a function",Date:"a Date",RegExp:"a RegExp",Error:"an Error",Map:"a Map",Set:"a Set",String:"a String object",Number:"a Number object",Boolean:"a Boolean object",Promise:"a Promise",WeakMap:"a WeakMap",WeakSet:"a WeakSet"},oo=e=>{let t=Object(e).name;return t&&qe(t,qr)&&qr[t]===e?t:void 0};var Tu=je((e,t,r)=>e===t?ye():e instanceof t?e:t instanceof e?t:r.addDisjoint("class",e,t)),Nu=(e,t)=>typeof e=="string"?or(t.data)===e||!t.problems.add("class",e):t.data instanceof e||!t.problems.add("class",e);var io=(e,t)=>{if(Array.isArray(e)){if(Array.isArray(t)){let r=ly(e,t);return r.length===e.length?r.length===t.length?ye():e:r.length===t.length?t:r}return e.includes(t)?e:[...e,t]}return Array.isArray(t)?t.includes(e)?t:[...t,e]:e===t?ye():[e,t]},ly=(e,t)=>{let r=[...e];for(let n of t)e.includes(n)||r.push(n);return r};var Cu=je((e,t)=>e===t?ye():Math.abs(e*t/py(e,t))),py=(e,t)=>{let r,n=e,o=t;for(;o!==0;)r=o,o=n%o,n=r;return n},Ru=(e,t)=>t.data%e===0||!t.problems.add("divisor",e);var jr=e=>e[0]==="?",so=e=>e[0]==="!",rt={index:"[index]"},Et=e=>jr(e)||so(e)?e[1]:e,my=e=>{if(typeof e.length=="object"&&so(e.length)&&typeof e.length[1]!="string"&&uo(e.length[1],"number"))return e.length[1].number.value},Fu=je((e,t,r)=>{let n=dy(e,t,r);if(typeof n=="symbol")return n;let o=my(n);if(o===void 0||!(rt.index in n))return n;let{[rt.index]:i,...s}=n,a=Et(i);for(let u=0;u<o;u++){if(!s[u]){s[u]=a;continue}let m=Et(s[u]);r.path.push(`${u}`);let f=ao(m,a,r);if(r.path.pop(),Ye(f))return f;!Me(f)&&f!==m&&(s[u]=f)}return s}),dy=nr((e,t,r,n)=>{if(t===void 0)return r===void 0?ye():r;if(r===void 0)return t;n.path.push(e);let o=ao(Et(t),Et(r),n);n.path.pop();let i=jr(t)&&jr(r);return Ye(o)&&i?{}:o},{onEmpty:"bubble"}),Au=(e,t,r)=>{let n=r.type.config?.keys??r.type.scope.config.keys;return n==="loose"?hy(e,t,r):gy(n,e,t,r)},hy=(e,t,r)=>{for(let n in t){let o=t[n];r.path.push(n),n===rt.index?e.push(["indexProp",tt(Et(o),r)]):jr(o)?e.push(["optionalProp",[n,tt(o[1],r)]]):so(o)?e.push(["prerequisiteProp",[n,tt(o[1],r)]]):e.push(["requiredProp",[n,tt(o,r)]]),r.path.pop()}},gy=(e,t,r,n)=>{let o={required:{},optional:{}};for(let i in r){let s=r[i];n.path.push(i),i===rt.index?o.index=tt(Et(s),n):jr(s)?o.optional[i]=tt(s[1],n):so(s)?t.push(["prerequisiteProp",[i,tt(s[1],n)]]):o.required[i]=tt(s,n),n.path.pop()}t.push([`${e}Props`,o])};function yy(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var rs=e=>typeof e=="string"||Array.isArray(e)?e.length:typeof e=="number"?e:0,vy=e=>typeof e=="string"?"characters":Array.isArray(e)?"items long":"",co=class{toString(){return oe(this.value)}get domain(){return ce(this.value)}get size(){return rs(this.value)}get units(){return vy(this.value)}get className(){return Object(this.value).constructor.name}constructor(t){yy(this,"value",void 0),this.value=t}};var fo={">":!0,">=":!0},ns={"<":!0,"<=":!0},Mr=e=>"comparator"in e,$u=je((e,t,r)=>{if(Mr(e))return Mr(t)?e.limit===t.limit?ye():r.addDisjoint("range",e,t):Pu(t,e.limit)?e:r.addDisjoint("range",e,t);if(Mr(t))return Pu(e,t.limit)?t:r.addDisjoint("range",e,t);let n=ir("min",e.min,t.min),o=ir("max",e.max,t.max);return n==="l"?o==="r"?ir("min",e.min,t.max)==="l"?r.addDisjoint("range",e,t):{min:e.min,max:t.max}:e:n==="r"?o==="l"?ir("max",e.max,t.min)==="l"?r.addDisjoint("range",e,t):{min:t.min,max:e.max}:t:o==="l"?e:o==="r"?t:ye()}),Pu=(e,t)=>Mr(e)?t===e.limit:by(e.min,t)&&wy(e.max,t),by=(e,t)=>!e||t>e.limit||t===e.limit&&!Lr(e.comparator),wy=(e,t)=>!e||t<e.limit||t===e.limit&&!Lr(e.comparator),ku=(e,t,r)=>{let n=r.lastDomain==="string"?"characters":r.lastDomain==="object"?"items long":void 0;if(Mr(t))return e.push(["bound",n?{...t,units:n}:t]);t.min&&e.push(["bound",n?{...t.min,units:n}:t.min]),t.max&&e.push(["bound",n?{...t.max,units:n}:t.max])},qu=(e,t)=>xy[e.comparator](rs(t.data),e.limit)||!t.problems.add("bound",e),xy={"<":(e,t)=>e<t,">":(e,t)=>e>t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e===t},ir=(e,t,r)=>t?r?t.limit===r.limit?Lr(t.comparator)?Lr(r.comparator)?"=":"l":Lr(r.comparator)?"r":"=":e==="min"?t.limit>r.limit?"l":"r":t.limit<r.limit?"l":"r":"l":r?"r":"=",Lr=e=>e.length===1;var os={},is=e=>(os[e]||(os[e]=new RegExp(e)),os[e]),ju=(e,t)=>is(e).test(t.data)||!t.problems.add("regex",`/${e}/`),Mu=je(io);var Bu=(e,t,r)=>"value"in e?"value"in t?e.value===t.value?ye():r.addDisjoint("value",e.value,t.value):Lu(e.value,t,r)?e:r.addDisjoint("leftAssignability",e,t):"value"in t?Lu(t.value,e,r)?t:r.addDisjoint("rightAssignability",e,t):Iy(e,t,r),Ey=je(io),Iy=nr({divisor:Cu,regex:Mu,props:Fu,class:Tu,range:$u,narrow:Ey},{onEmpty:"bubble"}),ss=(e,t)=>{let r=[],n;for(n in e)Sy[n](r,e[n],t);return r.sort((o,i)=>Br[o[0]]-Br[i[0]])},Sy={regex:(e,t)=>{for(let r of et(t))e.push(["regex",r])},divisor:(e,t)=>{e.push(["divisor",t])},range:ku,class:(e,t)=>{e.push(["class",t])},props:Au,narrow:(e,t)=>{for(let r of et(t))e.push(["narrow",r])},value:(e,t)=>{e.push(["value",t])}},Br={config:-1,domain:0,value:0,domains:0,branches:0,switch:0,alias:0,class:0,regex:1,divisor:1,bound:1,prerequisiteProp:2,distilledProps:3,strictProps:3,requiredProp:3,optionalProp:3,indexProp:3,narrow:4,morph:5},Lu=(e,t,r)=>!r.type.scope.type(["node",{[r.domain]:t}])(e).problems;var as=e=>e?.lBranches!==void 0,zu=(e,t,r)=>{let n={lBranches:e,rBranches:t,lExtendsR:[],rExtendsL:[],equalities:[],distinctIntersections:[]},o=t.map(i=>({condition:i,distinct:[]}));return e.forEach((i,s)=>{let a=!1,u=o.map((m,f)=>{if(a||!m.distinct)return null;let d=m.condition,l=zr(i,d,r);return Ye(l)?null:l===i?(n.lExtendsR.push(s),a=!0,null):l===d?(n.rExtendsL.push(f),m.distinct=null,null):Me(l)?(n.equalities.push([s,f]),a=!0,m.distinct=null,null):bt(l,"object")?l:te(`Unexpected predicate intersection result of type \'${ce(l)}\'`)});if(!a)for(let m=0;m<o.length;m++)u[m]&&o[m].distinct?.push(u[m])}),n.distinctIntersections=o.flatMap(i=>i.distinct??[]),n},us=e=>"rules"in e,Ur=(e,t)=>{if(us(e)){let r=ss(e.rules,t);if(e.morph)if(typeof e.morph=="function")r.push(["morph",e.morph]);else for(let n of e.morph)r.push(["morph",n]);return r}return ss(e,t)},Uu=e=>e.rules??e,zr=(e,t,r)=>{let n=Uu(e),o=Uu(t),i=Bu(n,o,r);return"morph"in e?"morph"in t?e.morph===t.morph?Me(i)||Ye(i)?i:{rules:i,morph:e.morph}:r.lastOperator==="&"?Z(no(r.path,"Intersection","of morphs")):{}:Ye(i)?i:{rules:Me(i)?e.rules:i,morph:e.morph}:"morph"in t?Ye(i)?i:{rules:Me(i)?t.rules:i,morph:t.morph}:i};var Wu=e=>`${e==="/"?"A":`At ${e}, a`} union including one or more morphs must be discriminatable`;var Gu=(e,t)=>{let r=Dy(e,t),n=e.map((o,i)=>i);return Ju(e,n,r,t)},Ju=(e,t,r,n)=>{if(t.length===1)return Ur(e[t[0]],n);let o=Ty(t,r);if(!o)return[["branches",t.map(s=>fs(e[s],n.type.scope)?Z(Wu(`${n.path}`)):Ur(e[s],n))]];let i={};for(let s in o.indexCases){let a=o.indexCases[s];i[s]=Ju(e,a,r,n),s!=="default"&&Wr(i[s],o.path,o,n)}return[["switch",{path:o.path,kind:o.kind,cases:i}]]},Wr=(e,t,r,n)=>{for(let o=0;o<e.length;o++){let[i,s]=e[o];if(t.length){if((i==="requiredProp"||i==="prerequisiteProp"||i==="optionalProp")&&s[0]===t[0]){if(typeof s[1]=="string"){if(r.kind!=="domain")return cs(r);e.splice(o,1);return}Wr(s[1],t.slice(1),r,n),s[1].length===0&&e.splice(o,1);return}}else if(r.kind==="domain"){if(i==="domain"||i==="domains"){e.splice(o,1);return}else if(i==="class"||i==="value")return}else if(r.kind===i){e.splice(o,1);return}if(i==="domains"){if(yu(s)!==1||!s.object)return cs(r);Wr(s.object,t,r,n);return}else if(i==="switch"){for(let a in s.cases)Wr(s.cases[a],t,r,n);return}else if(i==="branches"){for(let a of s)Wr(a,t,r,n);return}}return cs(r)},cs=e=>te(`Unexpectedly failed to discriminate ${e.kind} at path \'${e.path}\'`),Oy={domain:!0,class:!0,value:!0},Dy=(e,t)=>{let r={disjointsByPair:{},casesByDisjoint:{}};for(let n=0;n<e.length-1;n++)for(let o=n+1;o<e.length;o++){let i=`${n}/${o}`,s=[];r.disjointsByPair[i]=s;let a=new wt(t.type,"|");zr(e[n],e[o],a);for(let u in a.disjoints){if(u.includes(rt.index))continue;let{l:m,r:f,kind:d}=a.disjoints[u];if(!qe(d,Oy))continue;let l=Ku(d,m),g=Ku(d,f);if(l===void 0||g===void 0)continue;let w=u==="/"?d:`${u}/${d}`;if(s.push(w),!r.casesByDisjoint[w]){r.casesByDisjoint[w]={[l]:[n],[g]:[o]};continue}let x=r.casesByDisjoint[w],S=x[l];S?S.includes(n)||S.push(n):x[l]=[n];let N=x[g];N?N.includes(o)||N.push(o):x[g]=[o]}}return r},_y=e=>{let t=ge.fromString(e);return[t,t.pop()]},Ty=(e,t)=>{let r;for(let n=0;n<e.length-1;n++){let o=e[n];for(let i=n+1;i<e.length;i++){let s=e[i],a=t.disjointsByPair[`${o}/${s}`];for(let u of a){let m=t.casesByDisjoint[u],f={},d=[...e],l=0;for(let w in m){let x=m[w].filter(S=>{let N=e.indexOf(S);if(N!==-1)return delete d[N],!0});x.length!==0&&(f[w]=x,l++)}let g=re(d);if(g.length&&(f.default=g.map(w=>parseInt(w))),!r||l>r.score){let[w,x]=_y(u);if(r={path:w,kind:x,indexCases:f,score:l},l===e.length)return r}}}}return r},Ku=(e,t)=>{switch(e){case"value":return Vu(t);case"domain":return t;case"class":return oo(t);default:return}},Vu=e=>{let t=ce(e);return t==="object"||t==="symbol"?void 0:Xi(e)},Ny={value:e=>Vu(e)??"default",class:e=>or(e)??"default",domain:ce},Hu=(e,t)=>Ny[e](t),fs=(e,t)=>"morph"in e?!0:"props"in e?Object.values(e.props).some(r=>Cy(Et(r),t)):!1,Cy=(e,t)=>typeof e=="string"?t.resolve(e).includesMorph:Object.values(t.resolveTypeNode(e)).some(r=>r===!0?!1:xt(r)?r.some(n=>fs(n,t)):fs(r,t));var sr=e=>e===!0?{}:e,Yu=(e,t,r)=>{if(e===!0&&t===!0)return ye();if(!xt(e)&&!xt(t)){let s=zr(sr(e),sr(t),r);return s===e?e:s===t?t:s}let n=et(sr(e)),o=et(sr(t)),i=zu(n,o,r);return i.equalities.length===n.length&&i.equalities.length===o.length?ye():i.lExtendsR.length+i.equalities.length===n.length?e:i.rExtendsL.length+i.equalities.length===o.length?t:i},Zu=(e,t,r,n)=>{n.domain=e;let o=Yu(t,r,n);if(!as(o))return o;let i=[...o.distinctIntersections,...o.equalities.map(s=>o.lBranches[s[0]]),...o.lExtendsR.map(s=>o.lBranches[s]),...o.rExtendsL.map(s=>o.rBranches[s])];return i.length===0&&n.addDisjoint("union",o.lBranches,o.rBranches),i.length===1?i[0]:i},Qu=(e,t,r,n)=>{let o=new wt(n,"|"),i=Yu(t,r,o);if(!as(i))return Me(i)||i===t?r:i===r?t:e==="boolean"?!0:[sr(t),sr(r)];let s=[...i.lBranches.filter((a,u)=>!i.lExtendsR.includes(u)&&!i.equalities.some(m=>m[0]===u)),...i.rBranches.filter((a,u)=>!i.rExtendsL.includes(u)&&!i.equalities.some(m=>m[1]===u))];return s.length===1?s[0]:s},ls=(e,t)=>e===!0?[]:xt(e)?Gu(e,t):Ur(e,t),Xu=e=>typeof e=="object"&&"value"in e;var Kr=e=>"config"in e,ao=(e,t,r)=>{r.domain=void 0;let n=r.type.scope.resolveTypeNode(e),o=r.type.scope.resolveTypeNode(t),i=Ry(n,o,r);return typeof i=="object"&&!Ar(i)?Ar(r.disjoints)?Ou():r.addDisjoint("domain",re(n),re(o)):i===n?e:i===o?t:i},Ry=nr((e,t,r,n)=>{if(t===void 0)return r===void 0?te(to):void 0;if(r!==void 0)return Zu(e,t,r,n)},{onEmpty:"omit"}),It=(e,t,r)=>{let n=new wt(r,"&"),o=ao(e,t,n);return Ye(o)?Z(_u(n.disjoints)):Me(o)?e:o},lo=(e,t,r)=>{let n=r.scope.resolveTypeNode(e),o=r.scope.resolveTypeNode(t),i={},s=re({...n,...o});for(let a of s)i[a]=rr(n,a)?rr(o,a)?Qu(a,n[a],o[a],r):n[a]:rr(o,a)?o[a]:te(to);return i},Fy=e=>e[0]&&(e[0][0]==="value"||e[0][0]==="class"),ps=e=>{let t={type:e,path:new ge,lastDomain:"undefined"};return tt(e.node,t)},tt=(e,t)=>{if(typeof e=="string")return t.type.scope.resolve(e).flat;let r=Kr(e),n=Ay(r?e.node:e,t);return r?[["config",{config:gu(e.config),node:n}]]:n},Ay=(e,t)=>{let r=re(e);if(r.length===1){let o=r[0],i=e[o];if(i===!0)return o;t.lastDomain=o;let s=ls(i,t);return Fy(s)?s:[["domain",o],...s]}let n={};for(let o of r)t.lastDomain=o,n[o]=ls(e[o],t);return[["domains",n]]},uo=(e,t)=>Py(e,t)&&Xu(e[t]),Py=(e,t)=>{let r=re(e);return r.length===1&&r[0]===t},ar=e=>({object:{class:Array,props:{[rt.index]:e}}});function ms(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ie=class{shift(){return this.chars[this.i++]??""}get lookahead(){return this.chars[this.i]??""}shiftUntil(t){let r="";for(;this.lookahead;){if(t(this,r))if(r[r.length-1]===ie.escapeToken)r=r.slice(0,-1);else break;r+=this.shift()}return r}shiftUntilNextTerminator(){return this.shiftUntil(ie.lookaheadIsNotWhitespace),this.shiftUntil(ie.lookaheadIsTerminator)}get unscanned(){return this.chars.slice(this.i,this.chars.length).join("")}lookaheadIs(t){return this.lookahead===t}lookaheadIsIn(t){return this.lookahead in t}constructor(t){ms(this,"chars",void 0),ms(this,"i",void 0),ms(this,"finalized",!1),this.chars=[...t],this.i=0}};(function(e){var t=e.lookaheadIsTerminator=l=>l.lookahead in o,r=e.lookaheadIsNotWhitespace=l=>l.lookahead!==d,n=e.comparatorStartChars={"<":!0,">":!0,"=":!0},o=e.terminatingChars={...n,"|":!0,"&":!0,")":!0,"[":!0,"%":!0," ":!0},i=e.comparators={"<":!0,">":!0,"<=":!0,">=":!0,"==":!0},s=e.oneCharComparators={"<":!0,">":!0},a=e.comparatorDescriptions={"<":"less than",">":"more than","<=":"at most",">=":"at least","==":"exactly"},u=e.invertedComparators={"<":">",">":"<","<=":">=",">=":"<=","==":"=="},m=e.branchTokens={"|":!0,"&":!0},f=e.escapeToken="\\\\",d=e.whiteSpaceToken=" "})(ie||(ie={}));function $y(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ky(e,t){return t.get?t.get.call(e):t.value}function qy(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function ec(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function po(e,t){var r=ec(e,t,"get");return ky(e,r)}function jy(e,t,r){$y(e,t),t.set(e,r)}function My(e,t,r){var n=ec(e,t,"set");return qy(e,n,r),r}function lt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var hs=class extends TypeError{constructor(t){super(`${t}`),lt(this,"cause",void 0),this.cause=t}},kt=class{toString(){return this.message}get message(){return this.writers.addContext(this.reason,this.path)}get reason(){return this.writers.writeReason(this.mustBe,new co(this.data))}get mustBe(){return typeof this.writers.mustBe=="string"?this.writers.mustBe:this.writers.mustBe(this.source)}constructor(t,r,n,o,i){lt(this,"code",void 0),lt(this,"path",void 0),lt(this,"data",void 0),lt(this,"source",void 0),lt(this,"writers",void 0),lt(this,"parts",void 0),this.code=t,this.path=r,this.data=n,this.source=o,this.writers=i,this.code==="multi"&&(this.parts=this.source)}},ur=new WeakMap,gs=class extends Array{mustBe(t,r){return this.add("custom",t,r)}add(t,r,n){let o=ge.from(n?.path??po(this,ur).path),i=n&&"data"in n?n.data:po(this,ur).data,s=new kt(t,o,i,r,po(this,ur).getProblemConfig(t));return this.addProblem(s),s}addProblem(t){let r=`${t.path}`,n=this.byPath[r];if(n)if(n.parts)n.parts.push(t);else{let o=new kt("multi",n.path,n.data,[n,t],po(this,ur).getProblemConfig("multi")),i=this.indexOf(n);this[i===-1?this.length:i]=o,this.byPath[r]=o}else this.byPath[r]=t,this.push(t);this.count++}get summary(){return`${this}`}toString(){return this.join(`\n`)}throw(){throw new hs(this)}constructor(t){super(),lt(this,"byPath",{}),lt(this,"count",0),jy(this,ur,{writable:!0,value:void 0}),My(this,ur,t)}},mo=gs,Ly=e=>e[0].toUpperCase()+e.slice(1),ys=e=>e.map(t=>Hi[t]),tc=e=>e.map(t=>ts[t]),ds=e=>{if(e.length===0)return"never";if(e.length===1)return e[0];let t="";for(let r=0;r<e.length-1;r++)t+=e[r],r<e.length-2&&(t+=", ");return t+=` or ${e[e.length-1]}`,t},Pt=(e,t)=>`must be ${e}${t&&` (was ${t})`}`,rc=(e,t)=>t.length===0?Ly(e):t.length===1&&Pr(t[0])?`Item at index ${t[0]} ${e}`:`${t} ${e}`,$t={divisor:{mustBe:e=>e===1?"an integer":`a multiple of ${e}`},class:{mustBe:e=>{let t=oo(e);return t?ts[t]:`an instance of ${e.name}`},writeReason:(e,t)=>Pt(e,t.className)},domain:{mustBe:e=>Hi[e],writeReason:(e,t)=>Pt(e,t.domain)},missing:{mustBe:()=>"defined",writeReason:e=>Pt(e,"")},extraneous:{mustBe:()=>"removed",writeReason:e=>Pt(e,"")},bound:{mustBe:e=>`${ie.comparatorDescriptions[e.comparator]} ${e.limit}${e.units?` ${e.units}`:""}`,writeReason:(e,t)=>Pt(e,`${t.size}`)},regex:{mustBe:e=>`a string matching ${e}`},value:{mustBe:oe},branches:{mustBe:e=>ds(e.map(t=>`${t.path} must be ${t.parts?ds(t.parts.map(r=>r.mustBe)):t.mustBe}`)),writeReason:(e,t)=>`${e} (was ${t})`,addContext:(e,t)=>t.length?`At ${t}, ${e}`:e},multi:{mustBe:e=>"\\u2022 "+e.map(t=>t.mustBe).join(`\n\\u2022 `),writeReason:(e,t)=>`${t} must be...\n${e}`,addContext:(e,t)=>t.length?`At ${t}, ${e}`:e},custom:{mustBe:e=>e},cases:{mustBe:e=>ds(e)}},nc=re($t),By=()=>{let e={},t;for(t of nc)e[t]={mustBe:$t[t].mustBe,writeReason:$t[t].writeReason??Pt,addContext:$t[t].addContext??rc};return e},Uy=By(),oc=e=>{if(!e)return Uy;let t={};for(let r of nc)t[r]={mustBe:e[r]?.mustBe??$t[r].mustBe,writeReason:e[r]?.writeReason??$t[r].writeReason??e.writeReason??Pt,addContext:e[r]?.addContext??$t[r].addContext??e.addContext??rc};return t};function zy(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wy(e,t){return t.get?t.get.call(e):t.value}function Ky(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function ac(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function vs(e,t){var r=ac(e,t,"get");return Wy(e,r)}function Gy(e,t,r){zy(e,t),t.set(e,r)}function Jy(e,t,r){var n=ac(e,t,"set");return Ky(e,n,r),r}function nt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Vy=()=>({mustBe:[],writeReason:[],addContext:[],keys:[]}),Hy=["mustBe","writeReason","addContext"],uc=(e,t)=>{let r=new bs(t,e);ho(e.flat,r);let n=new cc(r);if(r.problems.count)n.problems=r.problems;else{for(let[o,i]of r.entriesToPrune)delete o[i];n.data=r.data}return n},cc=class{constructor(){nt(this,"data",void 0),nt(this,"problems",void 0)}},Gr=new WeakMap,bs=class{getProblemConfig(t){let r={};for(let n of Hy)r[n]=this.traversalConfig[n][0]??this.rootScope.config.codes[t][n];return r}traverseConfig(t,r){for(let o of t)this.traversalConfig[o[0]].unshift(o[1]);let n=ho(r,this);for(let o of t)this.traversalConfig[o[0]].shift();return n}traverseKey(t,r){let n=this.data;this.data=this.data[t],this.path.push(t);let o=ho(r,this);return this.path.pop(),n[t]!==this.data&&(n[t]=this.data),this.data=n,o}traverseResolution(t){let r=this.type.scope.resolve(t),n=r.qualifiedName,o=this.data,i=bt(o,"object");if(i){let u=vs(this,Gr)[n];if(u){if(u.includes(o))return!0;u.push(o)}else vs(this,Gr)[n]=[o]}let s=this.type;this.type=r;let a=ho(r.flat,this);return this.type=s,i&&vs(this,Gr)[n].pop(),a}traverseBranches(t){let r=this.failFast;this.failFast=!0;let n=this.problems,o=new mo(this);this.problems=o;let i=this.path,s=this.entriesToPrune,a=!1;for(let u of t)if(this.path=new ge,this.entriesToPrune=[],go(u,this)){a=!0,s.push(...this.entriesToPrune);break}return this.path=i,this.entriesToPrune=s,this.problems=n,this.failFast=r,a||!this.problems.add("branches",o)}constructor(t,r){nt(this,"data",void 0),nt(this,"type",void 0),nt(this,"path",void 0),nt(this,"problems",void 0),nt(this,"entriesToPrune",void 0),nt(this,"failFast",void 0),nt(this,"traversalConfig",void 0),nt(this,"rootScope",void 0),Gy(this,Gr,{writable:!0,value:void 0}),this.data=t,this.type=r,this.path=new ge,this.problems=new mo(this),this.entriesToPrune=[],this.failFast=!1,this.traversalConfig=Vy(),Jy(this,Gr,{}),this.rootScope=r.scope}},ho=(e,t)=>typeof e=="string"?ce(t.data)===e||!t.problems.add("domain",e):go(e,t),go=(e,t)=>{let r=!0;for(let n=0;n<e.length;n++){let[o,i]=e[n],s=Yy[o](i,t);if(r&&(r=s),!r&&(t.failFast||n<e.length-1&&Br[o]<Br[e[n+1][0]]))return!1}return r},ic=(e,t)=>e[0]in t.data?t.traverseKey(e[0],e[1]):(t.problems.add("missing",void 0,{path:t.path.concat(e[0]),data:void 0}),!1),sc=e=>(t,r)=>{let n=!0,o={...t.required};for(let s in r.data)if(t.required[s]?(n=r.traverseKey(s,t.required[s])&&n,delete o[s]):t.optional[s]?n=r.traverseKey(s,t.optional[s])&&n:t.index&&Hn.test(s)?n=r.traverseKey(s,t.index)&&n:e==="distilledProps"?r.failFast?r.entriesToPrune.push([r.data,s]):delete r.data[s]:(n=!1,r.problems.add("extraneous",r.data[s],{path:r.path.concat(s)})),!n&&r.failFast)return!1;let i=Object.keys(o);if(i.length){for(let s of i)r.problems.add("missing",void 0,{path:r.path.concat(s)});return!1}return n},Yy={regex:ju,divisor:Ru,domains:(e,t)=>{let r=e[ce(t.data)];return r?go(r,t):!t.problems.add("cases",ys(re(e)))},domain:(e,t)=>ce(t.data)===e||!t.problems.add("domain",e),bound:qu,optionalProp:(e,t)=>e[0]in t.data?t.traverseKey(e[0],e[1]):!0,requiredProp:ic,prerequisiteProp:ic,indexProp:(e,t)=>{if(!Array.isArray(t.data))return t.problems.add("class",Array),!1;let r=!0;for(let n=0;n<t.data.length;n++)if(r=t.traverseKey(`${n}`,e)&&r,!r&&t.failFast)return!1;return r},branches:(e,t)=>t.traverseBranches(e),switch:(e,t)=>{let r=vu(t.data,e.path),n=Hu(e.kind,r);if(rr(e.cases,n))return go(e.cases[n],t);let o=re(e.cases),i=t.path.concat(e.path),s=e.kind==="value"?o:e.kind==="domain"?ys(o):e.kind==="class"?tc(o):te(`Unexpectedly encountered rule kind \'${e.kind}\' during traversal`);return t.problems.add("cases",s,{path:i,data:r}),!1},alias:(e,t)=>t.traverseResolution(e),class:Nu,narrow:(e,t)=>{let r=t.problems.count,n=e(t.data,t.problems);return!n&&t.problems.count===r&&t.problems.mustBe(e.name?`valid according to ${e.name}`:"valid"),n},config:({config:e,node:t},r)=>r.traverseConfig(e,t),value:(e,t)=>t.data===e||!t.problems.add("value",e),morph:(e,t)=>{let r=e(t.data,t.problems);if(t.problems.length)return!1;if(r instanceof kt)return t.problems.addProblem(r),!1;if(r instanceof cc){if(r.problems){for(let n of r.problems)t.problems.addProblem(n);return!1}return t.data=r.data,!0}return t.data=r,!0},distilledProps:sc("distilledProps"),strictProps:sc("strictProps")};var St=new Proxy(()=>St,{get:()=>St});var ws=(e,t,r,n)=>{let o={node:e,flat:[["alias",e]],allows:a=>!i(a).problems,assert:a=>{let u=i(a);return u.problems?u.problems.throw():u.data},infer:St,inferIn:St,qualifiedName:Zy(e)?n.getAnonymousQualifiedName(e):`${n.name}.${e}`,definition:t,scope:n,includesMorph:!1,config:r},i={[e]:a=>uc(i,a)}[e];return Object.assign(i,o)},xs=e=>e?.infer===St,Zy=e=>e[0]==="\\u03BB";var fc=e=>{let t=e.scanner.shiftUntilNextTerminator();e.setRoot(Qy(e,t))},Qy=(e,t)=>e.ctx.type.scope.addParsedReferenceIfResolvable(t,e.ctx)?t:Xy(t)??e.error(t===""?Es(e):ev(t)),Xy=e=>{let t=kr(e);if(t!==void 0)return{number:{value:t}};let r=Zi(e);if(r!==void 0)return{bigint:{value:r}}},ev=e=>`\'${e}\' is unresolvable`,Es=e=>{let t=e.previousOperator();return t?Is(t,e.scanner.unscanned):tv(e.scanner.unscanned)},Is=(e,t)=>`Token \'${e}\' requires a right operand${t?` before \'${t}\'`:""}`,tv=e=>`Expected an expression${e?` before \'${e}\'`:""}`;var Ss=(e,t)=>({node:t.type.scope.resolveTypeNode(ve(e[0],t)),config:e[2]});var Le=e=>Object.isFrozen(e)?e:Array.isArray(e)?Object.freeze(e.map(Le)):rv(e),rv=e=>{for(let t in e)Le(e[t]);return e};var nv=Le({regex:$r.source}),ov=Le({range:{min:{comparator:">=",limit:0}},divisor:1}),lc=(e,t)=>{let r=t.type.scope.resolveNode(ve(e[1],t)),n=re(r).map(f=>sv(f,r[f])),o=pc(n);if(!o.length)return no(t.path,"keyof");let i={};for(let f of o){let d=typeof f;if(d==="string"||d==="number"||d==="symbol"){var s,a;(s=i)[a=d]??(s[a]=[]),i[d].push({value:f})}else if(f===$r){var u,m;(u=i).string??(u.string=[]),i.string.push(nv),(m=i).number??(m.number=[]),i.number.push(ov)}else return te(`Unexpected keyof key \'${oe(f)}\'`)}return Object.fromEntries(Object.entries(i).map(([f,d])=>[f,d.length===1?d[0]:d]))},iv={bigint:At(0n),boolean:At(!1),null:[],number:At(0),object:[],string:At(""),symbol:At(Symbol()),undefined:[]},sv=(e,t)=>e!=="object"||t===!0?iv[e]:pc(et(t).map(r=>av(r))),pc=e=>{if(!e.length)return[];let t=e[0];for(let r=1;r<e.length;r++)t=t.filter(n=>e[r].includes(n));return t},av=e=>{let t=[];if("props"in e)for(let r of Object.keys(e.props))r===rt.index?t.push($r):t.includes(r)||(t.push(r),$r.test(r)&&t.push(Yn(r,`Unexpectedly failed to parse an integer from key \'${r}\'`)));if("class"in e){let r=typeof e.class=="string"?qr[e.class]:e.class;for(let n of At(r.prototype))t.includes(n)||t.push(n)}return t};var dc=(e,t)=>{if(typeof e[2]!="function")return Z(uv(e[2]));let r=ve(e[0],t),n=t.type.scope.resolveTypeNode(r),o=e[2];t.type.includesMorph=!0;let i,s={};for(i in n){let a=n[i];a===!0?s[i]={rules:{},morph:o}:typeof a=="object"?s[i]=xt(a)?a.map(u=>mc(u,o)):mc(a,o):te(`Unexpected predicate value for domain \'${i}\': ${oe(a)}`)}return s},mc=(e,t)=>us(e)?{...e,morph:e.morph?Array.isArray(e.morph)?[...e.morph,t]:[e.morph,t]:t}:{rules:e,morph:t},uv=e=>`Morph expression requires a function following \'|>\' (was ${typeof e})`;var hc=e=>`Expected a Function or Record<Domain, Function> operand (${oe(e)} was invalid)`,gc=(e,t,r,n)=>{let o=re(t);if(!bt(e,"object"))return Z(hc(e));let i={};if(typeof e=="function"){let s={[n]:e};for(let a of o)i[a]=s}else for(let s of o){if(e[s]===void 0)continue;let a={[n]:e[s]};if(typeof a[n]!="function")return Z(hc(a));i[s]=a}return i};var yc=(e,t)=>{let r=ve(e[0],t),n=t.type.scope.resolveNode(r),o=Kr(n),i=o?n.node:n,s=It(r,gc(e[2],i,t,"narrow"),t.type);return o?{config:n.config,node:s}:s};var bc=(e,t)=>{if(fv(e))return wc[e[1]](e,t);if(lv(e))return xc[e[0]](e,t);let r={length:["!",{number:{value:e.length}}]};for(let n=0;n<e.length;n++)t.path.push(`${n}`),r[n]=ve(e[n],t),t.path.pop();return{object:{class:Array,props:r}}},vc=(e,t)=>{if(e[2]===void 0)return Z(Is(e[1],""));let r=ve(e[0],t),n=ve(e[2],t);return e[1]==="&"?It(r,n,t.type):lo(r,n,t.type)},cv=(e,t)=>ar(ve(e[0],t));var fv=e=>wc[e[1]]!==void 0,wc={"|":vc,"&":vc,"[]":cv,"=>":yc,"|>":dc,":":Ss},xc={keyof:lc,instanceof:e=>typeof e[1]!="function"?Z(`Expected a constructor following \'instanceof\' operator (was ${typeof e[1]}).`):{object:{class:e[1]}},"===":e=>({[ce(e[1])]:{value:e[1]}}),node:e=>e[1]},lv=e=>xc[e[0]]!==void 0;var Ec=(e,t)=>{let r={};for(let n in e){let o=n,i=!1;n[n.length-1]==="?"&&(n[n.length-2]===ie.escapeToken?o=`${n.slice(0,-2)}?`:(o=n.slice(0,-1),i=!0)),t.path.push(o);let s=ve(e[n],t);t.path.pop(),r[o]=i?["?",s]:s}return{object:{props:r}}};var Ic=e=>`Unmatched )${e===""?"":` before ${e}`}`,Sc="Missing )",Oc=(e,t)=>`Left bounds are only valid when paired with right bounds (try ...${t}${e})`,yo=e=>`Left-bounded expressions must specify their limits using < or <= (was ${e})`,Dc=(e,t,r,n)=>`An expression may have at most one left bound (parsed ${e}${ie.invertedComparators[t]}, ${r}${ie.invertedComparators[n]})`;function Jr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var vo=class{error(t){return Z(t)}hasRoot(){return this.root!==void 0}resolveRoot(){return this.assertHasRoot(),this.ctx.type.scope.resolveTypeNode(this.root)}rootToString(){return this.assertHasRoot(),oe(this.root)}ejectRootIfLimit(){this.assertHasRoot();let t=typeof this.root=="string"?this.ctx.type.scope.resolveNode(this.root):this.root;if(uo(t,"number")){let r=t.number.value;return this.root=void 0,r}}ejectRangeIfOpen(){if(this.branches.range){let t=this.branches.range;return delete this.branches.range,t}}assertHasRoot(){if(this.root===void 0)return te("Unexpected interaction with unset root")}assertUnsetRoot(){if(this.root!==void 0)return te("Unexpected attempt to overwrite root")}setRoot(t){this.assertUnsetRoot(),this.root=t}rootToArray(){this.root=ar(this.ejectRoot())}intersect(t){this.root=It(this.ejectRoot(),t,this.ctx.type)}ejectRoot(){this.assertHasRoot();let t=this.root;return this.root=void 0,t}ejectFinalizedRoot(){this.assertHasRoot();let t=this.root;return this.root=pv,t}finalize(){if(this.groups.length)return this.error(Sc);this.finalizeBranches(),this.scanner.finalized=!0}reduceLeftBound(t,r){let n=ie.invertedComparators[r];if(!qe(n,fo))return this.error(yo(r));if(this.branches.range)return this.error(Dc(`${this.branches.range.limit}`,this.branches.range.comparator,`${t}`,n));this.branches.range={limit:t,comparator:n}}finalizeBranches(){this.assertRangeUnset(),this.branches.union?(this.pushRootToBranch("|"),this.setRoot(this.branches.union)):this.branches.intersection&&this.setRoot(It(this.branches.intersection,this.ejectRoot(),this.ctx.type))}finalizeGroup(){this.finalizeBranches();let t=this.groups.pop();if(!t)return this.error(Ic(this.scanner.unscanned));this.branches=t}pushRootToBranch(t){this.assertRangeUnset(),this.branches.intersection=this.branches.intersection?It(this.branches.intersection,this.ejectRoot(),this.ctx.type):this.ejectRoot(),t==="|"&&(this.branches.union=this.branches.union?lo(this.branches.union,this.branches.intersection,this.ctx.type):this.branches.intersection,delete this.branches.intersection)}assertRangeUnset(){if(this.branches.range)return this.error(Oc(`${this.branches.range.limit}`,this.branches.range.comparator))}reduceGroupOpen(){this.groups.push(this.branches),this.branches={}}previousOperator(){return this.branches.range?.comparator??this.branches.intersection?"&":this.branches.union?"|":void 0}shiftedByOne(){return this.scanner.shift(),this}constructor(t,r){Jr(this,"ctx",void 0),Jr(this,"scanner",void 0),Jr(this,"root",void 0),Jr(this,"branches",void 0),Jr(this,"groups",void 0),this.ctx=r,this.branches={},this.groups=[],this.scanner=new ie(t)}},pv=new Proxy({},{get:()=>te("Unexpected attempt to access ejected attributes")});var _c=(e,t)=>{let r=e.scanner.shiftUntil(mv[t]);if(e.scanner.lookahead==="")return e.error(hv(r,t));e.scanner.shift()==="/"?(is(r),e.setRoot({string:{regex:r}})):e.setRoot({string:{value:r}})},Tc={"\'":1,\'"\':1,"/":1},mv={"\'":e=>e.lookahead==="\'",\'"\':e=>e.lookahead===\'"\',"/":e=>e.lookahead==="/"},dv={\'"\':"double-quote","\'":"single-quote","/":"forward slash"},hv=(e,t)=>`${t}${e} requires a closing ${dv[t]}`;var bo=e=>e.scanner.lookahead===""?e.error(Es(e)):e.scanner.lookahead==="("?e.shiftedByOne().reduceGroupOpen():e.scanner.lookaheadIsIn(Tc)?_c(e,e.scanner.shift()):e.scanner.lookahead===" "?bo(e.shiftedByOne()):fc(e);var Nc=e=>`Bounded expression ${e} must be a number, string or array`;var Cc=(e,t)=>{let r=gv(e,t),n=e.ejectRootIfLimit();return n===void 0?vv(e,r):e.reduceLeftBound(n,r)},gv=(e,t)=>e.scanner.lookaheadIs("=")?`${t}${e.scanner.shift()}`:qe(t,ie.oneCharComparators)?t:e.error(yv),yv="= is not a valid comparator. Use == to check for equality",vv=(e,t)=>{let r=e.scanner.shiftUntilNextTerminator(),n=kr(r,xv(t,r+e.scanner.unscanned)),o=e.ejectRangeIfOpen(),i={comparator:t,limit:n},s=o?Os(i,ns)?ir("min",o,i)==="l"?e.error(Ev({min:o,max:i})):{min:o,max:i}:e.error(yo(t)):wv(i,"==")?i:Os(i,fo)?{min:i}:Os(i,ns)?{max:i}:te(`Unexpected comparator \'${i.comparator}\'`);e.intersect(bv(s,e))},bv=(e,t)=>{let r=t.resolveRoot(),n=re(r),o={},i={range:e};return n.every(a=>{switch(a){case"string":return o.string=i,!0;case"number":return o.number=i,!0;case"object":return o.object=i,r.object===!0?!1:et(r.object).every(u=>"class"in u&&u.class===Array);default:return!1}})||t.error(Nc(t.rootToString())),o},wv=(e,t)=>e.comparator===t,Os=(e,t)=>e.comparator in t,xv=(e,t)=>`Comparator ${e} must be followed by a number literal (was \'${t}\')`,Ev=e=>`${eo(e)} is empty`;var Rc=e=>`Divisibility operand ${e} must be a number`;var Ac=e=>{let t=e.scanner.shiftUntilNextTerminator(),r=Yn(t,Fc(t));r===0&&e.error(Fc(0));let n=re(e.resolveRoot());n.length===1&&n[0]==="number"?e.intersect({number:{divisor:r}}):e.error(Rc(e.rootToString()))},Fc=e=>`% operator must be followed by a non-zero integer literal (was ${e})`;var Ds=e=>{let t=e.scanner.shift();return t===""?e.finalize():t==="["?e.scanner.shift()==="]"?e.rootToArray():e.error(Sv):qe(t,ie.branchTokens)?e.pushRootToBranch(t):t===")"?e.finalizeGroup():qe(t,ie.comparatorStartChars)?Cc(e,t):t==="%"?Ac(e):t===" "?Ds(e):te(Iv(t))},Iv=e=>`Unexpected character \'${e}\'`,Sv="Missing expected \']\'";var Pc=(e,t)=>t.type.scope.parseCache.get(e)??t.type.scope.parseCache.set(e,Ov(e,t)??Dv(e,t)),Ov=(e,t)=>{if(t.type.scope.addParsedReferenceIfResolvable(e,t))return e;if(e.endsWith("[]")){let r=e.slice(0,-2);if(t.type.scope.addParsedReferenceIfResolvable(e,t))return ar(r)}},Dv=(e,t)=>{let r=new vo(e,t);return bo(r),_v(r)},_v=e=>{for(;!e.scanner.finalized;)Tv(e);return e.ejectFinalizedRoot()},Tv=e=>e.hasRoot()?Ds(e):bo(e);var ve=(e,t)=>{let r=ce(e);if(r==="string")return Pc(e,t);if(r!=="object")return Z(_s(r));let n=or(e);switch(n){case"Object":return Ec(e,t);case"Array":return bc(e,t);case"RegExp":return{string:{regex:e.source}};case"Function":if(xs(e))return t.type.scope.addAnonymousTypeReference(e,t);if(Nv(e)){let o=e();if(xs(o))return t.type.scope.addAnonymousTypeReference(o,t)}return Z(_s("Function"));default:return Z(_s(n??oe(e)))}},C_=Symbol("as"),Nv=e=>typeof e=="function"&&e.length===0,_s=e=>`Type definitions must be strings or objects (was ${e})`;function Cv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var cr=class{get root(){return this.cache}has(t){return t in this.cache}get(t){return this.cache[t]}set(t,r){return this.cache[t]=r,r}constructor(){Cv(this,"cache",{})}},wo=class extends cr{set(t,r){return this.cache[t]=Le(r),r}};function Mc(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rv(e,t){return t.get?t.get.call(e):t.value}function Fv(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Lc(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function mt(e,t){var r=Lc(e,t,"get");return Rv(e,r)}function $c(e,t,r){Mc(e,t),t.set(e,r)}function kc(e,t,r){var n=Lc(e,t,"set");return Fv(e,n,r),r}function pt(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function xo(e,t){Mc(e,t),t.add(e)}function Ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Av=e=>({codes:oc(e.codes),keys:e.keys??"loose"}),Pv=0,qc={},Ts={};var qt=new WeakMap,fr=new WeakMap,jc=new WeakSet,Eo=new WeakSet,Cs=new WeakSet,Io=new WeakSet,Rs=class{getAnonymousQualifiedName(t){let r=0,n=t;for(;this.isResolvable(n);)n=`${t}${r++}`;return`${this.name}.${n}`}addAnonymousTypeReference(t,r){var n;return(n=r.type).includesMorph||(n.includesMorph=t.includesMorph),t.node}get infer(){return St}compile(){if(!Ts[this.name]){for(let t in this.aliases)this.resolve(t);Ts[this.name]=mt(this,fr).root}return mt(this,fr).root}addParsedReferenceIfResolvable(t,r){var n;let o=pt(this,Io,Fs).call(this,t,"undefined",[t]);return o?((n=r.type).includesMorph||(n.includesMorph=o.includesMorph),!0):!1}resolve(t){return pt(this,Io,Fs).call(this,t,"throw",[t])}resolveNode(t){return typeof t=="string"?this.resolveNode(this.resolve(t).node):t}resolveTypeNode(t){let r=this.resolveNode(t);return Kr(r)?r.node:r}isResolvable(t){return mt(this,qt).has(t)||this.aliases[t]}constructor(t,r={}){xo(this,jc),xo(this,Eo),xo(this,Cs),xo(this,Io),Ne(this,"aliases",void 0),Ne(this,"name",void 0),Ne(this,"config",void 0),Ne(this,"parseCache",void 0),$c(this,qt,{writable:!0,value:void 0}),$c(this,fr,{writable:!0,value:void 0}),Ne(this,"expressions",void 0),Ne(this,"intersection",void 0),Ne(this,"union",void 0),Ne(this,"arrayOf",void 0),Ne(this,"keyOf",void 0),Ne(this,"valueOf",void 0),Ne(this,"instanceOf",void 0),Ne(this,"narrow",void 0),Ne(this,"morph",void 0),Ne(this,"type",void 0),this.aliases=t,this.parseCache=new wo,kc(this,qt,new cr),kc(this,fr,new cr),this.expressions={intersection:(n,o,i)=>this.type([n,"&",o],i),union:(n,o,i)=>this.type([n,"|",o],i),arrayOf:(n,o)=>this.type([n,"[]"],o),keyOf:(n,o)=>this.type(["keyof",n],o),node:(n,o)=>this.type(["node",n],o),instanceOf:(n,o)=>this.type(["instanceof",n],o),valueOf:(n,o)=>this.type(["===",n],o),narrow:(n,o,i)=>this.type([n,"=>",o],i),morph:(n,o,i)=>this.type([n,"|>",o],i)},this.intersection=this.expressions.intersection,this.union=this.expressions.union,this.arrayOf=this.expressions.arrayOf,this.keyOf=this.expressions.keyOf,this.valueOf=this.expressions.valueOf,this.instanceOf=this.expressions.instanceOf,this.narrow=this.expressions.narrow,this.morph=this.expressions.morph,this.type=Object.assign((n,o={})=>{let i=ws("\\u03BBtype",n,o,this),s=pt(this,Cs,Bc).call(this,i),a=ve(n,s);return i.node=Le(Ar(o)?{config:o,node:this.resolveTypeNode(a)}:a),i.flat=Le(ps(i)),i},{from:this.expressions.node}),this.name=pt(this,jc,$v).call(this,r),r.standard!==!1&&pt(this,Eo,Ns).call(this,[Ts.standard],"imports"),r.imports&&pt(this,Eo,Ns).call(this,r.imports,"imports"),r.includes&&pt(this,Eo,Ns).call(this,r.includes,"includes"),this.config=Av(r)}};function $v(e){let t=e.name?qc[e.name]?Z(`A scope named \'${e.name}\' already exists`):e.name:`scope${++Pv}`;return qc[t]=this,t}function Ns(e,t){for(let r of e)for(let n in r)(mt(this,qt).has(n)||n in this.aliases)&&Z(qv(n)),mt(this,qt).set(n,r[n]),t==="includes"&&mt(this,fr).set(n,r[n])}function Bc(e){return{type:e,path:new ge}}function Fs(e,t,r){let n=mt(this,qt).get(e);if(n)return n;let o=this.aliases[e];if(!o)return t==="throw"?te(`Unexpectedly failed to resolve alias \'${e}\'`):void 0;let i=ws(e,o,{},this),s=pt(this,Cs,Bc).call(this,i);mt(this,qt).set(e,i),mt(this,fr).set(e,i);let a=ve(o,s);if(typeof a=="string"){if(r.includes(a))return Z(kv(e,r));r.push(a),a=pt(this,Io,Fs).call(this,a,"throw",r).node}return i.node=Le(a),i.flat=Le(ps(i)),i}var Be=(e,t={})=>new Rs(e,t),As=Be({},{name:"root",standard:!1}),Ze=As.type,kv=(e,t)=>`Alias \'${e}\' has a shallow resolution cycle: ${[...t,e].join("=>")}`,qv=e=>`Alias \'${e}\' is already defined`;var So=Be({Function:["node",{object:{class:Function}}],Date:["node",{object:{class:Date}}],Error:["node",{object:{class:Error}}],Map:["node",{object:{class:Map}}],RegExp:["node",{object:{class:RegExp}}],Set:["node",{object:{class:Set}}],WeakMap:["node",{object:{class:WeakMap}}],WeakSet:["node",{object:{class:WeakSet}}],Promise:["node",{object:{class:Promise}}]},{name:"jsObjects",standard:!1}),Uc=So.compile();var zc={bigint:!0,boolean:!0,null:!0,number:!0,object:!0,string:!0,symbol:!0,undefined:!0},Oo=Be({any:["node",zc],bigint:["node",{bigint:!0}],boolean:["node",{boolean:!0}],false:["node",{boolean:{value:!1}}],never:["node",{}],null:["node",{null:!0}],number:["node",{number:!0}],object:["node",{object:!0}],string:["node",{string:!0}],symbol:["node",{symbol:!0}],true:["node",{boolean:{value:!0}}],unknown:["node",zc],void:["node",{undefined:!0}],undefined:["node",{undefined:!0}]},{name:"ts",standard:!1}),jt=Oo.compile();var jv=e=>{let t=e.replace(/[- ]+/g,""),r=0,n,o,i;for(let s=t.length-1;s>=0;s--)n=t.substring(s,s+1),o=parseInt(n,10),i?(o*=2,o>=10?r+=o%10+1:r+=o):r+=o,i=!i;return!!(r%10===0&&t)},Mv=/^(?:4[0-9]{12}(?:[0-9]{3,6})?|5[1-5][0-9]{14}|(222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}|6(?:011|5[0-9][0-9])[0-9]{12,15}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\\d{3})\\d{11}|6[27][0-9]{14}|^(81[0-9]{14,17}))$/,Wc=Ze([Mv,"=>",(e,t)=>jv(e)||!t.mustBe("a valid credit card number")],{mustBe:"a valid credit card number"});var Lv=/^[./-]$/,Bv=/^([+-]?\\d{4}(?!\\d{2}\\b))((-?)((0[1-9]|1[0-2])(\\3([12]\\d|0[1-9]|3[01]))?|W([0-4]\\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\\d|[12]\\d{2}|3([0-5]\\d|6[1-6])))([T]((([01]\\d|2[0-3])((:?)[0-5]\\d)?|24:?00)([.,]\\d+(?!:))?)?(\\17[0-5]\\d([.,]\\d+)?)?([zZ]|([+-])([01]\\d|2[0-3]):?([0-5]\\d)?)?)?)?$/,Uv=e=>!isNaN(e),Do=e=>`a ${e}-formatted date`,zv=(e,t)=>{if(!t?.format){let a=new Date(e);return Uv(a)?a:"a valid date"}if(t.format==="iso8601")return Bv.test(e)?new Date(e):Do("iso8601");let r=e.split(Lv),n=e[r[0].length],o=n?t.format.split(n):[t.format];if(r.length!==o.length)return Do(t.format);let i={};for(let a=0;a<o.length;a++){if(r[a].length!==o[a].length&&!(o[a].length===1&&r[a].length===2))return Do(t.format);i[o[a][0]]=r[a]}let s=new Date(`${i.m}/${i.d}/${i.y}`);return`${s.getDate()}`===i.d?s:Do(t.format)},Kc=Ze([jt.string,"|>",(e,t)=>{let r=zv(e);return typeof r=="string"?t.mustBe(r):r}]);var Wv=Ze([Yi,"|>",e=>parseFloat(e)],{mustBe:"a well-formed numeric string"}),Kv=Ze([jt.string,"|>",(e,t)=>{if(!Pr(e))return t.mustBe("a well-formed integer string");let r=parseInt(e);return Number.isSafeInteger(r)?r:t.mustBe("an integer in the range Number.MIN_SAFE_INTEGER to Number.MAX_SAFE_INTEGER")}]),Gv=Ze(/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$/,{mustBe:"a valid email"}),Jv=Ze(/^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$/,{mustBe:"a valid UUID"}),Vv=Ze(/^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$/,{mustBe:"a valid semantic version (see https://semver.org/)"}),Hv=Ze([jt.string,"|>",e=>JSON.parse(e)],{mustBe:"a JSON-parsable string"}),_o=Be({alpha:[/^[A-Za-z]*$/,":",{mustBe:"only letters"}],alphanumeric:[/^[A-Za-z\\d]*$/,":",{mustBe:"only letters and digits"}],lowercase:[/^[a-z]*$/,":",{mustBe:"only lowercase letters"}],uppercase:[/^[A-Z]*$/,":",{mustBe:"only uppercase letters"}],creditCard:Wc,email:Gv,uuid:Jv,parsedNumber:Wv,parsedInteger:Kv,parsedDate:Kc,semver:Vv,json:Hv,integer:["node",{number:{divisor:1}}]},{name:"validation",standard:!1}),Gc=_o.compile();var To=Be({},{name:"standard",includes:[jt,Uc,Gc],standard:!1}),Yv=To.compile(),dt={root:As,tsKeywords:Oo,jsObjects:So,validation:_o,ark:To};var Zv=To.type;var Qv=dt.ark.intersection,Xv=dt.ark.union,eb=dt.ark.arrayOf,tb=dt.ark.keyOf,rb=dt.ark.instanceOf,nb=dt.ark.valueOf,ob=dt.ark.narrow,ib=dt.ark.morph;var{DataRequest:Jc,DataResponse:I1}=Be({DataRequest:{id:"number",method:"string",params:"any[]"},DataResponse:{id:"number","eventName?":"string",payload:"any",error:"any"}}).compile(),Vc="__METHODS__",Hc="__EVAL__";var sb=typeof parent<"u"&&typeof window<"u"&&window!==parent?parent.postMessage:postMessage,Vr=class{methods;constructor(t){if(!(typeof self<"u"&&typeof postMessage=="function"&&typeof addEventListener=="function"))throw new Error("Script must be executed as a worker");this.methods={...t,[Vc]:()=>Object.keys(t),[Hc]:(r,...n)=>new Function(`return (${r})`)()(...n)},addEventListener("message",r=>this.onMessage(r.data)),this.send("ready")}send(t,r){sb(t,r)}async onMessage(t){let{data:r,problems:n}=Jc(t);if(n)return this.send({id:-1,payload:null,error:n.toString()});try{let o=this.methods[r.method];if(!o)throw new Error(\'Unknown method "\'+r.method+\'"\');let i=await o.apply(o,r.params);this.send({id:r.id,payload:i,error:null})}catch(o){console.error(o),this.send({id:r.id,payload:null,error:ab(o)})}}emit(t,r){this.send({eventName:t,payload:r,id:-1,error:null})}};function ab(e){return Object.getOwnPropertyNames(e).reduce((t,r)=>Object.defineProperty(t,r,{value:e[r],enumerable:!0}),{})}var Yc=e=>`obsidian-zotero:${e}`;var ks=({key:e,groupID:t,parentItem:r},n=!1)=>{let o=[e];return!n&&r&&o.push(`a${r}`),typeof t=="number"&&o.push(`g${t}`),o.join("")},Zc=(e,t,r=!0)=>(n,...o)=>{let i="";for(let s=0;s<n.length;s++)s>0&&(i+=e(o[s-1])),i+=(r?n.raw:n)[s];return t(i)},qs=(e=!0,t)=>Zc(r=>r,r=>new RegExp(e?"^"+r+"$":r,t),!0),Ps=String.raw`[23456789ABCDEFGHIJKLMNPQRSTUVWXYZ]{8}`,$s=String.raw`\\d+`,Qc=e=>{let t={annotKey:Ps,parentKey:Ps,groupID:$s,page:$s};if(e)for(let r in t)t[r]=`(${t[r]})`;return Zc(r=>t[r],r=>r)`${"annotKey"}a${"parentKey"}(?:g${"groupID"})?(?:p${"page"})?`},_1=qs()`${Ps}(?:g${$s})?`,T1=qs()`${Qc(!0)}`,N1=qs()`(?:${Qc(!1)}n?)+`;var cb=/^[0-9]{4}\\-(0[0-9]|10|11|12)\\-(0[0-9]|[1-2][0-9]|30|31) /;var fb=/^\\-?[0-9]{4}\\-(0[1-9]|10|11|12)\\-(0[1-9]|[1-2][0-9]|30|31) ([0-1][0-9]|[2][0-3]):([0-5][0-9]):([0-5][0-9])$/,lb=/^\\-?[0-9]{4}\\-(0[1-9]|10|11|12)\\-(0[1-9]|[1-2][0-9]|30|31) ([0-1][0-9]|[2][0-3]):([0-5][0-9])$/,pb=e=>mb(e)||db(e)?!1:cb.test(e),Xc=e=>e?pb(e)?e.substring(0,10):"0000-00-00":"";var mb=e=>fb.test(e),db=e=>lb.test(e);var ef=(e,t,{getLogger:r,configure:n})=>{let o=Yc(e);return n({appenders:{out:{type:"console"}},categories:{default:{appenders:["out"],level:t},[o]:{appenders:["out"],level:t}}}),r(o)};var tf=()=>(...e)=>e;function rf(e,t){let r=Object.keys(t).map(n=>hb(e,n,t[n]));return r.length===1?r[0]:function(){r.forEach(n=>n())}}function hb(e,t,r){let n=e[t],o=e.hasOwnProperty(t),i=r(n);return n&&Object.setPrototypeOf(i,n),Object.setPrototypeOf(s,i),e[t]=s,a;function s(...u){return i===n&&e[t]===s&&a(),i.apply(this,u)}function a(){e[t]===s&&(o?e[t]=n:delete e[t]),i!==n&&(i=n,Object.setPrototypeOf(s,n||Function))}}var nf=e=>{let t=r=>async(...n)=>{try{return await r(...n)}catch(o){throw console.error(o),o}};return rf(e,Object.fromEntries(Object.keys(e).map(r=>[r,t]))),e};var of;(function(e){e[e.highlight=1]="highlight",e[e.note=2]="note",e[e.image=3]="image",e[e.ink=4]="ink",e[e.underline=5]="underline"})(of||(of={}));var sf;(function(e){e[e.manual=0]="manual",e[e.auto=1]="auto"})(sf||(sf={}));var af;(function(e){e[e.importedFile=0]="importedFile",e[e.importedUrl=1]="importedUrl",e[e.linkedFile=2]="linkedFile",e[e.linkedUrl=3]="linkedUrl",e[e.embeddedImage=4]="embeddedImage"})(af||(af={}));var js;(function(e){e[e.fullName=0]="fullName",e[e.nameOnly=1]="nameOnly"})(js||(js={}));var Ms=["attachment","note","annotation"];var No=Ms.map(e=>`\'${e}\'`).join(",");var be=(e="itemID")=>`--sql\n  ${e} IS NOT NULL\n  ${e==="itemID"?`AND ${e} NOT IN (SELECT itemID FROM deletedItems)`:""}\n`,Ue=(e,t="$itemId")=>typeof e=="boolean"?"":`AND ${e} = ${t}`;var Q=class{statement;constructor(t){this.statement=t.prepare(this.sql())}get database(){return this.statement.database}get(t){return this.statement.get(t)}all(t){return t===void 0?this.statement.all():this.statement.all(t)}},lr=class extends Q{query(t){return this.all(t)}},Co=class extends Q{query(){return this.all(void 0)}},pr=class extends Q{query(t){return this.all(t).map(r=>this.parse(r,t))}};var Ls=(e,t)=>{for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]-t[r];return 0};var Bs=e=>e?.split("|").map(t=>parseInt(t,10))??[];var Ro=`--sql\n  items.itemID,\n  items.key,\n  items.clientDateModified,\n  items.dateAdded,\n  items.dateModified,\n  annots.type,\n  annots.authorName,\n  annots.text,\n  annots.comment,\n  annots.color,\n  annots.pageLabel,\n  annots.sortIndex,\n  annots.position,\n  annots.isExternal\n`,Fo=`--sql\n  itemAnnotations annots\n  JOIN items USING (itemID)\n`,Ao=(e,t,r)=>Object.assign(e,{sortIndex:Bs(e.sortIndex),position:JSON.parse(e.position),libraryID:t,groupID:r,itemType:"annotation"});var gb=`--sql\nSELECT\n  ${Ro},\n  annots.parentItemID,\n  parentItems.key as parentItem\nFROM\n  ${Fo}\n  JOIN items as parentItems ON annots.parentItemID = parentItems.itemID\nWHERE\n  items.key = $annotKey\n  AND items.libraryID = $libId\n  AND ${be("items.itemID")}\n`,Hr=class extends Q{trxCache={};sql(){return gb}parse(t,r){return Ao(t,r.libId,r.groupID)}query(t){let{annotKeys:r,libId:n}=t,o=s=>s.reduce((a,u)=>{let m=this.get({annotKey:u,libId:n});return m&&(a[u]=this.parse(m,t)),a},{});return(this.trxCache[n]??=this.database.transaction(o))(r)}};var yb=`--sql\nSELECT\n  ${Ro}\nFROM\n  ${Fo}\nWHERE\n  parentItemID = $attachmentId\n  AND items.libraryID = $libId\n  AND ${be()}\n`,Yr=class extends pr{sql(){return yb}getKeyStatement=this.database.prepare("SELECT key FROM items WHERE itemID = $attachmentId AND libraryID = $libId");parse(t,r,n){return Object.assign(Ao(t,r.libId,r.groupID),{parentItem:n,parentItemID:r.attachmentId})}query(t){let r=this.getKeyStatement.get(t)?.key;if(r===void 0)throw new Error("Parent item not found");return this.all(t).map(n=>this.parse(n,t,r)).sort((n,o)=>Ls(n.sortIndex,o.sortIndex))}};var Po=`--sql\n  items.itemID,\n  items.key,\n  items.clientDateModified,\n  items.dateAdded,\n  items.dateModified,\n  notes.note,\n  notes.title\n`,$o=`--sql\n  itemNotes notes\n  JOIN items USING (itemID)\n`,ko=(e,t,r)=>Object.assign(e,{libraryID:t,groupID:r,itemType:"note"});var vb=`--sql\nSELECT\n  ${Po},\n  notes.parentItemID,\n  parentItems.key as parentItem\nFROM\n  ${$o}\n  JOIN items as parentItems ON notes.parentItemID = parentItems.itemID\nWHERE\n  items.key = $noteKey\n  AND items.libraryID = $libId\n  AND ${be("items.itemID")}\n`,Zr=class extends Q{trxCache={};sql(){return vb}parse(t,r){return ko(t,r.libId,r.groupID)}query(t){let{noteKeys:r,libId:n}=t,o=s=>s.reduce((a,u)=>{let m=this.get({noteKey:u,libId:n});return m&&(a[u]=this.parse(m,t)),a},{});return(this.trxCache[n]??=this.database.transaction(o))(r)}};var bb=`--sql\nSELECT\n  ${Po}\nFROM\n  ${$o}\nWHERE\n  parentItemID = $itemID\n  AND items.libraryID = $libId\n  AND ${be()}\n`,Qr=class extends pr{sql(){return bb}getKeyStatement=this.database.prepare("SELECT key FROM items WHERE itemID = $itemID AND libraryID = $libId");parse(t,r,n){return Object.assign(ko(t,r.libId,r.groupID),{parentItem:n,parentItemID:r.itemID})}query(t){let r=this.getKeyStatement.get(t)?.key;if(r===void 0)throw new Error("Parent item not found");return this.all(t).map(n=>this.parse(n,t,r))}};var wb=`--sql\nSELECT\n  atchs.itemID,\n  atchs.path,\n  atchs.contentType,\n  atchs.linkMode,\n  charsets.charset,\n  items.key,\n  COUNT(atchs.itemID) as annotCount\nFROM\n  itemAttachments atchs\n  JOIN items USING (itemID)\n  LEFT JOIN charsets USING (charsetID)\n  LEFT JOIN itemAnnotations annots ON atchs.itemID = annots.parentItemID\nWHERE\n  atchs.parentItemID = $itemId\n  AND libraryID = $libId\n  AND ${be("atchs.itemID")}\nGROUP BY atchs.itemID\n`,Xr=class extends lr{sql(){return wb}};var xb=`--sql\nSELECT\n  citekey\nFROM\n  citekeys\nWHERE\n  itemID = $itemID\n  AND (libraryID IS NULL OR libraryID = $libId)\n`,en=class extends Q{trxFunc=t=>t.reduce((r,[n,o])=>{let i=this.get({itemID:n,libId:o});return i&&(r[n]=i.citekey),r},{});trx=this.database.transaction(this.trxFunc);sql(){return xb}query(t){return this.trx(t.items)}};var Eb=`--sql\nSELECT\n  itemID\nFROM\n  citekeys\nWHERE\n  citekey = $citekey\n`,tn=class extends Q{trxFunc=t=>t.reduce((r,n)=>{let o=this.get({citekey:n});return r[n]=o?.itemID??-1,r},{});trx=this.database.transaction(this.trxFunc);sql(){return Eb}query(t){return this.trx(t.citekeys)}};var qo=e=>`--sql\nSELECT\n  itemID,\n  creators.firstName,\n  creators.lastName,\n  creators.fieldMode,\n  creatorTypes.creatorType,\n  orderIndex\nFROM\n  items\n  LEFT JOIN itemCreators USING (itemID)\n  JOIN creators USING (creatorID)\n  JOIN creatorTypes USING (creatorTypeID)\nWHERE\n  libraryID = $libId\n  ${Ue(e||"itemID")}\n  AND ${be()}\nORDER BY\n  itemID,\n  orderIndex\n`;var AT=qo(!0);function uf(e){for(var t={},r=e.length,n=0;n<r;++n){var o=e[n];t[o[0]]=o[1]}return t}var Mt=uf;var Ib=qo(!1),rn=class extends Q{trxFunc=t=>t.map(([r,n])=>[r,this.all({itemId:r,libId:n})]);trx=this.database.transaction(this.trxFunc);sql(){return Ib}query(t){return Mt(this.trx(t))}};var jo=e=>`--sql\nSELECT\n  items.itemID,\n  fieldsCombined.fieldName,\n  itemDataValues.value\nFROM\n  items\n  JOIN itemData USING (itemID)\n  JOIN itemDataValues USING (valueID)\n  JOIN fieldsCombined USING (fieldID)\n  JOIN itemTypesCombined USING (itemTypeID)\nWHERE\n  libraryID = $libId\n  ${Ue(e||"items.itemID")}\n  AND itemTypesCombined.typeName NOT IN (${No})\n  AND ${be()}\n`;var xN=jo(!0);var Sb=jo(!1),nn=class extends Q{trxFunc=t=>t.map(([r,n])=>[r,this.all({itemId:r,libId:n})]);trx=this.database.transaction(this.trxFunc);sql(){return Sb}query(t){return Mt(this.trx(t))}};var on=e=>`--sql\nSELECT\n  items.libraryID,\n  items.itemID,\n  items.key,\n  items.clientDateModified,\n  items.dateAdded,\n  items.dateModified,\n  itemTypesCombined.typeName as itemType,\n  json_group_array(collectionID) filter (where collectionID is not null) as collectionIDs\nFROM \n  items\n  JOIN itemTypesCombined USING (itemTypeID)\n  LEFT JOIN collectionItems USING (itemID)\nWHERE \n  libraryID = $libId\n  ${e==="full"?Ue(!1):e==="id"?Ue("items.itemID"):Ue("items.key","$key")}\n  AND ${be()}\n  AND itemType NOT IN (${No})\nGROUP BY itemID\n`;var Ob=on("full"),sn=class extends Q{sql(){return Ob}query(t){return this.all(t).map(({collectionIDs:n,...o})=>({...o,collectionIDs:JSON.parse(n)}))}};var Db=on("id"),_b=on("key"),an=class extends Q{trxFunc=t=>t.reduce((r,[n,o])=>{let i=this.get({itemId:n,libId:o});return i&&(r[n]={...i,collectionIDs:JSON.parse(i.collectionIDs)}),r},{});trx=this.database.transaction(this.trxFunc);sql(){return Db}query(t){return this.trx(t)}},un=class extends Q{trxFunc=t=>t.reduce((r,[n,o])=>{let i=this.get({key:n,libId:o});return i&&(r[n]={...i,collectionIDs:JSON.parse(i.collectionIDs)}),r},{});trx=this.database.transaction(this.trxFunc);sql(){return _b}query(t){return this.trx(t)}};var cn=e=>`--sql\nWITH\n  RECURSIVE CollectionPath AS (\n    -- Base case: collections without a parent\n    SELECT\n      collectionID,\n      parentCollectionID,\n      collectionName AS path\n    FROM\n      collections\n    WHERE\n      libraryID = $libId\n      ${e==="full"?Ue(!1):e==="id"?Ue("collectionID","$collectionID"):Ue("key","$key")}\n      AND ${be("collectionID")}\n    UNION ALL\n    -- Recursive case: join with parent collections\n    SELECT\n      prev.collectionID,\n      c.parentCollectionID,\n      c.collectionName\n    FROM\n      collections c\n      JOIN CollectionPath prev ON c.collectionID = prev.parentCollectionID\n  )\nSELECT\n  p.collectionID,\n  json_group_array(p.path) path,\n  c.key,\n  c.collectionName,\n  c.libraryID\nFROM\n  CollectionPath p\n  JOIN collections c USING (collectionID)\nGROUP BY\n  collectionID\nORDER BY\n  collectionID;\n`;function Us({collectionID:e,collectionName:t,path:r,...n}){return{...n,id:e,name:t,path:JSON.parse(r)}}var MN=cn("full");var Tb=cn("id"),zN=cn("key"),fn=class extends Q{trxFunc=t=>t.reduce((r,[n,o])=>{let i=this.get({collectionID:n,libId:o});return i&&r.set(n,Us(i)),r},new Map);trx=this.database.transaction(this.trxFunc);sql(){return Tb}query(t){return this.trx(t)}};var Nb=`--sql\nSELECT\n  libraries.libraryID,\n  groups.groupID,\n  CASE\n    libraries.type\n    WHEN \'user\' THEN \'My Library\'\n    WHEN \'group\' THEN groups.name\n    ELSE NULL\n  END AS name\nFROM\n  libraries\n  LEFT JOIN groups USING (libraryID)\nWHERE\n  libraries.libraryID IS NOT NULL\nORDER BY\n  libraryID\n`,ln=class extends Co{sql(){return Nb}};var Cb=`--sql\nSELECT\n  tagID,\n  type,\n  name\nFROM\n  itemTags\n  JOIN items USING (itemID)\n  JOIN tags USING (tagID)\nWHERE\n  itemID = $itemId\n  AND tagID IS NOT NULL\n  AND libraryID = $libId\n`,pn=class extends Q{trxFunc=t=>t.map(([r,n])=>[r,this.all({itemId:r,libId:n})]);trx=this.database.transaction(this.trxFunc);sql(){return Cb}query(t){return Mt(this.trx(t))}};var Rb=new Set(tf()("creators","itemID","itemType","key","libraryID","collections"));var Vh=Fr(Ws(),1);var Cd=Fr(Ws(),1),gi=Fr(Nd(),1),YE="INFO",Rd=ef("db-worker",YE,gi.default),Aa="log4js_loglevel";Cd.default.getItem(Aa).then(e=>{typeof e=="string"&&e in gi.levels&&(Rd.level=e,console.debug(`Read from localforage: loglevel ${e}`))});var he=Rd;var mh=require("fs"),dh=Fr(lh(),1);var Si=class extends Error{constructor(){super("Database not set")}},ph=e=>(0,mh.statSync)(e).mtimeMs,Or=class{database=null;get instance(){return this.database?.instance}nativeBinding=null;isUpToDate(){return this.database?this.database.mtime===ph(this.database.file):null}initDatabase(t,r){return new dh.default(`file:${t}?mode=ro&immutable=1`,{nativeBinding:r,uriPath:!0,verbose:void 0})}opened=!1;open(t){let r=t.nativeBinding?this.nativeBinding=t.nativeBinding:this.nativeBinding;if(!r)throw new Error("Failed to open database conn: no native binding provided");let n;if(t.file)n=t.file;else{if(!this.database?.file)throw new Si;n=this.database.file}try{return this.database?.instance&&(he.debug("Database opened before, closing: ",this.database.instance.name),this.close()),this.database={mtime:ph(n),instance:this.initDatabase(n,r),file:n,prepared:new Map},he.debug("Database opened: ",n),this.opened=!0,!0}catch(o){if(o.code!=="ENOENT")throw console.error("Failed to open database",n),o;return this.opened=!1,!1}}close(){this.opened=!1,this.instance?.close(),this.database=null}prepare(t){if(!this.database)throw new Si;let r=this.database.prepared.get(t);if(r)return r;let n=new t(this.database.instance);return this.database.prepared.set(t,n),n}};var qn=class{#e=null;get instance(){return this.status==="READY"?this.#e:null}get zotero(){if(!this.#e)throw new Error("database not ready");return this.#e.zotero}get bbt(){if(!this.#e)throw new Error("database not ready");return this.#e.bbt}status="NOT_INITIALIZED";checkDbStatus(t){return this.#e?this.#e[t].opened:!1}load(t,r){let n={zotero:this.#e?.zotero??new Or,bbt:this.#e?.bbt??new Or};try{let o=n.zotero.open({nativeBinding:r.nativeBinding,file:t.zotero});if(!o)throw new Error(`Failed to open main database, no database found at ${t.zotero}`);let i=n.bbt.open({nativeBinding:r.nativeBinding,file:t.bbt});i||he.debug(`Unable to open bbt database, no database found at ${t.bbt}`);let s=n.zotero.prepare(ln).query().reduce((a,u)=>(a[u.libraryID]=u,a),{});return this.#e={...n,libraries:s},this.status="READY",[o,i]}catch(o){throw this.status="ERROR",o}}groupOf(t){if(!this.#e)throw new Error("Library info not loaded");return this.#e.libraries[t].groupID}get libraries(){if(!this.#e)throw new Error("Library info not loaded");return Object.values(this.#e.libraries)}};var yh=Fr(gh(),1);var OI=e=>typeof e[0][0]=="string";function vh(e){return[...new Set(e)]}var jn=class{#e=Di;async get(t,r){if(t.length===0)return[];if(!r)return await Promise.all(t.map(([i,s])=>this.#t(i,s)));let n=OI(t)?this.#e.readItemByKey(t):this.#e.readItemById(t);return await this.#e.updateIndex(n),Object.values(n)}async#t(t,r){let n=await this.#e.getItemsCache(r);return typeof t=="number"?n.byId.get(t)??null:typeof t=="string"?n.byKey.get(t)??null:((0,yh.assertNever)(t),null)}};function Mn(){this.cache=null,this.matcher=null,this.stemmer=null,this.filter=null}Mn.prototype.add;Mn.prototype.append;Mn.prototype.search;Mn.prototype.update;Mn.prototype.remove;function Dr(e,t){return typeof e<"u"?e:t}function Ma(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=J();return t}function bh(e){return Object.keys(e)}function J(){return Object.create(null)}function wh(e){return[].concat.apply([],e)}function xh(e,t){return t.length-e.length}function Xt(e){return e.constructor===Array}function fe(e){return typeof e=="string"}function He(e){return typeof e=="object"}function Ln(e){return typeof e=="function"}function Ih(e,t,r,n){if(e&&(t&&(e=La(e,t)),this.matcher&&(e=La(e,this.matcher)),this.stemmer&&e.length>1&&(e=La(e,this.stemmer)),n&&e.length>1&&(e=DI(e)),r||r==="")){let o=e.split(r);return this.filter?_I(o,this.filter):o}return e}var Sh=/[\\p{Z}\\p{S}\\p{P}\\p{C}]+/u;function Oh(e){let t=J();for(let r=0,n=e.length;r<n;r++)t[e[r]]=1;return t}function Ba(e,t){let r=bh(e),n=r.length,o=[],i="",s=0;for(let a=0,u,m;a<n;a++)u=r[a],m=e[u],m?(o[s++]=Eh(t?"(?!\\\\b)"+u+"(\\\\b|_)":u),o[s++]=m):i+=(i?"|":"")+u;return i&&(o[s++]=Eh(t?"(?!\\\\b)("+i+")(\\\\b|_)":"("+i+")"),o[s]=""),o}function La(e,t){for(let r=0,n=t.length;r<n&&(e=e.replace(t[r],t[r+1]),!!e);r+=2);return e}function Eh(e){return new RegExp(e,"g")}function DI(e){let t="",r="";for(let n=0,o=e.length,i;n<o;n++)(i=e[n])!==r&&(t+=r=i);return t}function _I(e,t){let r=e.length,n=[];for(let o=0,i=0;o<r;o++){let s=e[o];s&&!t[s]&&(n[i++]=s)}return n}var TI=!1,NI="",Dh={encode:Ua,rtl:TI,tokenize:NI};function Ua(e){return Ih.call(this,(""+e).toLowerCase(),!1,Sh,!1)}var _h={},Th={};function _i(e){Bn(e,"add"),Bn(e,"append"),Bn(e,"search"),Bn(e,"update"),Bn(e,"remove")}function Bn(e,t){e[t+"Async"]=function(){let r=this,n=arguments,o=n[n.length-1],i;Ln(o)&&(i=o,delete n[n.length-1]);let s=new Promise(function(a){setTimeout(function(){r.async=!0;let u=r[t].apply(r,n);r.async=!1,a(u)})});return i?(s.then(i),this):s}}function Ti(e,t,r,n){let o=e.length,i=[],s,a,u=0;n&&(n=[]);for(let m=o-1;m>=0;m--){let f=e[m],d=f.length,l=J(),g=!s;for(let w=0;w<d;w++){let x=f[w],S=x.length;if(S)for(let N=0,q,k;N<S;N++)if(k=x[N],s){if(s[k]){if(!m){if(r)r--;else if(i[u++]=k,u===t)return i}(m||n)&&(l[k]=1),g=!0}if(n&&(q=(a[k]||0)+1,a[k]=q,q<o)){let ee=n[q-2]||(n[q-2]=[]);ee[ee.length]=k}}else l[k]=1}if(n)s||(a=l);else if(!g)return[];s=l}if(n)for(let m=n.length-1,f,d;m>=0;m--){f=n[m],d=f.length;for(let l=0,g;l<d;l++)if(g=f[l],!s[g]){if(r)r--;else if(i[u++]=g,u===t)return i;s[g]=1}}return i}function Nh(e,t){let r=J(),n=J(),o=[];for(let i=0;i<e.length;i++)r[e[i]]=1;for(let i=0,s;i<t.length;i++){s=t[i];for(let a=0,u;a<s.length;a++)u=s[a],r[u]&&(n[u]||(n[u]=1,o[o.length]=u))}return o}function Ni(e){this.limit=e!==!0&&e,this.cache=J(),this.queue=[]}var Ci=Ni;function Ri(e,t,r){He(e)&&(e=e.query);let n=this.cache.get(e);return n||(n=this.search(e,t,r),this.cache.set(e,n)),n}Ni.prototype.set=function(e,t){if(!this.cache[e]){let r=this.queue.length;r===this.limit?delete this.cache[this.queue[r-1]]:r++;for(let n=r-1;n>0;n--)this.queue[n]=this.queue[n-1];this.queue[0]=e}this.cache[e]=t};Ni.prototype.get=function(e){let t=this.cache[e];if(this.limit&&t){let r=this.queue.indexOf(e);if(r){let n=this.queue[r-1];this.queue[r-1]=this.queue[r],this.queue[r]=n}}return t};Ni.prototype.del=function(e){for(let t=0,r,n;t<this.queue.length;t++)n=this.queue[t],r=this.cache[n],r.includes(e)&&(this.queue.splice(t--,1),delete this.cache[n])};var Rh={memory:{charset:"latin:extra",resolution:3,minlength:4,fastupdate:!1},performance:{resolution:3,minlength:3,optimize:!1,context:{depth:2,resolution:1}},match:{charset:"latin:extra",tokenize:"reverse"},score:{charset:"latin:advanced",resolution:20,minlength:3,context:{depth:3,resolution:9}},default:{}};function za(e){if(fe(e))!1&&!Rh[e]&&console.warn("Preset not found: "+e),e=Rh[e];else{let t=e.preset;t&&(!1&&!t[t]&&console.warn("Preset not found: "+t),e=Object.assign({},t[t],e))}return e}function Fh(e,t,r,n,o,i,s){setTimeout(function(){let a=e(r?r+"."+n:n,JSON.stringify(s));a&&a.then?a.then(function(){t.export(e,t,r,o,i+1)}):t.export(e,t,r,o,i+1)})}function Ah(e,t,r,n,o){let i,s;switch(o||(o=0)){case 0:if(i="reg",this.fastupdate){s=J();for(let a in this.register)s[a]=1}else s=this.register;break;case 1:i="cfg",s={doc:0,opt:this.optimize?1:0};break;case 2:i="map",s=this.map;break;case 3:i="ctx",s=this.ctx;break;default:return}return Fh(e,t||this,r,i,n,o,s),!0}function Ph(e,t){if(t)switch(fe(t)&&(t=JSON.parse(t)),e){case"cfg":this.optimize=!!t.opt;break;case"reg":this.fastupdate=!1,this.register=t;break;case"map":this.map=t;break;case"ctx":this.ctx=t;break}}function $h(e,t,r,n,o){if(o||(o=0),n||(n=0),n<this.field.length){let i=this.field[n],s=this.index[i];t=this,setTimeout(function(){s.export(e,t,o?i:"",n,o++)||(n++,o=1,t.export(e,t,i,n,o))})}else{let i,s;switch(o){case 1:i="tag",s=this.tagindex;break;case 2:i="store",s=this.store;break;default:return}Fh(e,this,r,i,n,o,s)}}function kh(e,t){if(t)switch(fe(t)&&(t=JSON.parse(t)),e){case"tag":this.tagindex=t;break;case"reg":this.fastupdate=!1,this.register=t;for(let n=0,o;n<this.field.length;n++)o=this.index[this.field[n]],o.register=t,o.fastupdate=!1;break;case"store":this.store=t;break;default:e=e.split(".");let r=e[0];e=e[1],r&&e&&this.index[r].import(e,t)}}function _e(e,t){if(!(this instanceof _e))return new _e(e);let r,n,o;e?(!0&&(e=za(e)),r=e.charset,n=e.lang,fe(r)&&(r.indexOf(":")===-1&&(r+=":default"),r=Th[r]),fe(n)&&(n=_h[n])):e={};let i,s,a=e.context||{};this.encode=e.encode||r&&r.encode||Ua,this.register=t||J(),this.resolution=i=e.resolution||9,this.tokenize=o=r&&r.tokenize||e.tokenize||"strict",this.depth=o==="strict"&&a.depth,this.bidirectional=Dr(a.bidirectional,!0),this.optimize=s=Dr(e.optimize,!0),this.fastupdate=Dr(e.fastupdate,!0),this.minlength=e.minlength||1,this.boost=e.boost,this.map=s?Ma(i):J(),this.resolution_ctx=i=a.resolution||1,this.ctx=s?Ma(i):J(),this.rtl=r&&r.rtl||e.rtl,this.matcher=(o=e.matcher||n&&n.matcher)&&Ba(o,!1),this.stemmer=(o=e.stemmer||n&&n.stemmer)&&Ba(o,!0),this.filter=(o=e.filter||n&&n.filter)&&Oh(o),!0&&(this.cache=(o=e.cache)&&new Ci(o))}var $i=_e;_e.prototype.append=function(e,t){return this.add(e,t,!0)};_e.prototype.add=function(e,t,r,n){if(t&&(e||e===0)){if(!n&&!r&&this.register[e])return this.update(e,t);t=this.encode(""+t);let o=t.length;if(o){let i=J(),s=J(),a=this.depth,u=this.resolution;for(let m=0;m<o;m++){let f=t[this.rtl?o-1-m:m],d=f.length;if(f&&d>=this.minlength&&(a||!s[f])){let l=Fi(u,o,m),g="";switch(this.tokenize){case"full":if(d>2){for(let w=0;w<d;w++)for(let x=d;x>w;x--)if(x-w>=this.minlength){let S=Fi(u,o,m,d,w);g=f.substring(w,x),this.push_index(s,g,S,e,r)}break}case"reverse":if(d>1){for(let w=d-1;w>0;w--)if(g=f[w]+g,g.length>=this.minlength){let x=Fi(u,o,m,d,w);this.push_index(s,g,x,e,r)}g=""}case"forward":if(d>1){for(let w=0;w<d;w++)g+=f[w],g.length>=this.minlength&&this.push_index(s,g,l,e,r);break}default:if(this.boost&&(l=Math.min(l/this.boost(t,f,m)|0,u-1)),this.push_index(s,f,l,e,r),a&&o>1&&m<o-1){let w=J(),x=this.resolution_ctx,S=f,N=Math.min(a+1,o-m);w[S]=1;for(let q=1;q<N;q++)if(f=t[this.rtl?o-1-m-q:m+q],f&&f.length>=this.minlength&&!w[f]){w[f]=1;let k=Fi(x+(o/2>x?0:1),o,m,N-1,q-1),ee=this.bidirectional&&f>S;this.push_index(i,ee?S:f,k,e,r,ee?f:S)}}}}}this.fastupdate||(this.register[e]=1)}}return this};function Fi(e,t,r,n,o){return r&&e>1?t+(n||0)<=e?r+(o||0):(e-1)/(t+(n||0))*(r+(o||0))+1|0:0}_e.prototype.push_index=function(e,t,r,n,o,i){let s=i?this.ctx:this.map;if((!e[t]||i&&!e[t][i])&&(this.optimize&&(s=s[r]),i?(e=e[t]||(e[t]=J()),e[i]=1,s=s[i]||(s[i]=J())):e[t]=1,s=s[t]||(s[t]=[]),this.optimize||(s=s[r]||(s[r]=[])),(!o||!s.includes(n))&&(s[s.length]=n,this.fastupdate))){let a=this.register[n]||(this.register[n]=[]);a[a.length]=s}};_e.prototype.search=function(e,t,r){r||(!t&&He(e)?(r=e,e=r.query):He(t)&&(r=t));let n=[],o,i,s,a=0;if(r&&(e=r.query||e,t=r.limit,a=r.offset||0,i=r.context,s=!0&&r.suggest),e&&(e=this.encode(""+e),o=e.length,o>1)){let d=J(),l=[];for(let g=0,w=0,x;g<o;g++)if(x=e[g],x&&x.length>=this.minlength&&!d[x]){if(!this.optimize&&!s&&!this.map[x])return n;l[w++]=x,d[x]=1}e=l,o=e.length}if(!o)return n;t||(t=100);let u=this.depth&&o>1&&i!==!1,m=0,f;u?(f=e[0],m=1):o>1&&e.sort(xh);for(let d,l;m<o;m++){if(l=e[m],u?(d=this.add_result(n,s,t,a,o===2,l,f),(!s||d!==!1||!n.length)&&(f=l)):d=this.add_result(n,s,t,a,o===1,l),d)return d;if(s&&m===o-1){let g=n.length;if(g){if(g===1)return jh(n[0],t,a)}else{if(u){u=0,m=-1;continue}return n}}}return Ti(n,t,a,s)};_e.prototype.add_result=function(e,t,r,n,o,i,s){let a=[],u=s?this.ctx:this.map;if(this.optimize||(u=qh(u,i,s,this.bidirectional)),u){let m=0,f=Math.min(u.length,s?this.resolution_ctx:this.resolution);for(let d=0,l=0,g,w;d<f&&(g=u[d],!(g&&(this.optimize&&(g=qh(g,i,s,this.bidirectional)),n&&g&&o&&(w=g.length,w<=n?(n-=w,g=null):(g=g.slice(n),n=0)),g&&(a[m++]=g,o&&(l+=g.length,l>=r)))));d++);if(m){if(o)return jh(a,r,0);e[e.length]=a;return}}return!t&&a};function jh(e,t,r){return e.length===1?e=e[0]:e=wh(e),r||e.length>t?e.slice(r,r+t):e}function qh(e,t,r,n){if(r){let o=n&&t>r;e=e[o?t:r],e=e&&e[o?r:t]}else e=e[t];return e}_e.prototype.contain=function(e){return!!this.register[e]};_e.prototype.update=function(e,t){return this.remove(e).add(e,t)};_e.prototype.remove=function(e,t){let r=this.register[e];if(r){if(this.fastupdate)for(let n=0,o;n<r.length;n++)o=r[n],o.splice(o.indexOf(e),1);else Ai(this.map,e,this.resolution,this.optimize),this.depth&&Ai(this.ctx,e,this.resolution_ctx,this.optimize);t||delete this.register[e],!0&&this.cache&&this.cache.del(e)}return this};function Ai(e,t,r,n,o){let i=0;if(Xt(e))if(o){let s=e.indexOf(t);s!==-1?e.length>1&&(e.splice(s,1),i++):i++}else{o=Math.min(e.length,r);for(let s=0,a;s<o;s++)a=e[s],a&&(i=Ai(a,t,r,n,o),!n&&!i&&delete e[s])}else for(let s in e)i=Ai(e[s],t,r,n,o),i||delete e[s];return i}!0&&(_e.prototype.searchCache=Ri);!0&&(_e.prototype.export=Ah,_e.prototype.import=Ph);!0&&_i(_e.prototype);function Mh(e){e=e.data;let t=self._index,r=e.args,n=e.task;switch(n){case"init":let o=e.options||{},i=e.factory,s=o.encode;o.cache=!1,s&&s.indexOf("function")===0&&(o.encode=Function("return "+s)()),i?(Function("return "+i)()(self),self._index=new self.FlexSearch.Index(o),delete self.FlexSearch):self._index=new $i(o);break;default:let a=e.id,u=t[n].apply(t,r);postMessage(n==="search"?{id:a,msg:u}:{id:a})}}var Lh=0;function Un(e){if(!(this instanceof Un))return new Un(e);let t;e?Ln(t=e.encode)&&(e.encode=t.toString()):e={};let r=(self||window)._factory;r&&(r=r.toString());let n=typeof window>"u"&&self.exports,o=this;this.worker=FI(r,n,e.worker),this.resolver=J(),this.worker&&(n?this.worker.on("message",function(i){o.resolver[i.id](i.msg),delete o.resolver[i.id]}):this.worker.onmessage=function(i){i=i.data,o.resolver[i.id](i.msg),delete o.resolver[i.id]},this.worker.postMessage({task:"init",factory:r,options:e}))}var Bh=Un;zn("add");zn("append");zn("search");zn("update");zn("remove");function zn(e){Un.prototype[e]=Un.prototype[e+"Async"]=function(){let t=this,r=[].slice.call(arguments),n=r[r.length-1],o;Ln(n)&&(o=n,r.splice(r.length-1,1));let i=new Promise(function(s){setTimeout(function(){t.resolver[++Lh]=s,t.worker.postMessage({task:e,id:Lh,args:r})})});return o?(i.then(o),this):i}}function FI(factory,is_node_js,worker_path){let worker;try{worker=is_node_js?eval(\'new (require("worker_threads")["Worker"])("../dist/node/node.js")\'):factory?new Worker(URL.createObjectURL(new Blob(["onmessage="+Mh.toString()],{type:"text/javascript"}))):new Worker(fe(worker_path)?worker_path:"worker/worker.js",{type:"module"})}catch(e){}return worker}function Te(e){if(!(this instanceof Te))return new Te(e);let t=e.document||e.doc||e,r;this.tree=[],this.field=[],this.marker=[],this.register=J(),this.key=(r=t.key||t.id)&&ki(r,this.marker)||"id",this.fastupdate=Dr(e.fastupdate,!0),!0&&(this.storetree=(r=t.store)&&r!==!0&&[],this.store=r&&J()),!0&&(this.tag=(r=t.tag)&&ki(r,this.marker),this.tagindex=r&&J()),!0&&(this.cache=(r=e.cache)&&new Ci(r),e.cache=!1),!0&&(this.worker=e.worker),!0&&(this.async=!1),this.index=AI.call(this,e,t)}var zh=Te;function AI(e,t){let r=J(),n=t.index||t.field||t;fe(n)&&(n=[n]);for(let o=0,i,s;o<n.length;o++)i=n[o],fe(i)||(s=i,i=i.field),s=He(s)?Object.assign({},e,s):e,!0&&this.worker&&(r[i]=new Bh(s),r[i].worker||(this.worker=!1)),this.worker||(r[i]=new $i(s,this.register)),this.tree[o]=ki(i,this.marker),this.field[o]=i;if(!0&&this.storetree){let o=t.store;fe(o)&&(o=[o]);for(let i=0;i<o.length;i++)this.storetree[i]=ki(o[i],this.marker)}return r}function ki(e,t){let r=e.split(":"),n=0;for(let o=0;o<r.length;o++)e=r[o],e.indexOf("[]")>=0&&(e=e.substring(0,e.length-2),e&&(t[n]=!0)),e&&(r[n++]=e);return n<r.length&&(r.length=n),n>1?r:r[0]}function Ka(e,t){if(fe(t))e=e[t];else for(let r=0;e&&r<t.length;r++)e=e[t[r]];return e}function Ga(e,t,r,n,o){if(e=e[o],n===r.length-1)t[o]=e;else if(e)if(Xt(e)){t=t[o]=new Array(e.length);for(let i=0;i<e.length;i++)Ga(e,t,r,n,i)}else t=t[o]||(t[o]=J()),o=r[++n],Ga(e,t,r,n,o)}function Ja(e,t,r,n,o,i,s,a){if(e=e[s],e)if(n===t.length-1){if(Xt(e)){if(r[n]){for(let u=0;u<e.length;u++)o.add(i,e[u],!0,!0);return}e=e.join(" ")}o.add(i,e,a,!0)}else if(Xt(e))for(let u=0;u<e.length;u++)Ja(e,t,r,n,o,i,u,a);else s=t[++n],Ja(e,t,r,n,o,i,s,a)}Te.prototype.add=function(e,t,r){if(He(e)&&(t=e,e=Ka(t,this.key)),t&&(e||e===0)){if(!r&&this.register[e])return this.update(e,t);for(let n=0,o,i;n<this.field.length;n++)i=this.field[n],o=this.tree[n],fe(o)&&(o=[o]),Ja(t,o,this.marker,0,this.index[i],e,o[0],r);if(!0&&this.tag){let n=Ka(t,this.tag),o=J();fe(n)&&(n=[n]);for(let i=0,s,a;i<n.length;i++)if(s=n[i],!o[s]&&(o[s]=1,a=this.tagindex[s]||(this.tagindex[s]=[]),(!r||!a.includes(e))&&(a[a.length]=e,this.fastupdate))){let u=this.register[e]||(this.register[e]=[]);u[u.length]=a}}if(!0&&this.store&&(!r||!this.store[e])){let n;if(this.storetree){n=J();for(let o=0,i;o<this.storetree.length;o++)i=this.storetree[o],fe(i)?n[i]=t[i]:Ga(t,n,i,0,i[0])}this.store[e]=n||t}}return this};Te.prototype.append=function(e,t){return this.add(e,t,!0)};Te.prototype.update=function(e,t){return this.remove(e).add(e,t)};Te.prototype.remove=function(e){if(He(e)&&(e=Ka(e,this.key)),this.register[e]){for(let t=0;t<this.field.length&&(this.index[this.field[t]].remove(e,!this.worker),!this.fastupdate);t++);if(!0&&this.tag&&!this.fastupdate)for(let t in this.tagindex){let r=this.tagindex[t],n=r.indexOf(e);n!==-1&&(r.length>1?r.splice(n,1):delete this.tagindex[t])}!0&&this.store&&delete this.store[e],delete this.register[e]}return this};Te.prototype.search=function(e,t,r,n){r||(!t&&He(e)?(r=e,e=""):He(t)&&(r=t,t=0));let o=[],i=[],s,a,u,m,f,d,l=0;if(r)if(Xt(r))u=r,r=null;else{if(e=r.query||e,s=r.pluck,u=s||r.index||r.field,m=!0&&r.tag,a=!0&&this.store&&r.enrich,f=r.bool==="and",t=r.limit||t||100,d=r.offset||0,m&&(fe(m)&&(m=[m]),!e)){for(let w=0,x;w<m.length;w++)x=PI.call(this,m[w],t,d,a),x&&(o[o.length]=x,l++);return l?o:[]}fe(u)&&(u=[u])}u||(u=this.field),f=f&&(u.length>1||m&&m.length>1);let g=!n&&(this.worker||this.async)&&[];for(let w=0,x,S,N;w<u.length;w++){let q;if(S=u[w],fe(S)||(q=S,S=q.field,e=q.query||e,t=q.limit||t),g){g[w]=this.index[S].searchAsync(e,t,q||r);continue}else n?x=n[w]:x=this.index[S].search(e,t,q||r);if(N=x&&x.length,m&&N){let k=[],ee=0;f&&(k[0]=[x]);for(let xe=0,R,B;xe<m.length;xe++)R=m[xe],B=this.tagindex[R],N=B&&B.length,N&&(ee++,k[k.length]=f?[B]:B);ee&&(f?x=Ti(k,t||100,d||0):x=Nh(x,k),N=x.length)}if(N)i[l]=S,o[l++]=x;else if(f)return[]}if(g){let w=this;return new Promise(function(x){Promise.all(g).then(function(S){x(w.search(e,t,r,S))})})}if(!l)return[];if(s&&(!a||!this.store))return o[0];for(let w=0,x;w<i.length;w++){if(x=o[w],x.length&&a&&(x=Wh.call(this,x)),s)return x;o[w]={field:i[w],result:x}}return o};function PI(e,t,r,n){let o=this.tagindex[e],i=o&&o.length-r;if(i&&i>0)return(i>t||r)&&(o=o.slice(r,r+t)),n&&(o=Wh.call(this,o)),{tag:e,result:o}}function Wh(e){let t=new Array(e.length);for(let r=0,n;r<e.length;r++)n=e[r],t[r]={id:n,doc:this.store[n]};return t}Te.prototype.contain=function(e){return!!this.register[e]};!0&&(Te.prototype.get=function(e){return this.store[e]},Te.prototype.set=function(e,t){return this.store[e]=t,this});!0&&(Te.prototype.searchCache=Ri);!0&&(Te.prototype.export=$h,Te.prototype.import=kh);!0&&_i(Te.prototype);var $I=["a","about","above","after","again","against","all","also","am","an","and","any","are","aren\'t","as","at","be","because","been","before","being","below","both","but","by","can","cannot","can\'t","come","could","couldn\'t","did","didn\'t","do","does","doesn\'t","doing","dont","down","during","each","even","few","first","for","from","further","get","go","had","hadn\'t","has","hasn\'t","have","haven\'t","having","he","hed","her","here","here\'s","hers","herself","hes","him","himself","his","how","how\'s","i","id","if","ill","im","in","into","is","isn\'t","it","it\'s","itself","i\'ve","just","know","let\'s","like","make","me","more","most","mustn\'t","my","myself","new","no","nor","not","now","of","off","on","once","only","or","other","ought","our","our\'s","ourselves","out","over","own","same","say","see","shan\'t","she","she\'d","shell","shes","should","shouldn\'t","so","some","such","than","that","that\'s","the","their","theirs","them","themselves","then","there","there\'s","these","they","they\'d","they\'ll","they\'re","they\'ve","this","those","through","time","to","too","until","up","us","very","want","was","wasn\'t","way","we","wed","well","were","weren\'t","we\'ve","what","what\'s","when","when\'s","where","where\'s","which","while","who","whom","who\'s","why","why\'s","will","with","won\'t","would","wouldn\'t","you","you\'d","you\'ll","your","you\'re","your\'s","yourself","yourselves","you\'ve"],kI={ational:"ate",iveness:"ive",fulness:"ful",ousness:"ous",ization:"ize",tional:"tion",biliti:"ble",icate:"ic",ative:"",alize:"al",iciti:"ic",entli:"ent",ousli:"ous",alism:"al",ation:"ate",aliti:"al",iviti:"ive",ement:"",enci:"ence",anci:"ance",izer:"ize",alli:"al",ator:"ate",logi:"log",ical:"ic",ance:"",ence:"",ness:"",able:"",ible:"",ment:"",eli:"e",bli:"ble",ful:"",ant:"",ent:"",ism:"",ate:"",iti:"",ous:"",ive:"",ize:"",al:"",ou:"",er:"",ic:""},qI={},Kh={filter:$I,stemmer:kI,matcher:qI};function Gh(){let e,t,r=new Promise((n,o)=>{e=n,t=o});return{resolve:e,reject:t,promise:r}}var Wn=class{#e=Nr;readCitekeys(t){if(he.debug("Reading Better BibTex database"),!this.#e.bbt.opened)return he.info("Better BibTex database not enabled, skipping..."),[];let r=this.#e.bbt.prepare(en).query({items:t});return he.info("Finished reading Better BibTex"),r}toItemObjects(t,r){let n=this.readCitekeys(r),o=this.#e.zotero.prepare(nn).query(r),i=this.#e.zotero.prepare(rn).query(r),s=vh(r.flatMap(([u])=>t[u]?.collectionIDs?.map(m=>`${m}-${t[u].libraryID}`)??[])).filter(u=>u!==null),a=this.#e.zotero.prepare(fn).query(s.map(u=>u.split("-").map(m=>+m)));return r.reduce((u,[m,f])=>{if(!m)return u;let d=n[m];d||he.warn(`Citekey: No item found for itemID ${m}`,d);let l=o[m].reduce((N,q)=>{let{value:k}=q;return q.fieldName==="date"&&(k=Xc(k).split("-")[0]),(N[q.fieldName]??=[]).push(k),N},{}),{collectionIDs:g,...w}=t[m],x=g.map(N=>a.get(N)).filter(N=>N!==void 0),S={...w,libraryID:f,groupID:this.#e.groupOf(f),itemID:m,creators:i[m],collections:x,citekey:n[m],...l,dateAccessed:jI(l)?MI(l.accessDate[0]):null};return u[m]=S,u},{})}};function jI(e){let t=e;return Array.isArray(t.accessDate)&&t.accessDate.length===1&&typeof t.accessDate[0]=="string"}function MI(e){let t=e.replace(" ","T")+"Z";try{return new Date(t)}catch{return null}}var Kn=class{#e=Nr;#t=new Wn;#r=new zh({worker:!0,charset:Dh,language:Kh,document:{id:"itemID",index:["title","creators[]:firstName","creators[]:lastName","date"]},tokenize:"full",suggest:!0});#o=new Map;#n=new Map;getStatus(t){if(!this.#n.has(t)){let n=Gh();return this.#n.set(t,n),n.promise}let r=this.#n.get(t);return r instanceof Promise||typeof r=="string"?r:r.promise}load(t){let r=this.#n.get(t);if(r instanceof Promise)return r;let n=this.#a(t),o=this.#u(t,n).then(()=>{this.#n.set(t,"READY")}).catch(i=>{throw this.#n.set(t,"ERROR"),i});return typeof r=="string"||!r||o.then(r.resolve,r.reject),this.#n.set(t,o),o}async searchItems(t,r){return await this.#i(t),await this.#r.searchAsync(r)}async getCachedItems(t,r){await this.#i(r);let n=this.#o.get(r);if(!n)throw new Error("Cache not initialized");let o=[...n.byId.values()].sort((i,s)=>s.dateAccessed&&i.dateAccessed?s.dateAccessed.getTime()-i.dateAccessed.getTime():0);return t<=0?o:o.slice(0,t)}async getItemsCache(t){await this.#i(t);let r=this.#o.get(t);if(!r)throw new Error("Cache not initialized");return r}async#i(t){let r=this.getStatus(t);if(r==="ERROR")throw new Error("Indexing failed");r instanceof Promise&&await r}#a(t){he.debug("Reading main Zotero database for index");let{zotero:r}=this.#e,n=this.#s(r.prepare(sn).query({libId:t}));return he.info("Finished reading main Zotero database for index"),n}readItemByKey(t){let{zotero:r}=this.#e,n=r.prepare(un).query(t);return this.#s(t.map(([i])=>n[i]))}readItemById(t){let{zotero:r}=this.#e,n=r.prepare(an).query(t);return this.#s(t.map(([i])=>n[i]))}#s(t){let r=t.reduce((o,i)=>(o[i.itemID]=i,o),{}),n=t.map(o=>[o.itemID,o.libraryID]);return this.#t.toItemObjects(r,n)}async#u(t,r){he.trace("Start flexsearch indexing");let n=Object.values(r),o=this.#o.get(t);if(this.#o.set(t,{byId:new Map(n.map(i=>[i.itemID,i])),byKey:new Map(n.map(i=>[ks(i,!0),i]))}),!o)await Promise.all([...n.map(i=>this.#r.addAsync(i.itemID,i))]);else{let i=new Set(n.map(a=>a.itemID)),s=[...o.byId.keys()].filter(a=>!i.has(a));o.byId.clear(),o.byKey.clear(),await Promise.all([...n.map(a=>this.#r.addAsync(a.itemID,a)),...s.map(a=>this.#r.removeAsync(a))])}he.info("Library citation index done: "+t)}async updateIndex(t){await Promise.all(Object.values(t).map(async r=>{let n=this.#o.get(r.libraryID);if(!n)throw new Error("Cannot update index for library not initialized");n.byId.set(r.itemID,r),n.byKey.set(ks(r,!0),r),await this.#r.updateAsync(r.itemID,r)}))}};var Nr=new qn,Di=new Kn,Jh=new jn;function er(e,t){return(...r)=>{he.debug(`Reading Zotero database for ${typeof t=="string"?t:t(null,...r)}`);let n=e.apply(null,r);return Promise.resolve(n).then(o=>he.debug(`Finished reading Zotero database for ${typeof t=="string"?t:t(o,...r)}`)),n}}var Va=class{#e=Nr;#t=Di;#r=Jh;api={getLibs:()=>this.#e.libraries,initIndex:async t=>{await this.#t.load(t)},openDb:(...t)=>this.#e.load(...t),search:async(t,r)=>await this.#t.searchItems(t,r),getItems:async(t,r)=>await this.#r.get(t,r),getTags:er(t=>this.#e.zotero.prepare(pn).query(t),"tags"),getItemIDsFromCitekey:t=>this.#e.bbt.prepare(tn).query({citekeys:t}),getItemsFromCache:(t,r)=>this.#t.getCachedItems(t,r),getAttachments:er((t,r)=>this.#e.zotero.prepare(Xr).query({itemId:t,libId:r}),(t,r)=>`attachments of item ${r}`+(t?`, count: ${t.length}`:"")),getAnnotations:er((t,r)=>this.#e.zotero.prepare(Yr).query({attachmentId:t,libId:r,groupID:this.#e.groupOf(r)}),(t,r)=>`annotations of attachment ${r}`+(t?`, count: ${t.length}`:"")),getAnnotFromKey:er((t,r)=>this.#e.zotero.prepare(Hr).query({annotKeys:t,libId:r,groupID:this.#e.groupOf(r)}),(t,r)=>`annotations with keys: ${r.join(",")}`+(t?`, count: ${t.length}`:"")),getNotes:er((t,r)=>this.#e.zotero.prepare(Qr).query({itemID:t,libId:r,groupID:this.#e.groupOf(r)}),(t,r)=>`notes of literature ${r}`+(t?`, count: ${t.length}`:"")),getNoteFromKey:er((t,r)=>this.#e.zotero.prepare(Zr).query({noteKeys:t,libId:r,groupID:this.#e.groupOf(r)}),(t,r)=>`notes with keys: ${r.join(",")}`+(t?`, count: ${t.length}`:"")),isUpToDate:()=>this.#e.zotero.isUpToDate(),checkDbStatus:t=>this.#e.checkDbStatus(t),raw:(t,r,n)=>{let{zotero:{instance:o}}=this.#e;if(!o)throw new Error("failed to query raw: no main database opened");return o.prepare(r)[t](...n)},setLoglevel:t=>{he.level=t,Vh.default.setItem(Aa,t)}};toAPI(){return nf(this.api)}},LI=new Va;new Vr(LI.toAPI());\n/*! Bundled license information:\n\nlocalforage/dist/localforage.js:\n  (*!\n      localForage -- Offline Storage, Improved\n      Version 1.10.0\n      https://localforage.github.io/localForage\n      (c) 2013-2017 Mozilla, Apache License 2.0\n  *)\n\nflatted/cjs/index.js:\n  (*! (c) 2020 Andrea Giammarchi *)\n*/\n';var xh=class extends bi{initWebWorker(){return w1(t_,{name:"zotlit database worker"})}},ol=class extends vi{workerCtor(){return new xh}};var Rt=class extends ue{settings=this.use(de);app=this.use(Tn.App);plugin=this.use(be);server=this.use(Ur);get zoteroDataDir(){return this.settings.current?.zoteroDataDir}onload(){W.debug("loading DatabaseWorker"),this.settings.once(async()=>{let t=(0,Tn.debounce)(()=>this.refresh({task:"dbConn"}),500,!0);this.registerEvent(this.app.vault.on("zotero:db-updated",()=>t()));let r=process.hrtime();await this.initialize(),W.debug(`ZoteroDB Initialization complete. Took ${(0,r_.default)(process.hrtime(r))}`);let n=this.genAutoRefresh(this.plugin);this.registerEvent(this.server.on("bg:notify",async(o,i)=>{i.event==="regular-item/update"&&n(i)})),this.plugin.addCommand({id:"refresh-zotero-data",name:"Refresh Zotero data",callback:async()=>{await this.refresh({task:"full"})}}),this.plugin.addCommand({id:"refresh-zotero-search-index",name:"Refresh Zotero search index",callback:async()=>{await this.refresh({task:"searchIndex"})}})}),this.register(Le(Qe(async()=>{this.status===0?await this.initialize():await this.refresh({task:"full"})},()=>this.zoteroDataDir))),this.register(Le(Qe(async()=>{await this.refresh({task:"searchIndex",force:!0}),new Tn.Notice("Zotero search index updated.")},()=>this.settings.libId,!0)))}genAutoRefresh(t){let r=!1,n=null,o=()=>{n&&(W.debug("unregistering db refresh watcher"),n(),n=null)},i=(0,Tn.debounce)(async()=>{if(o(),W.debug("Auto Refreshing Zotero Search Index"),!r){r=!1;try{W.debug("Db not refreshed, waiting before auto refresh");let[s]=Rm(t.app,{timeout:1e4});await s}catch(s){if(s instanceof Ms){W.warn("no db refreshed event received in 10s, skip refresh search index");return}else{console.error("error while waiting for db refresh during execute",s);return}}}await this.refresh({task:"searchIndex",force:!0}),W.debug("Auto Refreshing Zotero Search Index Success")},5e3,!0);return s=>{if(W.debug(`Request to auto refresh search index: (refreshed ${r})`,s),i(),o(),r)return;W.debug("watching db refresh while waiting for search index auto refresh");let[a,u]=Rm(t.app,{timeout:null});n=u,a.then(()=>{W.debug("db refresh while requesting auto refresh search index"),r=!0,n=null}).catch(l=>{l instanceof js||console.error("error while waiting for db refresh during request",l)})}}async onunload(){await this.#e.terminate(),this.#t=0,this.#o=null}#e=new ol({minWorkers:1,maxWorkers:1});get api(){return this.#e.proxy}#t=0;get status(){return this.#t}#r=null;async#n(t){let r=this.settings.libId;return!t&&this.#r===r?(W.debug(`Skipping search index init, lib ${r} already indexed`),!1):(await this.api.initIndex(r),this.#r=r,W.debug(`Search index init complete for lib ${r}`),!0)}async#i(){let[t,r]=this.settings.dbConnParams,[n,o]=await this.api.openDb(t,r);if(o||W.debug("Failed to open Better BibTeX database, skipping..."),!n)throw new Error("Failed to init ZoteroDB")}async initialize(){if(this.#t!==0)throw new Error("Calling init on already initialized db, use refresh instead");await this.#i(),this.app.vault.trigger("zotero:db-ready"),await this.#n(!0),this.app.metadataCache.trigger("zotero:search-ready"),W.info("ZoteroDB Initialization complete."),this.#t=2}#s=null;#o=null;refresh(t){if(this.#t===0)return Promise.reject(new Error("Calling refresh on uninitialized database"));if(this.#t===2){this.#t=1;let r=(async()=>{t.task==="dbConn"?await this.#a():t.task==="searchIndex"?await this.#u(t.force):t.task==="full"?await this.#c():(0,wh.assertNever)(t),this.#t=2;let n=this.#o;n&&(this.#o=null,await this.refresh(n))})();return this.#s=r}else{if(this.#t===1)return this.#s?(this.#o=this.#l(t),this.#s):Promise.reject(new Error("Other task in pending state"));(0,wh.assertNever)(this.#t)}}async#a(){await this.#i(),this.app.vault.trigger("zotero:db-refresh")}async#u(t=!1){await this.#n(t)&&this.app.metadataCache.trigger("zotero:search-refresh")}async#c(){await this.#a(),await this.#u(!0),new Tn.Notice("ZoteroDB Refresh complete.")}#l(t){if(!this.#o)return t;let r=this.#o;return r.task==="full"?r:r.task===t.task?r.task==="searchIndex"?{...r,force:r.force||t.force}:r:{task:"full"}}};fe([pe],Rt.prototype,"zoteroDataDir",1);var n_="INFO",o_="log4js_loglevel",Tz=()=>{let e=localStorage.getItem(o_);return typeof e=="string"&&e in il.levels?(console.debug(`Read from localstorage: loglevel ${e}`),e):n_},Eh=Yv("main",Tz(),il.default),W=Eh,it=(e,t,...r)=>{if(!t){Eh.error(e,...r);return}Eh.error(e,t instanceof Error?t.message:String(t),...r),console.error(t)},m1={logLevel:n_},ra=class extends ue{settings=this.use(de);get level(){return this.settings.current?.logLevel}async applyLogLevel(){localStorage.setItem(o_,this.level),await this.use(Rt).api.setLoglevel(this.level)}onload(){this.register(Le(Qe(()=>this.applyLogLevel(),()=>this.level)))}};fe([pe],ra.prototype,"level",1);var qC=require("fs"),Jr=require("obsidian");S();var ve={},Ii=Symbol(),aC=e=>!!e[Ii],oC=e=>!e[Ii].c,ua=e=>{var t;let{b:r,c:n}=e[Ii];n&&(n(),(t=Vz.get(r))==null||t())},ml=(e,t)=>{let r=e[Ii].o,n=t[Ii].o;return r===n||e===n||aC(r)&&ml(r,t)},iC=(e,t)=>{let r={b:e,o:t,c:null},n=new Promise(o=>{r.c=()=>{r.c=null,o()},t.finally(r.c)});return n[Ii]=r,n},Vz=new WeakMap;var dl=e=>"init"in e,Mh="r",jh="w",ca="c",qh="s",sC="h",Gz="n",Jz="l",Zz="a",Yz="m",Xz=e=>{let t=new WeakMap,r=new WeakMap,n=new Map,o,i;if((ve.env&&ve.env.MODE)!=="production"&&(o=new Set,i=new Set),e)for(let[E,x]of e){let O={v:x,r:0,y:!0,d:new Map};(ve.env&&ve.env.MODE)!=="production"&&(Object.freeze(O),dl(E)||console.warn("Found initial value for derived atom which can cause unexpected behavior",E)),t.set(E,O)}let s=new WeakMap,a=(E,x,O)=>{let k=s.get(x);k||(k=new Map,s.set(x,k)),O.then(()=>{k.get(E)===O&&(k.delete(E),k.size||s.delete(x))}),k.set(E,O)},u=E=>{let x=new Set,O=s.get(E);return O&&(s.delete(E),O.forEach((k,A)=>{ua(k),x.add(A)})),x},l=new WeakMap,c=E=>{let x=l.get(E);return x||(x=new Map,l.set(E,x)),x},f=(E,x)=>{if(E){let O=c(E),k=O.get(x);return k||(k=f(E.p,x),k&&"p"in k&&oC(k.p)&&(k=void 0),k&&O.set(x,k)),k}return t.get(x)},p=(E,x,O)=>{if((ve.env&&ve.env.MODE)!=="production"&&Object.freeze(O),E)c(E).set(x,O);else{let k=t.get(x);t.set(x,O),n.has(x)||n.set(x,k)}},d=(E,x=new Map,O)=>{if(!O)return x;let k=new Map,A=!1;return O.forEach(N=>{var z;let te=((z=f(E,N))==null?void 0:z.r)||0;k.set(N,te),x.get(N)!==te&&(A=!0)}),x.size===k.size&&!A?x:k},h=(E,x,O,k,A)=>{let N=f(E,x);if(N){if(A&&(!("p"in N)||!ml(N.p,A)))return N;"p"in N&&ua(N.p)}let z={v:O,r:N?.r||0,y:!0,d:d(E,N?.d,k)},te=!N?.y;return!N||!("v"in N)||!Object.is(N.v,O)?(te=!0,++z.r,z.d.has(x)&&(z.d=new Map(z.d).set(x,z.r))):z.d!==N.d&&(z.d.size!==N.d.size||!Array.from(z.d.keys()).every(vr=>N.d.has(vr)))&&(te=!0,Promise.resolve().then(()=>{D(E)})),N&&!te?N:(p(E,x,z),z)},b=(E,x,O,k,A)=>{let N=f(E,x);if(N){if(A&&(!("p"in N)||!ml(N.p,A)))return N;"p"in N&&ua(N.p)}let z={e:O,r:(N?.r||0)+1,y:!0,d:d(E,N?.d,k)};return p(E,x,z),z},y=(E,x,O,k)=>{let A=f(E,x);if(A&&"p"in A){if(ml(A.p,O))return A.y?A:{...A,y:!0};ua(A.p)}a(E,x,O);let N={p:O,r:(A?.r||0)+1,y:!0,d:d(E,A?.d,k)};return p(E,x,N),N},v=(E,x,O,k)=>{if(O instanceof Promise){let A=iC(O,O.then(N=>{h(E,x,N,k,A)}).catch(N=>{if(N instanceof Promise)return aC(N)?N.then(()=>{T(E,x,!0)}):N;b(E,x,N,k,A)}));return y(E,x,A,k)}return h(E,x,O,k)},w=(E,x)=>{let O=f(E,x);if(O){let k={...O,y:!1};p(E,x,k)}else(ve.env&&ve.env.MODE)!=="production"&&console.warn("[Bug] could not invalidate non existing atom",x)},T=(E,x,O)=>{if(!O){let A=f(E,x);if(A){if(A.y&&"p"in A&&!oC(A.p))return A;if(A.d.forEach((N,z)=>{if(z!==x)if(!r.has(z))T(E,z);else{let te=f(E,z);te&&!te.y&&T(E,z)}}),Array.from(A.d).every(([N,z])=>{let te=f(E,N);return te&&!("p"in te)&&te.r===z}))return A.y?A:{...A,y:!0}}}let k=new Set;try{let A=x.read(N=>{k.add(N);let z=N===x?f(E,N):T(E,N);if(z){if("e"in z)throw z.e;if("p"in z)throw z.p;return z.v}if(dl(N))return N.init;throw new Error("no atom init")});return v(E,x,A,k)}catch(A){if(A instanceof Promise){let N=iC(A,A);return y(E,x,N,k)}return b(E,x,A,k)}},M=(E,x)=>T(x,E),V=(E,x)=>{let O=r.get(x);return O||(O=_(E,x)),O},J=(E,x)=>!x.l.size&&(!x.t.size||x.t.size===1&&x.t.has(E)),G=(E,x)=>{let O=r.get(x);O&&J(x,O)&&I(E,x)},K=(E,x)=>{let O=r.get(x);O?.t.forEach(k=>{k!==x&&(w(E,k),K(E,k))})},P=(E,x,O)=>{let k=!0,A=(te,vr)=>{let sr=T(E,te);if("e"in sr)throw sr.e;if("p"in sr){if(vr?.unstable_promise)return sr.p.then(()=>{let Ru=f(E,te);return Ru&&"p"in Ru&&Ru.p===sr.p?new Promise(xd=>setTimeout(xd)).then(()=>A(te,vr)):A(te,vr)});throw(ve.env&&ve.env.MODE)!=="production"&&console.info("Reading pending atom state in write operation. We throw a promise for now.",te),sr.p}if("v"in sr)return sr.v;throw(ve.env&&ve.env.MODE)!=="production"&&console.warn("[Bug] no value found while reading atom in write operation. This is probably a bug.",te),new Error("no value found")},N=(te,vr)=>{let sr;if(te===x){if(!dl(te))throw new Error("atom not writable");u(te).forEach(Cv=>{Cv!==E&&v(Cv,te,vr)});let xd=f(E,te),fj=v(E,te,vr);xd!==fj&&K(E,te)}else sr=P(E,te,vr);return k||D(E),sr},z=x.write(A,N,O);return k=!1,z},X=(E,x,O)=>{let k=P(O,E,x);return D(O),k},C=E=>!!E.write,_=(E,x,O)=>{let k={t:new Set(O&&[O]),l:new Set};if(r.set(x,k),(ve.env&&ve.env.MODE)!=="production"&&i.add(x),T(void 0,x).d.forEach((N,z)=>{let te=r.get(z);te?te.t.add(x):z!==x&&_(E,z,x)}),C(x)&&x.onMount){let N=te=>X(x,te,E),z=x.onMount(N);E=void 0,z&&(k.u=z)}return k},I=(E,x)=>{var O;let k=(O=r.get(x))==null?void 0:O.u;k&&k(),r.delete(x),(ve.env&&ve.env.MODE)!=="production"&&i.delete(x);let A=f(E,x);A?("p"in A&&ua(A.p),A.d.forEach((N,z)=>{if(z!==x){let te=r.get(z);te&&(te.t.delete(x),J(z,te)&&I(E,z))}})):(ve.env&&ve.env.MODE)!=="production"&&console.warn("[Bug] could not find atom state to unmount",x)},B=(E,x,O,k)=>{let A=new Set(O.d.keys());k?.forEach((N,z)=>{if(A.has(z)){A.delete(z);return}let te=r.get(z);te&&(te.t.delete(x),J(z,te)&&I(E,z))}),A.forEach(N=>{let z=r.get(N);z?z.t.add(x):r.has(x)&&_(E,N,x)})},D=E=>{if(E){c(E).forEach((O,k)=>{let A=t.get(k);if(O!==A){let N=r.get(k);N?.l.forEach(z=>z(E))}});return}for(;n.size;){let x=Array.from(n);n.clear(),x.forEach(([O,k])=>{let A=f(void 0,O);if(A&&A.d!==k?.d&&B(void 0,O,A,k?.d),k&&!k.y&&A?.y)return;let N=r.get(O);N?.l.forEach(z=>z())})}(ve.env&&ve.env.MODE)!=="production"&&o.forEach(x=>x())},re=E=>{c(E).forEach((O,k)=>{let A=t.get(k);(!A||O.r>A.r||O.y!==A.y||O.r===A.r&&O.d!==A.d)&&(t.set(k,O),O.d!==A?.d&&B(E,k,O,A?.d))})},oe=(E,x)=>{x&&re(x),D(void 0)},he=(E,x,O)=>{let A=V(O,E).l;return A.add(x),()=>{A.delete(x),G(O,E)}},ae=(E,x)=>{for(let[O,k]of E)dl(O)&&(v(x,O,k),K(x,O));D(x)};return(ve.env&&ve.env.MODE)!=="production"?{[Mh]:M,[jh]:X,[ca]:oe,[qh]:he,[sC]:ae,[Gz]:E=>(o.add(E),()=>{o.delete(E)}),[Jz]:()=>i.values(),[Zz]:E=>t.get(E),[Yz]:E=>r.get(E)}:{[Mh]:M,[jh]:X,[ca]:oe,[qh]:he,[sC]:ae}};var uC=(e,t)=>({s:t?t(e).SECRET_INTERNAL_store:Xz(e)}),$h=new Map,Lh=e=>($h.has(e)||$h.set(e,qe(uC())),$h.get(e)),cC=({children:e,initialValues:t,scope:r,unstable_createStore:n,unstable_enableVersionedWrite:o})=>{let[i,s]=j({});U(()=>{let l=a.current;l.w&&(l.s[ca](null,i),delete i.p,l.v=i)},[i]);let a=F();if(!a.current){let l=uC(t,n);if(o){let c=0;l.w=f=>{s(p=>{let d=c?p:{p};return f(d),d})},l.v=i,l.r=f=>{++c,f(),--c}}a.current=l}let u=Lh(r);return H(u.Provider,{value:a.current},e)},Qz=0;function Ft(e,t){let r=`atom${++Qz}`,n={toString:()=>r};return typeof e=="function"?n.read=e:(n.init=e,n.read=o=>o(n),n.write=(o,i,s)=>i(n,typeof s=="function"?s(o(n)):s)),t&&(n.write=t),n}function lt(e,t){let r=Lh(t),n=Q(r),{s:o,v:i}=n,s=p=>{let d=o[Mh](e,p);if((ve.env&&ve.env.MODE)!=="production"&&!d.y)throw new Error("should not be invalidated");if("e"in d)throw d.e;if("p"in d)throw d.p;if("v"in d)return d.v;throw new Error("no atom value")},[[a,u,l],c]=Nr((p,d)=>{let h=s(d);return Object.is(p[1],h)&&p[2]===e?p:[d,h,e]},i,p=>{let d=s(p);return[p,d,e]}),f=u;return l!==e&&(c(a),f=s(a)),U(()=>{let{v:p}=n;p&&o[ca](e,p);let d=o[qh](e,c,p);return c(p),d},[o,e,n]),U(()=>{o[ca](e,a)}),yo(f),f}function Bh(e,t){let r=Lh(t),{s:n,w:o}=Q(r);return Y(s=>{if((ve.env&&ve.env.MODE)!=="production"&&!("write"in e))throw new Error("not writable atom");let a=u=>n[jh](e,s,u);return o?o(a):a()},[n,o,e])}var MC=require("obsidian");S();var lC=()=>{let e=[];return{get:()=>e,set:(n,o)=>{e.push([n,o])}}};var Dr=Ft(null),zh=Ft(e=>{let{arch:t,platform:r,modules:n}=e(Dr).platform;return`${r}-${t}-${n}.node.gz`}),la=Ft(e=>`https://github.com/aidenlx/better-sqlite3/releases/download/${e(Dr).binaryVersion}/${e(zh)}`),zfe=Ft(e=>e(la).replace("github.com","download.fastgit.org")),hl=Ft(e=>ai(e(Dr).manifest)),fC=Ft(e=>e(Dr).mode);var FC=me(xn(),1);S();var pC=function(e){return function(t,r){var n=F(!1);e(function(){return function(){n.current=!1}},[]),e(function(){if(!n.current)n.current=!0;else return t()},r)}};function kn(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i}S();var fa=function(e){return typeof e=="function"};var dC=function(e){return typeof e>"u"};var e9=!1,mC=e9;function t9(e){mC&&(fa(e)||console.error("useMemoizedFn expected parameter is a function, got ".concat(typeof e)));var t=F(e);t.current=ne(function(){return e},[e]);var r=F();return r.current||(r.current=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return t.current.apply(this,n)}),r.current}var $t=t9;S();var hC=pC(U);var r9=!!(typeof window<"u"&&window.document&&window.document.createElement),gC=r9;S();function yC(e){function t(r,n){var o;try{o=e()}catch(p){console.error(p)}var i=function(p){return n?.serializer?n?.serializer(p):JSON.stringify(p)},s=function(p){return n?.deserializer?n?.deserializer(p):JSON.parse(p)};function a(){try{var p=o?.getItem(r);if(p)return s(p)}catch(d){console.error(d)}return fa(n?.defaultValue)?n?.defaultValue():n?.defaultValue}var u=kn(j(function(){return a()}),2),l=u[0],c=u[1];hC(function(){c(a())},[r]);var f=function(p){var d=fa(p)?p(l):p;if(c(d),dC(d))o?.removeItem(r);else try{o?.setItem(r,i(d))}catch(h){console.error(h)}};return[l,$t(f)]}return t}var n9=yC(function(){return gC?localStorage:void 0}),Uh=n9;function bC(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=bC(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function Wh(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=bC(e))&&(n&&(n+=" "),n+=t);return n}var _i=Wh;var vC=require("obsidian");S();var St=e=>{let t=F(null);return[Y(n=>{t.current&&t.current.empty(),n&&(0,vC.setIcon)(n,e),t.current=n},[e])]};wi();wi();var o9=0;function m(e,t,r,n,o){var i,s,a={};for(s in t)s=="ref"?i=t[s]:a[s]=t[s];var u={type:e,props:a,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--o9,__source:o,__self:n};if(typeof e=="function"&&(i=e.defaultProps))for(s in i)a[s]===void 0&&(a[s]=i[s]);return L.vnode&&L.vnode(u),u}var pa=({name:e,desc:t,button:r,onClick:n,icon:o,className:i,...s})=>m("div",{className:_i("setting-item",i),...s,children:[o&&m("div",{className:"setting-icon",children:o}),m("div",{className:"setting-item-info",children:[m("div",{className:"setting-item-name",children:e}),m("div",{className:"setting-item-description",children:t})]}),m("div",{className:"setting-item-control",children:r&&m("button",{className:"mod-cta",onClick:n,children:r})})]});S();var i9=()=>m("svg",{className:"icon-blank svg-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",height:"32",width:"32"}),s9=()=>m("svg",{className:"icon-spin svg-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",height:"32",width:"32",children:[m("path",{opacity:".25",d:"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"}),m("path",{d:"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z",children:m("animateTransform",{attributeName:"transform",type:"rotate",from:"0 16 16",to:"360 16 16",dur:"0.8s",repeatCount:"indefinite"})})]}),xC=({color:e="var(--icon-color, black)",delay:t=0,height:r=16,width:n=16,style:o,...i})=>{let[s,a]=j(t>0);return U(()=>{let u=-1;return s&&(u=window.setTimeout(()=>{a(!1)},t)),()=>{window.clearTimeout(u)}},[]),m("div",{style:{...o,fill:e,height:Number(r)||r,width:Number(n)||n},...i,children:s?m(i9,{}):m(s9,{})})};var EC=require("fs"),SC=require("fs/promises"),IC=require("stream"),Vh=require("stream/promises"),_C=require("zlib"),p9=require("@electron/remote");var gl=class extends Error{},Hh=class extends gl{},Kh=class extends gl{},a9=(e,t=",")=>e.join(t),u9={accept:"*",multiple:!1,strict:!1},wC=e=>{let{accept:t,multiple:r,strict:n}={...u9,...e},o=f9({multiple:r,accept:Array.isArray(t)?a9(t):t});return new Promise(i=>{o.onchange=()=>{i(c9(o.files,r,n)),o.remove()},o.click()})},c9=(e,t,r)=>new Promise((n,o)=>{if(!e)return o(new Hh);let i=l9(e,t,r);if(!i)return o(new Kh);n(i)}),l9=(e,t,r)=>!t&&r?e.length===1?e[0]:null:e.length?e:null,f9=({accept:e,multiple:t})=>{let r=document.createElement("input");return r.type="file",r.multiple=t,r.accept=e,r};var CC=require("obsidian"),yl=async(e,t,r)=>{let n=IC.Readable.from(Buffer.from(e)),o=(0,EC.createWriteStream)(t);try{r?await(0,Vh.pipeline)(n,o):await(0,Vh.pipeline)(n,(0,_C.createGunzip)(),o)}catch(i){throw o.destroy(),await(0,SC.rm)(t,{force:!0}),i}},TC=async()=>{let e=await wC({multiple:!1,accept:[".gz",".node"],strict:!0});return e?{decompressed:!e.name.endsWith(".gz"),arrayBuffer:await e.arrayBuffer()}:null},OC=async e=>(await fetch(e,{method:"HEAD"})).status,kC=async e=>(await(0,CC.requestUrl)({url:e})).arrayBuffer;var AC=(i=>(i[i.Idle=0]="Idle",i[i.Downloading=1]="Downloading",i[i.Importing=2]="Importing",i[i.Success=3]="Success",i[i.Failed=4]="Failed",i))(AC||{}),Ci=Ft(0),d9=Ft(e=>e(Ci)===4),NC=Ft(null),m9=Ft(e=>{switch(e(Ci)){case 0:return null;case 1:return"Downloading...";case 2:return"Importing...";case 3:return"Module successfully installed";case 4:return`Module install failed: ${e(NC)}`;default:break}}),h9=Ft(null,(e,t,[r,n])=>{t(Ci,4);let o="Failed to install module when "+AC[r];it(o,n),t(NC,o+": "+(n instanceof Error?n.message:`${n}`))}),g9=()=>{let e=Bh(Ci),t=Bh(h9),r=lt(la),n=lt(hl);return $t(async()=>{if(!n){t([0,new Error("Cannot find binary version")]);return}e(1);let o;try{if(await OC(r)===404)throw new Error(`Requested module not available (${r}), please open an issue on GitHub`);o=await kC(r)}catch(i){t([1,i]);return}e(2);try{await yl(o,n,!1)}catch(i){t([2,i]);return}e(3)})},RC=()=>{let e=lt(Ci),t=lt(m9),r=lt(Dr),n=g9();return m("div",{className:"zt-auto-install",children:[m(pa,{name:"Auto Install",desc:"Recommended",button:e===0?"Install":void 0,onClick:n}),e!==0&&m(pa,{className:_i("zt-auto-install-status",{"mod-warning":e===4,"mod-success":e===3}),icon:m(b9,{}),name:t,button:e===3?"Reload Plugin":void 0,onClick:()=>r.reloadPlugin()})]})},y9=()=>{let e=lt(d9),[t]=St(e?"slash":"check");return m("div",{className:"zt-install-done-icon",style:{display:"contents"},ref:t})},b9=()=>{switch(lt(Ci)){case 0:return null;case 1:case 2:return m(xC,{className:"zt-install-spin-icon",style:{display:"contents"}});case 3:case 4:return m(y9,{})}};var DC=require("obsidian");S();var v9=async e=>{try{let t=await TC();return t?(await yl(t.arrayBuffer,e,t.decompressed),!0):(W.info("No file selected, skip import module"),!1)}catch(t){return new DC.Notice(`Failed to import module from ${e}: ${t}`),it("import module "+e,t),!1}},x9=()=>{let[e,t]=j(!1),r=lt(hl),n=async()=>{if(!r)return;await v9(r)&&t(!0)},o=lt(la),i=lt(zh),s=lt(Dr);return m("ol",{children:[m("li",{children:["Download ",m("code",{children:".node.gz"})," file from"," ",m("a",{href:o,children:"GitHub"}),"."]}),m("li",{children:["Select downloaded ",m("code",{children:i})," or uncompressed"," ",m("code",{children:"better-sqlite3.node"}),"to install:",m(w9,{onClick:n,done:e})]}),m("li",{children:["Reload ZotLit:",m(E9,{onClick:()=>s.reloadPlugin()})]})]})},PC=()=>{let[e,t]=j(!1);return m("div",{className:"zt-manual-install",children:[m(pa,{name:"Manual Install",desc:"Use this option if you have trouble downloading the module with auto install.",button:`${e?"Hide":"Show"} Guide`,onClick:()=>t(r=>!r)}),m("div",{hidden:!e,children:m(x9,{})})]})},w9=({done:e,onClick:t})=>m("button",{className:_i({"zt-import-done":e}),onClick:t,children:e?"Library file imported":"Select"}),E9=({disabled:e,onClick:t})=>m("button",{disabled:e,onClick:t,children:"Reload Plugin"});var S9=()=>{let e=lt(fC);switch(e){case"install":return m($,{children:["ZotLit requires latest version of ",m("code",{children:"better-sqlite3"})," to be installed. Use one of the method below to install or update it."]});case"reset":return m($,{children:[m("code",{children:"better-sqlite3"})," seems to be broken and failed to load. you can try to use one of the method below to reinstall it."]});default:(0,FC.default)(e)}},$C=()=>m($,{children:[m("style",{children:`
.modal.mod-zt-install-guide .modal-content {
  display: flex;
  flex-direction: column;
}
.zt-install-methods {
  display: flex;
  flex-direction: column;
  gap: var(--size-4-4);
  flex-grow: 1;
  padding: var(--size-4-4);
  padding-bottom: var(--size-4-2);
}
.zt-install-methods .setting-item {
  padding: 0;
}
.zt-auto-install {
  display: flex;
  flex-direction: column;
  gap: var(--size-4-4);
}
.modal.mod-zt-install-guide button:disabled {
  background-color: var(--background-modifier-cover);
}
.modal.mod-zt-install-guide button:disabled:hover {
  box-shadow: var(--input-shadow);
}
.modal.mod-zt-install-guide button.zt-import-done {
  background-color: var(--background-modifier-success);
}
.zt-auto-install-status {
  border-top: none;
}
.zt-auto-install-status.mod-success .setting-icon ,
.zt-auto-install-status.mod-success .setting-item-name  {
  color: var(--text-success);
}
.zt-auto-install-status.mod-warning .setting-icon ,
.zt-auto-install-status.mod-warning .setting-item-name  {
  color: var(--text-error);
}
.zt-auto-install-status .setting-icon ,
.zt-auto-install-status .setting-item-name  {
  color: var(--text-muted);
}
      `}),m("div",{className:"zt-install-desc",children:m(S9,{})}),m("div",{className:"zt-install-methods",children:[m(RC,{}),m(PC,{})]})]});var da=class extends MC.Modal{constructor(r,n,o,i,s){super(s);this.manifest=r;this.platform=n;this.binaryVersion=o;this.mode=i;this.app=s;this.titleEl.setText("Setup ZotLit"),this.modalEl.addClass("mod-zt-install-guide")}onOpen(){let r=lC();r.set(Dr,this),R.render(m(cC,{initialValues:r.get(),children:m($C,{})}),this.contentEl)}onClose(){R.unmountComponentAtNode(this.contentEl)}async reloadPlugin(){await this.app.plugins.disablePlugin(this.manifest.id),this.close(),await this.app.plugins.enablePlugin(this.manifest.id)}};var jC=(e,t,r,n)=>{let o=JS();if(!o)throw new Error("Not in desktop app");let i=VS(o);if(i<0)new Jr.Notice(`The electron (electron: ${o.electron}, module version: ${o.modules}) in current version of obsidian is not supported by zotlit, please reinstall using latest obsidian installer from official website`);else if(i>0)new Jr.Notice(`The electron (electron: ${o.electron}, module version: ${o.modules}) in current version of obsidian is newer than the one supported by installed zotlit, please update zotlit to the latest version`);else if(!GS(o))new Jr.Notice(`Your device (${o.arch}-${o.platform}) is not supported by zotlit`);else{let s=km(t);if(!s)throw new Error(`Cannot find binary version for ${t.name} v${t.version}`);try{(0,qC.statSync)(e).isFile()?r==="reset"&&new da(t,o,s,r,n).open():new Jr.Notice("Path to database library occupied, please check the location manually: "+e,2e3)}catch(a){let u=a;u.code==="ENOENT"?new da(t,o,s,r,n).open():(new Jr.Notice(`Unexpected error while checking path of better-sqlite3, please check the location manually: ${e}, error: ${u}`,2e3),it("checking better-sqlite3 path:"+e,u))}}},I9=(e,t)=>{if(!Jr.Platform.isDesktopApp)throw new Error("Not in desktop app");let r=ai(e);if(!r)throw new Error(`Cannot find binary version for ${e.name} v${e.version}`);try{return require(r),!0}catch(n){return n?.code==="MODULE_NOT_FOUND"?jC(r,e,"install",t):(new Jr.Notice(`Failed to load database library: ${n}`),it("Failed to load database library",n),jC(r,e,"reset",t)),!1}},LC=I9;var fM=require("path/posix");var un=require("obsidian");var _e;(function(e){e[e.highlight=1]="highlight",e[e.note=2]="note",e[e.image=3]="image",e[e.ink=4]="ink",e[e.underline=5]="underline"})(_e||(_e={}));var bo;(function(e){e[e.manual=0]="manual",e[e.auto=1]="auto"})(bo||(bo={}));var bl;(function(e){e[e.importedFile=0]="importedFile",e[e.importedUrl=1]="importedUrl",e[e.linkedFile=2]="linkedFile",e[e.linkedUrl=3]="linkedUrl",e[e.embeddedImage=4]="embeddedImage"})(bl||(bl={}));var ma;(function(e){e[e.fullName=0]="fullName",e[e.nameOnly=1]="nameOnly"})(ma||(ma={}));var vl=["attachment","note","annotation"];var xl=vl.map(e=>`'${e}'`).join(",");var Ge=(e="itemID")=>`--sql
  ${e} IS NOT NULL
  ${e==="itemID"?`AND ${e} NOT IN (SELECT itemID FROM deletedItems)`:""}
`,Qt=(e,t="$itemId")=>typeof e=="boolean"?"":`AND ${e} = ${t}`;var wl=(e,t)=>{for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]-t[r];return 0},_9=new Set(["application/pdf","text/html","application/epub+zip"]),Gh=e=>!!e.path,ha=e=>Gh(e)&&!!e.contentType&&_9.has(e.contentType),BC=e=>`obzt-active-atch-${e.itemID}-${e.libraryID}`,Jh=(e,t)=>{let r=e.getItem(BC(t));if(!r)return null;let n=parseInt(r,10);return n>0?n:null},Ti=(e,t,r)=>e.setItem(BC(t),r.toString());var El=`--sql
  items.itemID,
  items.key,
  items.clientDateModified,
  items.dateAdded,
  items.dateModified,
  annots.type,
  annots.authorName,
  annots.text,
  annots.comment,
  annots.color,
  annots.pageLabel,
  annots.sortIndex,
  annots.position,
  annots.isExternal
`,Sl=`--sql
  itemAnnotations annots
  JOIN items USING (itemID)
`;var Pde=`--sql
SELECT
  ${El},
  annots.parentItemID,
  parentItems.key as parentItem
FROM
  ${Sl}
  JOIN items as parentItems ON annots.parentItemID = parentItems.itemID
WHERE
  items.key = $annotKey
  AND items.libraryID = $libId
  AND ${Ge("items.itemID")}
`;var qde=`--sql
SELECT
  ${El}
FROM
  ${Sl}
WHERE
  parentItemID = $attachmentId
  AND items.libraryID = $libId
  AND ${Ge()}
`;var Il=`--sql
  items.itemID,
  items.key,
  items.clientDateModified,
  items.dateAdded,
  items.dateModified,
  notes.note,
  notes.title
`,_l=`--sql
  itemNotes notes
  JOIN items USING (itemID)
`;var Wde=`--sql
SELECT
  ${Il},
  notes.parentItemID,
  parentItems.key as parentItem
FROM
  ${_l}
  JOIN items as parentItems ON notes.parentItemID = parentItems.itemID
WHERE
  items.key = $noteKey
  AND items.libraryID = $libId
  AND ${Ge("items.itemID")}
`;var Gde=`--sql
SELECT
  ${Il}
FROM
  ${_l}
WHERE
  parentItemID = $itemID
  AND items.libraryID = $libId
  AND ${Ge()}
`;var Yde=`--sql
SELECT
  atchs.itemID,
  atchs.path,
  atchs.contentType,
  atchs.linkMode,
  charsets.charset,
  items.key,
  COUNT(atchs.itemID) as annotCount
FROM
  itemAttachments atchs
  JOIN items USING (itemID)
  LEFT JOIN charsets USING (charsetID)
  LEFT JOIN itemAnnotations annots ON atchs.itemID = annots.parentItemID
WHERE
  atchs.parentItemID = $itemId
  AND libraryID = $libId
  AND ${Ge("atchs.itemID")}
GROUP BY atchs.itemID
`;var Cl=e=>`--sql
SELECT
  itemID,
  creators.firstName,
  creators.lastName,
  creators.fieldMode,
  creatorTypes.creatorType,
  orderIndex
FROM
  items
  LEFT JOIN itemCreators USING (itemID)
  JOIN creators USING (creatorID)
  JOIN creatorTypes USING (creatorTypeID)
WHERE
  libraryID = $libId
  ${Qt(e||"itemID")}
  AND ${Ge()}
ORDER BY
  itemID,
  orderIndex
`;var ame=Cl(!0);function UC(e){return e===void 0?{BS_PRIVATE_NESTED_SOME_NONE:0}:e!==null&&e.BS_PRIVATE_NESTED_SOME_NONE!==void 0?{BS_PRIVATE_NESTED_SOME_NONE:e.BS_PRIVATE_NESTED_SOME_NONE+1|0}:e}function WC(e,t){for(var r=e.length,n=t.length,o=new Array(r+n|0),i=0;i<r;++i)o[i]=e[i];for(var s=0;s<n;++s)o[r+s|0]=t[s];return o}function Zh(e,t){for(var r=0,n=e.length;r<n;++r)t(e[r])}function Tl(e,t){for(var r=e.length,n=new Array(r),o=0;o<r;++o)n[o]=t(e[o]);return n}function ga(e,t,r){for(var n=t,o=0,i=e.length;o<i;++o)n=r(n,e[o]);return n}var HC=function(e,t){for(var r in e)t(r)};function ya(e,t){if(e===t)return!0;var r=typeof e;if(r==="string"||r==="number"||r==="boolean"||r==="undefined"||e===null)return!1;var n=typeof t;if(r==="function"||n==="function")throw{RE_EXN_ID:"Invalid_argument",_1:"equal: functional value",Error:new Error};if(n==="number"||n==="undefined"||t===null)return!1;var o=0|e.TAG,i=0|t.TAG;if(o===248)return e[1]===t[1];if(o===251)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: abstract value",Error:new Error};if(o!==i)return!1;var s=0|e.length;if(s===(0|t.length))if(Array.isArray(e))for(var a=0;;){var u=a;if(u===s)return!0;if(!ya(e[u],t[u]))return!1;a=u+1|0}else{if(e instanceof Date&&t instanceof Date)return!(e>t||e<t);var l={contents:!0};return HC(e,function(c){if(!Object.prototype.hasOwnProperty.call(t,c)){l.contents=!1;return}}),l.contents&&HC(t,function(c){if(!Object.prototype.hasOwnProperty.call(e,c)||!ya(t[c],e[c])){l.contents=!1;return}}),l.contents}else return!1}function Ol(e,t){if(t in e)return UC(e[t])}var Yh=function(e,t){delete e[t]};function GC(e){for(var t=Object.keys(e),r=t.length,n=new Array(r),o=0;o<r;++o)n[o]=e[t[o]];return n}function Oi(e){for(var t={},r=e.length,n=0;n<r;++n){var o=e[n];t[o[0]]=o[1]}return t}function KC(e,t){return WC(e,[t])}function kl(){if(arguments.length===1){let e=arguments;return function(r){return KC(r,e[0])}}return KC(arguments[0],arguments[1])}function VC(e,t){return ga(e,{},function(r,n){var o=t(n),i=Ol(r,o);return i!==void 0?i.push(n):r[o]=[n],r})}function vo(){if(arguments.length===1){let e=arguments;return function(r){return VC(r,e[0])}}return VC(arguments[0],arguments[1])}function fT(e){}function pT(e){return{}}function JC(e,t){return e[t]}function dT(){if(arguments.length===1){let e=arguments;return function(r){return JC(r,e[0])}}return JC(arguments[0],arguments[1])}var ZC=Ol;function mT(){if(arguments.length===1){let e=arguments;return function(r){return ZC(r,e[0])}}return ZC(arguments[0],arguments[1])}function YC(e,t){return e[t]}function hT(){if(arguments.length===1){let e=arguments;return function(r){return YC(r,e[0])}}return YC(arguments[0],arguments[1])}function gT(e){return Object.entries(e)}var Al=GC;function yT(e){return Object.keys(e)}var bT=Oi;function XC(e,t){return Object.assign({},e,t)}function xo(){if(arguments.length===1){let e=arguments;return function(r){return XC(r,e[0])}}return XC(arguments[0],arguments[1])}function QC(e,t,r){var n=xo({},e);return n[t]=r,n}function Nl(){if(arguments.length===2){let e=arguments;return function(r){return QC(r,e[0],e[1])}}return QC(arguments[0],arguments[1],arguments[2])}function eT(e,t,r){return Nl(e,t,r(Ol(e,t)))}function vT(){if(arguments.length===2){let e=arguments;return function(r){return eT(r,e[0],e[1])}}return eT(arguments[0],arguments[1],arguments[2])}function tT(e,t,r){return Nl(e,t,r(e[t]))}function xT(){if(arguments.length===2){let e=arguments;return function(r){return tT(r,e[0],e[1])}}return tT(arguments[0],arguments[1],arguments[2])}function rT(e,t){var r=xo({},e);return Yh(r,t),r}function wT(){if(arguments.length===1){let e=arguments;return function(r){return rT(r,e[0])}}return rT(arguments[0],arguments[1])}function nT(e,t){var r=xo({},e);return Zh(t,function(n){Yh(r,n)}),r}function ET(){if(arguments.length===1){let e=arguments;return function(r){return nT(r,e[0])}}return nT(arguments[0],arguments[1])}function oT(e,t){return Oi(Tl(Object.keys(e),function(r){return[r,t(e[r])]}))}function ki(){if(arguments.length===1){let e=arguments;return function(r){return oT(r,e[0])}}return oT(arguments[0],arguments[1])}function iT(e,t){return Oi(Tl(Object.keys(e),function(r){return[r,t(r,e[r])]}))}function Ai(){if(arguments.length===1){let e=arguments;return function(r){return iT(r,e[0])}}return iT(arguments[0],arguments[1])}function sT(e,t){return Oi(ga(Object.keys(e),[],function(r,n){var o=e[n];return t(o)?kl(r,[n,o]):r}))}function ba(){if(arguments.length===1){let e=arguments;return function(r){return sT(r,e[0])}}return sT(arguments[0],arguments[1])}function aT(e,t){return Oi(ga(Object.keys(e),[],function(r,n){var o=e[n];return t(n,o)?kl(r,[n,o]):r}))}function Rl(){if(arguments.length===1){let e=arguments;return function(r){return aT(r,e[0])}}return aT(arguments[0],arguments[1])}function uT(e,t){return ba(e,function(r){return!t(r)})}function ST(){if(arguments.length===1){let e=arguments;return function(r){return uT(r,e[0])}}return uT(arguments[0],arguments[1])}function cT(e,t){return Rl(e,function(r,n){return!t(r,n)})}function IT(){if(arguments.length===1){let e=arguments;return function(r){return cT(r,e[0])}}return cT(arguments[0],arguments[1])}function lT(e,t){return Rl(e,function(r,n){return function(i,s){return s.includes(i)}(r,t)})}function Dl(){if(arguments.length===1){let e=arguments;return function(r){return lT(r,e[0])}}return lT(arguments[0],arguments[1])}function _T(e){return ya(e,{})}function CT(e){return!ya(e,{})}var Xh={__proto__:null,placeholder:fT,makeEmpty:pT,getUnsafe:dT,get:mT,prop:hT,toPairs:gT,values:Al,keys:yT,fromPairs:bT,merge:xo,set:Nl,update:vT,updateUnsafe:xT,deleteKey:wT,deleteKeys:ET,map:ki,mapWithKey:Ai,filter:ba,filterWithKey:Rl,reject:ST,rejectWithKey:IT,selectKeys:Dl,isEmpty:_T,isNotEmpty:CT};var Yme=Cl(!1);var Pl=e=>`--sql
SELECT
  items.itemID,
  fieldsCombined.fieldName,
  itemDataValues.value
FROM
  items
  JOIN itemData USING (itemID)
  JOIN itemDataValues USING (valueID)
  JOIN fieldsCombined USING (fieldID)
  JOIN itemTypesCombined USING (itemTypeID)
WHERE
  libraryID = $libId
  ${Qt(e||"items.itemID")}
  AND itemTypesCombined.typeName NOT IN (${xl})
  AND ${Ge()}
`;var nhe=Pl(!0);var ahe=Pl(!1);var va=e=>`--sql
SELECT
  items.libraryID,
  items.itemID,
  items.key,
  items.clientDateModified,
  items.dateAdded,
  items.dateModified,
  itemTypesCombined.typeName as itemType,
  json_group_array(collectionID) filter (where collectionID is not null) as collectionIDs
FROM 
  items
  JOIN itemTypesCombined USING (itemTypeID)
  LEFT JOIN collectionItems USING (itemID)
WHERE 
  libraryID = $libId
  ${e==="full"?Qt(!1):e==="id"?Qt("items.itemID"):Qt("items.key","$key")}
  AND ${Ge()}
  AND itemType NOT IN (${xl})
GROUP BY itemID
`;var dhe=va("full");var yhe=va("id"),bhe=va("key");var xa=e=>`--sql
WITH
  RECURSIVE CollectionPath AS (
    -- Base case: collections without a parent
    SELECT
      collectionID,
      parentCollectionID,
      collectionName AS path
    FROM
      collections
    WHERE
      libraryID = $libId
      ${e==="full"?Qt(!1):e==="id"?Qt("collectionID","$collectionID"):Qt("key","$key")}
      AND ${Ge("collectionID")}
    UNION ALL
    -- Recursive case: join with parent collections
    SELECT
      prev.collectionID,
      c.parentCollectionID,
      c.collectionName
    FROM
      collections c
      JOIN CollectionPath prev ON c.collectionID = prev.parentCollectionID
  )
SELECT
  p.collectionID,
  json_group_array(p.path) path,
  c.key,
  c.collectionName,
  c.libraryID
FROM
  CollectionPath p
  JOIN collections c USING (collectionID)
GROUP BY
  collectionID
ORDER BY
  collectionID;
`;var Ihe=xa("full");var Ohe=xa("id"),khe=xa("key");var TT=require("path"),An=({groupID:e,key:t},r)=>{let n=[r,"cache"];return e?n.push("groups",e.toString()):n.push("library"),(0,TT.join)(...n,t+".png")};var wa=e=>Fl(e)?[e.firstName,e.lastName].join(" "):$l(e)?e.lastName:null,Fl=e=>{let t=e;return t.fieldMode===ma.fullName&&t.firstName!==null&&t.lastName!==null},$l=e=>{let t=e;return t.fieldMode===ma.nameOnly&&t.lastName!==null},Qh=new Set(pn()("creators","itemID","itemType","key","libraryID","collections")),eg=e=>!vl.includes(e.itemType)&&typeof e.key=="string",Ea=e=>e.itemType==="annotation"&&!!e.parentItem;var OT=e=>typeof e.groupID=="number"?`groups/${e.groupID}`:"library",Nn=e=>{let t;if(eg(e))t=new URL(`zotero://select/${OT(e)}/items/${e.key}`);else if(Ea(e)){t=new URL(`zotero://open-pdf/${OT(e)}/items/${e.parentItem}`);let r;try{r=Jo(e.position.pageIndex,!0)}catch(n){console.warn(n),r=null}typeof r=="number"&&t.searchParams.append("page",r.toString()),e.key&&t.searchParams.append("annotation",e.key)}else return"";return t.toString()};var AT=require("obsidian");var jl=require("obsidian");async function kT(e){let t=await wo(e);if(!t)return null;let{value:r,evt:n}=t;return{value:r.item,evt:n}}function wo(e){let t,r=new Promise((o,i)=>{t=o}),n=Lt(e,{selectSuggestion:o=>function(s,a,...u){return t(s!==null?{value:s,evt:a}:null),o.call(this,s,a,...u)},onClose:o=>function(...s){return t(null),o.call(this,...s)}});return r.finally(n),e.open(),r}var Ml=class extends jl.SuggestModal{initial=!0;async#e(){let t=this.inputEl.value,r=await this.getSuggestions(t);if(r.length!==0){let n=this.limit;n&&n>0&&(r=r.slice(0,n)),this.chooser.setSuggestions(r)}else t?this.onNoSuggestion():this.chooser.setSuggestions(null)}#t=(0,jl.debounce)(this.#e.bind(this),250,!0);updateSuggestions(){this.initial?(this.#e(),this.initial=!1):this.#t()}};var tg=class extends AT.FuzzySuggestModal{constructor(r,n){super(n);this.attachments=r}getItems(){return this.attachments}renderSuggestion(r,n){n.addClass("mod-complex");let o=n.createDiv("suggestion-content").createDiv("suggestion-title").createSpan(),i=n.createDiv("suggestion-aux");super.renderSuggestion(r,o),i.createEl("kbd","suggestion-hotkey").setText((r.item.annotCount??0).toString())}getItemText(r){return r.path?.replace(/^storage:/,"")??r.key}onChooseItem(){}};async function N9(e,t){return e.length===1?e[0]:e.length?(await kT(new tg(e,t)))?.value??null:null}function Ni(e,t){Ti(window.localStorage,t,e.itemID)}async function Zr(e,t){let r=e.filter(ha);return await N9(r,t)}var _y=require("obsidian");var dt=require("obsidian");var Ri=require("obsidian"),NT=()=>`Press ${Ri.Platform.isMacOS?"\u2318 Cmd":"Ctrl"} + ${Ri.Platform.isMacOS?"\u2325 Option":"Shift"} + I, then go to the "Console" tab to see the log.`;var at=e=>e instanceof Ri.TFile&&e.extension==="md",RT=e=>typeof e=="string"?e:e.path;function rg(e){let t=vo(e,o=>o.comment?.match(Cm)?.[1]??-1),r=t[-1]??[],n=new Map(r.map(o=>[o.itemID,[o]]));delete t[-1];for(let[o,i]of Object.entries(t)){let s=n.get(+o);i.forEach(a=>{a.comment&&=a.comment.replace(Cm,"")??null}),s?s.push(...i.sort((a,u)=>wl(a.sortIndex,u.sortIndex))):i.forEach(a=>{n.set(a.itemID,[a])})}for(let[o,...i]of n.values())if(!(i.length<=0)){for(let s of i)s.comment&&(o.comment=(o.comment??"")+`
`+s.comment),s.text&&(o.text?o.text.endsWith("-")&&!o.text.endsWith("--")?o.text.substring(0,o.text.length-1)+s.text.trimStart():o.text.match(/[a-zA-Z\d]\s*$/)&&s.text.match(/^\s*[a-zA-Z\d]/)?o.text=o.text.trimEnd()+" "+s.text.trimStart():o.text=o.text.trimEnd()+s.text.trimStart():o.text=s.text);o.comment=o.comment?.replace(/\n+/,`
`).replace(/^\s+|\s+$/g,"")??null}return[...n.values()]}function ng(e){return e.map(t=>t[0])}function og(e,t){let r=e.map(([n,...o])=>{if(o.length===0)return[n.itemID,t[n.itemID]];let i=new Map(t[n.itemID].map(s=>[s.tagID,s]));return o.forEach(s=>{t[s.itemID].forEach(a=>{i.set(a.tagID,a)})}),[n.itemID,Array.from(i.values())]});return Object.fromEntries(r)}function DT(e,t){let r=rg(e);return{annotations:ng(r),tags:og(r,t)}}var Ul=class{constructor(t){this.cache=void 0,this.cache=t}define(t,r){this.cache[t]=r}get(t){return this.cache[t]}remove(t){delete this.cache[t]}reset(){this.cache={}}load(t){this.cache={...this.cache,...t}}},et=class extends Error{constructor(t){super(t),this.name="Eta Error"}};function Sa(e,t,r){let n=t.slice(0,r).split(/\n/),o=n.length,i=n[o-1].length+1;throw e+=" at line "+o+" col "+i+`:

  `+t.split(/\n/)[o-1]+`
  `+Array(i).join(" ")+"^",new et(e)}function R9(e,t,r,n){let o=t.split(`
`),i=Math.max(r-3,0),s=Math.min(o.length,r+3),a=n,u=o.slice(i,s).map(function(f,p){let d=p+i+1;return(d==r?" >> ":"    ")+d+"| "+f}).join(`
`),l=a?a+":"+r+`
`:"line "+r+`
`,c=new et(l+u+`

`+e.message);throw c.name=e.name,c}var D9=async function(){}.constructor;function P9(e,t){let r=this.config,n=t&&t.async?D9:Function;try{let o=new n(r.varName,"options",this.compileToString.call(this,e,t));return o.mtime=t?.mtime,o}catch(o){throw o instanceof SyntaxError?new et(`Bad template syntax

`+o.message+`
`+Array(o.message.length+1).join("=")+`
`+this.compileToString.call(this,e,t)+`
`):o}}function F9(e,t){let r=this.config,n=t&&t.async,o=this.compileBody,i=this.parse.call(this,e),s=`${r.functionHeader}
let include = (template, data) => this.render(template, data, options);
let includeAsync = (template, data) => this.renderAsync(template, data, options);

let __eta = {res: "", e: this.config.escapeFunction, f: this.config.filterFunction${r.debug?', line: 1, templateStr: "'+e.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n")+'"':""}};

function layout(path, data) {
  __eta.layout = path;
  __eta.layoutData = data;
}${r.debug?"try {":""}${r.useWith?"with("+r.varName+"||{}){":""}

${o.call(this,i)}
if (__eta.layout) {
  __eta.res = ${n?"await includeAsync":"include"} (__eta.layout, {...${r.varName}, body: __eta.res, ...__eta.layoutData});
}
${r.useWith?"}":""}${r.debug?"} catch (e) { this.RuntimeErr(e, __eta.templateStr, __eta.line, options.filepath) }":""}
return __eta.res;
`;if(r.plugins)for(let a=0;a<r.plugins.length;a++){let u=r.plugins[a];u.processFnString&&(s=u.processFnString(s,r))}return s}function $9(e){let t=this.config,r=0,n=e.length,o="";for(r;r<n;r++){let i=e[r];if(typeof i=="string")o+="__eta.res+='"+i+`'
`;else{let s=i.t,a=i.val||"";t.debug&&(o+="__eta.line="+i.lineNo+`
`),s==="r"?(t.autoFilter&&(a="__eta.f("+a+")"),o+="__eta.res+="+a+`
`):s==="i"?(t.autoFilter&&(a="__eta.f("+a+")"),t.autoEscape&&(a="__eta.e("+a+")"),o+="__eta.res+="+a+`
`):s==="e"&&(o+=a+`
`)}}return o}function M9(e,t,r,n){let o,i;return Array.isArray(t.autoTrim)?(o=t.autoTrim[1],i=t.autoTrim[0]):o=i=t.autoTrim,(r||r===!1)&&(o=r),(n||n===!1)&&(i=n),!i&&!o?e:o==="slurp"&&i==="slurp"?e.trim():(o==="_"||o==="slurp"?e=e.trimStart():(o==="-"||o==="nl")&&(e=e.replace(/^(?:\r\n|\n|\r)/,"")),i==="_"||i==="slurp"?e=e.trimEnd():(i==="-"||i==="nl")&&(e=e.replace(/(?:\r\n|\n|\r)$/,"")),e)}var j9={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function q9(e){return j9[e]}function L9(e){let t=String(e);return/[&<>"']/.test(t)?t.replace(/[&<>"']/g,q9):t}var PT={autoEscape:!0,autoFilter:!1,autoTrim:[!1,"nl"],cache:!1,cacheFilepaths:!0,debug:!1,escapeFunction:L9,filterFunction:e=>String(e),functionHeader:"",parse:{exec:"",interpolate:"=",raw:"~"},plugins:[],rmWhitespace:!1,tags:["<%","%>"],useWith:!1,varName:"it"},ql=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,Ll=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,Bl=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g;function zl(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function B9(e,t){return e.slice(0,t).split(`
`).length}function z9(e){let t=this.config,r=[],n=!1,o=0,i=t.parse;if(t.plugins)for(let f=0;f<t.plugins.length;f++){let p=t.plugins[f];p.processTemplate&&(e=p.processTemplate(e,t))}t.rmWhitespace&&(e=e.replace(/[\r\n]+/g,`
`).replace(/^\s+|\s+$/gm,"")),ql.lastIndex=0,Ll.lastIndex=0,Bl.lastIndex=0;function s(f,p){f&&(f=M9(f,t,n,p),f&&(f=f.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),r.push(f)))}let a=[i.exec,i.interpolate,i.raw].reduce(function(f,p){return f&&p?f+"|"+zl(p):p?zl(p):f},""),u=new RegExp(zl(t.tags[0])+"(-|_)?\\s*("+a+")?\\s*","g"),l=new RegExp("'|\"|`|\\/\\*|(\\s*(-|_)?"+zl(t.tags[1])+")","g"),c;for(;c=u.exec(e);){let f=e.slice(o,c.index);o=c[0].length+c.index;let p=c[1],d=c[2]||"";s(f,p),l.lastIndex=o;let h,b=!1;for(;h=l.exec(e);)if(h[1]){let y=e.slice(o,h.index);u.lastIndex=o=l.lastIndex,n=h[2],b={t:d===i.exec?"e":d===i.raw?"r":d===i.interpolate?"i":"",val:y};break}else{let y=h[0];if(y==="/*"){let v=e.indexOf("*/",l.lastIndex);v===-1&&Sa("unclosed comment",e,h.index),l.lastIndex=v}else y==="'"?(Ll.lastIndex=h.index,Ll.exec(e)?l.lastIndex=Ll.lastIndex:Sa("unclosed string",e,h.index)):y==='"'?(Bl.lastIndex=h.index,Bl.exec(e)?l.lastIndex=Bl.lastIndex:Sa("unclosed string",e,h.index)):y==="`"&&(ql.lastIndex=h.index,ql.exec(e)?l.lastIndex=ql.lastIndex:Sa("unclosed string",e,h.index))}b?(t.debug&&(b.lineNo=B9(e,c.index)),r.push(b)):Sa("unclosed tag",e,c.index)}if(s(e.slice(o,e.length),!1),t.plugins)for(let f=0;f<t.plugins.length;f++){let p=t.plugins[f];p.processAST&&(r=p.processAST(r,t))}return r}function FT(e,t){let r=t&&t.async?this.templatesAsync:this.templatesSync;if(this.resolvePath&&this.readFile&&!e.startsWith("@")){let n=t.filepath,o=r.get(n);if(this.config.cache&&o)return o;{let i=this.readFile(n),s=this.compile(i,t);return this.config.cache&&r.define(n,s),s}}else{let n=r.get(e);if(n)return n;throw new et("Failed to get template '"+e+"'")}}function $T(e,t,r){let n,o={...r,async:!1};return typeof e=="string"?(this.resolvePath&&this.readFile&&!e.startsWith("@")&&(o.filepath=this.resolvePath(e,o)),n=FT.call(this,e,o)):n=e,n.call(this,t,o)}function MT(e,t,r){let n,o={...r,async:!0};typeof e=="string"?(this.resolvePath&&this.readFile&&!e.startsWith("@")&&(o.filepath=this.resolvePath(e,o)),n=FT.call(this,e,o)):n=e;let i=n.call(this,t,o);return Promise.resolve(i)}function U9(e,t){let r=this.compile(e,{async:!1});return $T.call(this,r,t)}function W9(e,t){let r=this.compile(e,{async:!0});return MT.call(this,r,t)}var Wl=class{constructor(t){this.config=void 0,this.RuntimeErr=R9,this.compile=P9,this.compileToString=F9,this.compileBody=$9,this.parse=z9,this.render=$T,this.renderAsync=MT,this.renderString=U9,this.renderStringAsync=W9,this.filepathCache={},this.templatesSync=new Ul({}),this.templatesAsync=new Ul({}),this.resolvePath=null,this.readFile=null,t?this.config={...PT,...t}:this.config={...PT}}configure(t){this.config={...this.config,...t}}withConfig(t){return{...this,config:{...this.config,...t}}}loadTemplate(t,r,n){if(typeof r=="string")(n&&n.async?this.templatesAsync:this.templatesSync).define(t,this.compile(r,n));else{let o=this.templatesSync;(r.constructor.name==="AsyncFunction"||n&&n.async)&&(o=this.templatesAsync),o.define(t,r)}}};var WT=require("obsidian");var Yr=require("node:path/posix");var ig=require("obsidian");function H9(e){if(!e)return"";let t=Nm(e);return t||(e.endsWith(".eta.md")?e:e.endsWith(".eta")?e+".md":e+".eta.md")}function jT(e){let t=ct(e,this.settings.templateDir);if(t?.type==="embeded")return this.settings.simpleTemplates[t.name];let r=this.getFile(e);if(typeof r=="string"){if(!t)throw new et(`File '${e}' not found`);return ot.Ejectable[t.name]}if(!this.tplFileCache.has(r))throw new et(`File '${e}' not loaded`);return this.tplFileCache.get(r)}function qT(e){let t=ct(e,this.settings.templateDir);if(t?.type==="embeded")return-1;let r=this.getFile(e);if(typeof r=="string"){if(!t)throw new et(`File '${e}' not found`);return}if(!this.tplFileCache.has(r))throw new et(`File '${e}' not loaded`);return r.stat.mtime}function LT(e,t){let r="",n=this.config.views;if(!n)throw new et("Views directory is not defined");let o=t&&t.filepath,i=JSON.stringify({filename:o,path:e,views:this.config.views});if(e=H9(e),o){if(this.config.cacheFilepaths&&this.filepathCache[i])return this.filepathCache[i];(0,Yr.isAbsolute)(e)?r=(0,Yr.join)(n,(0,ig.normalizePath)(e)):r=(0,Yr.join)(o,"..",(0,ig.normalizePath)(e))}else r=(0,Yr.join)(n,e);if(K9(n,r))return o&&this.config.cacheFilepaths&&(this.filepathCache[i]=r),r;throw new et(`Template '${e}' is not in the views directory`)}function K9(e,t){let r=(0,Yr.relative)(e,t);return r&&!r.startsWith("..")&&!(0,Yr.isAbsolute)(r)}function BT(e,t){let r=t&&t.async?this.templatesAsync:this.templatesSync;if(e.startsWith("@")){let n=r.get(e);if(n)return n;throw new et("Failed to get template '"+e+"'")}else{let n=t.filepath,o=r.get(n),i=this.readModTime(n),s=o?.mtime;if(this.config.cache&&o&&(i===void 0||i>0&&s!==void 0&&i<=s))return o;let a=this.readFile(n),u=this.compile(a,t);return this.config.cache&&r.define(n,u),u}}function sg(e,t,r){let n,o={...r,async:!1};return typeof e=="string"?(e.startsWith("@")||(o.filepath=this.resolvePath(e,o)),n=BT.call(this,e,o)):n=e,n.call(this,t,o)}function ag(e,t,r){let n,o={...r,async:!0};typeof e=="string"?(e.startsWith("@")||(o.filepath=this.resolvePath(e,o)),n=BT.call(this,e,o)):n=e;let i=n.call(this,t,o);return Promise.resolve(i)}function zT(e,t){let r=this.compile(e,{async:!1});return sg.call(this,r,t)}function UT(e,t){let r=this.compile(e,{async:!0});return ag.call(this,r,t)}var Hl=class extends Wl{use=Go.this;settings=this.use(de);app=this.use(WT.App);tplFileCache=new WeakMap;constructor(){super();let t=this;this.config={...this.config,cache:!0,autoEscape:!1,autoFilter:!0,filterFunction:r=>r==null?"":r instanceof Date?r.toISOString():r,plugins:[],get autoTrim(){return t.settings.current?.autoTrim},get views(){return t.settings.templateDir}}}resolvePath=LT;readFile=jT;readModTime=qT;render=sg;renderAsync=ag;renderString=zT;renderStringAsync=UT;getFile(t){let r=this.app.vault.getAbstractFileByPath(t);if(!r)return t;if(!at(r))throw new et(`'${t}' is not a markdown file`);return r}};var kR=me(vR(),1),AR=me(_R(),1);var Of=require("obsidian");var NK="\\ufeff?",RK=typeof process<"u"?process.platform:"",DK="^("+NK+"(= yaml =|---)$([\\s\\S]*?)^(?:\\2|\\.\\.\\.)\\s*$"+(RK==="win32"?"\\r?":"")+"(?:\\n)?)",PK=new RegExp(DK,"m");function Ef(e){e=e||"";let t=e.split(/(\r?\n)/);return t[0]&&/= yaml =|---/.test(t[0])?$K(e):{yaml:null,body:e,bodyBegin:1}}function FK(e,t){let r=1,n=t.indexOf(`
`),o=e.index+e[0].length;for(;n!==-1;){if(n>=o)return r;r++,n=t.indexOf(`
`,n+1)}return r}function $K(e){let t=PK.exec(e);if(!t)return{yaml:null,body:e,bodyBegin:1};let r=t[t.length-1].replace(/^\s+|\s+$/g,""),n=e.replace(t[0],""),o=FK(t,e);return{yaml:r,body:n,bodyBegin:o}}var If=require("path"),dy=require("url");function ly(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function fy(e,t){if(typeof e!="string"||typeof t!="string")throw new TypeError("Expected a string");let r=new RegExp(`(?:${ly(t)}){2,}`,"g");return e.replace(r,t)}function Sf(){return/[<>:"/\\|?*\u0000-\u001F]/g}function CR(){return/^(con|prn|aux|nul|com\d|lpt\d)$/i}function py(e,t){if(typeof e!="string"||typeof t!="string")throw new TypeError("Expected a string");return e.startsWith(t)&&(e=e.slice(t.length)),e.endsWith(t)&&(e=e.slice(0,-t.length)),e}var MK=100,TR=/[\u0000-\u001F\u0080-\u009F]/g,jK=/^\.+(\\|\/)|^\.+$/,qK=/\.+$/;function Oo(e,t={}){if(typeof e!="string")throw new TypeError("Expected a string");let r=t.replacement===void 0?"!":t.replacement;if(Sf().test(r)&&TR.test(r))throw new Error("Replacement string cannot contain reserved filename characters");if(e=e.normalize("NFD"),e=e.replace(jK,r),e=e.replace(Sf(),r),e=e.replace(TR,r),e=e.replace(qK,""),r.length>0){let o=e[0]===".";e=fy(e,r),e=e.length>1?py(e,r):e,!o&&e[0]==="."&&(e=r+e),e[e.length-1]==="."&&(e+=r)}e=CR().test(e)?e+r:e;let n=typeof t.maxLength=="number"?t.maxLength:MK;if(e.length>n){let o=e.lastIndexOf(".");if(o===-1)e=e.slice(0,n);else{let i=e.slice(0,o),s=e.slice(o);e=i.slice(0,Math.max(1,n-s.length))+s}}return e}var my=e=>encodeURI(e)===e?e:`<${e}>`,_f=e=>e.name.endsWith(".eta.md"),hy=(e,t)=>t.path?t.path.startsWith("storage:")?(0,If.join)(e,"storage",t.key,t.path.replace(/^storage:/,"")):t.path:"",Cf=(e,t,r,n=null,o=null)=>{if(!n?.path)return"";let i=o?`#page=${o}`:void 0,s=t.vault.adapter.getBasePath(),a=hy(e,n),u=(0,If.relative)(s,a);if(u.startsWith(".."))return`[attachment](${my((0,dy.pathToFileURL)(a).href+(i??""))})`;{let l=t.metadataCache.getFirstLinkpathDest(u,"");return l?t.fileManager.generateMarkdownLink(l,r??"",i).replace(/^!/,""):(W.warn("fileLink: file not found",u,a),"")}},OR=e=>Oo(e,{replacement:"_"}),Tf=e=>Ea(e)&&e.type===_e.image,LK=(e,t,r)=>t?`[${r??""}](${my(e)})`:`[[${e}${r?"|"+r:""}]]`,gy=(e,t)=>{if(Tf(e)){let r=t.imgCacheImporter.import(e);if(r)return LK(r,t.app.vault.getConfig("useMarkdownLinks"));{let n=t.imgCacheImporter.getCachePath(e);return`[Annotation ${e.key}](${my((0,dy.pathToFileURL)(n).href)})`}}else return""};function NR(e){Lt(e,{compile:t=>function(n,o){let i=this,s=t.call(this,n,o);if(!o?.filepath)return s;let a=o.filepath,u=ct(a,i.settings.templateDir);if(!u)return s;let l=s;switch(u.name){case"filename":l=(c,f)=>OR(s.call(this,c,f));break;case"annotation":l=(c,f)=>{let p=s.call(this,c,f),d=!0,{yaml:h,body:b}=Ef(p);if(h)try{(0,Of.parseYaml)(h).callout===!1&&(d=!1)}catch(v){new Of.Notice(`Error parsing frontmatter, ${v}`)}if(!d)return b;let y=b.trim().split(`
`);return y.push(`^${c.blockID}`),y.map(v=>`> ${v}`).join(`
`)};break;default:break}return Object.groupBy&&Map.groupBy?l:(c,f)=>{let p=BK(),d=l.call(this,c,f);return p(),d}}})}function BK(){let e=[];return Object.groupBy||(Object.groupBy=AR.default,e.push(()=>delete Object.groupBy)),Map.groupBy||(Map.groupBy=kR.default,e.push(()=>delete Map.groupBy)),()=>e.forEach(t=>t())}var ko="zotero-key",ji="zt-attachments";var RR=require("url");var DR=require("obsidian");var Fn=e=>e.plugin.settings.current?.zoteroDataDir,za=Symbol("proxied"),kf=e=>!!e[za];var Af={"#FF6666":"red","#FF8C19":"orange","#F19837":"orange","#FFD400":"yellow","#999999":"gray","#AAAAAA":"gray","#5FB236":"green","#009980":"cyan","#2EA8E5":"blue","#576DD9":"navy","#A28AE5":"purple","#A6507B":"brown","#E56EEE":"magenta"};var yy=new Set(pn()("attachment","tags")),by=(e,t,r)=>new Proxy({get page(){return Jo(e.position.pageIndex,!0)??NaN},get backlink(){return Nn(e)},get blockID(){let n=Bt(e),o=Jo(e.position.pageIndex,!0);return typeof o=="number"&&(n+=`p${o}`),n},get commentMd(){return e.comment?(0,DR.htmlToMarkdown)(e.comment):""},get imgPath(){return Tf(this)?An(this,Fn(r)):""},get imgUrl(){if(Tf(this)){let n=An(this,Fn(r));return(0,RR.pathToFileURL)(n).href}else return""},get imgLink(){return gy(this,r.plugin)},get imgEmbed(){let n=gy(this,r.plugin);return n?`!${n}`:""},get fileLink(){return Cf(Fn(r),r.plugin.app,r.sourcePath,t.attachment,Jo(e.position.pageIndex,!0))},get textBlock(){return e.text?`\`\`\`zotero-annot
> ${e.text} [zotero](${Nn(e)})
\`\`\``:""},get colorName(){let n=e.color?.toUpperCase();return Af[n]||this.color},docItem:"not-loaded"},{get(n,o,i){if(o==="tags"){if(!t.tags[e.itemID])throw console.error(t,e.itemID),new Error("No tags loaded for item "+e.itemID);return t.tags[e.itemID]}if(o==="docItem"){if(n.docItem==="not-loaded")throw new Error("Doc Item not loaded for item "+e.itemID);return n.docItem}return yy.has(o)?Reflect.get(t,o,i):Reflect.get(e,o,i)??Reflect.get(n,o,i)},ownKeys(n){return[...Reflect.ownKeys(e),...yy,...Reflect.ownKeys(n)]},getOwnPropertyDescriptor(n,o){return Object.prototype.hasOwnProperty.call(e,o)?Reflect.getOwnPropertyDescriptor(e,o):yy.has(o)?Reflect.getOwnPropertyDescriptor(t,o):Reflect.getOwnPropertyDescriptor(n,o)}});function vy(e,t){return!e||kf(e)?e:new Proxy({get filePath(){return hy(Fn(t),e)}},{get(r,n,o){return n===za?!0:Reflect.get(e,n,o)??Reflect.get(r,n,o)},ownKeys(r){return[...Reflect.ownKeys(e),...Reflect.ownKeys(r)]},getOwnPropertyDescriptor(r,n){return Object.prototype.hasOwnProperty.call(e,n)?Reflect.getOwnPropertyDescriptor(e,n):Reflect.getOwnPropertyDescriptor(r,n)}})}var xy=class extends Array{toString(){return this.join(" > ")}},wy=({path:e,...t})=>{let r={path:xy.from(e),toString(){return t.name}};return new Proxy(r,{get(n,o,i){return Reflect.get(n,o,i)??Reflect.get(t,o,i)},ownKeys(n){return[...Reflect.ownKeys(t),...Reflect.ownKeys(n).filter(o=>!(o==="toJSON"||o==="toString"))]},getOwnPropertyDescriptor(n,o){return Object.prototype.hasOwnProperty.call(t,o)?Reflect.getOwnPropertyDescriptor(t,o):Reflect.getOwnPropertyDescriptor(n,o)}})};var Ey=e=>{let t={get fullname(){return wa(e)??""},toString(){return this.fullname},toJSON(){return this.fullname}};return new Proxy(t,{get(r,n,o){return Reflect.get(r,n,o)??Reflect.get(e,n,o)},ownKeys(r){return[...Reflect.ownKeys(e),...Reflect.ownKeys(r).filter(n=>!(n==="toJSON"||n==="toString"))]},getOwnPropertyDescriptor(r,n){return Object.prototype.hasOwnProperty.call(e,n)?Reflect.getOwnPropertyDescriptor(e,n):Reflect.getOwnPropertyDescriptor(r,n)}})};var Sy=new Set(pn()("attachment","allAttachments","tags","notes")),Iy=({creators:e,collections:t,...r},n,o)=>{let i=e.map(s=>Ey(s));return new Proxy({get backlink(){return Nn(r)},get fileLink(){return Cf(Fn(o),o.plugin.app,o.sourcePath,n.attachment)},get authorsShort(){let s=this.authors;if(!s.length)return"";let a=s[0],u=a.lastName??a.fullname;return s.length===1?u:`${u} et al.`},annotations:"not-loaded",creators:i,collections:t.map(s=>wy(s)),get authors(){return i.filter(s=>s.creatorType==="author")}},{get(s,a,u){if(a==="tags"){if(!n.tags[r.itemID])throw new Error("No tags loaded for item "+r.itemID);return n.tags[r.itemID]}return Sy.has(a)?n[a]:a==="annotations"?s.annotations:Reflect.get(r,a,u)??Reflect.get(s,a,u)},ownKeys(s){return[...Reflect.ownKeys(r),...Sy,...Reflect.ownKeys(s)]},getOwnPropertyDescriptor(s,a){return Object.prototype.hasOwnProperty.call(r,a)?Reflect.getOwnPropertyDescriptor(r,a):Sy.has(a)?Reflect.getOwnPropertyDescriptor(n,a):Reflect.getOwnPropertyDescriptor(s,a)}})};function PR(e){return!e||kf(e)?e:new Proxy({toString(){return e.name},toJSON(){return e.name}},{get(t,r,n){return r===za?!0:Reflect.get(t,r,n)??Reflect.get(e,r,n)},ownKeys(t){return[...Reflect.ownKeys(e),...Reflect.ownKeys(t).filter(r=>!(r==="toJSON"||r==="toString"))]},getOwnPropertyDescriptor(t,r){return Object.prototype.hasOwnProperty.call(e,r)?Reflect.getOwnPropertyDescriptor(e,r):Reflect.getOwnPropertyDescriptor(t,r)}})}function It(e,t,r){let n={...e,attachement:vy(e.attachment,t),allAttachments:e.allAttachments.map(a=>vy(a,t)),tags:ki(e.tags,a=>a.map(u=>PR(u)))},o=Iy(e.docItem,n,t),i=e.annotations.map(a=>{let u=by(a,n,t);return u.docItem=o,u}),s=r?i[e.annotations.findIndex(a=>a.itemID===r.itemID)]:void 0;return o.annotations=i,{annotation:s,annotations:i,docItem:o}}var $n=class extends ue{eta=this.use(Hl);plugin=this.use(be);settings=this.use(de);app=this.use(dt.App);get vault(){return this.app.vault}get folder(){return this.settings.templateDir}get filenameTemplate(){return this.settings.simpleTemplates?.filename}get autoTrim(){return this.settings.current?.autoTrim}async loadTemplates(){let t=this.vault.getAbstractFileByPath(this.folder);if(!t)return;if(!(t instanceof dt.TFolder)){W.warn("Template folder is occupied by a file");return}let r=[];dt.Vault.recurseChildren(t,async n=>{!at(n)||!n.path.endsWith(".eta.md")||r.push(n)}),await Promise.all(r.map(async n=>this.eta.tplFileCache.set(n,await this.vault.cachedRead(n))))}onload(){NR(this.eta),this.settings.once(async()=>{await this.loadTemplates()}),this.register(Le(Qe(()=>this.plugin.app.vault.trigger("zotero:template-updated","filename"),()=>this.filenameTemplate,!0))),this.register(Le(Qe(async()=>_r.All.forEach(t=>this.plugin.app.vault.trigger("zotero:template-updated",t)),()=>this.autoTrim,!0))),this.registerEvent(this.vault.on("create",this.onFileChange,this)),this.registerEvent(this.vault.on("modify",this.onFileChange,this)),this.registerEvent(this.vault.on("delete",async t=>{if(!at(t))return;let r=this.fromPath(t.path);r&&(this.eta.tplFileCache.delete(t),this.vault.trigger("zotero:template-updated",r))})),this.registerEvent(this.vault.on("rename",async(t,r)=>{await this.onFileChange(t);let n=this.fromPath(r);n&&this.vault.trigger("zotero:template-updated",n)}))}async onFileChange(t){if(!at(t))return;let r=this.fromPath(t.path);this.eta.tplFileCache.set(t,await this.vault.cachedRead(t)),this.vault.trigger("zotero:template-updated",r)}fromPath(t){let r=ct(t,this.folder);return r?.type==="ejectable"?r.name:null}onFileUpdate(t){at(t)&&this.fromPath(t.path)}onFileRename(t,r){at(t)&&this.fromPath(t.path),this.fromPath(r)}mergeAnnotTags(t){if(t.annotations.length===0)return t;let r=DT(t.annotations,t.tags);return t.annotations=r.annotations,t.tags={...t.tags,...r.tags},t}render(t,r){try{let n=this.eta.render(t,r);return this.plugin.imgCacheImporter.flush(),n}catch(n){throw console.error("Error while rendering",t,n),n}}renderAnnot(t,r,n){n.merge!==!1&&(r=this.mergeAnnotTags(r));let o=It(r,n,t);return this.render("annotation",o.annotation)}renderNote(t,r,n){r.merge!==!1&&(t=this.mergeAnnotTags(t));let o=It(t,r),i=this.#e(o.docItem,n),s=this.render("note",o.docItem);return["",i,s].join(`---
`)}renderAnnots(t,r){r.merge!==!1&&(t=this.mergeAnnotTags(t));let n=It(t,r);return this.render("annots",n.annotations)}renderCitations(t,r,n=!1){let o=t.map(i=>It(i,r));return this.render(n?"cite2":"cite",o.map(i=>i.docItem))}renderColored(t){return this.render("colored",t)}renderFilename(t,r){let n=It(t,r);return this.render("filename",n.docItem)}toFrontmatterRecord(t){let r=this.render("field",t),n=!1,{yaml:o,body:i}=Ef(r);if(o)try{(0,dt.parseYaml)(o).raw===!0&&(n=!0)}catch(f){new dt.Notice(`Error parsing frontmatter, ${f}`)}let s=Bt(t,!0),a=t.attachment?[t.attachment.itemID.toString()]:void 0,{[ko]:u,[ji]:l,...c}=(0,dt.parseYaml)(i);return{mode:n?"raw":"parsed",yaml:[`${ko}: ${s}`,`${ji}: ${l??a}`,i.trim(),""].join(`
`),data:{[ko]:s,[ji]:a,...ba(c,f=>!(f===""||f===null||f===void 0))}}}renderFrontmatter(t,r,n){let o=It(t,r);return this.#e(o.docItem,n)}#e(t,r){try{let n=this.toFrontmatterRecord(t);return n.mode==="raw"?n.yaml:(0,dt.stringifyYaml)(r!==void 0?xo(n.data,r):n.data)}catch(n){throw it("Failed to renderYaml",n,t),new dt.Notice("Failed to renderYaml"),n}}async setFrontmatterTo(t,r){try{let n=this.toFrontmatterRecord(r).data;await this.plugin.app.fileManager.processFrontMatter(t,o=>Object.assign(o,n))}catch(n){it("Failed to set frontmatter to file "+t.path,n,r),new dt.Notice("Failed to set frontmatter to file "+t.path)}}};fe([pe],$n.prototype,"folder",1),fe([pe],$n.prototype,"filenameTemplate",1),fe([pe],$n.prototype,"autoTrim",1);var Nf=require("@codemirror/state"),FR=require("obsidian");var $R=e=>Nf.Prec.highest(Nf.EditorState.languageData.of(t=>{let r=[],n=e.getConfig("autoPairBrackets"),o=e.getConfig("autoPairMarkdown");n&&r.push("(","[","{","'",'"'),o&&r.push("*","_","`","```");let i=t.field(FR.editorInfoField);return i?.file&&_f(i?.file)&&r.push("<","%"),[{closeBrackets:{brackets:r}}]}));var jR=require("obsidian");var MR=[{prefix:"=",name:"interpolate tag",description:"An interpolation outputs data into the template"},{prefix:" ",name:"evaluation tag",description:"An evaluate tag inserts its contents into the template function."}],Rf=class extends jR.EditorSuggest{onTrigger(t,r,n){if(!n||!_f(n))return null;let o=r.getLine(t.line),s=o.substring(0,t.ch).match(/<%([ =]?)$/);if(!s)return null;let[a,u]=s,l=o.substring(t.ch).match(/^([\w ]*)%>/),c;if(!l)c={...t};else{let[,f]=l;if(u===" "&&f.length===1)return null;c={...t,ch:t.ch+f.length}}return{end:c,start:{ch:s.index+a.length-u.length,line:t.line},query:s[1]}}getSuggestions(t){return t.query?MR.filter(r=>r.prefix===t.query):MR}renderSuggestion({prefix:t,name:r,description:n},o){t===" "?o.createSpan({text:"No Prefix"}):o.createEl("code",{text:t}),o.createDiv({text:r}),o.createDiv({text:n})}selectSuggestion({prefix:t},r){if(!this.context)return;let{editor:n,end:o,start:i}=this.context,s=t===" "?"  ":"= it. ";n.transaction({changes:[{from:i,to:o,text:s}],selection:{from:{...i,ch:i.ch+s.length-1}}})}};var qi=class extends ue{#e=null;plugin=this.use(be);settings=this.use(de);#t(){this.plugin.registerEditorSuggest(new Rf(this.plugin.app))}get etaBracketPairing(){return this.settings.current?.autoPairEta}#r(t){let r=this.#e!==null;this.#e===null?(this.#e=[],this.plugin.registerEditorExtension(this.#e)):this.#e.length=0,t&&this.#e.push($R(this.plugin.app.vault)),r&&this.plugin.app.workspace.updateOptions()}onload(){this.#t(),this.register(Le(Qe(()=>this.#r(this.etaBracketPairing),()=>this.etaBracketPairing)))}};fe([pe],qi.prototype,"etaBracketPairing",1);var Cy=e=>{let t=e?.frontmatter?.[ko];return t&&typeof t=="string"&&Gv.test(t)?t:null},Ao=(e,t)=>{if(!e)return null;let r=typeof e=="string"?t.getCache(e):e instanceof _y.TFile?t.getFileCache(e):null;return Cy(r)},No=(e,t)=>{if(!e)return null;let n=(typeof e=="string"?t.getCache(e):e instanceof _y.TFile?t.getFileCache(e):null)?.frontmatter?.[ji];if(n&&Array.isArray(n)&&n.length>0){let o=[];for(let i of n)if(typeof i=="string"){let s=Number(i);if(!(s>0&&Number.isInteger(s)))return null;o.push(s)}else if(typeof i=="number"){if(!(i>0&&Number.isInteger(i)))return null;o.push(i)}return o}return null},Ua=({id:e})=>!!e&&Zv.test(e),Wa=e=>e.split("n").map(t=>{let[,r,,n]=t.split("p")[0].match(Jv);return Bt({key:r,groupID:n?+n:void 0},!0)});function Ha(e,t){let r=RT(e);return!!Ao(r,t.metadataCache)}function Df(e){return e.workspace.activeLeaf?.containerEl.win??window}var aM=require("url");S();var Mn=qe({});S();var Be=qe({});S();var qR=function(e){return typeof e=="function"};var UK=!1,LR=UK;function WK(e){LR&&(qR(e)||console.error("useMemoizedFn expected parameter is a function, got ".concat(typeof e)));var t=F(e);t.current=ne(function(){return e},[e]);var r=F();return r.current||(r.current=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return t.current.apply(this,n)}),r.current}var hr=WK;S();S();function HK(e,t){e===void 0&&(e=!1);var r=kn(j(e),2),n=r[0],o=r[1],i=ne(function(){var s=t===void 0?!e:t,a=function(){return o(function(f){return f===e?s:e})},u=function(f){return o(f)},l=function(){return o(e)},c=function(){return o(s)};return{toggle:a,set:u,setLeft:l,setRight:c}},[]);return[n,i]}var BR=HK;function Pf(e){e===void 0&&(e=!1);var t=kn(BR(!!e),2),r=t[0],n=t[1],o=n.toggle,i=n.set,s=ne(function(){var a=function(){return i(!0)},u=function(){return i(!1)};return{toggle:o,set:function(l){return i(!!l)},setTrue:a,setFalse:u}},[]);return[r,s]}S();function KK(e){var t=function(){return new Set(e)},r=kn(j(t),2),n=r[0],o=r[1],i=function(u){n.has(u)||o(function(l){var c=new Set(l);return c.add(u),c})},s=function(u){n.has(u)&&o(function(l){var c=new Set(l);return c.delete(u),c})},a=function(){return o(t())};return[n,{add:hr(i),remove:hr(s),reset:hr(a)}]}var Ty=KK;S();var UR={},zR=e=>{let t,r=new Set,n=(u,l)=>{let c=typeof u=="function"?u(t):u;if(!Object.is(c,t)){let f=t;t=l??typeof c!="object"?c:Object.assign({},t,c),r.forEach(p=>p(t,f))}},o=()=>t,a={setState:n,getState:o,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(UR.env&&UR.env.MODE)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}};return t=e(n,o,a),a},Ka=e=>e?zR(e):zR;S();var XR=me(YR(),1);var{useSyncExternalStoreWithSelector:lV}=XR.default;function _t(e,t=e.getState,r){let n=lV(e.subscribe,e.getState,e.getServerState||e.getState,t,r);return yo(n),n}function Bi(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,o]of e)if(!Object.is(o,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}let r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(t,r[n])||!Object.is(e[r[n]],t[r[n]]))return!1;return!0}S();function QR(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=eD(t))&&(n&&(n+=" "),n+=r);return n}function eD(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=eD(e[n]))&&(r&&(r+=" "),r+=t);return r}var Ay="-";function nD(e){var t=pV(e);function r(o){var i=o.split(Ay);return i[0]===""&&i.length!==1&&i.shift(),oD(i,t)||fV(o)}function n(o){return e.conflictingClassGroups[o]||[]}return{getClassGroupId:r,getConflictingClassGroupIds:n}}function oD(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),o=n?oD(e.slice(1),n):void 0;if(o)return o;if(t.validators.length!==0){var i=e.join(Ay);return t.validators.find(function(s){var a=s.validator;return a(i)})?.classGroupId}}var tD=/^\[(.+)\]$/;function fV(e){if(tD.test(e)){var t=tD.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function pV(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},o=mV(Object.entries(e.classGroups),r);return o.forEach(function(i){var s=i[0],a=i[1];ky(a,n,s,t)}),n}function ky(e,t,r,n){e.forEach(function(o){if(typeof o=="string"){var i=o===""?t:rD(t,o);i.classGroupId=r;return}if(typeof o=="function"){if(dV(o)){ky(o(n),t,r,n);return}t.validators.push({validator:o,classGroupId:r});return}Object.entries(o).forEach(function(s){var a=s[0],u=s[1];ky(u,rD(t,a),r,n)})})}function rD(e,t){var r=e;return t.split(Ay).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function dV(e){return e.isThemeGetter}function mV(e,t){return t?e.map(function(r){var n=r[0],o=r[1],i=o.map(function(s){return typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(function(a){var u=a[0],l=a[1];return[t+u,l]})):s});return[n,i]}):e}function iD(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function o(i,s){r.set(i,s),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(s){var a=r.get(s);if(a!==void 0)return a;if((a=n.get(s))!==void 0)return o(s,a),a},set:function(s,a){r.has(s)?r.set(s,a):o(s,a)}}}var Ny="!";function sD(e){var t=e.separator||":";return function(n){for(var o=0,i=[],s=0,a=0;a<n.length;a++){var u=n[a];o===0&&u===t[0]&&(t.length===1||n.slice(a,a+t.length)===t)&&(i.push(n.slice(s,a)),s=a+t.length),u==="["?o++:u==="]"&&o--}var l=i.length===0?n:n.substring(s),c=l.startsWith(Ny),f=c?l.substring(1):l;return{modifiers:i,hasImportantModifier:c,baseClassName:f}}}function aD(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var o=n[0]==="[";o?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function uD(e){return{cache:iD(e.cacheSize),splitModifiers:sD(e),...nD(e)}}var hV=/\s+/;function cD(e,t){var r=t.splitModifiers,n=t.getClassGroupId,o=t.getConflictingClassGroupIds,i=new Set;return e.trim().split(hV).map(function(s){var a=r(s),u=a.modifiers,l=a.hasImportantModifier,c=a.baseClassName,f=n(c);if(!f)return{isTailwindClass:!1,originalClassName:s};var p=aD(u).join(":"),d=l?p+Ny:p;return{isTailwindClass:!0,modifierId:d,classGroupId:f,originalClassName:s}}).reverse().filter(function(s){if(!s.isTailwindClass)return!0;var a=s.modifierId,u=s.classGroupId,l=a+u;return i.has(l)?!1:(i.add(l),o(u).forEach(function(c){return i.add(a+c)}),!0)}).reverse().map(function(s){return s.originalClassName}).join(" ")}function lD(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,o,i,s=a;function a(l){var c=t[0],f=t.slice(1),p=f.reduce(function(d,h){return h(d)},c());return n=uD(p),o=n.cache.get,i=n.cache.set,s=u,u(l)}function u(l){var c=o(l);if(c)return c;var f=cD(l,n);return i(l,f),f}return function(){return s(QR.apply(null,arguments))}}function Se(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var pD=/^\[(?:([a-z-]+):)?(.+)\]$/i,gV=/^\d+\/\d+$/,yV=new Set(["px","full","screen"]),bV=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,vV=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh)/,xV=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function rr(e){return zi(e)||yV.has(e)||gV.test(e)||jn(e)}function jn(e){return Ro(e,"length",wV)}function dD(e){return Ro(e,"size",yD)}function mD(e){return Ro(e,"position",yD)}function hD(e){return Ro(e,"url",EV)}function $f(e){return Ro(e,"number",zi)}function zi(e){return!Number.isNaN(Number(e))}function Ui(e){return fD(e)||Ro(e,"number",fD)}function Pe(e){return pD.test(e)}function Wi(){return!0}function tn(e){return bV.test(e)}function gD(e){return Ro(e,"",SV)}function Ro(e,t,r){var n=pD.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function wV(e){return vV.test(e)}function yD(){return!1}function EV(e){return e.startsWith("url(")}function fD(e){return Number.isInteger(Number(e))}function SV(e){return xV.test(e)}function bD(){var e=Se("colors"),t=Se("spacing"),r=Se("blur"),n=Se("brightness"),o=Se("borderColor"),i=Se("borderRadius"),s=Se("borderSpacing"),a=Se("borderWidth"),u=Se("contrast"),l=Se("grayscale"),c=Se("hueRotate"),f=Se("invert"),p=Se("gap"),d=Se("gradientColorStops"),h=Se("inset"),b=Se("margin"),y=Se("opacity"),v=Se("padding"),w=Se("saturate"),T=Se("scale"),M=Se("sepia"),V=Se("skew"),J=Se("space"),G=Se("translate"),K=function(){return["auto","contain","none"]},P=function(){return["auto","hidden","clip","visible","scroll"]},X=function(){return["auto",t]},C=function(){return["",rr]},_=function(){return["auto",zi,Pe]},I=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},B=function(){return["solid","dashed","dotted","double","none"]},D=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},re=function(){return["start","end","center","between","around","evenly"]},oe=function(){return["","0",Pe]},he=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},ae=function(){return[zi,$f]},E=function(){return[zi,Pe]};return{cacheSize:500,theme:{colors:[Wi],spacing:[rr],blur:["none","",tn,jn],brightness:ae(),borderColor:[e],borderRadius:["none","","full",tn,jn],borderSpacing:[t],borderWidth:C(),contrast:ae(),grayscale:oe(),hueRotate:E(),invert:oe(),gap:[t],gradientColorStops:[e],inset:X(),margin:X(),opacity:ae(),padding:[t],saturate:ae(),scale:ae(),sepia:oe(),skew:E(),space:[t],translate:[t]},classGroups:{aspect:[{aspect:["auto","square","video",Pe]}],container:["container"],columns:[{columns:[tn]}],"break-after":[{"break-after":he()}],"break-before":[{"break-before":he()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(I(),[Pe])}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:K()}],"overscroll-x":[{"overscroll-x":K()}],"overscroll-y":[{"overscroll-y":K()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[h]}],"inset-x":[{"inset-x":[h]}],"inset-y":[{"inset-y":[h]}],top:[{top:[h]}],right:[{right:[h]}],bottom:[{bottom:[h]}],left:[{left:[h]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ui]}],basis:[{basis:[t]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Pe]}],grow:[{grow:oe()}],shrink:[{shrink:oe()}],order:[{order:["first","last","none",Ui]}],"grid-cols":[{"grid-cols":[Wi]}],"col-start-end":[{col:["auto",{span:[Ui]},Pe]}],"col-start":[{"col-start":_()}],"col-end":[{"col-end":_()}],"grid-rows":[{"grid-rows":[Wi]}],"row-start-end":[{row:["auto",{span:[Ui]},Pe]}],"row-start":[{"row-start":_()}],"row-end":[{"row-end":_()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Pe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Pe]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:re()}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:[].concat(re(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(re(),["baseline","stretch"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[J]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[J]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",t]}],"min-w":[{"min-w":["min","max","fit",rr]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[tn]},tn,jn]}],h:[{h:[t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",rr]}],"max-h":[{"max-h":[t,"min","max","fit"]}],"font-size":[{text:["base",tn,jn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",$f]}],"font-family":[{font:[Wi]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",jn]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",rr]}],"list-style-type":[{list:["none","disc","decimal",Pe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(B(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",rr]}],"underline-offset":[{"underline-offset":["auto",rr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:[t]}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",jn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap"]}],break:[{break:["normal","words","all","keep"]}],content:[{content:["none",Pe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(I(),[mD])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",dD]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},hD]}],"bg-color":[{bg:[e]}],"gradient-from":[{from:[d]}],"gradient-via":[{via:[d]}],"gradient-to":[{to:[d]}],rounded:[{rounded:[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[].concat(B(),["hidden"])}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:B()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:[""].concat(B())}],"outline-offset":[{"outline-offset":[rr]}],"outline-w":[{outline:[rr]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:C()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[rr]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",tn,gD]}],"shadow-color":[{shadow:[Wi]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":D()}],"bg-blend":[{"bg-blend":D()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",tn,Pe]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[M]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[M]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Pe]}],duration:[{duration:E()}],ease:[{ease:["linear","in","out","in-out",Pe]}],delay:[{delay:E()}],animate:[{animate:["none","spin","ping","pulse","bounce",Pe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[Ui,Pe]}],"translate-x":[{"translate-x":[G]}],"translate-y":[{"translate-y":[G]}],"skew-x":[{"skew-x":[V]}],"skew-y":[{"skew-y":[V]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Pe]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Pe]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":[t]}],"scroll-mx":[{"scroll-mx":[t]}],"scroll-my":[{"scroll-my":[t]}],"scroll-mt":[{"scroll-mt":[t]}],"scroll-mr":[{"scroll-mr":[t]}],"scroll-mb":[{"scroll-mb":[t]}],"scroll-ml":[{"scroll-ml":[t]}],"scroll-p":[{"scroll-p":[t]}],"scroll-px":[{"scroll-px":[t]}],"scroll-py":[{"scroll-py":[t]}],"scroll-pt":[{"scroll-pt":[t]}],"scroll-pr":[{"scroll-pr":[t]}],"scroll-pb":[{"scroll-pb":[t]}],"scroll-pl":[{"scroll-pl":[t]}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Pe]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[rr,$f]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-t","rounded-r","rounded-b","rounded-l","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]}}}var Ry=lD(bD);function ee(...e){return Ry(Wh(e))}S();S();function Mf(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var jf=(e,t)=>{let{setIcon:r}=Q(Mn),n=F(null);return Y(i=>{n.current&&IV.call(n.current),i&&(r(i,e),t&&i.firstElementChild instanceof SVGSVGElement&&i.firstElementChild.style.setProperty("--icon-size",typeof t=="number"||!Number.isNaN(Number(t))?`${t}px`:t)),n.current=i},[e,t,r])};function IV(){for(;this.lastChild;)this.removeChild(this.lastChild)}var qn=st(Z(function({icon:t,size:r,className:n,...o},i){let s=jf(t,r),a=Mf(s,i);return m("div",{ref:a,className:ee("zt-icon",n),...o})}));S();var Do=Z(function({onClick:t,onKeyDown:r,className:n,...o},i){return m(qn,{onClick:t,onKeyDown:r??t,className:ee("clickable-icon",n),...o,ref:i,role:"button",tabIndex:0})});S();S();var vD=st(Z(function({icon:t,...r},n){let o=jf(t);return m("button",{ref:Mf(o,n),...r})}));var Po=Z(function({className:t,active:r=!1,...n},o){return m(vD,{...n,ref:o,className:ee("clickable-icon",{"is-active":r},t)})});function Va(e){return m(Do,{size:16,icon:"info","aria-label":"Show details",...e})}function Ga(){let e=arguments[0];for(let t=1,r=arguments.length;t<r;t++)e=arguments[t](e);return e}S();S();var xD=st(function({content:t,className:r,...n}){let{sanitize:o,renderMarkdown:i}=Q(Mn),s=ne(()=>o(t).replace(/<\/?b>/g,"**").replace(/<\/?i>/g,"*"),[t,o]);return m("div",{className:ee("annot-comment select-text overflow-x-auto break-words px-2 py-1",r),...n,children:i(s)})});S();var wD=Z(function({className:t,...r},n){return m("div",{ref:n,className:ee("annot-excerpt",t),...r})});var ED=me(xn(),1);S();function Dy({text:e,pageLabel:t,className:r,collapsed:n=!1,...o}){let i=e??`Area Excerpt for Page ${t??"?"}`;return m("img",{className:ee("w-full",n?"max-h-20 object-cover object-left-top":"object-scale-down",r),alt:i,...o})}var SD=st(function({type:t,text:r,pageLabel:n,imgSrc:o,collapsed:i}){switch(t){case _e.highlight:case _e.underline:return m("p",{className:"select-text",children:r});case _e.image:if(!o)throw new Error("imgSrc is required for image annotation");return m(Dy,{collapsed:i,src:o,pageLabel:n,text:r});case _e.note:case _e.ink:return m($,{children:["Unsupported Type: ",_e[t]]});default:(0,ED.assertNever)(t)}});function Py({checkbox:e,drag:t,buttons:r,onMoreOptions:n,className:o,children:i,onContextMenu:s,...a}){return m("div",{className:ee("annot-header flex cursor-context-menu items-center gap-1",o),onContextMenu:s??n,...a,children:[e,m("div",{className:"annot-header-drag-container flex flex-row items-center gap-1",children:t}),m("div",{className:"annot-header-buttons-container flex flex-row items-center gap-1 opacity-0 transition-opacity hover:opacity-100",children:r}),m("div",{className:"annot-header-space flex-1"}),i]})}var _V=typeof global=="object"&&global&&global.Object===Object&&global,ID=_V;var CV=typeof self=="object"&&self&&self.Object===Object&&self,TV=ID||CV||Function("return this")(),_D=TV;var OV=_D.Symbol,rn=OV;var CD=Object.prototype,kV=CD.hasOwnProperty,AV=CD.toString,Ja=rn?rn.toStringTag:void 0;function NV(e){var t=kV.call(e,Ja),r=e[Ja];try{e[Ja]=void 0;var n=!0}catch{}var o=AV.call(e);return n&&(t?e[Ja]=r:delete e[Ja]),o}var TD=NV;var RV=Object.prototype,DV=RV.toString;function PV(e){return DV.call(e)}var OD=PV;var FV="[object Null]",$V="[object Undefined]",kD=rn?rn.toStringTag:void 0;function MV(e){return e==null?e===void 0?$V:FV:kD&&kD in Object(e)?TD(e):OD(e)}var AD=MV;function jV(e){return e!=null&&typeof e=="object"}var ND=jV;var qV="[object Symbol]";function LV(e){return typeof e=="symbol"||ND(e)&&AD(e)==qV}var RD=LV;function BV(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var DD=BV;var zV=Array.isArray,PD=zV;var UV=1/0,FD=rn?rn.prototype:void 0,$D=FD?FD.toString:void 0;function MD(e){if(typeof e=="string")return e;if(PD(e))return DD(e,MD)+"";if(RD(e))return $D?$D.call(e):"";var t=e+"";return t=="0"&&1/e==-UV?"-0":t}var jD=MD;function WV(e){return e==null?"":jD(e)}var Hi=WV;function HV(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),r=r>o?o:r,r<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}var qD=HV;function KV(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:qD(e,t,r)}var LD=KV;var VV="\\ud800-\\udfff",GV="\\u0300-\\u036f",JV="\\ufe20-\\ufe2f",ZV="\\u20d0-\\u20ff",YV=GV+JV+ZV,XV="\\ufe0e\\ufe0f",QV="\\u200d",eG=RegExp("["+QV+VV+YV+XV+"]");function tG(e){return eG.test(e)}var qf=tG;function rG(e){return e.split("")}var BD=rG;var zD="\\ud800-\\udfff",nG="\\u0300-\\u036f",oG="\\ufe20-\\ufe2f",iG="\\u20d0-\\u20ff",sG=nG+oG+iG,aG="\\ufe0e\\ufe0f",uG="["+zD+"]",Fy="["+sG+"]",$y="\\ud83c[\\udffb-\\udfff]",cG="(?:"+Fy+"|"+$y+")",UD="[^"+zD+"]",WD="(?:\\ud83c[\\udde6-\\uddff]){2}",HD="[\\ud800-\\udbff][\\udc00-\\udfff]",lG="\\u200d",KD=cG+"?",VD="["+aG+"]?",fG="(?:"+lG+"(?:"+[UD,WD,HD].join("|")+")"+VD+KD+")*",pG=VD+KD+fG,dG="(?:"+[UD+Fy+"?",Fy,WD,HD,uG].join("|")+")",mG=RegExp($y+"(?="+$y+")|"+dG+pG,"g");function hG(e){return e.match(mG)||[]}var GD=hG;function gG(e){return qf(e)?GD(e):BD(e)}var JD=gG;function yG(e){return function(t){t=Hi(t);var r=qf(t)?JD(t):void 0,n=r?r[0]:t.charAt(0),o=r?LD(r,1).join(""):t.slice(1);return n[e]()+o}}var ZD=yG;var bG=ZD("toUpperCase"),YD=bG;function vG(e,t,r,n){var o=-1,i=e==null?0:e.length;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}var XD=vG;function xG(e){return function(t){return e?.[t]}}var QD=xG;var wG={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},EG=QD(wG),eP=EG;var SG=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,IG="\\u0300-\\u036f",_G="\\ufe20-\\ufe2f",CG="\\u20d0-\\u20ff",TG=IG+_G+CG,OG="["+TG+"]",kG=RegExp(OG,"g");function AG(e){return e=Hi(e),e&&e.replace(SG,eP).replace(kG,"")}var tP=AG;var NG=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function RG(e){return e.match(NG)||[]}var rP=RG;var DG=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function PG(e){return DG.test(e)}var nP=PG;var uP="\\ud800-\\udfff",FG="\\u0300-\\u036f",$G="\\ufe20-\\ufe2f",MG="\\u20d0-\\u20ff",jG=FG+$G+MG,cP="\\u2700-\\u27bf",lP="a-z\\xdf-\\xf6\\xf8-\\xff",qG="\\xac\\xb1\\xd7\\xf7",LG="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",BG="\\u2000-\\u206f",zG=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",fP="A-Z\\xc0-\\xd6\\xd8-\\xde",UG="\\ufe0e\\ufe0f",pP=qG+LG+BG+zG,dP="['\u2019]",oP="["+pP+"]",WG="["+jG+"]",mP="\\d+",HG="["+cP+"]",hP="["+lP+"]",gP="[^"+uP+pP+mP+cP+lP+fP+"]",KG="\\ud83c[\\udffb-\\udfff]",VG="(?:"+WG+"|"+KG+")",GG="[^"+uP+"]",yP="(?:\\ud83c[\\udde6-\\uddff]){2}",bP="[\\ud800-\\udbff][\\udc00-\\udfff]",Ki="["+fP+"]",JG="\\u200d",iP="(?:"+hP+"|"+gP+")",ZG="(?:"+Ki+"|"+gP+")",sP="(?:"+dP+"(?:d|ll|m|re|s|t|ve))?",aP="(?:"+dP+"(?:D|LL|M|RE|S|T|VE))?",vP=VG+"?",xP="["+UG+"]?",YG="(?:"+JG+"(?:"+[GG,yP,bP].join("|")+")"+xP+vP+")*",XG="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",QG="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",eJ=xP+vP+YG,tJ="(?:"+[HG,yP,bP].join("|")+")"+eJ,rJ=RegExp([Ki+"?"+hP+"+"+sP+"(?="+[oP,Ki,"$"].join("|")+")",ZG+"+"+aP+"(?="+[oP,Ki+iP,"$"].join("|")+")",Ki+"?"+iP+"+"+sP,Ki+"+"+aP,QG,XG,mP,tJ].join("|"),"g");function nJ(e){return e.match(rJ)||[]}var wP=nJ;function oJ(e,t,r){return e=Hi(e),t=r?void 0:t,t===void 0?nP(e)?wP(e):rP(e):e.match(t)||[]}var EP=oJ;var iJ="['\u2019]",sJ=RegExp(iJ,"g");function aJ(e){return function(t){return XD(EP(tP(t).replace(sJ,"")),e,"")}}var SP=aJ;var uJ=SP(function(e,t,r){return e+(r?" ":"")+YD(t)}),My=uJ;S();var IP=st(function({icon:t,color:r,type:n,className:o,...i}){let s=My(_e[n]);return m(qn,{icon:t,style:{color:r??void 0},className:ee(o,"annot-type-icon","flex h-auto cursor-grab items-center justify-center opacity-[var(--icon-opacity)]"),"aria-label":s,"aria-label-delay":"500",...i})});var _P=me(xn(),1),CP=e=>{switch(e){case _e.highlight:return"align-left";case _e.underline:return"underline";case _e.image:return"frame";case _e.note:case _e.ink:return"file-question";default:(0,_P.assertNever)(e)}};S();var TP=e=>{let{annotRenderer:t,store:r}=Q(Be),n=_t(r,t.storeSelector,Bi);return t.get(e,n)};S();var OP=e=>{let{getImgSrc:t}=Q(Be);return ne(()=>t(e),[e,t])};function jy({className:e,...t}){return m(Do,{icon:"more-vertical",className:ee("annot-header-more-options",e),"aria-label":"More options",size:"0.9rem","aria-label-delay":"50",...t})}S();var kP=st(function({pageLabel:t,backlink:r,className:n,...o}){let i=t?`Page ${t}`:"";return r?m("a",{className:ee("annot-page","external-link","bg-[length:12px] bg-[center_right_3px] pr-[18px] text-xs",n),href:r,"aria-label":`Open annotation in Zotero at page ${t}`,"aria-label-delay":"500",...o,children:i}):m("span",{className:ee("annot-page",n),children:i})});S();function qy({tags:e}){return e.length===0?null:m("div",{className:"annot-tags-container",children:e.map(t=>m(cJ,{...t},t.tagID))})}var cJ=st(function({name:t}){return m("a",{className:ee("tag","annot-tag"),children:t})});function Ly({collapsed:e=!1,annotation:t,checkbox:r,tags:n,className:o,...i}){let s=F(null),{onMoreOptions:a,onDragStart:u,onShowDetails:l}=Q(Be),c=Xh.selectKeys(t,["type","text","pageLabel"]),f=TP(t),p=hr(h=>a(h,t)),d=hr(()=>l("annot",t.itemID));return m("div",{className:ee("annot-preview","bg-primary shadow-border col-span-1 flex flex-col divide-y overflow-auto rounded-sm transition-colors",o),"data-id":t.itemID,...i,children:[m(Py,{className:"bg-primary-alt py-1 pl-2 pr-1",checkbox:r,drag:m(IP,{type:t.type,color:t.color,icon:CP(t.type),draggable:f!==null,onDragStart:hr(h=>f&&u(h,f,s.current)),size:16}),buttons:m($,{children:[m(Va,{className:"p-0.5",size:14,onClick:d}),m(jy,{className:"p-0",onClick:p})]}),onMoreOptions:p,children:m(kP,{pageLabel:t.pageLabel,backlink:Nn(t)})}),m(wD,{ref:s,className:"px-2 py-1",children:m("blockquote",{className:ee("border-l-blockquote pl-2 leading-tight",{"line-clamp-3":e}),style:{borderColor:t.color??"var(--interactive-accent)"},children:m(SD,{...c,collapsed:e,imgSrc:OP(t)})})}),t.comment&&m(xD,{content:t.comment}),n&&m(qy,{tags:n})]})}function By({selectable:e=!1,collapsed:t,annotations:r,getTags:n}){let[o,{add:i,remove:s}]=Ty();return m("div",{role:"list",className:"@md:grid-cols-2 @md:gap-3 @3xl:grid-cols-4 grid grid-cols-1 gap-2",children:r.map(a=>m(Ly,{checkbox:e&&m(lJ,{checked:o.has(a.itemID),onChange:u=>u?i(a.itemID):s(a.itemID)}),collapsed:t,role:"listitem",annotation:a,tags:n(a.itemID)},a.itemID))})}function lJ({checked:e,onChange:t}){return m("div",{className:"flex h-5 items-center",children:m("input",{type:"checkbox",className:"m-0 h-4 w-4",checked:e,onChange:r=>t(r.target.checked)})})}S();var fJ=()=>_t(Q(Be).store,e=>({attachments:e.allAttachments,onChange:e.setActiveAtch,value:e.attachmentID}),Bi);function zy(){let{attachments:e,onChange:t,value:r}=fJ();return e?e.length===1?null:e.length<=0?m("span",{className:"atch-select-empty",children:"No attachments available"}):m("select",{className:"atch-select",onChange:n=>t(parseInt(n.target.value,10)),value:r??void 0,children:e.map(({itemID:n,path:o,annotCount:i})=>m("option",{value:n,children:["(",i,") ",o?.replace(/^storage:/,"")]},n))}):m($,{children:"Loading"})}function Uy({isCollapsed:e,...t}){return m(Po,{...t,icon:e?"chevrons-up-down":"chevrons-down-up","aria-label":e?"Expand":"Collapse"})}S();function Lf(e){let{store:t,onSetFollow:r}=Q(Be),n=_t(t,s=>s.follow),o=n===null?"not following":n==="ob-note"?"active literature note":"active literature in Zotero reader";return m($,{children:[m(Po,{...e,onClick:r,icon:n===null?"unlink":"link","aria-label":"Choose follow mode"+(n===null?" (Currently linked with literature)":""),"aria-label-delay":"50"}),n!==null&&m("span",{className:"ml-1","aria-label":`Following ${o}`,children:n==="ob-note"?"ob":"zt"})]})}function Bf({children:e,buttons:t}){return m("div",{className:"nav-header",children:[m("div",{className:"nav-buttons-container",children:t}),e]})}function Wy(e){return m(Po,{...e,icon:"refresh-ccw","aria-label":"Refresh annotation list","aria-label-delay":"50"})}var pJ=()=>{let{registerDbUpdate:e,store:t}=Q(Be),r=_t(t,n=>n.refresh);U(()=>e(r),[e,r])};function Za(){pJ();let{store:e}=Q(Be),t=_t(e,r=>r.doc);return t?m(dJ,{docItem:t.docItem}):m($,{children:[m(Bf,{buttons:m(Lf,{})}),m("div",{className:"pane-empty p-2",children:"Active file not literature note"})]})}function dJ({docItem:e}){let{refreshConn:t,onShowDetails:r}=Q(Be),[n,{toggle:o}]=Pf(!1),i=mJ();return m($,{children:[m(Bf,{buttons:m($,{children:[m(Va,{className:"nav-action-button",onClick:hr(()=>r("doc-item",e.itemID))}),m(Uy,{className:"nav-action-button",isCollapsed:n,onClick:o}),m(Wy,{className:"nav-action-button",onClick:t}),m(Lf,{})]}),children:m(zy,{})}),m("div",{className:ee("annots-container @container","overflow-auto px-3 pt-1 pb-8 text-xs"),children:i?m(By,{collapsed:n,...i}):m($,{children:"Loading"})})]})}var mJ=()=>_t(Q(Be).store,e=>!e.doc||!e.annotations||!e.attachment?null:{annotations:e.annotations,getTags:t=>e.tags[t]??[]},Bi);S();function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ce.apply(this,arguments)}function Hy(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function zf(e,t=166){let r;function n(...o){let i=()=>{e.apply(this,o)};clearTimeout(r),r=setTimeout(i,t)}return n.clear=()=>{clearTimeout(r)},n}function Ky(e){return e&&e.ownerDocument||document}function Ya(e){return Ky(e).defaultView||window}function Vy(e,t){typeof e=="function"?e(t):e&&(e.current=t)}S();var hJ=typeof window<"u"?Et:U,Gy=hJ;S();function Uf(...e){return ne(()=>e.every(t=>t==null)?null:t=>{e.forEach(r=>{Vy(r,t)})},e)}S();S();var gJ=["onChange","maxRows","minRows","style","value"];function Wf(e){return parseInt(e,10)||0}var yJ={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function AP(e){return e==null||Object.keys(e).length===0||e.outerHeightStyle===0&&!e.overflow}var bJ=Z(function(t,r){let{onChange:n,maxRows:o,minRows:i=1,style:s,value:a}=t,u=Hy(t,gJ),{current:l}=F(a!=null),c=F(null),f=Uf(r,c),p=F(null),d=F(0),[h,b]=j({outerHeightStyle:0}),y=Y(()=>{let V=c.current,G=Ya(V).getComputedStyle(V);if(G.width==="0px")return{outerHeightStyle:0};let K=p.current;K.style.width=G.width,K.value=V.value||t.placeholder||"x",K.value.slice(-1)===`
`&&(K.value+=" ");let P=G.boxSizing,X=Wf(G.paddingBottom)+Wf(G.paddingTop),C=Wf(G.borderBottomWidth)+Wf(G.borderTopWidth),_=K.scrollHeight;K.value="x";let I=K.scrollHeight,B=_;i&&(B=Math.max(Number(i)*I,B)),o&&(B=Math.min(Number(o)*I,B)),B=Math.max(B,I);let D=B+(P==="border-box"?X+C:0),re=Math.abs(B-_)<=1;return{outerHeightStyle:D,overflow:re}},[o,i,t.placeholder]),v=(V,J)=>{let{outerHeightStyle:G,overflow:K}=J;return d.current<20&&(G>0&&Math.abs((V.outerHeightStyle||0)-G)>1||V.overflow!==K)?(d.current+=1,{overflow:K,outerHeightStyle:G}):V},w=Y(()=>{let V=y();AP(V)||b(J=>v(J,V))},[y]),T=()=>{let V=y();AP(V)||Rr(()=>{b(J=>v(J,V))})};return U(()=>{let V=zf(()=>{d.current=0,c.current&&T()}),J,G=c.current,K=Ya(G);return K.addEventListener("resize",V),typeof ResizeObserver<"u"&&(J=new ResizeObserver(V),J.observe(G)),()=>{V.clear(),K.removeEventListener("resize",V),J&&J.disconnect()}}),Gy(()=>{w()}),U(()=>{d.current=0},[a]),m($,{children:[m("textarea",ce({value:a,onChange:V=>{d.current=0,l||w(),n&&n(V)},ref:f,rows:i,style:ce({height:h.outerHeightStyle,overflow:h.overflow?"hidden":void 0},s)},u)),m("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:p,tabIndex:-1,style:ce({},yJ.shadow,s,{padding:0})})]})}),Xa=bJ;S();S();S();S();function vJ(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function Jy(...e){return t=>e.forEach(r=>vJ(r,t))}function Hf(...e){return Y(Jy(...e),e)}S();function NP(e,t=[]){let r=[];function n(i,s){let a=qe(s),u=r.length;r=[...r,s];function l(f){let{scope:p,children:d,...h}=f,b=p?.[e][u]||a,y=ne(()=>h,Object.values(h));return H(b.Provider,{value:y},d)}function c(f,p){let d=p?.[e][u]||a,h=Q(d);if(h)return h;if(s!==void 0)return s;throw new Error(`\`${f}\` must be used within \`${i}\``)}return l.displayName=i+"Provider",[l,c]}let o=()=>{let i=r.map(s=>qe(s));return function(a){let u=a?.[e]||i;return ne(()=>({[`__scope${e}`]:{...a,[e]:u}}),[a,u])}};return o.scopeName=e,[n,xJ(o,...t)]}function xJ(...e){let t=e[0];if(e.length===1)return t;let r=()=>{let n=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){let s=n.reduce((a,{useScope:u,scopeName:l})=>{let f=u(i)[`__scope${l}`];return{...a,...f}},{});return ne(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}function Ct(e,t,{checkForDefaultPrevented:r=!0}={}){return function(o){if(e?.(o),r===!1||!o.defaultPrevented)return t?.(o)}}S();S();function Zy(e){let t=F(e);return U(()=>{t.current=e}),ne(()=>(...r)=>{var n;return(n=t.current)===null||n===void 0?void 0:n.call(t,...r)},[])}function RP({prop:e,defaultProp:t,onChange:r=()=>{}}){let[n,o]=wJ({defaultProp:t,onChange:r}),i=e!==void 0,s=i?e:n,a=Zy(r),u=Y(l=>{if(i){let f=typeof l=="function"?l(e):l;f!==e&&a(f)}else o(l)},[i,e,o,a]);return[s,u]}function wJ({defaultProp:e,onChange:t}){let r=j(e),[n]=r,o=F(n),i=Zy(t);return U(()=>{o.current!==n&&(i(n),o.current=n)},[n,o,i]),r}S();function DP(e){let t=F({value:e,previous:e});return ne(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}S();S();var Qa=globalThis?.document?Et:()=>{};function PP(e){let[t,r]=j(void 0);return Qa(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let n=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;let i=o[0],s,a;if("borderBoxSize"in i){let u=i.borderBoxSize,l=Array.isArray(u)?u[0]:u;s=l.inlineSize,a=l.blockSize}else s=e.offsetWidth,a=e.offsetHeight;r({width:s,height:a})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}S();S();function EJ(e,t){return Nr((r,n)=>{let o=t[r][n];return o??r},e)}var Yy=e=>{let{present:t,children:r}=e,n=SJ(t),o=typeof r=="function"?r({present:n.isPresent}):Ve.only(r),i=Hf(n.ref,o.ref);return typeof r=="function"||n.isPresent?Xt(o,{ref:i}):null};Yy.displayName="Presence";function SJ(e){let[t,r]=j(),n=F({}),o=F(e),i=F("none"),s=e?"mounted":"unmounted",[a,u]=EJ(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return U(()=>{let l=Kf(n.current);i.current=a==="mounted"?l:"none"},[a]),Qa(()=>{let l=n.current,c=o.current;if(c!==e){let p=i.current,d=Kf(l);e?u("MOUNT"):d==="none"||l?.display==="none"?u("UNMOUNT"):u(c&&p!==d?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,u]),Qa(()=>{if(t){let l=f=>{let d=Kf(n.current).includes(f.animationName);f.target===t&&d&&Rr(()=>u("ANIMATION_END"))},c=f=>{f.target===t&&(i.current=Kf(n.current))};return t.addEventListener("animationstart",c),t.addEventListener("animationcancel",l),t.addEventListener("animationend",l),()=>{t.removeEventListener("animationstart",c),t.removeEventListener("animationcancel",l),t.removeEventListener("animationend",l)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:Y(l=>{l&&(n.current=getComputedStyle(l)),r(l)},[])}}function Kf(e){return e?.animationName||"none"}S();S();S();var Qy=Z((e,t)=>{let{children:r,...n}=e,o=Ve.toArray(r),i=o.find(_J);if(i){let s=i.props.children,a=o.map(u=>u===i?Ve.count(s)>1?Ve.only(null):Pt(s)?s.props.children:null:u);return H(Xy,ce({},n,{ref:t}),Pt(s)?Xt(s,void 0,a):null)}return H(Xy,ce({},n,{ref:t}),r)});Qy.displayName="Slot";var Xy=Z((e,t)=>{let{children:r,...n}=e;return Pt(r)?Xt(r,{...CJ(n,r.props),ref:Jy(t,r.ref)}):Ve.count(r)>1?Ve.only(null):null});Xy.displayName="SlotClone";var IJ=({children:e})=>H($,null,e);function _J(e){return Pt(e)&&e.type===IJ}function CJ(e,t){let r={...t};for(let n in t){let o=e[n],i=t[n];/^on[A-Z]/.test(n)?o&&i?r[n]=(...a)=>{i(...a),o(...a)}:o&&(r[n]=o):n==="style"?r[n]={...o,...i}:n==="className"&&(r[n]=[o,i].filter(Boolean).join(" "))}return{...e,...r}}var TJ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],eb=TJ.reduce((e,t)=>{let r=Z((n,o)=>{let{asChild:i,...s}=n,a=i?Qy:t;return U(()=>{window[Symbol.for("radix-ui")]=!0},[]),H(a,ce({},s,{ref:o}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});var FP="Checkbox",[OJ,lOe]=NP(FP),[kJ,AJ]=OJ(FP),NJ=Z((e,t)=>{let{__scopeCheckbox:r,name:n,checked:o,defaultChecked:i,required:s,disabled:a,value:u="on",onCheckedChange:l,...c}=e,[f,p]=j(null),d=Hf(t,T=>p(T)),h=F(!1),b=f?!!f.closest("form"):!0,[y=!1,v]=RP({prop:o,defaultProp:i,onChange:l}),w=F(y);return U(()=>{let T=f?.form;if(T){let M=()=>v(w.current);return T.addEventListener("reset",M),()=>T.removeEventListener("reset",M)}},[f,v]),H(kJ,{scope:r,state:y,disabled:a},H(eb.button,ce({type:"button",role:"checkbox","aria-checked":Fo(y)?"mixed":y,"aria-required":s,"data-state":$P(y),"data-disabled":a?"":void 0,disabled:a,value:u},c,{ref:d,onKeyDown:Ct(e.onKeyDown,T=>{T.key==="Enter"&&T.preventDefault()}),onClick:Ct(e.onClick,T=>{v(M=>Fo(M)?!0:!M),b&&(h.current=T.isPropagationStopped(),h.current||T.stopPropagation())})})),b&&H(PJ,{control:f,bubbles:!h.current,name:n,value:u,checked:y,required:s,disabled:a,style:{transform:"translateX(-100%)"}}))}),RJ="CheckboxIndicator",DJ=Z((e,t)=>{let{__scopeCheckbox:r,forceMount:n,...o}=e,i=AJ(RJ,r);return H(Yy,{present:n||Fo(i.state)||i.state===!0},H(eb.span,ce({"data-state":$P(i.state),"data-disabled":i.disabled?"":void 0},o,{ref:t,style:{pointerEvents:"none",...e.style}})))}),PJ=e=>{let{control:t,checked:r,bubbles:n=!0,...o}=e,i=F(null),s=DP(r),a=PP(t);return U(()=>{let u=i.current,l=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(l,"checked").set;if(s!==r&&f){let p=new Event("click",{bubbles:n});u.indeterminate=Fo(r),f.call(u,Fo(r)?!1:r),u.dispatchEvent(p)}},[s,r,n]),H("input",ce({type:"checkbox","aria-hidden":!0,defaultChecked:Fo(r)?!1:r},o,{tabIndex:-1,ref:i,style:{...e.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function Fo(e){return e==="indeterminate"}function $P(e){return Fo(e)?"indeterminate":e?"checked":"unchecked"}var tb=NJ,MP=DJ;S();var rb=Z(({className:e,checked:t,...r},n)=>m(tb,{ref:n,className:ee("data-[state=checked]:text-mod-error peer h-3 w-3 shrink-0 rounded-sm border disabled:cursor-not-allowed disabled:opacity-50 bg-primary obzt-btn-reset",e),checked:t,...r,children:m(MP,{className:ee("flex items-center justify-center"),children:m(qn,{icon:"chevrons-down",size:"0.75rem",className:"contents"})})}));rb.displayName=tb.displayName;var jP=Z(({id:e,checked:t,onCheckChange:r,title:n,disabled:o,className:i,...s},a)=>m("div",{className:ee("flex items-center gap-x-1","rounded-sm focus-within:outline-none focus-within:ring-2 focus-within:ring-mod-border-focus focus-within:ring-offset-2",t&&"animate-pulse",i),ref:a,...s,children:[m(rb,{className:ee("h-3 w-3",o&&"hidden"),id:e,checked:t,disabled:o,onCheckedChange:r}),m("label",{htmlFor:e,className:"peer-[[data-state=checked]]:text-mod-error text-status-bar text-txt-status-bar leading-none peer-disabled:cursor-not-allowed",children:n})]}));jP.displayName="ImportingStatus";var Xp=require("obsidian");S();var Vi=require("obsidian");S();var qP={sanitize:DOMPurify.sanitize.bind(DOMPurify),setIcon:Vi.setIcon,renderMarkdown(e){return m($J,{content:e})}};function $J({content:e}){let t=F(null);return m("div",{className:"contents",ref:n=>{n?(n.empty(),t.current&&t.current.unload(),t.current=new Vi.Component,Vi.MarkdownRenderer.renderMarkdown(e,n,"",t.current)):t.current&&(t.current.unload(),t.current=null)}})}var $o=require("obsidian"),Vf=class extends $o.FileView{constructor(t){super(t),this.navigation=!1,this.allowNoFile=!0,this.requestUpdate=(0,$o.debounce)(()=>this.update(),10)}load(){super.load(),this.registerEvent(this.app.workspace.on("file-open",this.onFileOpen,this))}async setState(t,r){if(!Object.hasOwn(t,"file")&&!Object.hasOwn(t,"group")){let n=this.leaf.workspace.getActiveFile();n&&(t.file=n?.path)}await super.setState(t,r)}onLoadFile(t){return this.requestUpdate()}onUnloadFile(t){return this.requestUpdate()}onFileOpen(t){this.leaf.group||this.leaf.pinned||(t instanceof $o.TFile?this.loadFile(t):this.loadFile(null),this.requestUpdate())}onGroupChange(){if(super.onGroupChange(),this.leaf.group)for(let t=0,r=this.leaf.workspace.getGroupLeaves(this.leaf.group);t<r.length;t++){let n=r[t];if(n!==this.leaf&&n.view instanceof $o.FileView){let o=n.view.getSyncViewState();this.leaf.openFile(n.view.file,o)}}else{let t=this.leaf.workspace.getActiveFile();this.loadFile(t)}}};var LP=require("obsidian");var Gf=require("obsidian"),Jf="zt-citations",Zf=async(e,t)=>typeof e=="string"&&e.trim().length>0?await t.database.search(e):await t.database.getItemsOf(50);function Yf({item:e,fields:t},r){r.addClass("mod-complex");let n=r.createDiv("suggestion-content").createDiv("suggestion-title").createSpan(),o=r.createDiv("suggestion-aux");for(let a of t){let u=o.createEl("kbd","suggestion-hotkey");switch(u.setAttribute("aria-label",a),a){case"title":(0,Gf.setIcon)(u,"type");break;case"creators":(0,Gf.setIcon)(u,"user");break;case"date":(0,Gf.setIcon)(u,"calendar");break;default:u.setText(a);break}}let[i]=e.title??[],s=n.createDiv({cls:"title"});typeof i=="string"&&i?s.setText(i):s.setText("Title missing"),this.plugin.settings.current?.showCitekeyInSuggester&&e.citekey&&n.createDiv({cls:"citekey",text:e.citekey}),MJ(e)&&n.append(jJ(e))}var MJ=e=>e.itemType==="journalArticle",jJ=e=>{let{creators:t,date:r,publicationTitle:n,volume:o,issue:i,pages:s}=e,a={creators:qJ(t),date:r,publication:n,volume:o,issue:i,pages:s},u=(l,c,f)=>a[c]&&l.createSpan({cls:f??c,text:a[c]??void 0});return createDiv({cls:"meta"},l=>{(a.creators||a.date)&&l.createSpan({cls:"author-year"},c=>{u(c,"creators"),u(c,"date")}),u(l,"publication"),(a.volume||a.issue)&&l.createSpan({cls:"vol-issue"},c=>{u(c,"volume"),u(c,"issue")}),u(l,"pages")})},qJ=e=>{if(!e||!e[0])return"";let t=e[0],r=Fl(t)||$l(t)?t.lastName:"";return e.length>1&&(r=r.trim()+" et al."),r};var eu=class extends LP.EditorSuggest{constructor(r){super(r.app);this.plugin=r;this.suggestEl.addClass(Jf)}getSuggestions(r){return Zf(r.query,this.plugin)}renderSuggestion=Yf.bind(this)};var nn=class extends Ml{constructor(r){super(r.app);this.plugin=r;this.modalEl.addClass(Jf)}getSuggestions(r){return Zf(r,this.plugin)}renderSuggestion=Yf.bind(this);onChooseSuggestion(){}};var UP=require("obsidian");var BP=require("@codemirror/state");async function zP(e,t,r=t.settings.current?.updateOverwrite){let{app:n,noteIndex:o,templateRenderer:i}=t,s=o.getNotesFor(e);if(s.length===0)return null;let a=t.settings.libId,u=await t.databaseAPI.getAttachments(e.itemID,a),l=new Set(s.flatMap(y=>No(y,t.app.metadataCache))),c=u.filter(y=>l.has(y.itemID)),f;c.length===0&&(f=await Zr(u,t.app),f&&(Ni(f,e),c.push(f)));let p=await t.databaseAPI.getNotes(e.itemID,a).then(y=>t.noteParser.normalizeNotes(y)),d=await tu(e,{all:u,selected:c,notes:p},t),h=Object.values(d)[0],b={notes:s.length,addedAnnots:0,updatedAnnots:0};for(let y of s){let v=n.metadataCache.getCache(y);if(!v)continue;let w=No(y,t.app.metadataCache);w||(f===void 0&&(f=await Zr(c,t.app)),f?w=[f.itemID]:w=[]);let T=n.vault.getAbstractFileByPath(y),M={plugin:t,sourcePath:y};if(r){let _=await i.renderNote(d[w[0]],M);await n.vault.modify(T,_);continue}let V=Ga((v.sections?.filter(Ua)??[]).flatMap(_=>Wa(_.id).map(I=>[I,_.position])),vo(([_])=>_),Ai((_,I)=>({key:_,blocks:I.map(([B,D])=>D)}))),J=new Set(Object.values(v.blocks??{})?.filter(Ua).flatMap(_=>Wa(_.id).map(I=>I))),G=new Map(w.map(_=>[d[_],[]])),K=[];if(await Promise.all(w.map(async _=>{let I=d[_];if(!(!I.annotations||I.annotations.length===0))return await Promise.all(I.annotations.map(async B=>{let D=Bt(B,!0),re=V[D];if(re){if(!t.settings.current?.updateAnnotBlock)return;let oe=await i.renderAnnot(B,I,M);K.push(...re.blocks.map(he=>({from:he.start.offset,to:he.end.offset,insert:oe})))}else J.has(D)||G.get(I).push(B)})??[])})),K.length>0){let _=BP.EditorState.create({doc:await n.vault.read(T)}).update({changes:K}).state.doc.toString();await n.vault.modify(T,_)}await i.setFrontmatterTo(T,It(h,M).docItem);let P=[...G].reduce((_,[I,B])=>{if(B.length===0)return _;let D=i.renderAnnots({...I,annotations:B},M);return(_&&_+`
`)+D},"");P&&await n.vault.append(T,P);let X=K.length,C=[...G.values()].reduce((_,I)=>_+I.length,0);b.updatedAnnots+=X,b.addedAnnots+=C}return b}async function tu(e,{all:t,selected:r,notes:n},o){let i=o.settings.libId,s=await o.databaseAPI.getTags([[e.itemID,i]]);if(r.length===0)return{[-1]:{docItem:e,attachment:null,tags:s,allAttachments:t,annotations:[],notes:n}};let a={};for(let u of r){let l=u?await o.databaseAPI.getAnnotations(u.itemID,i):[];a[u.itemID]={docItem:e,attachment:u,tags:{...s,...await o.databaseAPI.getTags(l.map(c=>[c.itemID,i]))},allAttachments:t,annotations:l,notes:n}}return a}async function Xf({alt:e,item:t},{start:r,end:n,editor:o,file:i},s){let{plugin:a}=s,u=a.settings.libId,l=await a.databaseAPI.getAttachments(t.itemID,u),c=new Set(No(i,a.app.metadataCache)),f=l.filter(y=>c.has(y.itemID)),p;f.length===0&&(p=await Zr(l,a.app),p&&(Ni(p,t),f.push(p)));let d=await a.databaseAPI.getNotes(t.itemID,u).then(y=>a.noteParser.normalizeNotes(y)),h=await tu(t,{all:l,selected:f,notes:d},s.plugin),b=s.renderCitations(Object.values(h),{plugin:s.plugin},e);o.replaceRange(b,r,n),o.setCursor(o.offsetToPos(o.posToOffset(r)+b.length))}var WP=e=>UP.Keymap.isModifier(e,"Shift");var LJ=[{command:"\u2191\u2193",purpose:"to navigate"},{command:"\u21B5",purpose:"to insert primary Markdown citation"},{command:"\u21B5 (end with /)",purpose:"Insert secondary Markdown citation"}],ru=class extends eu{constructor(r){super(r);this.plugin=r;this.setInstructions(LJ)}onTrigger(r,n){if(!this.plugin.settings.current?.citationEditorSuggester)return null;let o=n.getLine(r.line),s=o.substring(0,r.ch).match(/\[@([\w\- ]*)\/?$/);if(!s)return null;let a={...r};return o[r.ch]==="]"&&(a.ch+=1),{end:a,start:{ch:s.index,line:r.line,alt:!!s[0]?.endsWith("/")},query:s[1]}}selectSuggestion(r){this.context&&Xf({item:r.item,alt:this.context.start.alt??!1},this.context,this.plugin.templateRenderer)}};var BJ=[{command:"\u2191\u2193",purpose:"to navigate"},{command:"\u21B5",purpose:"to insert Markdown citation"},{command:"shift \u21B5",purpose:"to insert secondary Markdown citation"},{command:"esc",purpose:"to dismiss"}],nb=class extends nn{constructor(r){super(r);this.plugin=r;this.setInstructions(BJ)}};async function ob(e,t,r){let n=await Qf(r);if(!n)return!1;let o=e.getCursor();return await Xf({item:n.value.item,alt:WP(n.evt)},{start:o,end:o,editor:e,file:t},r.templateRenderer),!0}async function Qf(e){return await wo(new nb(e))}var Bo=require("obsidian");S();S();S();S();var Bn=me(Ln());S();function sb(e){let t=Object.prototype.toString.call(e).slice(8,-1);return t==="Object"&&typeof e[Symbol.iterator]=="function"?"Iterable":t==="Custom"&&e.constructor!==Object&&e instanceof Object?"Object":t}var GP=me(Ln());S();var ou=me(Ln());S();var HP=me(Ln());S();function nu(e){let{styling:t,arrowStyle:r="single",expanded:n,nodeType:o,onClick:i}=e;return R.createElement("div",(0,HP.default)({},t("arrowContainer",r),{onClick:i}),R.createElement("div",t(["arrow","arrowSign"],o,n,r),"\u25B6",r==="double"&&R.createElement("div",t(["arrowSign","arrowSignInner"]),"\u25B6")))}function zJ(e,t){return e==="Object"?Object.keys(t).length:e==="Array"?t.length:1/0}function UJ(e){return typeof e.set=="function"}function WJ(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1/0,i;if(e==="Object"){let s=Object.getOwnPropertyNames(t);r&&s.sort(r===!0?void 0:r),s=s.slice(n,o+1),i={entries:s.map(a=>({key:a,value:t[a]}))}}else if(e==="Array")i={entries:t.slice(n,o+1).map((s,a)=>({key:a+n,value:s}))};else{let s=0,a=[],u=!0,l=UJ(t);for(let c of t){if(s>o){u=!1;break}n<=s&&(l&&Array.isArray(c)?typeof c[0]=="string"||typeof c[0]=="number"?a.push({key:c[0],value:c[1]}):a.push({key:`[entry ${s}]`,value:{"[key]":c[0],"[value]":c[1]}}):a.push({key:s,value:c})),s++}i={hasMore:!u,entries:a}}return i}function ab(e,t,r){let n=[];for(;t-e>r*r;)r=r*r;for(let o=e;o<=t;o+=r)n.push({from:o,to:Math.min(t,o+r-1)});return n}function ub(e,t,r,n){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,s=WJ.bind(null,e,t,r);if(!n)return s().entries;let a=i<1/0,u=Math.min(i-o,zJ(e,t));if(e!=="Iterable"){if(u<=n||n<7)return s(o,i).entries}else if(u<=n&&!a)return s(o,i).entries;let l;if(e==="Iterable"){let{hasMore:c,entries:f}=s(o,o+n-1);l=c?[...f,...ab(o+n,o+2*n-1,n)]:f}else l=a?ab(o,i,n):[...s(0,n-5).entries,...ab(n-4,u-5,n),...s(u-4,u-1).entries];return l}var KP=me(Ln());S();function cb(e){let{styling:t,from:r,to:n,renderChildNodes:o,nodeType:i}=e,[s,a]=j(!1),u=Y(()=>{a(!s)},[s]);return s?R.createElement("div",t("itemRange",s),o(e,r,n)):R.createElement("div",(0,KP.default)({},t("itemRange",s),{onClick:u}),R.createElement(nu,{nodeType:i,styling:t,expanded:!1,onClick:u,arrowStyle:"double"}),`${r} ... ${n}`)}function HJ(e){return e.to!==void 0}function VP(e,t,r){let{nodeType:n,data:o,collectionLimit:i,circularCache:s,keyPath:a,postprocessValue:u,sortObjectKeys:l}=e,c=[];return ub(n,o,l,i,t,r).forEach(f=>{if(HJ(f))c.push(R.createElement(cb,(0,ou.default)({},e,{key:`ItemRange--${f.from}-${f.to}`,from:f.from,to:f.to,renderChildNodes:VP})));else{let{key:p,value:d}=f,h=s.indexOf(d)!==-1;c.push(R.createElement(iu,(0,ou.default)({},e,{postprocessValue:u,collectionLimit:i,key:`Node--${p}`,keyPath:[p,...a],value:u(d),circularCache:[...s,d],isCircular:h,hideRoot:!1})))}}),c}function Mo(e){let{circularCache:t=[],collectionLimit:r,createItemString:n,data:o,expandable:i,getItemString:s,hideRoot:a,isCircular:u,keyPath:l,labelRenderer:c,level:f=0,nodeType:p,nodeTypeIndicator:d,shouldExpandNodeInitially:h,styling:b}=e,[y,v]=j(u?!1:h(l,o,f)),w=Y(()=>{i&&v(!y)},[i,y]),T=y||a&&f===0?VP({...e,circularCache:t,level:f+1}):null,M=R.createElement("span",b("nestedNodeItemType",y),d),V=s(p,o,M,n(o,r),l),J=[l,p,y,i];return a?R.createElement("li",b("rootNode",...J),R.createElement("ul",b("rootNodeChildren",...J),T)):R.createElement("li",b("nestedNode",...J),i&&R.createElement(nu,{styling:b,nodeType:p,expanded:y,onClick:w}),R.createElement("label",(0,ou.default)({},b(["label","nestedNodeLabel"],...J),{onClick:w}),c(...J)),R.createElement("span",(0,ou.default)({},b("nestedNodeItemString",...J),{onClick:w}),V),R.createElement("ul",b("nestedNodeChildren",...J),T))}function KJ(e){let t=Object.getOwnPropertyNames(e).length;return`${t} ${t!==1?"keys":"key"}`}function lb(e){let{data:t,...r}=e;return R.createElement(Mo,(0,GP.default)({},r,{data:t,nodeType:"Object",nodeTypeIndicator:r.nodeType==="Error"?"Error()":"{}",createItemString:KJ,expandable:Object.getOwnPropertyNames(t).length>0}))}var JP=me(Ln());S();function VJ(e){return`${e.length} ${e.length!==1?"items":"item"}`}function fb(e){let{data:t,...r}=e;return R.createElement(Mo,(0,JP.default)({},r,{data:t,nodeType:"Array",nodeTypeIndicator:"[]",createItemString:VJ,expandable:t.length>0}))}var ZP=me(Ln());S();function GJ(e,t){let r=0,n=!1;if(Number.isSafeInteger(e.size))r=e.size;else for(let o of e){if(t&&r+1>t){n=!0;break}r+=1}return`${n?">":""}${r} ${r!==1?"entries":"entry"}`}function pb(e){return R.createElement(Mo,(0,ZP.default)({},e,{nodeType:"Iterable",nodeTypeIndicator:"()",createItemString:GJ,expandable:!0}))}S();function gr(e){let{nodeType:t,styling:r,labelRenderer:n,keyPath:o,valueRenderer:i,value:s,valueGetter:a=u=>u}=e;return R.createElement("li",r("value",t,o),R.createElement("label",r(["label","valueLabel"],t,o),n(o,t,!1,!1)),R.createElement("span",r("valueText",t,o),i(a(s),s,...o)))}function iu(e){let{getItemString:t,keyPath:r,labelRenderer:n,styling:o,value:i,valueRenderer:s,isCustomNode:a,...u}=e,l=a(i)?"Custom":sb(i),c={getItemString:t,key:r[0],keyPath:r,labelRenderer:n,nodeType:l,styling:o,value:i,valueRenderer:s},f={...u,...c,data:i,isCustomNode:a};switch(l){case"Object":case"Error":case"WeakMap":case"WeakSet":return R.createElement(lb,f);case"Array":return R.createElement(fb,f);case"Iterable":case"Map":case"Set":return R.createElement(pb,f);case"String":return R.createElement(gr,(0,Bn.default)({},c,{valueGetter:p=>`"${p}"`}));case"Number":return R.createElement(gr,c);case"Boolean":return R.createElement(gr,(0,Bn.default)({},c,{valueGetter:p=>p?"true":"false"}));case"Date":return R.createElement(gr,(0,Bn.default)({},c,{valueGetter:p=>p.toISOString()}));case"Null":return R.createElement(gr,(0,Bn.default)({},c,{valueGetter:()=>"null"}));case"Undefined":return R.createElement(gr,(0,Bn.default)({},c,{valueGetter:()=>"undefined"}));case"Function":case"Symbol":return R.createElement(gr,(0,Bn.default)({},c,{valueGetter:p=>p.toString()}));case"Custom":return R.createElement(gr,c);default:return R.createElement(gr,(0,Bn.default)({},c,{valueGetter:()=>`<${l}>`}))}}var Hp=me(ep()),E2=me(eF()),_b=me(aF()),Cb=me(O$()),Eb=me(X$()),Sb=me(y2());function b2(e){var t=e[0],r=e[1],n=e[2],o,i,s;return o=t*1+r*0+n*1.13983,i=t*1+r*-.39465+n*-.5806,s=t*1+r*2.02311+n*0,o=Math.min(Math.max(0,o),1),i=Math.min(Math.max(0,i),1),s=Math.min(Math.max(0,s),1),[o*255,i*255,s*255]}function v2(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,o=t*.299+r*.587+n*.114,i=t*-.14713+r*-.28886+n*.436,s=t*.615+r*-.51499+n*-.10001;return[o,i,s]}function x2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Tt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x2(Object(r),!0).forEach(function(n){(0,E2.default)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var S2=Cb.default,w2=Object.keys(S2),dX=function(t){return t<.25?1:t<.5?.9-t:1.1-t},mX=function(t){var r=(0,Eb.default)(t),n=v2(r.array()),o=(0,_b.default)(n,3),i=o[0],s=o[1],a=o[2],u=[dX(i),s,a],l=b2(u);return Eb.default.rgb(l).hex()},Yi=function(t){return function(r){return{className:[r.className,t.className].filter(Boolean).join(" "),style:Tt(Tt({},r.style||{}),t.style||{})}}},hX=function(t,r){if(t===void 0)return r;if(r===void 0)return t;var n=(0,Hp.default)(t),o=(0,Hp.default)(r);switch(n){case"string":switch(o){case"string":return[r,t].filter(Boolean).join(" ");case"object":return Yi({className:t,style:r});case"function":return function(i){for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];return Yi({className:t})(r.apply(void 0,[i].concat(a)))}}break;case"object":switch(o){case"string":return Yi({className:r,style:t});case"object":return Tt(Tt({},r),t);case"function":return function(i){for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];return Yi({style:t})(r.apply(void 0,[i].concat(a)))}}break;case"function":switch(o){case"string":return function(i){for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];return t.apply(void 0,[Yi(i)({className:r})].concat(a))};case"object":return function(i){for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];return t.apply(void 0,[Yi(i)({style:r})].concat(a))};case"function":return function(i){for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];return t.apply(void 0,[r.apply(void 0,[i].concat(a))].concat(a))}}}},gX=function(t,r){var n=Object.keys(r);for(var o in t)n.indexOf(o)===-1&&n.push(o);return n.reduce(function(i,s){return i[s]=hX(t[s],r[s]),i},{})},yX=function(t,r){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];if(r===null)return t;Array.isArray(r)||(r=[r]);var s=r.map(function(u){return t[u]}).filter(Boolean),a=s.reduce(function(u,l){return typeof l=="string"?u.className=[u.className,l].filter(Boolean).join(" "):(0,Hp.default)(l)==="object"?u.style=Tt(Tt({},u.style),l):typeof l=="function"&&(u=Tt(Tt({},u),l.apply(void 0,[u].concat(o)))),u},{className:"",style:{}});return a.className||delete a.className,Object.keys(a.style).length===0&&delete a.style,a},Ib=function(t){return Object.keys(t).reduce(function(r,n){return r[n]=/^base/.test(n)?mX(t[n]):n==="scheme"?t[n]+":inverted":t[n],r},{})},I2=(0,Sb.default)(function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.defaultBase16,o=n===void 0?S2:n,i=t.base16Themes,s=i===void 0?null:i,a=bX(r,s);a&&(r=Tt(Tt({},a),r));for(var u=w2.reduce(function(b,y){return b[y]=r[y]||o[y],b},{}),l=Object.keys(r).reduce(function(b,y){return w2.indexOf(y)===-1&&(b[y]=r[y]),b},{}),c=e(u),f=gX(l,c),p=arguments.length,d=new Array(p>3?p-3:0),h=3;h<p;h++)d[h-3]=arguments[h];return(0,Sb.default)(yX,2).apply(void 0,[f].concat(d))},3),_2=function(t){return!!t.extend},bX=function(t,r){if(t&&_2(t)&&t.extend&&(t=t.extend),typeof t=="string"){var n=t.split(":"),o=(0,_b.default)(n,2),i=o[0],s=o[1];r?t=r[i]:t=Cb[i],s==="inverted"&&(t=Ib(t))}return t&&Object.prototype.hasOwnProperty.call(t,"base00")?t:void 0},C2=function(t){return typeof t=="string"?"".concat(t,":inverted"):t&&_2(t)&&t.extend?typeof t.extend=="string"?Tt(Tt({},t),{},{extend:"".concat(t.extend,":inverted")}):Tt(Tt({},t),{},{extend:Ib(t.extend)}):t&&Ib(t)};var T2={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"};var vX=e=>({BACKGROUND_COLOR:e.base00,TEXT_COLOR:e.base07,STRING_COLOR:e.base0B,DATE_COLOR:e.base0B,NUMBER_COLOR:e.base09,BOOLEAN_COLOR:e.base09,NULL_COLOR:e.base08,UNDEFINED_COLOR:e.base08,FUNCTION_COLOR:e.base08,SYMBOL_COLOR:e.base08,LABEL_COLOR:e.base0D,ARROW_COLOR:e.base0D,ITEM_STRING_COLOR:e.base0B,ITEM_STRING_EXPANDED_COLOR:e.base03}),xX=e=>({String:e.STRING_COLOR,Date:e.DATE_COLOR,Number:e.NUMBER_COLOR,Boolean:e.BOOLEAN_COLOR,Null:e.NULL_COLOR,Undefined:e.UNDEFINED_COLOR,Function:e.FUNCTION_COLOR,Symbol:e.SYMBOL_COLOR}),wX=e=>{let t=vX(e);return{tree:{border:0,padding:0,marginTop:"0.5em",marginBottom:"0.5em",marginLeft:"0.125em",marginRight:0,listStyle:"none",MozUserSelect:"none",WebkitUserSelect:"none",backgroundColor:t.BACKGROUND_COLOR},value:(r,n,o)=>{let{style:i}=r;return{style:{...i,paddingTop:"0.25em",paddingRight:0,marginLeft:"0.875em",WebkitUserSelect:"text",MozUserSelect:"text",wordWrap:"break-word",paddingLeft:o.length>1?"2.125em":"1.25em",textIndent:"-0.5em",wordBreak:"break-all"}}},label:{display:"inline-block",color:t.LABEL_COLOR},valueLabel:{margin:"0 0.5em 0 0"},valueText:(r,n)=>{let{style:o}=r;return{style:{...o,color:xX(t)[n]}}},itemRange:(r,n)=>({style:{paddingTop:n?0:"0.25em",cursor:"pointer",color:t.LABEL_COLOR}}),arrow:(r,n,o)=>{let{style:i}=r;return{style:{...i,marginLeft:0,transition:"150ms",WebkitTransition:"150ms",MozTransition:"150ms",WebkitTransform:o?"rotateZ(90deg)":"rotateZ(0deg)",MozTransform:o?"rotateZ(90deg)":"rotateZ(0deg)",transform:o?"rotateZ(90deg)":"rotateZ(0deg)",transformOrigin:"45% 50%",WebkitTransformOrigin:"45% 50%",MozTransformOrigin:"45% 50%",position:"relative",lineHeight:"1.1em",fontSize:"0.75em"}}},arrowContainer:(r,n)=>{let{style:o}=r;return{style:{...o,display:"inline-block",paddingRight:"0.5em",paddingLeft:n==="double"?"1em":0,cursor:"pointer"}}},arrowSign:{color:t.ARROW_COLOR},arrowSignInner:{position:"absolute",top:0,left:"-0.4em"},nestedNode:(r,n,o,i,s)=>{let{style:a}=r;return{style:{...a,position:"relative",paddingTop:"0.25em",marginLeft:n.length>1?"0.875em":0,paddingLeft:s?0:"1.125em"}}},rootNode:{padding:0,margin:0},nestedNodeLabel:(r,n,o,i,s)=>{let{style:a}=r;return{style:{...a,margin:0,padding:0,WebkitUserSelect:s?"inherit":"text",MozUserSelect:s?"inherit":"text",cursor:s?"pointer":"default"}}},nestedNodeItemString:(r,n,o,i)=>{let{style:s}=r;return{style:{...s,paddingLeft:"0.5em",cursor:"default",color:i?t.ITEM_STRING_EXPANDED_COLOR:t.ITEM_STRING_COLOR}}},nestedNodeItemType:{marginLeft:"0.3em",marginRight:"0.3em"},nestedNodeChildren:(r,n,o)=>{let{style:i}=r;return{style:{...i,padding:0,margin:0,listStyle:"none",display:o?"block":"none"}}},rootNodeChildren:{padding:0,margin:0,listStyle:"none"}}},EX=I2(wX,{defaultBase16:T2}),O2=EX;var k2=e=>e,SX=(e,t,r)=>r===0,IX=(e,t,r,n)=>R.createElement("span",null,r," ",n),_X=e=>{let[t]=e;return R.createElement("span",null,t,":")},CX=()=>!1;function A2(e){let{data:t,theme:r,invertTheme:n,keyPath:o=["root"],labelRenderer:i=_X,valueRenderer:s=k2,shouldExpandNodeInitially:a=SX,hideRoot:u=!1,getItemString:l=IX,postprocessValue:c=k2,isCustomNode:f=CX,collectionLimit:p=50,sortObjectKeys:d=!1}=e,h=ne(()=>O2(n?C2(r):r),[r,n]);return R.createElement("ul",h("tree"),R.createElement(iu,{keyPath:u?[]:o,value:c(t),isCustomNode:f,styling:h,labelRenderer:i,valueRenderer:s,shouldExpandNodeInitially:a,hideRoot:u,getItemString:l,postprocessValue:c,collectionLimit:p,sortObjectKeys:d}))}var N2=require("obsidian");var TX=()=>{let[e]=St("clipboard-copy");return m("span",{ref:e})},R2=(e,t,r,n,o)=>{if(o.length===1){let i=async s=>{s.preventDefault(),s.stopPropagation(),await navigator.clipboard.writeText("```json\n"+JSON.stringify(t,null,2)+"\n```"),new N2.Notice("Copied JSON code block to clipboard")};return m("span",{role:"button",tabIndex:0,onClick:i,onKeyDown:i,"aria-label":"Copy item details in JSON",children:[n," ",m(TX,{})]})}if(o[1]==="creators"&&o.length===3){let i=wa(t);if(i)return m("span",{children:i})}if(o[1]==="tags"&&o.length===3){let i=t;return m("span",{children:['"',i.name,'"" (',bo[i.type],")"]})}if(o[0]==="sortIndex"&&o.length===2)return m("span",{children:["[",t.join(", "),"]"]});if(o.length===2&&Array.isArray(t)&&t.length===1){let i=JSON.stringify(t[0]);return m("span",{children:[r," ",i.length>100?i.slice(0,100)+"...":i]})}return m("span",{children:[r," ",n]})};var P2=require("obsidian");var F2=(e,t,r,n)=>{let o=e.length===1,i=e.slice(0,-1),s=D2(i);return m("span",{...o?void 0:{onContextMenu:l=>{let c=new P2.Menu().addItem(f=>f.setTitle("Copy template").onClick(()=>{navigator.clipboard.writeText(`<%= ${s} %>`)}));n&&t!=="Array"&&c.addItem(f=>f.setTitle("Copy template (using with)").onClick(()=>{let[p,...d]=i,h=typeof p=="string"&&$2.test(p)?p:`'${p}'`,b=D2(d);navigator.clipboard.writeText(`<% { const { ${h}: $it } = ${b}; %>
  <%= $it %>
<% } %>`)})),t==="Array"&&c.addItem(f=>f.setTitle("Copy template (using for-of loop)").onClick(()=>{navigator.clipboard.writeText(`<% for (const $it of ${s}) { %>
  <%= $it %>
<% } %>`)})).addItem(f=>f.setTitle("Copy template (using forEach)").onClick(()=>{navigator.clipboard.writeText(`<% ${s}.forEach(($it, i) => { %>
  <%= $it %>
<% }) %>`)})).addItem(f=>f.setTitle("Copy template (pick first element)").onClick(()=>{navigator.clipboard.writeText(`<%= ${s}.first() %>`)})).addItem(f=>f.setTitle("Copy template (pick last element)").onClick(()=>{navigator.clipboard.writeText(`<%= ${s}.last() %>`)})),Qh.has(i[0])||c.addItem(f=>f.setTitle("Copy template (render when present)").onClick(()=>{navigator.clipboard.writeText(`<% if (${s}) { %>
  <%= ${s} %>
<% } %>`)})),l.preventDefault(),c.showAtMouseEvent(l.nativeEvent)},style:{cursor:"context-menu"}},children:[e[0],": "]})},D2=e=>"it"+e.map(OX).reverse().join(""),$2=/^[$_\p{ID_Start}][$\u200c\u200d\p{ID_Continue}]*$/u,OX=e=>typeof e=="number"?`[${e}]`:$2.test(e)?`.${e}`:`[${JSON.stringify(e)}]`;var kX=new Set(["sortIndex"]),AX=new Set(["creators","tags"]),NX=new Set(["position"]),M2=(e,t,r)=>{let n=e[0];return kX.has(n)||AX.has(n)&&Array.isArray(t)&&t.length>6?!1:!!(NX.has(n)||r<1||r<2&&Array.isArray(t)&&t.length>1)};var RX={grad:.9,turn:360,rad:360/(2*Math.PI)},an=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},Ze=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},nr=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=1),e>r?r:e>t?e:t},K2=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},j2=function(e){return{r:nr(e.r,0,255),g:nr(e.g,0,255),b:nr(e.b,0,255),a:nr(e.a)}},Tb=function(e){return{r:Ze(e.r),g:Ze(e.g),b:Ze(e.b),a:Ze(e.a,3)}},DX=/^#([0-9a-f]{3,8})$/i,Kp=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},V2=function(e){var t=e.r,r=e.g,n=e.b,o=e.a,i=Math.max(t,r,n),s=i-Math.min(t,r,n),a=s?i===t?(r-n)/s:i===r?2+(n-t)/s:4+(t-r)/s:0;return{h:60*(a<0?a+6:a),s:i?s/i*100:0,v:i/255*100,a:o}},G2=function(e){var t=e.h,r=e.s,n=e.v,o=e.a;t=t/360*6,r/=100,n/=100;var i=Math.floor(t),s=n*(1-r),a=n*(1-(t-i)*r),u=n*(1-(1-t+i)*r),l=i%6;return{r:255*[n,a,s,s,u,n][l],g:255*[u,n,n,a,s,s][l],b:255*[s,s,u,n,n,a][l],a:o}},q2=function(e){return{h:K2(e.h),s:nr(e.s,0,100),l:nr(e.l,0,100),a:nr(e.a)}},L2=function(e){return{h:Ze(e.h),s:Ze(e.s),l:Ze(e.l),a:Ze(e.a,3)}},B2=function(e){return G2((r=(t=e).s,{h:t.h,s:(r*=((n=t.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:t.a}));var t,r,n},Eu=function(e){return{h:(t=V2(e)).h,s:(o=(200-(r=t.s))*(n=t.v)/100)>0&&o<200?r*n/100/(o<=100?o:200-o)*100:0,l:o/2,a:t.a};var t,r,n,o},PX=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,FX=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,$X=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,MX=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,z2={string:[[function(e){var t=DX.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?Ze(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?Ze(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=$X.exec(e)||MX.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:j2({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=PX.exec(e)||FX.exec(e);if(!t)return null;var r,n,o=q2({h:(r=t[1],n=t[2],n===void 0&&(n="deg"),Number(r)*(RX[n]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return B2(o)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,n=e.b,o=e.a,i=o===void 0?1:o;return an(t)&&an(r)&&an(n)?j2({r:Number(t),g:Number(r),b:Number(n),a:Number(i)}):null},"rgb"],[function(e){var t=e.h,r=e.s,n=e.l,o=e.a,i=o===void 0?1:o;if(!an(t)||!an(r)||!an(n))return null;var s=q2({h:Number(t),s:Number(r),l:Number(n),a:Number(i)});return B2(s)},"hsl"],[function(e){var t=e.h,r=e.s,n=e.v,o=e.a,i=o===void 0?1:o;if(!an(t)||!an(r)||!an(n))return null;var s=function(a){return{h:K2(a.h),s:nr(a.s,0,100),v:nr(a.v,0,100),a:nr(a.a)}}({h:Number(t),s:Number(r),v:Number(n),a:Number(i)});return G2(s)},"hsv"]]},U2=function(e,t){for(var r=0;r<t.length;r++){var n=t[r][0](e);if(n)return[n,t[r][1]]}return[null,void 0]},jX=function(e){return typeof e=="string"?U2(e.trim(),z2.string):typeof e=="object"&&e!==null?U2(e,z2.object):[null,void 0]};var Ob=function(e,t){var r=Eu(e);return{h:r.h,s:nr(r.s+100*t,0,100),l:r.l,a:r.a}},kb=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},W2=function(e,t){var r=Eu(e);return{h:r.h,s:r.s,l:nr(r.l+100*t,0,100),a:r.a}},H2=function(){function e(t){this.parsed=jX(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return Ze(kb(this.rgba),2)},e.prototype.isDark=function(){return kb(this.rgba)<.5},e.prototype.isLight=function(){return kb(this.rgba)>=.5},e.prototype.toHex=function(){return t=Tb(this.rgba),r=t.r,n=t.g,o=t.b,s=(i=t.a)<1?Kp(Ze(255*i)):"","#"+Kp(r)+Kp(n)+Kp(o)+s;var t,r,n,o,i,s},e.prototype.toRgb=function(){return Tb(this.rgba)},e.prototype.toRgbString=function(){return t=Tb(this.rgba),r=t.r,n=t.g,o=t.b,(i=t.a)<1?"rgba("+r+", "+n+", "+o+", "+i+")":"rgb("+r+", "+n+", "+o+")";var t,r,n,o,i},e.prototype.toHsl=function(){return L2(Eu(this.rgba))},e.prototype.toHslString=function(){return t=L2(Eu(this.rgba)),r=t.h,n=t.s,o=t.l,(i=t.a)<1?"hsla("+r+", "+n+"%, "+o+"%, "+i+")":"hsl("+r+", "+n+"%, "+o+"%)";var t,r,n,o,i},e.prototype.toHsv=function(){return t=V2(this.rgba),{h:Ze(t.h),s:Ze(t.s),v:Ze(t.v),a:Ze(t.a,3)};var t},e.prototype.invert=function(){return qt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),qt(Ob(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),qt(Ob(this.rgba,-t))},e.prototype.grayscale=function(){return qt(Ob(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),qt(W2(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),qt(W2(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?qt({r:(r=this.rgba).r,g:r.g,b:r.b,a:t}):Ze(this.rgba.a,3);var r},e.prototype.hue=function(t){var r=Eu(this.rgba);return typeof t=="number"?qt({h:t,s:r.s,l:r.l,a:r.a}):Ze(r.h)},e.prototype.isEqual=function(t){return this.toHex()===qt(t).toHex()},e}(),qt=function(e){return e instanceof H2?e:new H2(e)};var qX=/^#(?:[\dA-F]{3}){1,2}$|^#(?:[\dA-F]{4}){1,2}$/i,LX=e=>{let t=qt(e),{r,g:n,b:o}=t.rgba;return r*.299+n*.587+o*.114>186},J2=(e,t,...r)=>{if(typeof t=="string"&&qX.test(t))return m("span",{style:{backgroundColor:t,padding:"0 0.5em",color:LX(t)?"black":"white"},children:t});let n;return r[0]==="linkMode"&&typeof t=="number"&&(n=bl[t]),r[0]==="type"&&typeof t=="number"&&(r.length===2&&_e[t]?n=_e[t]:r.length===4&&typeof r[1]=="number"&&r[2]==="tags"&&bo[t]&&(n=bo[t])),n?m($,{children:[e," ",m("span",{children:["(",n,")"]})]}):e};var Z2=()=>document.body.classList.contains("theme-dark"),BX={scheme:"Solarized Light",author:"Ethan Schoonover (modified by aramisgithub)",base00:"transparent",base01:"#eee8d5",base02:"#93a1a1",base03:"#839496",base04:"#657b83",base05:"#586e75",base06:"#073642",base07:"#002b36",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"},zX={scheme:"Solarized Dark",author:"Ethan Schoonover (modified by aramisgithub)",base00:"transparent",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"};function Ab({item:e,registerCssChange:t}){let[r,n]=j(()=>Z2());return U(()=>t?.(()=>n(Z2())),[t]),e?m(A2,{data:e,theme:r?zX:BX,invertTheme:!1,keyPath:["Zotero Item Data"],shouldExpandNodeInitially:M2,valueRenderer:J2,labelRenderer:F2,getItemString:R2}):m("div",{children:"No Details Available"})}var Y2=require("obsidian");var Vp=e=>({plugin:e,sourcePath:""});function UX(){return Ka((e,t)=>({preview:null,templateType:null,setTemplateType(r){e(n=>({...n,templateType:r||void 0}))},setPreview(r){e(({...n})=>({...n,preview:r??null}))},async setPreviewFromState(r,n){let o=t().preview;if(o?.docItem.itemID===r?.docItem&&o?.attachment?.itemID===r?.attachment&&o?.annot?.itemID===r?.annot)return!1;let i=n.database.settings.libId;if(!r.docItem)return console.error("TemplatePreview: no docItem provided"),!1;let[s]=await n.databaseAPI.getItems([[r.docItem,i]]);if(!s)return console.error("TemplatePreview: no docItem found for id "+r.docItem),!1;let a=await n.databaseAPI.getAttachments(r.docItem,i),u=a.find(d=>d.itemID===r.attachment)??null;r.attachment&&!u&&console.error("TemplatePreview: no attachment found for id "+r.attachment);let l=u?await n.databaseAPI.getAnnotations(u.itemID,i):[],c=l.find(d=>d.itemID===r.annot);r.annot&&!c&&console.error("TemplatePreview: no annotation found for id "+r.annot);let f=await n.databaseAPI.getTags([[r.docItem,i],...l.map(d=>[d.itemID,i])]),p;try{p=await n.databaseAPI.getNotes(s.itemID,i).then(d=>n.noteParser.normalizeNotes(d))}catch(d){console.error(d),p=[]}return e(()=>({preview:{docItem:s,allAttachments:a,annotations:l,attachment:u,tags:f,annot:l.find(d=>d.itemID===r.annot),notes:p}})),!0}}))}function X2(e,t){let r=null,n=null,o=null;return function(...i){if(r&&window.clearTimeout(r),n){o=i;return}r=window.setTimeout(()=>{r=null,n=e(...i).then(()=>{o?n=e(...o):n=null}).catch(s=>{console.error(s),n=null})},t)}}var Xi=class extends Y2.FileView{constructor(r,n){super(r);this.plugin=n;this.store=UX()}store;canAcceptExtension(r){return r==="md"}getTemplateType(r){if(!r)return!1;let n=ct(r.path,this.plugin.settings.templateDir);return n?.type!=="ejectable"?!1:n.name}setTemplateType(r){this.store.getState().setTemplateType(r)}async onLoadFile(r){await super.onLoadFile(r),this.setTemplateType(this.getTemplateType(r))}getState(){let r=super.getState(),{preview:n}=this.store.getState(),o;if(!n)o={preview:null};else{let{docItem:i,attachment:s,annot:a}=n;o={preview:{docItem:i.itemID,attachment:s?.itemID,annot:a?.itemID}}}return{...r,...o}}async setState(r,n){if(await super.setState(r,n),r.preview===void 0)return;let o=this.store.getState();r.preview===null?o.setPreview(null):await o.setPreviewFromState(r.preview,this.plugin)}setPreview(r){this.store.getState().setPreview(r)}async onOpen(){await super.onOpen();let[r,n]=ui(this.plugin);n&&this.register(n),await r}};var Qi="zotero-item-details",Q2=({templateType:e})=>e==="annotation"?e:"note",Gp=class extends Xi{getViewType(){return Qi}getDisplayText(){let t=this.store.getState();return t.templateType?"Zotero Item Details: "+Q2(t):"Zotero Item Details"}async onOpen(){await super.onOpen();let[t,r]=ui(this.plugin);r&&this.register(r),await t,R.render(m(WX,{store:this.store,plugin:this.plugin}),this.contentEl)}async onClose(){R.unmountComponentAtNode(this.contentEl),await super.onClose()}};function WX({store:e,plugin:t}){let r=_t(e,Q2),n=_t(e,i=>i.preview),o=ne(()=>{let i=Vp(t);if(!n)return null;switch(r){case"note":{let s=It(n,i);return s.docItem.annotations=void 0,s.docItem}case"annotation":{let s=It(n,i),a=n.annot?s.annotations.find(u=>u.itemID===n.annot?.itemID):s.annotations[0];return a?(a.docItem=void 0,a):null}default:throw new Error("Unsupported template type")}},[t,n,r]);return o?m(Ab,{item:o,registerCssChange:i=>(t.app.workspace.on("css-change",i),()=>t.app.workspace.off("css-change",i))}):m("div",{})}var eM=me(xn(),1),or=require("obsidian");var es="zotero-template-preview",Jp=class extends Xi{getViewType(){return es}getDisplayText(){let t=this.store.getState().templateType;return t?"Zotero Template Preview: "+t:"Zotero Template Preview"}async switchToTemplate(t){if(!this.leaf.group)return!1;let r=tM(this.leaf.group,this.plugin);if(!r)return!1;let n=Rb(t,this.plugin.settings.templateDir,this.app);if(!n||!(n instanceof or.TFile)){new or.Notice("Template file not found: "+t);return}return await r.openFile(n),!0}onload(){let t={annots:this.addAction("list-ordered","Open Template for Annotations",async()=>await this.switchToTemplate("annots")||new or.Notice("Cannot switch to template")),note:this.addAction("file-input","Open Note Template",async()=>await this.switchToTemplate("note")||new or.Notice("Cannot switch to template")),annotation:this.addAction("highlighter","Open Template for Single Annotation",async()=>await this.switchToTemplate("annotation")||new or.Notice("Cannot switch to template")),field:this.addAction("info","Open Template for Note Properties",async()=>await this.switchToTemplate("field")||new or.Notice("Cannot switch to template"))};Object.values(t).forEach(r=>r.hide()),this.register(this.store.subscribe((r,n)=>{if(r.templateType!==n.templateType)for(let[o,i]of Object.entries(t))i.toggle(o!==r.templateType)})),this.registerEvent(this.app.vault.on("zotero:template-updated",r=>{let n=this.getTemplateType(this.file);n&&r===n&&(this.setTemplateType(n),this.requestRender())}))}content=null;async render(){let{preview:t,templateType:r}=this.store.getState();if(!r){this.contentEl.empty(),this.contentEl.setText("No template preview available");return}if(!t){this.contentEl.empty(),this.contentEl.setText("No preview data available");return}let n="",o=Vp(this.plugin),i=this.plugin.templateRenderer;try{switch(r){case"annotation":{let u=t.annot??t.annotations[0];if(!u){this.contentEl.setText("No annotation data available");return}n=i.renderAnnot(u,t,o);break}case"annots":n=i.renderAnnots(t,o);break;case"note":n=i.renderNote(t,o);break;case"field":n=i.renderFrontmatter(t,o);break;case"cite":n=i.renderCitations([t],o);break;case"cite2":n=i.renderCitations([t],o,!0);break;case"colored":n=i.renderColored({content:"I'm Highlight",color:"#FF000080",colorName:"red",bgColor:"#FF000080",bgColorName:"red"});break;default:(0,eM.assertNever)(r)}if(n===this.content?.markdown)return;this.content?.unload(),this.contentEl.empty();let s=await(0,or.loadPrism)(),a=s.highlight(n,s.languages.markdown,"markdown");this.content=new Nb(n),this.contentEl.createEl("pre").createEl("code",{cls:"language-markdown"}).innerHTML=a}catch(s){this.content?.unload(),this.contentEl.empty();let a=s instanceof Error?s.message:String(s);this.contentEl.createEl("h1",{text:`Error while rendering ${r}`,cls:["mod-error","message"]}),this.contentEl.createEl("pre",{text:a})}}requestRender=X2(()=>this.render(),200);async onOpen(){await super.onOpen(),this.register(this.store.subscribe((t,r)=>{t.templateType!==r.templateType?this.requestRender():t.preview!==r.preview&&this.requestRender()}))}},Nb=class extends or.Component{constructor(r){super();this.markdown=r}};async function zo(e,t,{app:r,settings:n}){let{workspace:o}=r,i=Rb(e,n.templateDir,r);if(!i||!(i instanceof Bo.TFile)){new Bo.Notice("Template file not found: "+e);return}let s=o.getLeavesOfType("markdown").filter(c=>{let f=c.view;return f.file?ct(f.file.path,n.templateDir)?.type==="ejectable"&&c.getRoot().type==="floating":!1});if(s.length>0){let c=s[0];if(await c.openFile(i),!c.group)return;let f=o.getGroupLeaves(c.group);for(let p of f){let d=p.view.getViewType();if(d===es||d===Qi){let h=p.view.getState();await p.view.setState({...h,preview:t},{})}}return}let a=o.openPopoutLeaf(),u=o.createLeafBySplit(a,"vertical"),l=o.createLeafBySplit(u,"vertical");await Promise.all([a.openFile(i,{active:!0}),u.setViewState({type:es,state:{file:i.path,preview:t},group:a}),l.setViewState({type:Qi,state:{file:i.path,preview:t},group:a})])}function Rb(e,t,r){let n=so(e,t),o=r.vault.getAbstractFileByPath(n);return o instanceof Bo.TFile?o:null}function tM(e,t){return t.app.workspace.getGroupLeaves(e).find(n=>n.view instanceof Bo.MarkdownView&&n.view.file&&ct(n.view.file.path,t.settings.templateDir)?.type==="ejectable")}var rM=e=>(t,r,n)=>{let{imgCacheImporter:o}=e,i=String(t.timeStamp),s="drag-source";t.dataTransfer.setData("text/plain",r()),t.dataTransfer.setData(s,i),t.dataTransfer.dropEffect="copy";let a=t.target.win,{workspace:u}=e.app,l=p=>{p.dataTransfer?.getData(s)===i&&o.flush(),u.off("editor-drop",l),a.removeEventListener("dragend",c)},c=()=>{o.cancel(),u.off("editor-drop",l)},f=u.on("editor-drop",p=>{p.dataTransfer?.getData("drag-source")===i&&o.flush(),u.offref(f)});a.addEventListener("dragend",c,{once:!0}),n&&t.dataTransfer.setDragImage(n,0,0)},nM=e=>({storeSelector:t=>Dl(t,["doc","attachment","allAttachments","tags","annotations"]),get:(t,{allAttachments:r,attachment:n,doc:o,tags:i,annotations:s})=>!r||!n||!o||!i[t.itemID]||!s?null:()=>{let a=e.app.workspace.getActiveFile(),u=a&&at(a)?a.path:null;return e.templateRenderer.renderAnnot(t,{tags:i,attachment:n,allAttachments:r,annotations:s,docItem:o.docItem,notes:[]},{plugin:e,sourcePath:u,merge:!1})}});var ts=require("obsidian");var oM=e=>(t,r)=>{let n=new ts.Menu;if(n.addItem(o=>o.setTitle("Jump to note").setIcon("links-going-out").onClick(HX(r,e))),e.app.workspace.trigger("zotero:open-annot-menu",r,n),t.nativeEvent instanceof MouseEvent)n.showAtMouseEvent(t.nativeEvent);else{let o=t.currentTarget.getBoundingClientRect();n.showAtPosition({x:o.left,y:o.bottom})}},HX=(e,t)=>async()=>{let r=t.app.workspace.getActiveFile(),n=r&&at(r)?r.path:void 0,o=t.plugin.noteIndex.getBlocksFor({item:e,file:n}).shift();if(!o){new ts.Notice("No embed for this annotation in current note");return}let i=o.blocks.sort((p,d)=>{let h=p.start.offset-d.start.offset;return h!==0?h:p.end.offset-d.end.offset})[0];await sleep(10);let{leaf:s}=t,{workspace:a,vault:u}=t.app,l;if(s.group)l=a.getGroupLeaves(s.group);else{l=[];let p=a.getActiveFileView();p&&l.push(p.leaf)}let c=!1,f=i.end.line+1;for(let p of l)p&&p.view instanceof ts.MarkdownView&&p.view.file?.path===o.file&&(p.view.setEphemeralState({line:f}),c=!0);if(!c){let p=u.getAbstractFileByPath(o.file);if(!p||!at(p))throw new Error("File from block info not found: "+o.file);a.getLeaf().openFile(p,{eState:{line:f}})}};var iM=(e,t)=>t.length===0?null:e?t.find(r=>r.itemID===e)??t[0]:t[0],Zp=()=>({doc:null,allAttachments:null,attachmentID:null,annotations:null,attachment:null,tags:{}}),KX=()=>({follow:"zt-reader",doc:null,allAttachments:null,attachmentID:null,annotations:null,attachment:null,tags:{}}),Su=e=>e.databaseAPI,sM=e=>Ka((t,r)=>{let n=async(s,a)=>{let u=(await Su(e).getAttachments(s,a)).filter(ha);t(l=>({...l,allAttachments:u,attachment:iM(l.attachmentID,u)}))},o=async(s,a)=>{let u=await Su(e).getTags([[s,a]]);return t(l=>({...l,tags:u})),u},i=async s=>{let{attachment:a}=r();if(!a)return;let u=await Su(e).getAnnotations(a.itemID,s),l=rg(u);t(p=>({...p,annotations:ng(l),attachment:a}));let c=await Su(e).getTags(u.map(p=>[p.itemID,s])),f=og(l,c);t(p=>({...p,tags:{...p.tags,...f}}))};return{...KX(),loadDocItem:async(s,a,u,l=!1)=>{if(s<0)return t(Zp());if(r().doc?.docItem.itemID===s&&!l)return;let c=(await Su(e).getItems([[s,u]]))[0];if(!c)return t(Zp());let f={docItem:c,lib:u};if(a<0){let p=Jh(window.localStorage,c);t({...Zp(),doc:f,attachmentID:p})}else Ti(window.localStorage,c,a),t({...Zp(),doc:f,attachmentID:a});await n(c.itemID,u),await o(c.itemID,u),await i(u)},refresh:async()=>{let{doc:s,attachment:a}=r();if(!s)return;let{docItem:u,lib:l}=s;await n(u.itemID,l),await o(u.itemID,l),a&&await i(l)},setActiveAtch:s=>{let{doc:a,allAttachments:u}=r();if(a)if(Ti(window.localStorage,a.docItem,s),!u)t(l=>({...l,attachment:null,attachmentID:s}));else{let l=iM(s,u);t(c=>({...c,attachment:l,attachmentID:s}))}},setFollow:s=>t({follow:s})}});var Qp="zotero-annotation-view",Yp=class extends Vf{constructor(r,n){super(r);this.plugin=n;this.store=sM(n)}update(){if(this.follow!=="ob-note")return;let r=this.plugin.settings.libId;(async()=>{if(this.file?.extension!=="md")return!1;let n=Ao(this.file,this.app.metadataCache),o=No(this.file,this.app.metadataCache);if(!n)return!1;let[i]=await this.plugin.databaseAPI.getItems([[n,r]]);return i?(this.setStatePrev(s=>({...s,follow:"ob-note",itemId:i.itemID,attachmentId:o?.[0]??void 0})),!0):!1})().then(n=>{n||this.setStatePrev(o=>({...o,follow:"ob-note",itemId:-1}))})}getViewType(){return Qp}#e=null;onload(){super.onload(),this.contentEl.addClass("obzt");let r=null,n=!1,o=i=>{if(n)r=i;else{n=!0;let{itemId:s,attachmentId:a}=i;this.setStatePrev(u=>({...u,itemId:s,attachmentId:a})).then(()=>{if(n=!1,r===null)return;let u=r;r=null,o(u)})}};this.registerEvent(this.plugin.server.on("bg:notify",(i,s)=>{s.event==="reader/active"&&(this.#e=s.itemId,!(this.follow!=="zt-reader"||s.itemId<0||s.attachmentId<0)&&o(s))}))}getDisplayText(){return this.follow!=="ob-note"||!this.file?.basename?"Zotero Annotations":`Zotero Annotations for ${this.file.basename}`}getIcon(){return"highlighter"}get lib(){return this.plugin.settings.libId}store;get follow(){return this.store.getState().follow}getState(){let r=super.getState(),n=this.store.getState(),o={itemId:n.doc?.docItem.itemID??-1,attachmentId:n.attachment?.itemID??-1,follow:n.follow};return{...r&&typeof r=="object"?r:{},...o}}async setState(r,n){await super.setState(r,n??{});let{itemId:o=-1,attachmentId:i=-1,follow:s="zt-reader"}=r;this.store.getState().setFollow(s),await this.store.getState().loadDocItem(o,i,this.lib)}async setStatePrev(r){await this.setState(r(this.getState()))}onSetFollowZt=async()=>{this.setStatePrev(r=>({...r,follow:"zt-reader"})),await this.setStatePrev(({attachmentId:r,...n})=>({...n,follow:"zt-reader",...this.#e===null?{attachmentId:r}:{itemId:this.#e}}))};onSetFollowOb=()=>{this.store.getState().setFollow("ob-note"),this.update()};onSetFollowNull=async()=>{let{plugin:r}=this,n=await Qf(r);if(!n)return;let{itemID:o}=n.value.item,i=r.settings.libId,s=await r.databaseAPI.getAttachments(o,i),a=await Zr(s,this.app);await this.setStatePrev(({attachmentId:u,...l})=>({...l,follow:null,itemId:o,attachmentId:a?.itemID}))};getContext(){let r=this,{plugin:n,store:o,app:i}=r;return{store:o,registerDbUpdate(s){return i.vault.on("zotero:db-refresh",s),()=>i.vault.off("zotero:db-refresh",s)},refreshConn:async()=>{await n.dbWorker.refresh({task:"dbConn"})},getImgSrc:s=>{let a=An(s,n.settings.current?.zoteroDataDir);return VX(a)},onShowDetails:async(s,a)=>{let u=o.getState(),l=u.attachmentID??void 0;if(s==="doc-item")await zo("note",{docItem:a,attachment:l},n);else{let c=u.doc?.docItem.itemID;if(!c)throw new Error("Missing doc item when showing annotation details");await zo("annotation",{docItem:c,attachment:l,annot:a},n)}},onDragStart:rM(n),onMoreOptions:oM(r),annotRenderer:nM(n),onSetFollow(s){let a=new Xp.Menu,u=o.getState().follow;if(u!=="zt-reader"&&a.addItem(l=>l.setIcon("book").setTitle("Follow active literature in Zotero reader").onClick(r.onSetFollowZt)),u!=="ob-note"&&a.addItem(l=>l.setIcon("file-edit").setTitle("Follow active literature note").onClick(r.onSetFollowOb)),a.addItem(l=>l.setIcon("file-lock-2").setTitle("Link with selected literature").onClick(async()=>{s.target.blur(),await r.onSetFollowNull()})),s.nativeEvent instanceof MouseEvent)a.showAtMouseEvent(s.nativeEvent);else{let c=s.target.getBoundingClientRect();a.showAtPosition({x:c.x,y:c.y})}}}}async onOpen(){await super.onOpen();let[r,n]=ui(this.plugin);n&&this.register(n),this.contentEl.empty(),this.contentEl.createDiv({cls:"pane-empty p-2",text:"Loading..."}),r.then(()=>{this.contentEl.empty(),R.render(m(Mn.Provider,{value:qP,children:m(Be.Provider,{value:this.getContext(),children:m(Za,{})})}),this.contentEl)}).catch(o=>{this.contentEl.empty(),console.error("Failed to load annot view: ",o),this.contentEl.createDiv({cls:"pane-empty p-2",text:"Failed to load, Check console for details"})}),this.registerEvent(this.plugin.server.on("bg:notify",(o,i)=>{if(i.event!=="reader/annot-select")return;let s=i.updates.filter(([,u])=>u).pop();if(!s)return;let[a]=s;this.highlightAnnot(a)}))}async onClose(){R.unmountComponentAtNode(this.contentEl),await super.onClose()}async highlightAnnot(r){let n=this.contentEl.querySelector(`.annot-preview[data-id="${r}"]`);n instanceof HTMLElement&&(n.addClass("select-flashing"),n.scrollIntoView({behavior:"smooth",block:"center"}),await sleep(1500),n.removeClass("select-flashing"))}};function VX(e){return(Xp.Platform.resourcePathPrefix??"app://local/")+(0,aM.pathToFileURL)(e).pathname.substring(1)+`?${Date.now()}`}var uM=require("path/posix");var ed=require("obsidian");var GX=[{command:"\u2191\u2193",purpose:"to navigate"},{command:"\u21B5",purpose:"to continue select note to import"},{command:"esc",purpose:"to dismiss"}],Db=class extends nn{constructor(r){super(r);this.plugin=r;this.setInstructions(GX)}};async function cM(e){let t=await wo(new Db(e));if(!t)return!1;let{value:{item:r}}=t,n=await e.databaseAPI.getNotes(r.itemID,e.settings.libId);if(n.length===0)return new ed.Notice("No note found for selected literature"),!1;let o=await Wv(n,c=>c.title??c.note?.substring(0,20)??`No title (Key ${c.key})`);if(!o.item)return!1;let i=o.item;if(!i.note)return new ed.Notice("Selected note is empty"),!1;let s=await e.noteParser.turndown(i.note),a=e.settings.current?.literatureNoteFolder,u=(0,uM.join)(a,"zt-import",Oo(i.title??[i.note.substring(0,10),i.key].join("_"),{replacement:"_"})),l=await e.app.fileManager.createNewMarkdownFile(e.app.vault.getRoot(),u,s);return await e.app.workspace.openLinkText(l.path,"",!0),new ed.Notice(`Note imported: ${i.title??i.key}`),!0}var $r=require("obsidian");var td=class extends ue{plugin=this.use(be);onload(){this.registerEvent(this.plugin.server.on("zotero/open",t=>this.onZtOpen(xc(t)))),this.registerEvent(this.plugin.server.on("zotero/export",t=>this.onZtExport(xc(t)))),this.registerEvent(this.plugin.server.on("zotero/update",t=>this.onZtExport(xc(t))))}async onZtOpen(t){if(t.type==="annotation"){new $r.Notice("Not implemented yet");return}if(t.items.length<1){new $r.Notice("No items to open");return}await this.plugin.noteFeatures.openNote(t.items[0])}async onZtUpdate(t){if(t.type==="annotation"){new $r.Notice("Single annotation update not yet supported");return}if(t.items.length<1){new $r.Notice("No items to open");return}if(t.items.length>1){new $r.Notice("Multiple literature note update not yet supported");return}await this.plugin.noteFeatures.updateNoteFromId(t.items[0])}async onZtExport(t){if(t.type==="annotation"){new $r.Notice("Not implemented yet");return}t.items.length<1?new $r.Notice("No items to open"):t.items.length>1&&new $r.Notice("Multiple items not yet supported");let{libraryID:r,id:n}=t.items[0],[o]=await this.plugin.databaseAPI.getItems([[n,r]]);if(!o){new $r.Notice("Item not found: "+n);return}let i=await this.plugin.noteFeatures.createNoteForDocItemFull(o);await this.plugin.app.workspace.openLinkText(i,"",!1,{active:!0})}};var lM=require("obsidian");var JX=[{command:"\u2191\u2193",purpose:"to navigate"},{command:"\u21B5",purpose:"to open/create literature note"},{command:"esc",purpose:"to dismiss"}],Pb=class extends nn{constructor(r){super(r);this.plugin=r;this.setInstructions(JX)}};async function Fb(e){let t=await wo(new Pb(e));if(!t)return!1;let{value:{item:r},evt:n}=t;if(await e.noteFeatures.openNote(r,!0))return!0;let o=await e.noteFeatures.createNoteForDocItemFull(r);return await e.app.workspace.openLinkText(o,"",lM.Keymap.isModEvent(n),{active:!0}),!0}var $b=class extends ue{plugin=this.use(be);protocol=this.use(td);onload(){let{plugin:t}=this,{app:r}=t;t.addCommand({id:"note-quick-switcher",name:"Open quick switcher for literature notes",callback:()=>Fb(t)}),t.registerView(Qp,o=>new Yp(o,t)),t.registerView(es,o=>new Jp(o,t)),t.registerView(Qi,o=>new Gp(o,t)),t.registerEvent(t.app.workspace.on("file-menu",(o,i)=>{let s=ct(i.path,t.settings.templateDir);s?.type==="ejectable"&&o.addItem(a=>a.setIcon("edit").setTitle("Open template preview").onClick(()=>{zo(s.name,null,t)}))})),t.addCommand({id:"zotero-annot-view",name:"Open Zotero annotation view in side panel",callback:()=>{r.workspace.ensureSideLeaf(Qp,"right",{active:!0,state:{file:r.workspace.getActiveFile()?.path}})}}),t.addCommand({id:"insert-markdown-citation",name:"Insert Markdown citation",editorCallback:(o,i)=>ob(o,i.file,t)}),t.registerEditorSuggest(new ru(t));let n=async(o,i)=>{let s=t.settings.libId,a=Ao(o,r.metadataCache);if(!a)return new un.Notice("Cannot get zotero item key from file name"),!1;let[u]=await t.databaseAPI.getItems([[a,s]]);if(!u)return new un.Notice("Cannot find zotero item with key "+a),!1;await this.updateNote(u,i)};t.addCommand({id:"update-literature-note",name:"Update literature note",editorCheckCallback(o,i,s){let a=s.file&&Ha(s.file,r);if(o)return!!a;a&&n(s.file)}}),t.addCommand({id:"overwrite-update-literature-note",name:"Force update literature note by overwriting",editorCheckCallback(o,i,s){let a=s.file&&Ha(s.file,r);if(o)return!!a;a&&n(s.file,!0)}}),t.addCommand({id:"import-note",name:"Import note",callback:()=>cM(t)}),t.registerEvent(t.app.workspace.on("file-menu",(o,i)=>{Ha(i,r)&&(o.addItem(s=>s.setTitle("Update literature note").setIcon("sync").onClick(()=>n(i))),t.settings.current?.updateOverwrite||o.addItem(s=>s.setTitle("Force update by overwriting").setIcon("sync").onClick(()=>n(i,!0))))})),t.registerEvent(t.app.workspace.on("file-menu",(o,i)=>{let s=ct(i.path,t.settings.templateDir);s?.type==="ejectable"&&o.addItem(a=>a.setTitle("Reset to default").setIcon("reset").onClick(async()=>{Df(r).confirm("Reset template to default?")&&await t.app.vault.modify(i,ot.Ejectable[s.name])}))}))}async openNote(t,r=!1){let{workspace:n}=this.plugin.app,{noteIndex:o}=this.plugin,i=o.getNotesFor(t);if(!i.length)return!r&&new un.Notice(`No literature note found for zotero item with key ${t.key}`),!1;let s=i.sort().shift();return await n.openLinkText(s,"",!1,{active:!0}),!0}async createNoteForDocItem(t,r){let{noteIndex:n}=this.plugin,o=n.getNotesFor(t);if(o.length)throw new rd(o,t.key);let{vault:i,fileManager:s}=this.plugin.app,{literatureNoteFolder:a}=this.plugin.settings.current,u=this.plugin.templateRenderer,l=(0,fM.join)(a,r.filename(u,{plugin:this.plugin})),c=i.getAbstractFileByPath(l);if(c&&Ao(c,this.plugin.app.metadataCache))throw new rd([l],t.key);return await s.createNewMarkdownFile(i.getRoot(),l,r.note(u,{plugin:this.plugin,sourcePath:l}))}async createNoteForDocItemFull(t){let r=this.plugin.settings.libId,n=await this.plugin.databaseAPI.getAttachments(t.itemID,r),o=await Zr(n,this.plugin.app);o&&Ni(o,t);let i=await this.plugin.databaseAPI.getNotes(t.itemID,r).then(l=>this.plugin.noteParser.normalizeNotes(l)),s=await tu(t,{all:n,selected:o?[o]:[],notes:i},this.plugin),a=Object.values(s)[0];return(await this.createNoteForDocItem(t,{note:(l,c)=>l.renderNote(a,c),filename:(l,c)=>l.renderFilename(a,c)})).path}async updateNoteFromId(t){let{noteIndex:r,databaseAPI:n}=this.plugin;if(!r.getNotesFor(t).length){new un.Notice(`No literature note found for zotero item with key ${t.key}`);return}let[i]=await n.getItems([[t.key,t.libraryID]]);if(!i){new un.Notice(`Cannot find zotero item with key ${t.key}`);return}await this.updateNote(i)}async updateNote(t,r){let n=await zP(t,this.plugin,r);n?n.addedAnnots>0||n.updatedAnnots>0?new un.Notice(`Affected ${n.notes} notes, annotations: ${n.addedAnnots} added, ${n.updatedAnnots} updated`):new un.Notice(`Affected ${n.notes} notes, no annotation updated`):new un.Notice("No note found for this literature")}},pM=$b,rd=class extends Error{constructor(r,n){super(`Note linked to ${n} already exists: ${r.join(",")}`);this.targets=r;this.key=n;this.name="NoteExistsError"}};var od=require("@codemirror/language");var Mb=require("obsidian");var nd=class extends ue{plugin=this.use(be);onload(){this.patchEditorClick()}async patchEditorClick(){let{workspace:t}=this.plugin.app,{noteIndex:r,database:n,settings:o,noteFeatures:i}=this.plugin;await x1(this.plugin.app);let s=()=>t.getLeavesOfType("markdown").length>0,[a,u]=qs({register:c=>t.on("layout-change",()=>{s()&&c()}),unregister:c=>t.offref(c),escape:s,timeout:null});u&&this.register(u),await a;let l=t.getLeavesOfType("markdown")[0].view;this.register(Lt(l.editor.constructor.prototype,{getClickableTokenAt:c=>function(f,...p){let d=c.call(this,f,...p);return d||ZX.call(this,f,r)}})),this.register(Lt(l.editMode.constructor.prototype,{triggerClickableToken:c=>function(f,p){if(f.type==="internal-link"&&f.citekey==="zotero")(async()=>{let d=f.text,{[d]:h}=await n.api.getItemIDsFromCitekey([f.text]);if(h<0){new Mb.Notice(`Citekey ${d} not found in Zotero`);return}let[b]=await n.api.getItems([[h,o.libId]]);if(!b){new Mb.Notice(`Item not found for citekey ${d}`);return}let y=await i.createNoteForDocItemFull(b);await t.openLinkText(y,"",!0,{active:!0})})();else return c.call(this,f,p)}}))}};function ZX(e,t){let r=this.cm,n=r.state.doc,o=[],i=n.line(e.line+1),s=(0,od.syntaxTree)(r.state),a=i.from;s.iterate({from:i.from,to:i.to,enter:b=>{let y=b.type,v=b.from,w=b.to,T=y.prop(od.tokenClassNodeProp);T&&(a<v&&o.push({type:"",from:a,to:v}),o.push({type:T,from:v,to:w}),a=w)}}),a<i.to&&o.push({type:"",from:a,to:i.to});let u=this.posToOffset(e),l=-1;for(let b=0;b<o.length;b++){let y=o[b];if(y.from<=u&&y.to>=u){l=b;break}}if(l<0)return null;let c=o[l];if(!c.type.split(" ").includes("hmd-barelink"))return null;let p=n.sliceString(c.from,c.to);if(!p.startsWith("@"))return null;let d=p.slice(1),h={start:this.offsetToPos(c.from),end:this.offsetToPos(c.to)};if(t.citekeyCache.has(d)){let[b]=t.citekeyCache.get(d);return{type:"internal-link",text:b,...h}}else return{type:"internal-link",text:d,citekey:"zotero",...h}}var id=require("obsidian");var rs=class extends ue{plugin=this.use(be);settings=this.use(de);app=this.use(id.App);get meta(){return this.app.metadataCache}get vault(){return this.app.vault}get literatureNoteFolder(){return this.settings.current?.literatureNoteFolder}get joinPath(){return YX(this.literatureNoteFolder)}noteCache=new Map;blockCache={byFile:new Map,byKey:new Map};citekeyCache=new Map;#e(t,r){let n=Cy(r);if(n){if(!this.noteCache.has(n))return this.noteCache.set(n,new Set([t])),!0;let i=this.noteCache.get(n),s=i.size;return i.add(t).size!==s}let o=!1;for(let[i,s]of this.noteCache.entries()){let a=s.delete(t);o||=a,a&&s.size===0&&this.noteCache.delete(i)}return o}#t(t,r){let n=u=>{let l=this.blockCache.byFile.get(u);if(!l)return!1;this.blockCache.byFile.delete(u);for(let c of l){let f=this.blockCache.byKey.get(c.key);f.delete(c),f.size===0&&this.blockCache.byKey.delete(c.key)}return!0};if(!r)return n(t);let{blocks:o,sections:i}=r;if(!i||!o)return n(t);let s=i.filter(Ua);if(s.length===0)return n(t);n(t);let a=Ga(s.flatMap(u=>Wa(u.id).map(l=>[l,u.position])),vo(([u])=>u),Ai((u,l)=>({file:t,key:u,blocks:l.map(([c,f])=>f)})),Al);this.blockCache.byFile.set(t,a);for(let u of a){let l=this.blockCache.byKey.get(u.key);l?l.add(u):this.blockCache.byKey.set(u.key,new Set([u]))}return!0}#r(t,r){let n=r?.frontmatter?.citekey;if(n){if(!this.citekeyCache.has(n))return this.citekeyCache.set(n,new Set([t])),!0;let i=this.citekeyCache.get(n),s=i.size;return i.add(t).size!==s}let o=!1;for(let[i,s]of this.citekeyCache.entries()){let a=s.delete(t);o||=a,a&&s.size===0&&this.citekeyCache.delete(i)}return o}getNotesFor(t){let r=this.noteCache.get(Bt(t,!0));return r?[...r]:[]}getBlocksFor({file:t,item:r}){if(!t&&!r)throw new Error("no file or item provided");let n=r?this.blockCache.byKey.get(Bt(r,!0)):null,o=t?this.blockCache.byFile.get(t):null;return t&&r?!o||!n?[]:o.filter(i=>n.has(i)):t?o?[...o]:[]:r?n?[...n]:[]:[]}getBlocksIn(t){let r=this.blockCache.byFile.get(t);return r?[...r]:null}#n(t,r){r===void 0&&(r=this.meta.getCache(t)),[this.#e(t,r),this.#t(t,r),this.#r(t,r)].some(o=>o)&&this.meta.trigger("zotero:index-update",t)}#i(t){this.#n(t,null)}#s(){this.noteCache.clear(),this.blockCache.byFile.clear(),this.blockCache.byKey.clear(),this.meta.trigger("zotero:index-clear")}onload(){this.settings.once(()=>{[this.meta.on("changed",this.onMetaChanged,this),this.vault.on("rename",this.onFileRenamed,this),this.vault.on("delete",this.onFileRemoved,this)].forEach(this.registerEvent.bind(this));let[t,r]=v1(this.plugin.app,{});r&&this.register(r),t.then(()=>{this.onMetaBuilt(),this.plugin.addCommand({id:"refresh-note-index",name:"Refresh literature notes index",callback:()=>{this.reload(),new id.Notice("Literature notes re-indexed")}})})}),this.register(Le(Qe(()=>this.reload(),()=>this.literatureNoteFolder,!0)))}onMetaBuilt(){for(let t of this.vault.getMarkdownFiles())this.#n(t.path)}onMetaChanged(t,r,n){this.#n(t.path,n)}onFileRemoved(t){at(t)&&this.#i(t.path)}onFileRenamed(t,r){this.#i(r),at(t)&&this.#n(t.path)}reload(){this.#s(),this.onMetaBuilt(),W.info("Note Index: Reloaded")}};fe([pe],rs.prototype,"literatureNoteFolder",1);var YX=e=>e==="/"?"":e+"/";var jb=require("crypto");var dM="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var XX=128,Uo,ns,QX=e=>{!Uo||Uo.length<e?(Uo=Buffer.allocUnsafe(e*XX),(0,jb.randomFillSync)(Uo),ns=0):ns+e>Uo.length&&((0,jb.randomFillSync)(Uo),ns=0),ns+=e};var sd=(e=21)=>{QX(e-=0);let t="";for(let r=ns-e;r<ns;r++)t+=dM[Uo[r]&63];return t};var vM=require("obsidian");var qb=/^https?:\/\/zotero\.org\/.*\/items\/([A-Z\d]+)$/;function os(e){let t=e.match(qb);return t?t[1]:null}var{DataCitation:mM,DataAnnotation:hM}=wt({CitationItem:{uris:[qb]},DataCitation:{citationItems:"CitationItem[]","properties?":"any","locator?":"string"},DataAnnotation:{attachmentURI:qb,annotationKey:"string",citationItem:"CitationItem"}}).compile();var gM=e=>({filter:(t,r)=>t.nodeName==="SPAN"&&!!t.style.color,replacement:(t,r,n)=>{if(!(r instanceof HTMLElement))throw new Error("Unexpected node");let{color:o,colorName:i}=Lb(r.style.color),s=r.firstChild,a={bgColor:null,bgColorName:null};if(s===r.lastChild&&s?.nodeName==="SPAN"&&s.style.backgroundColor){let{color:u,colorName:l}=Lb(s.style.backgroundColor);a={bgColor:u,bgColorName:l}}return e.renderColored({content:t,color:o,colorName:i,...a})}}),yM=e=>({filter:(t,r)=>t.nodeName==="SPAN"&&!!t.style.backgroundColor,replacement:(t,r,n)=>{if(!(r instanceof HTMLElement))throw new Error("Unexpected node");let{color:o,colorName:i}=Lb(r.style.backgroundColor),s=r.parentElement;return s?.nodeName==="SPAN"&&s.style.color&&!r.nextSibling?t:e.renderColored({content:t,color:null,colorName:null,bgColor:o,bgColorName:i})}});function Lb(e){if(!e)return{colorName:null,color:null};let t=qt(e).toHex().toUpperCase();return{colorName:Af[t.substring(0,7)]??t,color:t}}var Iu={cite:{pattern:/%%ZTNOTE\.CITE:([\w-]{10})%%/g,create:e=>`%%ZTNOTE.CITE:${e}%%`},annot:{pattern:/%%ZTNOTE\.ANNOT:([\w-]{10})%%/g,create:e=>`%%ZTNOTE.ANNOT:${e}%%`}},Bb=class{constructor(t){Object.assign(this,t)}toString(){return this.content}},ad=class extends ue{plugin=this.use(be);citations=new Map;annotations=new Map;tdService=new globalThis.TurndownService({headingStyle:"atx"}).addRule("color",gM(this.plugin.templateRenderer)).addRule("bg-color",yM(this.plugin.templateRenderer)).addRule("highlight-imported",{filter:(t,r)=>{if(t.tagName!=="P")return!1;let[n,o,i]=t.childNodes;return n instanceof HTMLElement&&n.classList.contains("highlight")?o instanceof HTMLElement?o.classList.contains("citation"):o instanceof Text&&o.textContent?.trim()===""?i instanceof HTMLElement&&i.classList.contains("citation"):!1:!1},replacement:(t,r,n)=>{let[o,i]=r.children;for(;r.firstChild!==i;)r.removeChild(r.firstChild);r.removeChild(i);let s=bM(o.dataset.annotation),a=r,u=sd(10);return this.annotations.set(u,{annotationKey:s.annotationKey,citationKey:os(s.citationItem.uris[0]),attachementKey:os(s.attachmentURI),commentHTML:a.textContent?.trim()?a.innerHTML:null,inline:!1}),Iu.annot.create(u)}}).addRule("citation",{filter:(t,r)=>t.classList.contains("citation")&&!!t.dataset.citation,replacement:(t,r,n)=>{if(!(r instanceof HTMLElement))throw new Error("Unexpected node");let o=eQ(r.dataset.citation),i=sd(10);return this.citations.set(i,{text:t,itemKeys:o.citationItems.map(({uris:[s]})=>os(s))}),Iu.cite.create(i)}}).addRule("highlight",{filter:(t,r)=>t.classList.contains("highlight")&&!!t.dataset.annotation,replacement:(t,r,n)=>{if(!(r instanceof HTMLElement))throw new Error("Unexpected node");let o=bM(r.dataset.annotation),i=sd(10);return this.annotations.set(i,{annotationKey:o.annotationKey,citationKey:os(o.citationItem.uris[0]),attachementKey:os(o.attachmentURI),commentHTML:null,inline:!0}),Iu.annot.create(i)}});onload(){}async normalizeNotes(t){let r=[];for(let{note:n,...o}of t)r.push(new Bb({...o,content:n?await this.turndown(n):"",note:n}));return r}async turndown(t){this.citations.clear(),this.annotations.clear();let r=this.tdService.turndown(t),n={citations:[...this.citations.values()].flatMap(c=>c.itemKeys),annotations:[...this.annotations.values()].map(c=>c.citationKey)},o=new Set([...this.annotations.values()].map(c=>c.attachementKey)),i=this.plugin.settings.libId,s=tQ([...n.citations,...n.annotations]),a=await this.plugin.databaseAPI.getItems(s.map(c=>[c,i])).then(async c=>{let f=new Map;for(let p=0;p<s.length;p++){let d=s[p],h=c[p];if(h===null){f.set(d,null);continue}let b=await this.plugin.databaseAPI.getAttachments(h.itemID,i),y=new Map;for(let v of b){if(!o.has(v.key))continue;let w=await this.plugin.databaseAPI.getAnnotations(v.itemID,i);for(let T of w)y.set(T.key,T)}f.set(d,{item:h,attachments:b,annotations:y})}return f}),u=await this.plugin.databaseAPI.getTags([...a.values()].flatMap(c=>c?[c.item.itemID,...[...c.annotations.values()].map(f=>f.itemID)]:[]).map(c=>[c,i])),l=r.replaceAll(Iu.cite.pattern,(c,f)=>{let p=this.citations.get(f),d=p.itemKeys.map(b=>{let y=a.get(b);if(!y)throw W.error("citation not found, key: ",b,p),new Error(`citation not found: key ${b}`);return{allAttachments:y.attachments,annotations:[],docItem:y.item,attachment:null,tags:u,notes:[]}});return this.plugin.templateRenderer.renderCitations(d,{plugin:this.plugin})}).replaceAll(Iu.annot.pattern,(c,f)=>{let p=this.annotations.get(f),d=a.get(p.citationKey);if(!d)throw W.error("citation not found, key:",f,p),new Error(`citation key not found: ${f}`);let h=d.annotations.get(p.annotationKey);if(!h)throw W.error("annotation not found, key: ",p.annotationKey,p),new Error(`annotation key not found: ${p.annotationKey}`);let b=this.plugin.templateRenderer.renderAnnot({...h,ztnote:{comment:p.commentHTML,get commentMd(){return p.commentHTML?(0,vM.htmlToMarkdown)(p.commentHTML):""},inline:p.inline}},{allAttachments:d.attachments,annotations:[...d.annotations.values()],attachment:d.attachments.find(y=>y.itemID===h.parentItemID),docItem:d.item,notes:[],tags:u},{plugin:this.plugin});return p.inline?b:`
`+b+`
`}).replace(/\n{3,}/g,`

`);return this.citations.clear(),this.annotations.clear(),l}};function eQ(e){let t=JSON.parse(decodeURIComponent(e)),{data:r,problems:n}=mM(t);if(n)throw W.error("Unexpected citation data",t,n),new Error("Unexpected citation data: "+n.summary);return r}function bM(e){let t=JSON.parse(decodeURIComponent(e)),{data:r,problems:n}=hM(t);if(n)throw W.error("Unexpected annotation data",t,n),new Error("Unexpected annotation data: "+n.summary);return r}function tQ(e){return[...new Set(e)]}var ld=require("fs/promises");var rQ=(e,t)=>t.some(r=>e instanceof r),xM,wM;function nQ(){return xM||(xM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oQ(){return wM||(wM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var EM=new WeakMap,Ub=new WeakMap,SM=new WeakMap,zb=new WeakMap,Hb=new WeakMap;function iQ(e){let t=new Promise((r,n)=>{let o=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{r(Mr(e.result)),o()},s=()=>{n(e.error),o()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(r=>{r instanceof IDBCursor&&EM.set(r,e)}).catch(()=>{}),Hb.set(t,e),t}function sQ(e){if(Ub.has(e))return;let t=new Promise((r,n)=>{let o=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{r(),o()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});Ub.set(e,t)}var Wb={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return Ub.get(e);if(t==="objectStoreNames")return e.objectStoreNames||SM.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Mr(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function IM(e){Wb=e(Wb)}function aQ(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){let n=e.call(ud(this),t,...r);return SM.set(n,t.sort?t.sort():[t]),Mr(n)}:oQ().includes(e)?function(...t){return e.apply(ud(this),t),Mr(EM.get(this))}:function(...t){return Mr(e.apply(ud(this),t))}}function uQ(e){return typeof e=="function"?aQ(e):(e instanceof IDBTransaction&&sQ(e),rQ(e,nQ())?new Proxy(e,Wb):e)}function Mr(e){if(e instanceof IDBRequest)return iQ(e);if(zb.has(e))return zb.get(e);let t=uQ(e);return t!==e&&(zb.set(e,t),Hb.set(t,e)),t}var ud=e=>Hb.get(e);function CM(e,t,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){let s=indexedDB.open(e,t),a=Mr(s);return n&&s.addEventListener("upgradeneeded",u=>{n(Mr(s.result),u.oldVersion,u.newVersion,Mr(s.transaction),u)}),r&&s.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),a.then(u=>{i&&u.addEventListener("close",()=>i()),o&&u.addEventListener("versionchange",l=>o(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var cQ=["get","getKey","getAll","getAllKeys","count"],lQ=["put","add","delete","clear"],Kb=new Map;function _M(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Kb.get(t))return Kb.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,o=lQ.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(o||cQ.includes(r)))return;let i=async function(s,...a){let u=this.transaction(s,o?"readwrite":"readonly"),l=u.store;return n&&(l=l.index(a.shift())),(await Promise.all([l[r](...a),o&&u.done]))[0]};return Kb.set(t,i),i}IM(e=>({...e,get:(t,r,n)=>_M(t,r)||e.get(t,r,n),has:(t,r)=>!!_M(t,r)||e.has(t,r)}));var fd=require("obsidian");var fQ="zotlit",cd="pdf-outline",_u=class extends ue{constructor(r){super();this.plugin=r}db=CM(fQ,1,{upgrade(r){r.createObjectStore(cd,{keyPath:"path"})}});async getCachedOutlineKeys(){return await(await this.db).getAllKeys(cd)}async getPDFOutline(r,n=!1){let o=await this.db,i=await o.get(cd,r),s;try{s=await(0,ld.stat)(r)}catch(u){if(u.code==="ENOENT")return new fd.Notice("PDF file not found"),null;throw u}if(i&&s.mtimeMs===i.mtime&&!n)return W.debug("PDF outline cache hit",r),i.outline;let a=await this.#e(r);return a?(await o.put(cd,{path:r,mtime:s.mtimeMs,outline:a,created:Date.now()}),W.debug("PDF outline cache miss and updated",r),a):null}pdfjs;async#e(r){this.pdfjs??=await(0,fd.loadPdfJs)();let n=this.pdfjs.getDocument(await(0,ld.readFile)(r)),o=await n.promise,i=TM(await o.getOutline(),0),s=await Promise.all(i.map(async({dest:a,...u})=>{if(!Array.isArray(a))return{...u,page:null};let[l]=a,c=await o.getPageIndex(l);return{...u,page:c}}));return await o.cleanup(),await n.destroy(),s}},TM=(e,t)=>e.flatMap(({title:r,dest:n,items:o})=>[{title:r,dest:n,level:t},...TM(o,t+1)]);var Vb=require("fs");var OM=require("obsidian");var cn=class extends ue{settings=this.use(de);api=this.use(Rt).api;app=this.use(OM.App);get autoRefresh(){return this.settings.current?.autoRefresh}onDatabaseUpdate(t){return()=>this.app.vault.trigger("zotero:db-updated",t)}onload(){this.register(Le(Qe(()=>this.setAutoRefresh(this.autoRefresh),()=>this.autoRefresh))),W.debug("loading DatabaseWatcher")}onunload(){this.#e()}#e(){this.#r=!1,this.#t=ki(this.#t,t=>(t?.close(),null))}#t={main:null,bbt:null};#r=!1;async setAutoRefresh(t,r=!1){t===this.#r&&!r||(W.debug("Auto refresh set to "+t),this.#r=t,this.#e(),t&&(this.#t.main=(0,Vb.watch)(this.settings.zoteroDbPath,this.onDatabaseUpdate("main")),await this.api.checkDbStatus("bbt")&&(this.#t.bbt=(0,Vb.watch)(this.settings.betterBibTexDbPath,this.onDatabaseUpdate("bbt")))))}};fe([pe],cn.prototype,"autoRefresh",1);var Cu=class extends ue{onunload(){W.info("ZoteroDB unloaded")}get defaultLibId(){return this.settings.libId}settings=this.use(de);#e=this.use(Rt);watcher=this.use(cn);get api(){return this.#e.api}async search(t){let n=this.defaultLibId;if(this.#e.status!==2)throw new Error("Search index not ready");let o=await this.api.search(n,{query:t,limit:50,index:pQ});if(o.length===0)return[];let i=dQ(o);return i.length===0?[]:(await this.api.getItems(i.map(a=>[a.id,n]))).map((a,u)=>{let{id:l,fields:c,score:f}=i[u];if(!a)throw new Error("Item not found: "+l);return{item:a,score:f,fields:[...c]}})}async getItemsOf(t=50,r=this.defaultLibId){if(this.#e.status!==2)throw new Error("Search index not ready");return(await this.api.getItemsFromCache(t,r)).map(o=>({item:o,score:-1,fields:[]}))}},pQ=["title","creators[]:firstName","creators[]:lastName","date"];function dQ(e){let{size:t}=new Set(e.flatMap(n=>n.result)),r=e.reduce((n,{field:o,result:i})=>(o.startsWith("creators[]")&&(o="creators"),i.forEach((s,a)=>{let u=t-a;switch(o){case"title":u*=100;break;case"creators":case"date":u*=5;break;default:throw new Error("Unknown field: "+o)}if(!n.has(+s))n.set(+s,{id:+s,score:u,fields:new Set([o])});else{let l=n.get(+s);l.fields.add(o),l.score+=u}}),n),new Map);return Array.from(r.values()).sort((n,o)=>o.score-n.score)}var yr=require("fs/promises"),kM=require("path"),AM=require("path/posix");var ir=require("obsidian");var Un=class extends ue{onload(){W.debug("loading ImgCacheImporter")}async onunload(){await this.flush()}get app(){return this.use(be).app}settings=this.use(de);queue=new Map;getCachePath(t){return An(t,this.settings.current?.zoteroDataDir)}get mode(){return this.settings.current?.imgExcerptImport}get path(){return this.settings.current?.imgExcerptPath}get imgExcerptDir(){return this.mode?this.path:null}getInVaultPath(t){if(!this.imgExcerptDir||t.type!==_e.image)return null;let r=this.getCachePath(t);return hQ(t,r,this.imgExcerptDir)}import(t){let r=this.getCachePath(t),n=this.getInVaultPath(t);if(!n)return null;let o;return this.queue.has(n)?o=this.queue.get(n):(o=async()=>{let i=await this.linkToVault(n,r);return this.queue.delete(n),i},this.queue.set(n,o)),n}async flush(){return await Promise.all([...this.queue.values()].map(r=>r()))}cancel(){this.queue.clear()}async linkToVault(t,r){let n=await(0,yr.stat)(r).then(s=>{if(!s.isFile()&&!s.isSymbolicLink()){let a=`failed to link image excerpt cache to vault: given path not file ${r}`;return new ir.Notice(a),it(a,null),-1}return s.mtimeMs}).catch(s=>{if(s.code==="ENOENT"){let a=`failed to link image excerpt cache to vault: file not found ${r}`;return new ir.Notice(a),it(a,s),-1}throw s});if(n===-1)return!1;let o=this.mode;if(o===!1)return W.trace("import mode disabled"),!1;let i=(0,AM.dirname)(t);if(i!=="."&&i!==".."&&await this.app.vault.createFolder(i).catch(()=>{}),this.app.vault.adapter instanceof ir.FileSystemAdapter){let s=this.app.vault.adapter.getFullPath(t),a=await(0,yr.lstat)(s).catch(u=>{if(u.code!=="ENOENT")throw u;return null});if(o==="copy"){let u=-1;if(a)if(a.isSymbolicLink())W.trace(s+" is symlink, unlinking"),await(0,yr.rm)(s);else if(a.isFile())u=a.mtimeMs;else{let l="Failed to import image excerpt cache: cannot overwrite non-file "+s;return new ir.Notice(l),it(l,null),!1}if(u<0||n>u)return W.trace(s+" is file, "+(u<0?"creating":"overwritting")),await(0,yr.copyFile)(r,s),new ir.Notice(`Copied image excerpt cache to vault: ${t}`),!0;W.trace("mtime check pass, skipping")}else{if(a){if(a.isSymbolicLink())return W.trace(s+" is symlink, skipping"),!1;if(a.isFile())W.trace(s+" is file, remove before symlinking"),await(0,yr.rm)(s);else{let u="Failed to import image excerpt cache: cannot overwrite non-file "+s;return new ir.Notice(u),it(u,null),!1}}try{await(0,yr.symlink)(r,s,"file")}catch(u){if(u.code==="EPERM")return new ir.Notice(`Failed to symlink image excerpt cache to vault: permission denied ${r}, check directory permission or change import mode to copy. If you are using FAT32 drive, symlink is not supported.`),it(`Failed to symlink image excerpt cache to vault: permission denied ${r}`,u),!1;throw u}return new ir.Notice(`linked image excerpt cache to vault: ${t}`),!0}return!1}else throw new Error("Mobile not supported")}};fe([pe],Un.prototype,"mode",1),fe([pe],Un.prototype,"path",1),fe([pe],Un.prototype,"imgExcerptDir",1);var mQ=(e,t)=>(t??"")+(0,kM.basename)(e),hQ=(e,t,r)=>{let n=mQ(t,e.groupID);return[(0,ir.normalizePath)(r),n].join("/")};S();S();S();function is(e,t=[]){let r=[];function n(i,s){let a=qe(s),u=r.length;r=[...r,s];function l(f){let{scope:p,children:d,...h}=f,b=p?.[e][u]||a,y=ne(()=>h,Object.values(h));return H(b.Provider,{value:y},d)}function c(f,p){let d=p?.[e][u]||a,h=Q(d);if(h)return h;if(s!==void 0)return s;throw new Error(`\`${f}\` must be used within \`${i}\``)}return l.displayName=i+"Provider",[l,c]}let o=()=>{let i=r.map(s=>qe(s));return function(a){let u=a?.[e]||i;return ne(()=>({[`__scope${e}`]:{...a,[e]:u}}),[a,u])}};return o.scopeName=e,[n,gQ(o,...t)]}function gQ(...e){let t=e[0];if(e.length===1)return t;let r=()=>{let n=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){let s=n.reduce((a,{useScope:u,scopeName:l})=>{let f=u(i)[`__scope${l}`];return{...a,...f}},{});return ne(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}S();S();S();function yQ(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function Gb(...e){return t=>e.forEach(r=>yQ(r,t))}function Wo(...e){return Y(Gb(...e),e)}S();var ss=Z((e,t)=>{let{children:r,...n}=e,o=Ve.toArray(r),i=o.find(vQ);if(i){let s=i.props.children,a=o.map(u=>u===i?Ve.count(s)>1?Ve.only(null):Pt(s)?s.props.children:null:u);return H(Jb,ce({},n,{ref:t}),Pt(s)?Xt(s,void 0,a):null)}return H(Jb,ce({},n,{ref:t}),r)});ss.displayName="Slot";var Jb=Z((e,t)=>{let{children:r,...n}=e;return Pt(r)?Xt(r,{...xQ(n,r.props),ref:Gb(t,r.ref)}):Ve.count(r)>1?Ve.only(null):null});Jb.displayName="SlotClone";var bQ=({children:e})=>H($,null,e);function vQ(e){return Pt(e)&&e.type===bQ}function xQ(e,t){let r={...t};for(let n in t){let o=e[n],i=t[n];/^on[A-Z]/.test(n)?o&&i?r[n]=(...a)=>{i(...a),o(...a)}:o&&(r[n]=o):n==="style"?r[n]={...o,...i}:n==="className"&&(r[n]=[o,i].filter(Boolean).join(" "))}return{...e,...r}}function NM(e){let t=e+"CollectionProvider",[r,n]=is(t),[o,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),s=d=>{let{scope:h,children:b}=d,y=R.useRef(null),v=R.useRef(new Map).current;return R.createElement(o,{scope:h,itemMap:v,collectionRef:y},b)},a=e+"CollectionSlot",u=R.forwardRef((d,h)=>{let{scope:b,children:y}=d,v=i(a,b),w=Wo(h,v.collectionRef);return R.createElement(ss,{ref:w},y)}),l=e+"CollectionItemSlot",c="data-radix-collection-item",f=R.forwardRef((d,h)=>{let{scope:b,children:y,...v}=d,w=R.useRef(null),T=Wo(h,w),M=i(l,b);return R.useEffect(()=>(M.itemMap.set(w,{ref:w,...v}),()=>void M.itemMap.delete(w))),R.createElement(ss,{[c]:"",ref:T},y)});function p(d){let h=i(e+"CollectionConsumer",d);return R.useCallback(()=>{let y=h.collectionRef.current;if(!y)return[];let v=Array.from(y.querySelectorAll(`[${c}]`));return Array.from(h.itemMap.values()).sort((M,V)=>v.indexOf(M.ref.current)-v.indexOf(V.ref.current))},[h.collectionRef,h.itemMap])}return[{Provider:s,Slot:u,ItemSlot:f},p,n]}S();S();var Tu=globalThis?.document?Et:()=>{};var wQ=lr["useId".toString()]||(()=>{}),EQ=0;function pd(e){let[t,r]=j(wQ());return Tu(()=>{e||r(n=>n??String(EQ++))},[e]),e||(t?`radix-${t}`:"")}S();S();var SQ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Wn=SQ.reduce((e,t)=>{let r=Z((n,o)=>{let{asChild:i,...s}=n,a=i?ss:t;return U(()=>{window[Symbol.for("radix-ui")]=!0},[]),H(a,ce({},s,{ref:o}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});S();function Ou(e){let t=F(e);return U(()=>{t.current=e}),ne(()=>(...r)=>{var n;return(n=t.current)===null||n===void 0?void 0:n.call(t,...r)},[])}S();function dd({prop:e,defaultProp:t,onChange:r=()=>{}}){let[n,o]=IQ({defaultProp:t,onChange:r}),i=e!==void 0,s=i?e:n,a=Ou(r),u=Y(l=>{if(i){let f=typeof l=="function"?l(e):l;f!==e&&a(f)}else o(l)},[i,e,o,a]);return[s,u]}function IQ({defaultProp:e,onChange:t}){let r=j(e),[n]=r,o=F(n),i=Ou(t);return U(()=>{o.current!==n&&(i(n),o.current=n)},[n,o,i]),r}S();var _Q=qe(void 0);function md(e){let t=Q(_Q);return e||t||"ltr"}var Zb="rovingFocusGroup.onEntryFocus",CQ={bubbles:!1,cancelable:!0},Xb="RovingFocusGroup",[Yb,RM,TQ]=NM(Xb),[OQ,Qb]=is(Xb,[TQ]),[kQ,AQ]=OQ(Xb),NQ=Z((e,t)=>H(Yb.Provider,{scope:e.__scopeRovingFocusGroup},H(Yb.Slot,{scope:e.__scopeRovingFocusGroup},H(RQ,ce({},e,{ref:t}))))),RQ=Z((e,t)=>{let{__scopeRovingFocusGroup:r,orientation:n,loop:o=!1,dir:i,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:u,onEntryFocus:l,...c}=e,f=F(null),p=Wo(t,f),d=md(i),[h=null,b]=dd({prop:s,defaultProp:a,onChange:u}),[y,v]=j(!1),w=Ou(l),T=RM(r),M=F(!1),[V,J]=j(0);return U(()=>{let G=f.current;if(G)return G.addEventListener(Zb,w),()=>G.removeEventListener(Zb,w)},[w]),H(kQ,{scope:r,orientation:n,dir:d,loop:o,currentTabStopId:h,onItemFocus:Y(G=>b(G),[b]),onItemShiftTab:Y(()=>v(!0),[]),onFocusableItemAdd:Y(()=>J(G=>G+1),[]),onFocusableItemRemove:Y(()=>J(G=>G-1),[])},H(Wn.div,ce({tabIndex:y||V===0?-1:0,"data-orientation":n},c,{ref:p,style:{outline:"none",...e.style},onMouseDown:Ct(e.onMouseDown,()=>{M.current=!0}),onFocus:Ct(e.onFocus,G=>{let K=!M.current;if(G.target===G.currentTarget&&K&&!y){let P=new CustomEvent(Zb,CQ);if(G.currentTarget.dispatchEvent(P),!P.defaultPrevented){let X=T().filter(D=>D.focusable),C=X.find(D=>D.active),_=X.find(D=>D.id===h),B=[C,_,...X].filter(Boolean).map(D=>D.ref.current);DM(B)}}M.current=!1}),onBlur:Ct(e.onBlur,()=>v(!1))})))}),DQ="RovingFocusGroupItem",PQ=Z((e,t)=>{let{__scopeRovingFocusGroup:r,focusable:n=!0,active:o=!1,tabStopId:i,...s}=e,a=pd(),u=i||a,l=AQ(DQ,r),c=l.currentTabStopId===u,f=RM(r),{onFocusableItemAdd:p,onFocusableItemRemove:d}=l;return U(()=>{if(n)return p(),()=>d()},[n,p,d]),H(Yb.ItemSlot,{scope:r,id:u,focusable:n,active:o},H(Wn.span,ce({tabIndex:c?0:-1,"data-orientation":l.orientation},s,{ref:t,onMouseDown:Ct(e.onMouseDown,h=>{n?l.onItemFocus(u):h.preventDefault()}),onFocus:Ct(e.onFocus,()=>l.onItemFocus(u)),onKeyDown:Ct(e.onKeyDown,h=>{if(h.key==="Tab"&&h.shiftKey){l.onItemShiftTab();return}if(h.target!==h.currentTarget)return;let b=MQ(h,l.orientation,l.dir);if(b!==void 0){h.preventDefault();let v=f().filter(w=>w.focusable).map(w=>w.ref.current);if(b==="last")v.reverse();else if(b==="prev"||b==="next"){b==="prev"&&v.reverse();let w=v.indexOf(h.currentTarget);v=l.loop?jQ(v,w+1):v.slice(w+1)}setTimeout(()=>DM(v))}})})))}),FQ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $Q(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function MQ(e,t,r){let n=$Q(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return FQ[n]}function DM(e){let t=document.activeElement;for(let r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function jQ(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var PM=NQ,FM=PQ;S();S();function qQ(e,t){return Nr((r,n)=>{let o=t[r][n];return o??r},e)}var ev=e=>{let{present:t,children:r}=e,n=LQ(t),o=typeof r=="function"?r({present:n.isPresent}):Ve.only(r),i=Wo(n.ref,o.ref);return typeof r=="function"||n.isPresent?Xt(o,{ref:i}):null};ev.displayName="Presence";function LQ(e){let[t,r]=j(),n=F({}),o=F(e),i=F("none"),s=e?"mounted":"unmounted",[a,u]=qQ(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return U(()=>{let l=hd(n.current);i.current=a==="mounted"?l:"none"},[a]),Tu(()=>{let l=n.current,c=o.current;if(c!==e){let p=i.current,d=hd(l);e?u("MOUNT"):d==="none"||l?.display==="none"?u("UNMOUNT"):u(c&&p!==d?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,u]),Tu(()=>{if(t){let l=f=>{let d=hd(n.current).includes(f.animationName);f.target===t&&d&&Rr(()=>u("ANIMATION_END"))},c=f=>{f.target===t&&(i.current=hd(n.current))};return t.addEventListener("animationstart",c),t.addEventListener("animationcancel",l),t.addEventListener("animationend",l),()=>{t.removeEventListener("animationstart",c),t.removeEventListener("animationcancel",l),t.removeEventListener("animationend",l)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:Y(l=>{l&&(n.current=getComputedStyle(l)),r(l)},[])}}function hd(e){return e?.animationName||"none"}var $M="Tabs",[BQ,DPe]=is($M,[Qb]),MM=Qb(),[zQ,tv]=BQ($M),UQ=Z((e,t)=>{let{__scopeTabs:r,value:n,onValueChange:o,defaultValue:i,orientation:s="horizontal",dir:a,activationMode:u="automatic",...l}=e,c=md(a),[f,p]=dd({prop:n,onChange:o,defaultProp:i});return H(zQ,{scope:r,baseId:pd(),value:f,onValueChange:p,orientation:s,dir:c,activationMode:u},H(Wn.div,ce({dir:c,"data-orientation":s},l,{ref:t})))}),WQ="TabsList",HQ=Z((e,t)=>{let{__scopeTabs:r,loop:n=!0,...o}=e,i=tv(WQ,r),s=MM(r);return H(PM,ce({asChild:!0},s,{orientation:i.orientation,dir:i.dir,loop:n}),H(Wn.div,ce({role:"tablist","aria-orientation":i.orientation},o,{ref:t})))}),KQ="TabsTrigger",VQ=Z((e,t)=>{let{__scopeTabs:r,value:n,disabled:o=!1,...i}=e,s=tv(KQ,r),a=MM(r),u=jM(s.baseId,n),l=qM(s.baseId,n),c=n===s.value;return H(FM,ce({asChild:!0},a,{focusable:!o,active:c}),H(Wn.button,ce({type:"button",role:"tab","aria-selected":c,"aria-controls":l,"data-state":c?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:u},i,{ref:t,onMouseDown:Ct(e.onMouseDown,f=>{!o&&f.button===0&&f.ctrlKey===!1?s.onValueChange(n):f.preventDefault()}),onKeyDown:Ct(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&s.onValueChange(n)}),onFocus:Ct(e.onFocus,()=>{let f=s.activationMode!=="manual";!c&&!o&&f&&s.onValueChange(n)})})))}),GQ="TabsContent",JQ=Z((e,t)=>{let{__scopeTabs:r,value:n,forceMount:o,children:i,...s}=e,a=tv(GQ,r),u=jM(a.baseId,n),l=qM(a.baseId,n),c=n===a.value,f=F(c);return U(()=>{let p=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(p)},[]),H(ev,{present:o||c},({present:p})=>H(Wn.div,ce({"data-state":c?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":u,hidden:!p,id:l,tabIndex:0},s,{ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0}}),p&&i))});function jM(e,t){return`${e}-trigger-${t}`}function qM(e,t){return`${e}-content-${t}`}var LM=UQ,rv=HQ,nv=VQ,ov=JQ;S();var BM=LM,iv=Z(({className:e,...t},r)=>m(rv,{ref:r,className:ee("inline-flex items-center justify-center rounded-md bg-secondary p-1",e),...t}));iv.displayName=rv.displayName;var Hn=Z(({className:e,...t},r)=>m(nv,{className:ee("obzt-btn-reset","inline-flex min-w-[100px] items-center justify-center rounded-[0.185rem] px-3 py-1.5  text-sm font-medium text-txt-muted transition-all  disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-primary data-[state=active]:text-txt-normal data-[state=active]:shadow-sm",e),...t,ref:r}));Hn.displayName=nv.displayName;var Kn=Z(({className:e,...t},r)=>m(ov,{className:ee("mt-2 rounded-md border p-6",e),...t,ref:r}));Kn.displayName=ov.displayName;S();S();function as(){return as=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},as.apply(this,arguments)}var jPe=typeof Symbol<"u"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator",qPe=typeof Symbol<"u"?Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")):"@@asyncIterator";var YQ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?Et:U,XQ=function(t){var r=F(t);return YQ(function(){r.current=t}),Y(function(){return r.current},[r])},QQ={status:"not-requested",loading:!1,result:void 0,error:void 0},UM={status:"loading",loading:!0,result:void 0,error:void 0},eee=function(t){return UM},tee=function(t,r){return{status:"success",loading:!1,result:t,error:void 0}},ree=function(t,r){return{status:"error",loading:!1,result:void 0,error:t}},zM=function(){},nee={initialState:function(t){return t&&t.executeOnMount?UM:QQ},executeOnMount:!0,executeOnUpdate:!0,setLoading:eee,setResult:tee,setError:ree,onSuccess:zM,onError:zM},oee=function(t){return as({},nee,{},t)},iee=function(t){var r=j(function(){return t.initialState(t)}),n=r[0],o=r[1],i=Y(function(){return o(t.initialState(t))},[o,t]),s=Y(function(){return o(t.setLoading(n))},[n,o]),a=Y(function(c){return o(t.setResult(c,n))},[n,o]),u=Y(function(c){return o(t.setError(c,n))},[n,o]),l=Y(function(c){return o(as({},n,{},c))},[n,o]);return{value:n,set:o,merge:l,reset:i,setLoading:s,setResult:a,setError:u}},see=function(){var t=F(!1);return U(function(){return t.current=!0,function(){t.current=!1}},[]),function(){return t.current}},aee=function(){var t=F(null);return{set:function(n){return t.current=n},get:function(){return t.current},is:function(n){return t.current===n}}},WM=function(t,r,n){!r&&(r=[]);var o=oee(n),i=j(null),s=i[0],a=i[1],u=iee(o),l=see(),c=aee(),f=function(v){return l()&&c.is(v)},p=function(){for(var v=arguments.length,w=new Array(v),T=0;T<v;T++)w[T]=arguments[T];var M=function(){try{return Promise.resolve(t.apply(void 0,w))}catch(V){return Promise.reject(V)}}();return a(w),c.set(M),u.setLoading(),M.then(function(V){f(M)&&u.setResult(V),o.onSuccess(V,{isCurrent:function(){return c.is(M)}})},function(V){f(M)&&u.setError(V),o.onError(V,{isCurrent:function(){return c.is(M)}})}),M},d=XQ(p),h=Y(function(){return d().apply(void 0,arguments)},[d]),b=!l();return U(function(){var y=function(){return d().apply(void 0,r)};b&&o.executeOnMount&&y(),!b&&o.executeOnUpdate&&y()},r),as({},u.value,{set:u.set,merge:u.merge,reset:u.reset,execute:h,currentPromise:c.get(),currentParams:s})};function HM(e,t,r){return WM(e,t,r)}var KM=function(t,r){return WM(t,[],as({},r,{executeOnMount:!1,executeOnUpdate:!1}))};var VM=require("obsidian");var gd=class{constructor(t){this.path=t??gd.defaultPath}vaildPath;get path(){return this.vaildPath}set path(t){t?this.vaildPath=(0,VM.normalizePath)(t):this.vaildPath=gd.defaultPath}getFile(t){return t.getAbstractFileByPath(this.vaildPath)}fromJSON(t){return t&&(this.vaildPath=t),this}toJSON(){return this.path}toString(){return this.path}},ku=gd;Av(ku,"defaultPath","/");var Ot=qe({});function us(e){return new ku(e).path}function yd(e,t,r){let[n,o]=j(!1);return[HM(e,[...t,n],r),Y(()=>o(i=>!i),[])]}var GM=require("obsidian");S();S();var ye=Z(function({name:t,description:r,heading:n,children:o,className:i},s){return m("div",{className:ee("setting-item",n&&"setting-item-heading border-none",i),children:[m("div",{className:"setting-item-info",children:[m("div",{className:"setting-item-name",children:t}),r&&m("div",{className:"setting-item-description",children:r})]}),m("div",{className:"setting-item-control",ref:s,children:o})]})});function uee(e){let t=F(e);return t.current=e,ne(()=>ju(()=>t.current()),[])}function Fe(e,t){let r=Q(Ot).settings,n=uee(()=>e(r.current)).value,o=$t(function(s){r.update(a=>t(s,a))});return[n,o]}function sv(e,t){let r=$t(t),n=F(null);return U(()=>{n.current?.setValue(e)},[e]),Y(o=>{if(!o)n.current?.toggleEl.remove(),n.current=null;else{let i=new GM.ToggleComponent(o);i.setValue(e),i.onChange(r),n.current=i}},[])}function br({name:e,children:t,get:r,set:n}){let o=sv(...Fe(r,n));return m(av,{ref:o,name:e,children:t})}var av=Z(function({name:t,children:r},n){return m(ye,{className:"mod-toggle",ref:n,name:t,description:r})});var YM=me(require("node:net"),1),XM=me(require("node:os"),1),vd=class extends Error{constructor(t){super(`${t} is locked`)}},cs={old:new Set,young:new Set},cee=1e3*15;var bd,lee=()=>{let e=XM.default.networkInterfaces(),t=new Set([void 0,"0.0.0.0"]);for(let r of Object.values(e))for(let n of r)t.add(n.address);return t},JM=e=>new Promise((t,r)=>{let n=YM.default.createServer();n.unref(),n.on("error",r),n.listen(e,()=>{let{port:o}=n.address();n.close(()=>{t(o)})})}),ZM=async(e,t)=>{if(e.host||e.port===0)return JM(e);for(let r of t)try{await JM({port:e.port,host:r})}catch(n){if(!["EADDRNOTAVAIL","EINVAL"].includes(n.code))throw n}return e.port},fee=function*(e){e&&(yield*e),yield 0};async function uv(e){let t,r=new Set;if(e&&(e.port&&(t=typeof e.port=="number"?[e.port]:e.port),e.exclude)){let o=e.exclude;if(typeof o[Symbol.iterator]!="function")throw new TypeError("The `exclude` option must be an iterable.");for(let i of o){if(typeof i!="number")throw new TypeError("Each item in the `exclude` option must be a number corresponding to the port you want excluded.");if(!Number.isSafeInteger(i))throw new TypeError(`Number ${i} in the exclude option is not a safe integer and can't be used`)}r=new Set(o)}bd===void 0&&(bd=setInterval(()=>{cs.old=cs.young,cs.young=new Set},cee),bd.unref&&bd.unref());let n=lee();for(let o of fee(t))try{if(r.has(o))continue;let i=await ZM({...e,port:o},n);for(;cs.old.has(i)||cs.young.has(i);){if(o!==0)throw new vd(o);i=await ZM({...e,port:o},n)}return cs.young.add(i),i}catch(i){if(!["EADDRINUSE","EACCES"].includes(i.code)&&!(i instanceof vd))throw i}throw new Error("No available ports found")}var cv=require("obsidian");S();function QM(){let[e,t]=Fe(n=>n.enableServer,(n,o)=>({...o,enableServer:n})),r=sv(e,t);return m($,{children:[m(ye,{heading:!0,name:"Background connect",description:"Allow Zotero to send status in the background, which is required for some features like focus annotation on selection in Zotero"}),m(av,{ref:r,name:"Enable",children:"Remember to enable the server in Zotero as well"}),e&&m(pee,{})]})}function pee(){let[e,t]=Fe(a=>a.serverPort,(a,u)=>({...u,serverPort:a})),[r]=Fe(a=>a.serverHostname,(a,u)=>({...u,serverHostname:a})),[n,o]=j(e),[i]=St("check");async function s(){if(isNaN(n)||n<0||n>65535)return new cv.Notice("Invalid port number: "+n),o(e),!1;if(n===e)return!1;let a=await uv({host:r,port:[n]});return a!==n?(new cv.Notice(`Port is currently occupied, a different port is provided: ${a}, confirm again to apply the change.`),o(a),!1):(t(a),!0)}return m(ye,{name:"Port number",description:`Default to ${e}`,children:[m("input",{type:"number",value:n,min:0,max:65535,onChange:a=>o(Number.parseInt(a.target.value,10))}),m("button",{"aria-label":"Apply",ref:i,onClick:s})]})}var tj=require("@electron/remote"),rj=require("obsidian");S();function lv({children:e,path:t,state:r}){return m("div",{children:[e,": ",r==="failed"&&"(Failed to load)",m(fv,{path:t,state:r})]})}function fv({path:e,state:t}){return m("code",{"data-state":t,className:ee("data-[state=success]:text-txt-success","data-[state=failed]:text-txt-error","data-[state=disabled]:text-txt-muted"),children:e})}S();function pv(e){let{database:t}=Q(Ot),[r,n]=yd(()=>t.api.checkDbStatus(e),[e]),o;return r.loading?o="disabled":r.error?o="failed":o=r.result?"success":"failed",[o,n]}function dv(){let e=ej("main"),t=ej("bbt"),[r,n]=pv("zotero"),[o,i]=pv("bbt"),[s,a,u]=dee(()=>{n(),i()});return m(ye,{name:"Zotero data directory",description:m($,{children:[m(lv,{path:e,state:r,children:"Zotero"}),m(lv,{path:t,state:o,children:"Better BibTeX"})]}),children:[m(fv,{path:s,state:a}),m("button",{onClick:u,children:"Select"})]})}function dee(e){let[t,r]=Fe(s=>s.zoteroDataDir,(s,a)=>({...a,zoteroDataDir:s})),{app:n}=Q(Ot),o=KM(async()=>{try{let{filePaths:[s]}=await tj.dialog.showOpenDialog({defaultPath:t,properties:["openDirectory"]});s&&t!==s&&(r(s),await new Promise((a,u)=>{function l(){a(),n.vault.off("zotero:db-refresh",l)}n.vault.on("zotero:db-refresh",l),setTimeout(()=>{u(new DOMException("Timeout after 5s","TimeoutError")),n.vault.off("zotero:db-refresh",l)},5e3)}),e())}catch(s){throw console.error("Failed to set data directory",s),new rj.Notice(`Failed to set data directory: ${s}`),s}}),i;return o.loading?i="disabled":o.error?i="failed":i="success",[t,i,o.execute]}function ej(e){let t=Q(Ot).settings;return e==="main"?t.zoteroDbPath:t.betterBibTexDbPath}function mv(){return m($,{children:[m(dv,{}),m(br,{name:"Refresh automatically when Zotero updates database",get:e=>e.autoRefresh,set:(e,t)=>({...t,autoRefresh:e})}),m(QM,{})]})}S();function Ho({name:e,children:t,normalize:r,get:n,set:o}){let[i,s]=Fe(n,o),[a,u]=j(i);return m(hv,{name:e,value:a,onChange:l=>u(l.target.value),onSubmit:()=>{let l=r?.(a)??a;l!==a&&u(l),s(l)},children:t})}function hv({name:e,children:t,value:r,onChange:n,onSubmit:o}){let[i]=St("check");return m(ye,{name:e,description:t,children:[m(Xa,{className:"border",value:r,onChange:n}),m("button",{"aria-label":"Apply",ref:i,onClick:o})]})}function nj(){let[e,t]=Fe(r=>r.imgExcerptImport===!1?"false":r.imgExcerptImport,(r,n)=>({...n,imgExcerptImport:r==="false"?!1:r}));return m($,{children:[m(ye,{heading:!0,name:"Image excerpt",description:"Controls how to import images in annotaion excerpts."}),m(ye,{name:"Mode",description:m("dl",{className:"mt-2 grid grid-cols-3 gap-1",children:[m("div",{children:[m("dt",{className:"text-xs font-medium text-txt-normal",children:"Direct link"}),m("dd",{className:"mt-1",children:["Use image embed linked directly to the original image in Zotero cache using ",m("code",{children:"file://"})," url"]})]}),m("div",{children:[m("dt",{className:"text-xs font-medium text-txt-normal",children:"Symlink"}),m("dd",{className:"mt-1",children:["Create a symlink to the original image in Zotero cache within the specified folder",m("p",{className:"text-txt-error",children:"Don't use this option if your file system doesn't support symlink."})]})]}),m("div",{children:[m("dt",{className:"text-xs font-medium text-txt-normal",children:"Copy"}),m("dd",{className:"mt-1",children:"Copy the original image to the specified folder."})]})]}),children:m("select",{className:"dropdown",onChange:r=>t(r.target.value),value:e,children:[m("option",{value:"false",children:"direct link"},0),m("option",{value:"symlink",children:"symlink"},1),m("option",{value:"copy",children:"copy"},2)]})}),e!=="false"&&m($,{children:m(Ho,{name:"Default location",get:r=>r.imgExcerptPath,set:(r,n)=>({...n,imgExcerptPath:r}),normalize:us,children:"The folder to store image excerpts."})})]})}S();function gv(){let{database:e}=Q(Ot),[t,r]=Fe(a=>a.citationLibrary,(a,u)=>({...u,citationLibrary:a})),[n,o]=yd(()=>e.api.getLibs(),[]),i=n.result??[{groupID:null,libraryID:1,name:"My Library"}],[s]=St("switch");return m(ye,{name:"Citation library",children:[m("select",{className:"dropdown",onChange:a=>r(Number.parseInt(a.target.value,10)),value:t,children:i.map(({groupID:a,libraryID:u,name:l})=>m("option",{value:u,children:l?a?`${l} (Group)`:l:`Library ${u}`},u))}),m("button",{"aria-label":"Refresh",ref:s,onClick:async()=>{await e.refresh({task:"full"}),o()}})]})}function yv(){return m($,{children:[m(Ho,{name:"Default location for new literature notes",get:e=>e.literatureNoteFolder,set:(e,t)=>({...t,literatureNoteFolder:e}),normalize:us}),m(gv,{}),m(nj,{})]})}function bv(){let[e,t]=Fe(r=>r.logLevel,(r,n)=>({...n,logLevel:r}));return m($,{children:[m(ye,{heading:!0,name:"Debug"}),m(ye,{name:"Log Level",description:m($,{children:["Change level of logs output to the console.",m("br",{}),"Set to DEBUG if you need to report a issue",m("br",{}),"To check console, ",NT()]}),children:m("select",{className:"dropdown",onChange:r=>{let n=r.target.value;t(n)},value:e,children:Object.entries(Xv).map(([r,n])=>m("option",{value:n,children:r},n))})})]})}function vv(){return m($,{children:m(bv,{})})}var oj=require("obsidian");var Au=class extends oj.PluginSettingTab{#e(){let t=this.containerEl.parentElement;if(!t)throw new Error("Setting tab is not mounted");if(!t.classList.contains("vertical-tab-content-container"))return W.error("Failed to patch unload, unexpected tabContentContainer"),console.error(t),!1;let r=this,n=Lt(t,{empty:o=>function(){r.unload(),o.call(this),n()}});return W.debug("Setting tab unload patched"),!0}#t=[];register(t){this.#t.push(t)}unload(){for(;this.#t.length>0;)this.#t.pop()()}display(){this.containerEl.empty(),this.#e()}};function xv(){return m($,{children:[m(br,{name:"Citation editor suggester",get:e=>e.citationEditorSuggester,set:(e,t)=>({...t,citationEditorSuggester:e})}),m(br,{name:"Show BibTex citekey in suggester",get:e=>e.showCitekeyInSuggester,set:(e,t)=>({...t,showCitekeyInSuggester:e})})]})}S();function wv(){let[e,t]=Fe(l=>l.autoTrim[0],(l,c)=>({...c,autoTrim:[l,c.autoTrim[1]]})),[r,n]=Fe(l=>l.autoTrim[1],(l,c)=>({...c,autoTrim:[c.autoTrim[0],l]})),[o,i]=j(e),[s,a]=j(r),u=$t(async function(c,f){let p=c==="false"?!1:c;f===0?(i(p),t(p)):(a(p),n(p))});return m(ye,{name:"Auto trim",description:m($,{children:[m("p",{className:"text-sm",children:["Controls default whitespace/new line trimming before/after a ejs"," ",m("code",{className:"whitespace-nowrap",children:"<% Tag %>"})]}),m("dl",{className:"mt-2",children:m("div",{className:"grid grid-cols-2 gap-1",children:[m("div",{children:[m("dt",{className:"text-xs font-medium text-txt-normal",children:"Newline slurp"}),m("dd",{className:"mt-1",children:"Removes the following newline before and after the tag."})]}),m("div",{children:[m("dt",{className:"text-xs font-medium text-txt-normal",children:"Whitespace slurp:"}),m("dd",{className:"mt-1",children:"Removes all whitespace before and after the tag."})]})]})})]}),children:m("div",{className:"flex flex-col gap-2",children:[0,1].map(l=>m("div",{className:"flex flex-col items-start gap-1 text-sm",children:[m("span",{children:l===0?"Leading":"Ending"}),m("select",{className:"dropdown",onChange:c=>u(c.target.value,l),value:String(l===0?o:s),children:[m("option",{value:"false",children:"Disable"},0),m("option",{value:"nl",children:"Newline slurp (-)"},1),m("option",{value:"slurp",children:"Whitespace slurp (_)"},2)]})]},l))})})}var Gn=require("obsidian");S();var ij=require("obsidian");S();function Ev(e,{icon:t,desc:r,disable:n}){let o=$t(e),i=F(null);return U(()=>{i.current?.setIcon(t??"")},[t]),U(()=>{i.current?.setTooltip(r??"")},[r]),U(()=>{i.current?.setDisabled(n??!1)},[n]),Y(s=>{if(!s)i.current?.extraSettingsEl.remove(),i.current=null;else{let a=new ij.ExtraButtonComponent(s);a.onClick(o),i.current=a}},[])}var Vn={filename:{title:"Note filename",desc:"Used to render filename for each imported literature note"},cite:{title:"Primary Markdown citation",desc:"Used to render citation in literature note"},cite2:{title:"Secondary Markdown citation",desc:"Used to render alternative citation in literature note"},field:{title:"Note properties",desc:"Used to render Properties in literature note"},note:{title:"Note content",desc:"Used to render created literature note"},annotation:{title:"Single annotaion",desc:"Used to render single annotation"},annots:{title:"Annotations",desc:"Used to render annotation list when batch importing"},colored:{title:"Colored highlight",desc:"Used to render highlights with color in imported Zotero note"}};function sj({type:e}){let{app:t,settings:r}=Q(Ot),[n]=St("arrow-up-right"),[o]=St("folder-input"),[i]=St("reset"),[s,a]=j(()=>Sv(e,{app:t,folder:r.templateDir})),u=so(e,r.templateDir);return U(()=>{let l=[t.vault.on("delete",c=>{c.path===u&&a(!1)}),t.vault.on("create",c=>{c.path===u&&a(!0)}),t.vault.on("rename",(c,f)=>{c.path===u&&a(!0),f===u&&a(!1)})];return()=>l.forEach(c=>t.vault.offref(c))},[u]),s?m(ye,{name:Vn[e].title,description:Vn[e].desc,children:[m("code",{children:u}),m("button",{"aria-label":"Open template file",ref:n,onClick:async()=>{await zo(e,null,{app:t,settings:r})}}),m("button",{"aria-label":"Reset to default",ref:i,onClick:async()=>{if(!Df(t).confirm("Reset template to default?"))return;let c=t.vault.getAbstractFileByPath(u);c instanceof Gn.TFile?(await t.vault.modify(c,ot.Ejectable[e]),new Gn.Notice(`Template '${u}' reset`)):a(!0)}})]}):m(ye,{name:Vn[e].title,description:Vn[e].desc,children:[m("pre",{className:"text-left max-w-xs overflow-scroll rounded border p-4",children:ot.Ejectable[e]}),m("button",{"aria-label":"Save to template folder",ref:o,onClick:async()=>{let l=await aj(e,{app:t,folder:r.templateDir});a(l)}})]})}async function aj(e,{app:t,folder:r}){let n=so(e,r),o=t.vault.getAbstractFileByPath(n);return o instanceof Gn.TFile?!0:o?(new Gn.Notice(`The path '${n}' is occupied by a folder`),!1):(await t.fileManager.createNewMarkdownFile(t.vault.getRoot(),n,ot.Ejectable[e]),new Gn.Notice(`Template '${n}' created`),!0)}function Sv(e,{app:t,folder:r}){let n=so(e,r);return t.vault.getAbstractFileByPath(n)instanceof Gn.TFile}function uj(){let{app:e,settings:t}=Q(Ot),[r,n]=j(()=>_r.Ejectable.every(i=>Sv(i,{app:e,folder:t.templateDir}))),o=Ev(async()=>{let i=_r.Ejectable.filter(s=>!Sv(s,{app:e,folder:t.templateDir}));await Promise.all(i.map(s=>aj(s,{app:e,folder:t.templateDir}))),n(!0)},{icon:r?"":"folder-input",desc:r?"":"Save template files to template folder",disable:r});return[r,o]}S();function cj({type:e}){let[t,r]=Fe(i=>i.template.templates[e],(i,s)=>({...s,template:{...s.template,templates:{...s.template.templates,[e]:i}}})),[n,o]=j(t);return m(hv,{name:Vn[e].title,value:n,onChange:i=>o(i.target.value),onSubmit:()=>{r(n)},children:Vn[e].desc})}function Iv(){let[e,t]=uj();return m($,{children:[m(Ho,{name:"Template location",get:r=>r.template.folder,set:(r,n)=>({...n,template:{...n.template,folder:r}}),normalize:us,children:"The folder which templates are ejected into and stored"}),m(br,{name:"Auto pair for Eta",get:r=>r.autoPairEta,set:(r,n)=>({...n,autoPairEta:r}),children:["Pair `<` and `%` automatically in eta templates.",m("br",{}),"If you have issue with native auto pair features, you can disable this option and report the bug in GitHub"]}),m(wv,{}),m(ye,{heading:!0,name:"Simple"}),_r.Embeded.map(r=>m(cj,{type:r},r)),m(ye,{heading:!0,name:"Ejectable",ref:t,description:"These templates can be customized once saved to the template folder",children:e||m("div",{children:"Eject"})}),_r.Ejectable.map(r=>m(sj,{type:r},r))]})}function _v(){return m($,{children:[m(ye,{heading:!0,name:"Update note",description:m($,{children:["You can find update note option in ",m("code",{children:"More Options"})," menu and command pallette inside a literature note. When update, all literature notes with the same ",m("code",{children:"zotero-key"})," will be updated."]})}),m(br,{name:"Overwrite existing note",get:e=>e.updateOverwrite,set:(e,t)=>({...t,updateOverwrite:e}),children:m("div",{className:"space-y-2",children:m("div",{className:"text-txt-error",children:"\u26A0 WARNING: This will overwrite the whole note content with latest one when update literature note, make sure you didn't add any custom content in the note before enable this option."})})}),m(br,{name:"In-place update of existing annotations",get:e=>e.updateAnnotBlock,set:(e,t)=>({...t,updateAnnotBlock:e}),children:m("div",{className:"space-y-2",children:[m("div",{children:"(Experimental)"}),m("div",{className:"text-txt-error",children:"\u26A0 WARNING: When enable, the plugin will try to update existing annotaion callouts marked with block-id in addition to appped newly-added ones, which may cause unexpected behavior. Make sure you have backup of your notes before enable this option."}),m("div",{className:"text-txt-accent",children:"\u24D8 Note: If you disable callout warpping in annotation template, you need to make sure the block-id is added properly in the template."}),m("div",{className:"text-txt-accent",children:"\u24D8 Note: This won't work on annotations imported before this feature is available, unless every annotation is inside a block with proper block-id"})]})})]})}var Nu=class extends Au{constructor(r){super(r.app,r);this.plugin=r;this.containerEl.addClass("obzt")}display(){super.display(),R.render(m(Ot.Provider,{value:{settings:this.plugin.settings,app:this.app,database:this.plugin.dbWorker,closeTab:()=>this.setting.close()},children:m(mee,{})}),this.containerEl),this.register(()=>R.unmountComponentAtNode(this.containerEl))}};function mee(){let[e,t]=Uh("obzt-setting-tab",{defaultValue:"general"});return m(BM,{value:e,onValueChange:t,className:"flex h-full flex-col",children:[m(iv,{className:"self-start max-w-full",children:[m(Hn,{value:"general",children:"General"}),m(Hn,{value:"connect",children:"Connect"}),m(Hn,{value:"suggester",children:"Suggester"}),m(Hn,{value:"template",children:"Template"}),m(Hn,{value:"update",children:"Note update"}),m(Hn,{value:"misc",children:"Misc"})]}),m(Kn,{value:"general",className:"divide-y flex-grow overflow-y-scroll",children:m(yv,{})}),m(Kn,{value:"connect",className:"divide-y flex-grow overflow-y-scroll",children:m(mv,{})}),m(Kn,{value:"suggester",className:"divide-y flex-grow overflow-y-scroll",children:m(xv,{})}),m(Kn,{value:"template",className:"divide-y flex-grow overflow-y-scroll",children:m(Iv,{})}),m(Kn,{value:"update",className:"divide-y flex-grow overflow-y-scroll",children:m(_v,{})}),m(Kn,{value:"misc",className:"divide-y flex-grow overflow-y-scroll",children:m(vv,{})})]})}var be=class extends lj.Plugin{use=Go.plugin(this);constructor(t,r){if(super(t,r),!LC(r,t))throw new Error("Library check failed")}settings=h1(this);services={_log:this.use(ra)};noteIndex=this.use(rs);server=this.use(Ur);citekeyClick=this.use(nd);templateEditor=this.use(qi);noteFeatures=this.use(pM);noteParser=this.use(ad);get databaseAPI(){return this.dbWorker.api}dbWorker=this.use(Rt);imgCacheImporter=this.use(Un);dbWatcher=this.use(cn);database=this.use(Cu);templateRenderer=this.use($n);pdfParser=this.use(_u);onload(){W.info("loading ZotLit"),this.addSettingTab(new Nu(this)),globalThis.zoteroAPI={version:this.manifest.version,getDocItems:t=>this.databaseAPI.getItems(t),getItemIDsFromCitekey:(...t)=>this.databaseAPI.getItemIDsFromCitekey(...t),getAnnotsFromKeys:(...t)=>this.databaseAPI.getAnnotFromKey(...t),getAnnotsOfAtch:(...t)=>this.databaseAPI.getAnnotations(...t),getAttachments:(...t)=>this.databaseAPI.getAttachments(...t),getLibs:()=>this.databaseAPI.getLibs()},this.register(()=>{delete globalThis.zoteroAPI})}onunload(){W.info("unloading ZotLit")}};0&&(module.exports={});
/*! Bundled license information:

flatted/cjs/index.js:
  (*! (c) 2020 Andrea Giammarchi *)

use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

@mui/base/index.js:
  (**
   * @mui/base v5.0.0-alpha.122
   *
   * @license MIT
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
