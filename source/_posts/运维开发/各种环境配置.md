---
title: 各种环境配置
date: 2023-11-18 14:53:11
tags:
  - java
  - mysql
  - nacos
  - sentinel
sticky: 90
excerpt: 一些关于各种spring中间件和系统环境配置的教程
author: fcs
---
![](https://picsum.photos/800/250)
> 一切安装启动的应用都要开启**防火墙 TCP 端口和云服务商防火墙规则**才能访问。
# Java
安装 jdk：
```shell
yum install java-1.8.0-openjdk
```
环境变量设置：
```profiles
#set java environment
export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.392.b08-2.el7_9.x86_64/jre
export JRE_HOME=$JAVA_HOME/jre
export CLASSPATH=$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH
export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$PATH
```
刷新系统环境变量配置：
```shell
source /etc/profile
```

# Mysql





## Docker部署

1. 拉取mysql镜像
```sh
docker pull mysql:5.7
```
2. 配置外部文件用于卷挂载
```sh
mkdir -p /data/mysql-1/conf #-p:表示若无主目录则自动创建
mkdir -p /data/mysql-1/data
mkdir -p /data/mysql-1/log
```
3. 添加自定义配置文件 `my.cnf`（*主从模式，也可只部署一个mysql，去掉主从相关的配置文件内容即可*）
**主机配置**
```cnf
[mysqld]  
## 同一局域网内注意要唯一 ,默认server-id=1，主从配置时主和从库必须不同 
server-id=1    
## 开启二进制日志功能，可以随便取（主从配置关键）  
log-bin=master-bin  
## 二级制日志格式，有三种 row，statement，mixed 
binlog-format=ROW  
## 同步的数据库名称,如果不配置，表示同步所有的库
binlog-do-db=数据库名 
port=3306  
user=mysql  
character-set-server=utf8  
default_authentication_plugin=mysql_native_password  
secure_file_priv=/var/lib/mysql  
expire_logs_days=7  
sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION  
max_connections=1000  
lower_case_table_names = 0  
[client]  
default-character-set=utf8  
[mysql]  
default-character-set=utf8
```
**从机配置**
```
[mysqld]
## 设置server_id,注意要唯一
server-id=2  
## 开启二进制日志功能，以备Slave作为其它Slave的Master时使用
log-bin=mysql-slave-bin   
## relay_log配置中继日志
relay_log=mysql-relay-bin  
read_only=1  ## 设置为只读,该项如果不设置，表示slave可读可写
port=3307  
user=mysql  
character-set-server=utf8  
default_authentication_plugin=mysql_native_password  
secure_file_priv=/var/lib/mysql  
expire_logs_days=7  
sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION  
max_connections=1000  
lower_case_table_names = 0  
[client]  
default-character-set=utf8  
[mysql]  
default-character-set=utf8
```


4. 根据镜像和外部待挂载文件启动mysql容器实例
```sh
docker run -id --name mysql-2 -p 3307:3307  -v /usr/local/docker/data/mysql2/conf/my.cnf:/etc/mysql/my.cnf -v /usr/local/docker/data/mysql2/data:/var/lib/mysql -v /usr/local/docker/data/mysql2/log:/var/log/mysql -e MYSQL_ROOT_PASSWORD=123456 -e MYSQL_TCP_PORT=3307 --restart=always --privileged=true mysql:5.7
```
此docker run命令的功能是:
1. --name指定容器名称为mysql-2
2. -p映射主机3307端口到容器3307端口,外部访问时用主机3307端口 
3. -v挂载配置文件,-v /data/mysql2/conf/my.cnf:/etc/mysql/my.cnf 
4. -v挂载数据文件,-v /data/mysql2/data:/var/lib/mysql
5. -v挂载日志文件,-v /data/mysql2/log:/var/log/mysql
6. -e设置环境变量MYSQL_ROOT_PASSWORD指定root用户密码为123456
7. --restart=always设置容器重启策略为总是重启
8. --privileged=true使用特权模式运行容器
9. -d后台方式运行容器
10. mysql:5.7使用MYSQL:5.7镜像
整体功能是:
运行一个MYSQL:5.7容器,名称为mysql-2,映射端口3307,并将配置文件、数据文件和日志文件分别挂载为主机目录,设置root密码并开启特权模式和自动重启，可以实现数据持久化,并通过3307端口来管理该mysql服务。
5. 修改root用户远程访问权限
```sql
alter user 'root'@'%' identified with mysql_native_password by '123456'; #修改为任何ip可远程访问
flush privileges; #刷新权限
```
6. 查看是否启动成功容器，并且支持远程访问
![](http://qnpicmap.fcsluck.top/pics/202311280029568.png)
![](http://qnpicmap.fcsluck.top/pics/202311280030655.png)

# Redis
要安装和部署 Redis，你可以按照以下步骤进行操作：
- 官网地址： https:/redis.io 
- GitHub Windows 版本维护地址： https:/github.com/tporadowski/redis/releases

要在 Windows 上安装和使用 Redis，您可以按照以下步骤操作：
1. 从 Redis 官方网站（ https://redis.io/download ）下载最新版本的 Redis 压缩包。
2. 将压缩包解压到您想要安装 Redis 的目录。
3. 在 Redis 目录中找到 redis.windows.conf 文件，并将其重命名为 redis.conf。
4. 打开 redis.conf 文件，并找到 `# bind 127.0.0.1` 这一行，将其前面的注释符号“#”去掉，这样可以允许远程访问 Redis。
5. 打开命令提示符窗口（cmd）并导航到 Redis 目录。
6. 运行命令 `redis-server.exe redis.conf` 启动 Redis 服务器。
7. 另外打开一个命令提示符窗口，并导航到 Redis 目录。
8. 运行命令 `redis-cli.exe` 连接到正在运行的 Redis 服务器。

- windows对redis服务指令：
	1. 卸载服务：`redis-server --service-uninstall`
	2. 开启服务：`redis-server --service-start`
	3. 停止服务：`redis-server --service-stop`

> 现在您已经成功安装和连接到 Redis 服务器。您可以使用 redis-cli 命令行工具来执行各种操作，例如设置键值对、获取值、删除键等。

# Docker
## 1.安装指南
1. 查看系统内核
```sh
uname -r
```
在安装 [Docker](https://cloud.tencent.com/product/tke?from_column=20065&from=20065) 之前，首先要检查系统内核是否满足要求，Centos7 Linux 内核：官方建议 3.10 以上，3.8 以上貌似也可。
> 注意：本文的命令使用的是 root 用户登录执行，不是 root 的话所有命令前面要加 `sudo`

2. 使用 root 权限更新 yum 包（生产环境中此步操作需慎重，学习环境可随意）
```sh
yum -y update #升级所有包同时也升级软件和系统内核；​ 
yum -y upgrade #只升级所有包，不升级软件和系统内核
```
3. 卸载旧版本（之前安装过）
```sh
yum erase docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-selinux \
                  docker-engine-selinux \
                  docker-engine \
                  docker-ce

```
4. 安装 docker 依赖
```sh
yum install -y yum-utils device-mapper-persistent-data lvm2
```
5. 设置 yum 源（以下两个都可用）
```sh
yum-config-manager --add-repo http://download.docker.com/linux/centos/docker-ce.repo（中央仓库）
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo（阿里仓库）
```
6. 检索 docker 可用版本
```sh
yum list docker-ce --showduplicates | sort -r
```
7. 安装指定版本
```sh
yum -y install docker-ce-18.03.1.ce
#直接安装最新版
yum install docker-ce -y
```
安装成功样图：
![](http://qnpicmap.fcsluck.top/pics/202311271638947.png)
8. 启动 docker 并设置开机自启
```sh
systemctl start docker
systemctl enable docker
```
![](http://qnpicmap.fcsluck.top/pics/202311271638364.png)
9. 配置国内镜像源
```sh
第一步：新建或编辑daemon.json
vi /etc/docker/daemon.json
第二步：daemon.json中编辑如下
{
    "registry-mirrors": ["http://hub-mirror.c.163.com"]
}
第三步：重启docker
systemctl restart docker.service
第四步：执行docker info查看是否修改成功
docker info
```
## 2.常见指令

### 查询远程镜像
查询远程 Docker 仓库镜像的主要命令和参数包括:
`1. docker search 关键词`
在 Docker Hub 上搜索镜像,支持分页显示等参数。
`2. docker search --limit=n 关键词`
限制搜索结果数量。
`3. docker search -f 字段=值关键词`
按字段过滤搜索结果。
`4. docker search --automated=true 关键词` 
仅搜索自动构建镜像。
`5. docker search --no-trunc 关键词`
输出完整的镜像描述。
`6. docker search -s 星级关键词`
按照仓库星级排列结果。
`7. docker search --help`
获取 docker search 支持的参数帮助。
`8. docker inspect 镜像名`
查看远程镜像详细信息。
`9. docker pull 镜像[:标签]` 
从 Docker Hub 拉取指定镜像。
`10. docker pull -a`
拉取所有 tagged 镜像及其历史版本。
`11. docker pull --help`
获取 docker pull 支持的参数帮助。
### 查询本地镜像

Docker查询镜像的主要命令和参数包括:
`1. docker images`
查看所有本地镜像,默认列出所有镜像。
`2. docker images -q`
只输出镜像ID,不显示其他信息。
`3. docker images --filter=since=xxx` 
过滤出指定时间后创建的镜像。
`4. docker images -f dangling=true`
查询悬空镜像(即未被使用的镜像)。 
`5. docker images -a`
显示所有镜像,包括中间层镜像。
`6. docker images --digests` 
显示镜像的摘要信息。
`7. docker images name`
查找指定名称的镜像。
`8. docker images --no-trunc`
显示完整的镜像名称。
`9. docker image inspect image`
查看镜像的详细配置信息。

### 操作容器实例

#### 停止/删除容器
要停止并删除所有Docker容器,可以使用以下命令:
```bash
docker stop $(docker ps -aq)
```
这个命令会:
- docker ps -aq:查询所有正在运行的容器的ID并以空白隔开
- $(docker ps -aq):执行上述查询并将结果作为子命令的参数
- docker stop:停止参数列出的所有容器
停止完容器后,可以使用以下命令删除所有容器:
```bash 
docker rm $(docker ps -aq)
```
或者使用以下单行命令直接停止并删除:
```bash
docker stop $(docker ps -aq) && docker rm $(docker ps -aq)
```
还有其他方法:
```bash
docker ps -a -q | xargs docker rm
```
或者:
```bash 
docker container stop $(docker container ls -aq) && \
  docker container rm $(docker container ls -aq)
```
以上命令都可以很方便地停止并删除本地所有的Docker容器。选择其中一个按需使用即可。
另外,也可以使用docker system prune命令进行整理,一次性清理未使用的镜像、网络、数据卷等资源。








# Nacos
1. 下载 nacos 压缩包
2. 解压并修改配置文件（单点 or 集群）
`application.properties：`
```properties
#*************** Spring Boot Related Configurations ***************#
### Default web context path:
server.servlet.contextPath=/nacos
### Include message field
server.error.include-message=ALWAYS
### Default web server port:
server.port=8848
#*************** Network Related Configurations ***************#
### If prefer hostname over ip for Nacos server addresses in cluster.conf:
# nacos.inetutils.prefer-hostname-over-ip=false
### Specify local server's IP:
# nacos.inetutils.ip-address=
#*************** Config Module Related Configurations ***************#
### If use MySQL as datasource:
spring.datasource.platform=mysql
### Count of DB:
db.num=1
### Connect URL of DB:
db.url.0=jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true&useUnicode=true&useSSL=false&serverTimezone=UTC
db.user.0=nacos
db.password.0=nacos
### Connection pool configuration: hikariCP
db.pool.config.connectionTimeout=30000
db.pool.config.validationTimeout=10000
db.pool.config.maximumPoolSize=20
db.pool.config.minimumIdle=2
```
`cluster.conf:`
```conf
2.0.0.1:8846 //ip为本地内网ip，不是localhost/127.0.0.1
2.0.0.1:8847
```
3. 创建数据库 nacos，为该数据库配置用户名和密码以及权限，再导入 `nacos-mysql.sql` 文件自动新建相应数据表。

4. `sh startup.sh -m standalone` 单点启动

![image.png](http://qnpicmap.fcsluck.top/pics/202311181541807.png)
# Sentinel
1. 下载 [Sentinel](https://github.com/alibaba/Sentinel/releases) 的 jar 包上传至 linux 系统上
2. 使用 _nohup_ 指令持久化后台运行 **jar 包**
3. 后端持久运行 jar 包：
   `nohup java -Xms100m -Xmx100m -jar score-api-0.0.1-SNAPSHOT.jar&`

![image.png](http://qnpicmap.fcsluck.top/pics/202311181541977.png)
# Seata
## 服务端配置
1. 下载 [Seata](https://github.com/seata/seata/releases/) 服务端
2. 新建一个 **namespace** 用于 seata 使用：*seata*
![image.png](http://qnpicmap.fcsluck.top/pics/202311201527195.png)
3. 客户端配置- `application.yml`
```yaml
server:  
  port: 7091  
spring:  
  application:  
    name: seata-server  
logging:  
  config: classpath:logback-spring.xml  
  file:  
    path: ${log.home:${user.home}/logs/seata}  
  extend:  
    logstash-appender:  
      destination: 127.0.0.1:4560  
    kafka-appender:  
      bootstrap-servers: 127.0.0.1:9092  
      topic: logback_to_logstash  
console:  
  user:  
    username: seata  
    password: seata  
seata:  
  config:  
    # support: nacos, consul, apollo, zk, etcd3  
    type: nacos  
    nacos:  
      serverAddr: xxx:8848  
      namespace: 401254cb-2aa6-4be3-bd44-4a139ebdc687 #自定义的命名空间  
      group: SEATA_GROUP  
      username: nacos  
      password: nacos  
      dataId: seata-server.properties  
  registry:  
    # support: nacos, eureka, redis, zk, consul, etcd3, sofa  
    type: nacos  
    nacos:  
      application: seata-server  
      server-addr: xxx:8848  
      namespace: 401254cb-2aa6-4be3-bd44-4a139ebdc687  #自定义的命名空间  
      group: SEATA_GROUP  
      cluster: default  
      username: nacos  
      password: nacos  
  store:  
    # support: file 、 db 、 redis  
    mode: file  
  #  server:  
  #    service-port: 8091 #If not configured, the default is '${server.port} + 1000'  security:  
    secretKey: SeataSecretKey0c382ef121d778043159209298fd40bf3850a017  
    tokenValidityInMilliseconds: 1800000  
    ignore:  
      urls: /,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.jpeg,/**/*.ico,/api/v1/auth/login
```
4. 初始 Mysql 数据库
新建 seata 库->执行 `mysql.sql` 初始化脚本->【Seata 1.x 版本 mysql 脚本】压缩包目录 `seata/script/db/mysql.sql`
![image.png](http://qnpicmap.fcsluck.top/pics/202311201526596.png)
5. 导入初始配置到 nacos
- 修改压缩包目录 `seata/script/config-center/config.txt` 文件中几处内容：
```txt
# 存储模式
store.mode=db
store.db.datasource=druid
store.db.dbType=mysql
# 需要根据 mysql 的版本调整 driverClassName
# mysql8 及以上版本对应的 driver：com.mysql.cj.jdbc.Driver
# mysql8 以下版本的 driver：com.mysql.jdbc.Driver
store.db.driverClassName=com.mysql.jdbc.Driver
# 注意根据生产实际情况调整参数 host 和 port
store.db.url=jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&rewriteBatchedStatements=true
# 数据库用户名密码
store.db.user=root
store.db.password=12345678
# 微服务里配置与这里一致,客户端事务组映射配置（要与客户端的 application.yml 中的配置保持一致）  
service.vgroupMapping.user-service-seata-service-group=default  
service.vgroupMapping.book-service-seata-service-group=default  
service.vgroupMapping.borrow-service-seata-service-group=default
```
> [!WARNING] 特别说明
> 配置事务分组 service.vgroupMapping.dev_tx_group=default  
> dev_tx_group：需要与客户端保持一致，可以自定义 (如上所示自定义) 
> default：需要跟客户端和 application.yml 中的 cluster 保持一致  
> default 必须要等于 registry.conf.cluster = “default”

- 通过压缩包目录 `seatascript/config-center/nacos/nacos-config.sh` 将修改后的 config.txt 发布到 nacos 上
```shell
# 运行指令，通过 Git Bash Here
sh nacos-config.sh -h localhost -p 8848 -g SEATA_GROUP -t 891d7906-dd03-4b8c-9fe9-a1f0609b3189
# 具体说明参见： http://seata.io/zh-cn/docs/user/configurations.html
# -h: nacos host，默认 localhost
# -p: nacos 端口，默认 8848
# -g: nacos 分组，默认'SEATA_GROUP'.
# -t: 租户信息 Tenant information，对应 nacos namespace ID，默认''
# -u: nacos 用户名，默认''
# -w: nacos 用户密码，默认''
```
![image.png](http://qnpicmap.fcsluck.top/pics/202311201533687.png)
6. 启动 seata
根据系统环境启动 seata 服务端：
![image.png|500](http://qnpicmap.fcsluck.top/pics/202311201535684.png)
## 客户端配置
1. 引入 Maven 依赖
```xml
<!--        seata-->  
<dependency>  
    <groupId>com.alibaba.cloud</groupId>  
    <artifactId>spring-cloud-starter-alibaba-seata</artifactId>  
</dependency>
```
2. 修改微服务的 `application.yml`
```yml
spring:  
  application:  
    name: book-service  
  datasource:  
    url: jdbc:mysql://localhost:3306/springcloud?useUnicode=true&characterEncoding=utf8  
    username: root  
    password: 123456  
    driver-class-name: com.mysql.cj.jdbc.Driver  
  cloud:  
    nacos:  
      discovery:  
        # 配置 Nacos 注册中心地址  
        server-addr: xxx:8848  
      #        namespace: 44a80565-86f1-450f-88ea-6f93801cd08c #设置命名空间为开发环境  
    sentinel:  
      transport:  
        # 添加监控页面地址即可  
        dashboard: 127.0.0.1:8080
seata:  
  tx-service-group: user-service-seata-service-group #必须配置和服务端的service .vgroupMapping.xxx 一致  
  # 注册  registry:  
    # 使用 Nacos  
    type: nacos  
    nacos:  
      # 使用 Seata 的命名空间，这样才能正确找到 Seata 服务，由于组使用的是 SEATA_GROUP，配置默认值就是，就不用配了  
      namespace: 401254cb-2aa6-4be3-bd44-4a139ebdc687  
      username: nacos  
      password: nacos  
      server-addr: ${spring.cloud.nacos.discovery.server-addr}  
  # 配置  
  config:  
    type: nacos  
    nacos:  
      namespace: 401254cb-2aa6-4be3-bd44-4a139ebdc687  
      username: nacos  
      password: nacos  
      server-addr: ${spring.cloud.nacos.discovery.server-addr}  
  service:  
    vgroup-mapping:  
      tx-group-mapping: user-service-seata-service-group  #必须配置和服务端的service .vgroupMapping.xxx 一致
```
3. 配置完成启动微服务即可
# RabbitMQ
1. 下载安装 [RabbitMQ](https://www.rabbitmq.com/) 和 [Erlang](https://www.erlang.org/) 并配置环境变量
2. 安装完成后找到安装文件路径，找到 sbin 目录下，打开命令行 cmd，在命令行里切换到 sbin 目录下，输入如下命令：
```shell
rabbitmq-plugins enable rabbitmq_management
```
运行成功后，打开任务资源管理器，找到 rabbitmq 服务右键重新启动。或者也可以，双击 sbin 下的 rabbitmq-server.bat（双击后稍等片刻）
3. 安装完成后，通过浏览器访问 RabbitMQ 控制台 [http://localhost:15672](http://localhost:15672/)
	- 默认的端口号：*5672*
	- 默认的用户和密码是  *guest*  
	- 管理后台的默认端口号：*15672*
![image.png](http://qnpicmap.fcsluck.top/pics/202311221729835.png)
常用命令：
1. windows
	```shell
	#查看端口占用情况
	netstat -ano | findstr :15672
	#下载插件
	rabbitmq-plugins.bat enable rabbitmq_management
	#查看是否安装成功
	rabbitmqctl.bat status
	#如果查看报错 ，可能是后台服务器没有开启，开启后台服务器再重试  #如果查看报错 ，可能是后台服务器没有开启，开启后台服务器再重试  
	net start RabbitMQ
	#查看RabbitMQ已有用户以及用户对应的角色信息
	rabbitmqctl.bat list_users
	#RabbitMQ的默认用户名和密码是guest ，只能在本机访问，新增一个用户，并赋予超级管理员角色
	rabbitmqctl add_user 用户名密码
	#设置用户角色
	rabbitmqctl set_user_tags 用户名 administrator
	```
2. linux
	```bash
	#列出所有队列 ：
	rabbitmqctl list_queues
	#列出所有交换器 ：
	rabbitmqctl list_exchanges
	#列出所有绑定 ：
	rabbitmqctl list_bindings
	#列出所有连接 ：
	rabbitmqctl list_connections
	#列出所有通道 ：
	rabbitmqctl list_channels
	#列出所有消费者 ：
	rabbitmqctl list_consumers
	#查看队列的状态信息 ：
	rabbitmqctl list_queues name messages_ready messages_unacknowledged
	#查看交换器的状态信息 ：
	rabbitmqctl list_exchanges name type
	#查看连接的状态信息 ：
	rabbitmqctl list_connections name user state
	#查看通道的状态信息 ：
	rabbitmqctl list_channels connection_name user number_of_consumers
	#查看 RabbitMQ 节点的状态信息：
	rabbitmqctl status
	#查看 RabbitMQ 节点的详细状态信息：
	rabbitmqctl status --verbose
	#查看 RabbitMQ 节点的配置信息：
	rabbitmqctl environment
	#查看 RabbitMQ 节点的运行日志：
	rabbitmqctl report
	#查看 RabbitMQ 节点的内存使用情况：
	rabbitmqctl eval 'memory'
	```
---
# Windows
## 关闭进程
```shell
taskkill /f /t /im nginx.exe
taskkill /f /pid <查询的PID号>
```
![image.png](http://qnpicmap.fcsluck.top/pics/202311182136214.png)
## 查看端口
```shell
netstat -ano #查看所有端口
netstat -ano | findstr <端口号>
netstat -ano | find "关键字"
```
# Linux
## 内核信息
查看 Linux 系统内核的主要命令和方法有:
1. uname 命令
```sh
uname -r
```
显示当前正在使用的内核版本号。
2. 查看/proc/version 文件
```sh
cat /proc/version
```
文件中包含内核名称、版本、编译日期等详细信息。
3. rpm 命令(对于 RPM 包系统)
```sh
rpm -q kernel-headers kernel-devel
```
显示内核头文件和开发包的版本。
4. dpkg 命令(对于 Debian/Ubuntu 系统) 
```sh
dpkg -l | grep linux-image
```
显示所有已安装的内核包。
5. 查看 grub 启动项
对于 grub 启动引导,可以查看 /boot/grub/grub.cfg 文件,找到默认引导的内核版本。
6. 系统属性
如系统设置->关于本机中也会显示内核版本。
7. sysctl 命令 
```sh
sysctl kernel.version
```
直接显示内核版本号。
8. 主机名和操作系统文件
```sh
cat /etc/hostname
cat /etc/*release
```
## 查看端口
```shell
netstat -tuln | grep :<端口号>
netstat -nplt #查看所有端口
```
> **netstat** 参数含义：
> -a (all)显示所有选项，默认不显示 LISTEN 相关
> -t (tcp)仅显示 tcp 相关选项
> -u (udp)仅显示 udp 相关选项
> -n 拒绝显示别名，能显示数字的全部转化成数字。
> -l 仅列出有在 Listen (监听) 的服務状态
> -p 显示建立相关链接的程序名
> -r 显示路由信息，路由表
> -e 显示扩展信息，例如 uid 等
> -s 按各个协议进行统计
> -c 每隔一个固定时间，执行该 netstat 命令。
## 查看程序
```shell
ps -ef | grep java #查询java进程的程序
ps -ef #查看正在运行的进程
```
## 安装服务
`yum` 工具中常见的几个主要参数如下:
- y: 执行命令时根据提示自动进行 Yes 答复。等同于--assumeyes。
- C: 只检查是否需要进行包更新,但不实际安装/升级包。
- d: 下载包文件但不安装/升级。通常与-y 一起使用。
- e: 安装程序时产生详细输出信息。
- q: 执行"搜索"操作时本身不输出任何搜索结果,只返回退出状态。
- R: 将安装时需要下载的依赖包一并保存下来可以离线安装。
- y: 和--assumeyes 参数一样,自动答复 yes,而不询问或提示。
- update: 更新已安装的软件包到最新版本。
- upgrade: 升级系统,更新所有软件包到最新版本。 
- check-update:检查是否有更新。
- list: 显示已安装和可更新的软件包列表。
- search: 搜索软件包。
- install: 安装软件包。
- remove: 只删除软件包文件,但不删除软件的配置文件和数据文件。 
- erase: 除了删除软件包文件外,还会删除该软件产生的所有配置文件和数据文件。实现了更彻底的卸载和清理。
## 防火墙
### centos 7
一、防火墙的开启、关闭、禁用命令
> （1）设置开机启用防火墙：`systemctl enable firewalld.service`
> （2）设置开机禁用防火墙：`systemctl disable firewalld.service`
> （3）启动防火墙：`systemctl start firewalld`
> （4）关闭防火墙：`systemctl stop firewalld`
> （5）检查防火墙状态：`systemctl status firewalld` 
二、使用 firewall-cmd 配置端口
> （1）查看防火墙状态：`firewall-cmd --state`
> （2）重新加载配置：`firewall-cmd --reload`
> （3）查看开放的端口：`firewall-cmd --list-ports`
> （4）开启防火墙端口：`firewall-cmd --zone=public --add-port=9200/tcp --permanent`
## 文件处理
### 查看目录
显示指定目录的详细信息
```sh
ls -l [目录或者文件]
```
显示指定目录的隐藏文件
```sh
ls -al [目录或者文件]
```
### 删除文件
强制删除不提示
```bash
rm -f 文件名
```
删除整个文件夹并不提示
```bash
rm -rf 目录名
```
### 复制迁移文件
复制单个文件到文件夹中
```bash
cp 文件 文件夹
```
复制整个文件夹到另一个文件夹中
```bash
cp -r 源文件夹 目标文件夹
```
重命名文件或文件夹
```bash
mv 源文件名 新文件名
```
移动文件或文件夹
```bash
mv 源文件 目标文件
```
### 查看文件

查看文件详细信息
```sh
stat 文件名
```

查看文件
```bash
more/cat 文件名
```
查看文件，要求显示行号并分页
```bash
cat -n 文件名 | more
```
默认查看文件后 10 行
```bash
tail 文件名
```
查看文件末尾 5 行的内容
```bash
tail -n 5 文件名
```
实时追踪文档的更新
```bash
tail -f 文件名
```
输出你好
```bash
echo 你好
```
在文件末尾添加内容
```bash
echo 内容 >> 文件名
```
覆盖文件的所有内容
```bash
echo 新内容 > 文件名
```
把文件内容写入到另一个文件的末尾
```bash
cat 文件名1 >> 文件名2
```
在当前目录建立一个指向/tmp 目录的硬链接
```bash
ln /tmp 自定义链接名
```
在当前目录建立一个指向/tmp 目录的软链接
```bash
ln -s /tmp 自定义链接h
```
查看/tmp 目录是否存在名为 log.txt 文件
```bash
find /tmp -name log.txt
```
查看/tmp 目录是否存在小于超过 2M 的文件
```bash
find /tmp -size -2M
```
查看整个系统是否存在大于 100M 的文件
```bash
find / -size +100M
```
查看文件中，在第几行有 yes
```bash
cat 文件名 | grep -n yes
```
查看文件中，在第几行有 yes 并忽略大小写
```bash
cat 文件名 | grep -ni yes
```
### 展示树形结构
tree 命令可以用来以树形结构显示目录的内容。它的主要用法如下:
1. 显示当前目录下的文件和目录结构:
```bash
tree
```
2. 显示指定目录下的文件和目录结构:
```bash
tree /path/to/directory
```
3. 只显示指定深度内的结构:
```sh
tree -L 2  // 只显示两层深度的目录结构
```
4. 不递归显示,只显示指定目录的直接内容:
```sh
tree -I
``` 
5. 隐藏空目录:
```sh
tree -I -D
```
6. 输出为颜色图示:
```sh
tree -C
```
7. 指定后缀只显示匹配文件的结构: 
```sh
tree -P '*.txt'
```
8. 将结构输出到指定文件:
```sh
tree > directory.txt
```
9. 对输出进行压缩:
```sh
tree -C -z
```
### 解压文件
把文件压缩为.gz 尾缀的压缩文件
```bash
gzip 文件.gz
```
解压 gz 尾缀的文件
```bash
gunzip 文件.gz
```
把/tmp 文件夹的所有文件压缩成.zip 尾缀的压缩文件
```bash
zip -r 文件.zip /tmp
```
解压 zip 尾缀的文件，解压到/root 目录下
```bash
unzip -d  /root 文件.zip
```
把/tmp 文件夹的所有文件压缩为.tar.gz 尾缀的压缩文件
```bash
tar -zcvf 文件.tar.gz /tmp
```
解压.tar.gz 尾缀的文件，解压到/root 目录下
```bash
tar -zxvf 文件.tar.gz -C  /root
```
## 进程管理
查看某进程的资源占用情况
```bash
top -p 进程号
```
找出占用 CPU 最多的进程
```bash
top，然后按大写的P
```
找出占用内存最多的进程
```bash
top，然后按大写的M
```
查看正在运行的进程
```bash
ps -ef
```
查看有关 mysql 的进程信息
```bash
ps -ef | grep mysql
```
正常杀死进程
```bash
kill -15 PID号
kill -12 pid #安全关闭
```
强制杀死进程
```bash
kill -9 pid #强制关闭
```
找出 CPU 占用高的进程 ID
```bash
top -c
```
根据进程 ID，找出 CPU 占用高的线程 ID
```bash
ps H -eo pid,tid,%cpu | grep 进程ID
```
输出‘指定进程 ID 的 16 进制’
```bash
printf "%x\n" 进程ID
```
根据‘指定进程 ID 的 16 进制’，查看到底是哪里 java 的代码问题
```bash
jstack 进程ID | grep 指定进程ID的16进制 -A20
```


# 参考

1. [centos7安装Docker详细步骤（无坑版教程）-腾讯云开发者社区-腾讯云](https://cloud.tencent.com/developer/article/1701451)
2. [使用Docker搭建MySQL主从复制（一主一从）\_使用docker搭建mysql主从复制(一主一从)-CSDN博客](https://blog.csdn.net/abcde123_123/article/details/106244181)
3. [前端研发需要知道的Docker-腾讯云开发者社区-腾讯云](https://cloud.tencent.com/developer/article/2364484)
