<!-- Templater 动态生成目录 -->
<%* 
  // 获取当前文件的所有标题（来自元数据缓存）
  const fileCache = app.metadataCache.getFileCache(here);
  const headings = fileCache.headings || []; // 防止无标题时报错

  // 生成目录的 Markdown 列表
  let tocContent = "";
  for (const heading of headings) {
    // 根据标题层级计算缩进（一级标题无缩进，二级缩进 2 空格，三级缩进 4 空格...）
    const indent = "  ".repeat(heading.level - 1);
    // 生成列表项（链接到标题锚点）
    tocContent += `${indent}- [${heading.text}](#${heading.slug})
`;
  }

  // 输出目录到笔记（保留一级标题）
  dv.paragraph(`## 目录`);
  dv.paragraph(tocContent);
%>