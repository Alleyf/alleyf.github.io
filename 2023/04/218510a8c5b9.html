

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="http://qnpicmap.fcsluck.top/pics/202311162214229.png">
  <link rel="icon" href="http://qnpicmap.fcsluck.top/pics/202311162214229.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="alleyf">
  <meta name="keywords" content="">
  
    <meta name="description" content="it is some basic usage of SpringBoot .">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringBoot启示录">
<meta property="og:url" content="https://alleyf.github.io/2023/04/218510a8c5b9.html">
<meta property="og:site_name" content="alleyf">
<meta property="og:description" content="it is some basic usage of SpringBoot .">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/20230428173445.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/20230428185132.png">
<meta property="og:image" content="https://s2.loli.net/2023/04/28/jh6pWVrx2yZSB43.png">
<meta property="og:image" content="https://s2.loli.net/2023/04/29/dvnpCAF81RxlBK5.png">
<meta property="og:image" content="https://s2.loli.net/2023/04/29/wokjgHNQVc4TCSW.png">
<meta property="og:image" content="https://s2.loli.net/2023/05/02/sgfWcYZxHa2rJKm.png">
<meta property="og:image" content="https://s2.loli.net/2023/05/29/PcG5L8ZYouWhyp6.png">
<meta property="og:image" content="https://s2.loli.net/2023/06/01/Z6TuNLREyqGFazH.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202307311353929.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202307311410745.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202307311433682.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202309262023932.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202309272236587.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310011258914.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031214347.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031453650.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031453642.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031453615.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031454406.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021153950.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021200042.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021206531.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021214865.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021240929.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021501320.png">
<meta property="article:published_time" content="2023-04-28T08:37:54.000Z">
<meta property="article:modified_time" content="2023-10-05T07:25:50.738Z">
<meta property="article:author" content="alleyf">
<meta property="article:tag" content="SpringBoot">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/20230428173445.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>SpringBoot启示录 - alleyf</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"alleyf.github.io","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"d57048846da607439cf11718741f2eb0","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?d57048846da607439cf11718741f2eb0";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  

  

  



  
<!-- hexo injector head_end start --><script> let HEXO_MMEDIA_DATA = { js: [], css: [], aplayerData: [], metingData: [], artPlayerData: [], dplayerData: []}; </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="alleyf" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Mr.Alleyf</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/gallery/">
                <i class="iconfont icon-images"></i>
                画廊
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml">
                <i class="iconfont icon-rss"></i>
                RSS
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" target="_blank" rel="noopener" href="https://github.com/Alleyf">
                <i class="iconfont icon-github-fill"></i>
                Github
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://api.likepoems.com/img/nature') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="SpringBoot启示录"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        alleyf
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-04-28 16:37" pubdate>
          2023年4月28日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          71k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          594 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">SpringBoot启示录</h1>
            
              <p class="note note-info">
                
                  
                    本文最后更新于：5 个月前
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h1 id="1-开发环境热部署"><a href="#1-开发环境热部署" class="headerlink" title="1.开发环境热部署"></a>1.开发环境热部署</h1><h2 id="1-说明"><a href="#1-说明" class="headerlink" title="1. 说明"></a>1. 说明</h2><blockquote>
<ol>
<li>在实际的项目开发调试过程中会频繁地修改后台类文件，导致需要重新编译、重新启动，整个过程非常麻烦，影响开发效率。</li>
<li>Spring Boot 提供了 spring-boot-devtools 组件，使得无须手动重启 SpringBoot 应用即可重新编译、启动项目，大大缩短编译启动的时间。devtools 会监听 classpath 下的文件变动，触发 Restart 类加载器重新加载该类,从而实现类文件和属性文件的热部署。</li>
<li>并不是所有的更改都需要重启应用 (如静态资源、视图模板)，可以通过设置spring. devtools. restart. exclude 属性来指定一些文件或目录的修改不用重启应用</li>
</ol>
</blockquote>
<h2 id="2-配置"><a href="#2-配置" class="headerlink" title="2. 配置"></a>2. 配置</h2><blockquote>
<p>在 <strong>pom. xml</strong> 配置文件中添加 <strong>dev-tools 依赖</strong>。<br>使用 <strong>optional&#x3D;true</strong> 表示依赖<strong>不会传递</strong>，即该项目依赖 devtools; 其他项目如果引入此项目生成的 JAR 包，则不会包含 devtools</p>
</blockquote>
<h3 id="1-pom-xml"><a href="#1-pom-xml" class="headerlink" title="1.pom. xml"></a>1.pom. xml</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>	&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;<br>	&lt;optional&gt;<span class="hljs-literal">true</span>&lt;/optional&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure>
<h3 id="2-application-properties"><a href="#2-application-properties" class="headerlink" title="2. application. properties"></a>2. application. properties</h3><blockquote>
<p>在 application. properties 中配置 <strong>devtools.</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">#热部署生效<br>spring.devtools.restart.enabLed=<span class="hljs-literal">true</span><br>#设置重启目录<br>spring.devtooLs.restart.additional-paths=src/main/java<br>#设置classpath目录下的 WEB-INF 文件夹内容修改不重启<br>spring.devtooLs.restart.exclude=<span class="hljs-keyword">static</span><span class="hljs-comment">/**</span><br></code></pre></td></tr></table></figure>

<ul>
<li>如果使用了<span style="background:rgba(240, 200, 0, 0.2)"> Eclipse</span>, 那么在修改完代码并保存之后，项目将自动编译并触发重启，而如果使用了 <span style="background:rgba(160, 204, 246, 0.55)">IntelliJ IDEA</span>, 还需要配置项目自动编译。</li>
<li>打开<font color="#245bdb"> Settings </font>页面，在左边的菜单栏依次找到Build, Execution, Deployment-→Compile, 勾选 <font color="#ffc000">Build project automatically</font></li>
<li>按 <font color="#4bacc6">Ctrl+ Shift+ Alt+ &#x2F;</font>快捷键调出 Maintenance 页面，单击 <font color="#9bbb59">Registry</font>, 勾选<font color="#8064a2">compiler.automake.allow.when.app.running </font>复选框 (可能找不到，修改设置为下图即可解决)。</li>
<li>做完这两步配置之后，若开发者再次在 IntelliJ IDEA 中修改代码，则项目会自动重启。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/20230428173445.png" srcset="/img/loading.gif" lazyload alt="image.png|425"></p>
<h1 id="2-控制器"><a href="#2-控制器" class="headerlink" title="2. 控制器"></a>2. 控制器</h1><blockquote>
<ol>
<li>Spring Boot 提供了<font color="#f79646">@Controller</font> 和<font color="#c0504d">@RestController</font> 两种注解来标识此类负责<span style="background:rgba(240, 107, 5, 0.2)">接收和处理 HTTP 请求</span>。</li>
<li>如果请求的是<font color="#00b0f0">页面和数据</font>，使用<font color="#0070c0">@Controller </font>注解即可; 如果只是请求<font color="#ff0000">数据</font>,则可以使用<font color="#c00000">@RestController </font>注解。</li>
</ol>
</blockquote>
<h2 id="1-demo"><a href="#1-demo" class="headerlink" title="1.demo"></a>1.demo</h2><p>@ RestController 的用法<br>默认情况下，@RestController 注解会将返回的对象数据转换为 <strong>JSON 格式</strong>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloController</span> &#123;<br>	<span class="hljs-meta">@RequestMapping</span> (<span class="hljs-string">&quot;/user&quot;</span>)<br>	<span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span> <span class="hljs-params">()</span>&#123;<br>		<span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>		user.setUsername (<span class="hljs-string">&quot;zhangsan&quot;</span>);<br>		user.setPassword (<span class="hljs-string">&quot;123&quot;</span>) ;<br>		<span class="hljs-keyword">return</span> user;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-路由映射"><a href="#2-路由映射" class="headerlink" title="2.路由映射"></a>2.路由映射</h2><blockquote>
<p>@RequestMapping 注解主要负责 URL 的路由映射。它可以添加Controller类或者具体的方法上。<br>如果添加在 Controller 类上，则这个 Controller 中的所有路由映射都将会加上此映射规则，如果添加在方法上，则只对当前方法生效。<br>@RequestMapping 注解包含很多属性参数来定义 HTTP 的请求映射规则。常用的属性参数如下:<br><span style="background:#d3f8b6">- value: 请求 URL 的路径, 支持 URL 模板、正则表达式</span><br><span style="background:#d3f8b6">- method: HTTP 请求方法</span></p>
</blockquote>
<ul>
<li>consumes:请求的媒体类型 (Content- Type)，如 application&#x2F;json</li>
<li>produces: 响应的媒体类型<br><span style="background:#d3f8b6">- params, headers: 请求的参数及请求头的值</span></li>
</ul>
<h3 id="1-路由规则"><a href="#1-路由规则" class="headerlink" title="1. 路由规则"></a>1. 路由规则</h3><ol>
<li>@RequestMapping 的 <font color="#0070c0">value </font>属性用于<font color="#0070c0">匹配 URL 映射</font>，value 支持简单表达式</li>
<li>@RequestMapping (“&#x2F;user”)</li>
<li>@RequestMapping 支持使用通配符匹配 URL，用于统一映射某些 URL 规则类似的请求: @RequestMapping (“&#x2F;getJson&#x2F;*. json”), 当在浏览器中请求&#x2F;getJson&#x2F;a.json 或者&#x2F;getJson&#x2F;b.json 时都会匹配到后台的 Json 方法</li>
<li>@RequestMapping 的通配符匹配非常简单实用，支持**<span style="background:#b1ffff">“*“  “?” “**“</span>** 等通配符</li>
<li>符号<font color="#ffc000"> “*“ </font>匹配<font color="#ffc000">任意字符</font>，符号 <font color="#00b050">“**“</font> 匹配<font color="#00b050">任意路径</font>，符号<font color="#00b0f0"> “?” </font>匹配<font color="#0070c0">单个字符</font>。有通配符的优先级低于没有通配符的，比如&#x2F;user&#x2F;addjson 比&#x2F;user&#x2F;* .json 优先匹配。有“**” 通配符的优先级低于有”*“ 通配符的。</li>
</ol>
<h3 id="2-Method-匹配"><a href="#2-Method-匹配" class="headerlink" title="2. Method 匹配"></a>2. Method 匹配</h3><ul>
<li>HTTP 请求 Method 有 <span style="background:#affad1">GET、POST、 PUT、DELETE </span>等方式。HTTP 支持的全部Method</li>
<li>@RequestMapping 注解提供了 method 参数指定请求的 Method 类型，包括<span style="background:rgba(205, 244, 105, 0.55)">RequestMethod. GET、RequestMethod. POST、RequestMethod.DELETE、RequestMethod. PUT</span> 等值，分别对应 HTTP 请求的 Method<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping</span> (value = <span class="hljs-string">&quot;/getData&quot;</span> , method = RequestMethod.GET)<br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getData</span> <span class="hljs-params">()</span>&#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
Method 匹配也可以使用<span style="background:rgba(3, 135, 102, 0.2)">@GetMapping、@PostMapping </span>等注解代替。</li>
</ul>
<h3 id="3-参数传递"><a href="#3-参数传递" class="headerlink" title="3. 参数传递"></a>3. 参数传递</h3><h4 id="1-get-请求"><a href="#1-get-请求" class="headerlink" title="1. get 请求"></a>1. get 请求</h4><blockquote>
<p>视图函数定义 query_params 路由参数，函数体内可以直接获取该参数。</p>
</blockquote>
<p>demo：</p>
<p>方式 1 同参（参数可有可无都能成功响应）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloController</span> &#123;  <br><span class="hljs-comment">// get注解  </span><br><span class="hljs-meta">@RequestMapping(value = &quot;/index1&quot;,method = RequestMethod.GET)</span><br><span class="hljs-comment">// @GetMapping(&quot;/index1&quot;)  </span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello1</span><span class="hljs-params">(String name)</span>&#123;  <br>	<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;欢迎您：&quot;</span>+name;  <br>&#125;  <br>&#125;<br></code></pre></td></tr></table></figure>

<p>方式 2 不同参（参数必须携带，否则 400 错误响应）</p>
<blockquote>
<p>将参数 usrname 映射为 name，默认<font color="#0070c0"> require&#x3D;true</font>（必须携带参数否则报错），设置为 false 可以<font color="#6425d0">不携带参数访问</font><br><code>public String hello2(@RequestParam(value = &quot;usrname&quot;,required = false) String name)</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index2&quot;,method = RequestMethod.GET)</span>  <br><span class="hljs-comment">// @GetMapping(&quot;/index&quot;)  </span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello2</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;usrname&quot;)</span> String name)</span>&#123;  <br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;欢迎您：&quot;</span>+name;  <br>&#125;<br></code></pre></td></tr></table></figure>

<p>通配符匹配路由：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;test/*&quot;)</span>  <span class="hljs-comment">// 匹配同级任何路由</span><br><span class="hljs-meta">@GetMapping(&quot;test/**&quot;)</span>  <span class="hljs-comment">// 匹配任何路由（包括子级）</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;  <br>	<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;匹配同级任意路径&quot;</span>;  <br>&#125;<br></code></pre></td></tr></table></figure>



<h4 id="2-Post-请求"><a href="#2-Post-请求" class="headerlink" title="2.Post 请求"></a>2.Post 请求</h4><h5 id="1-urlencode-格式数据"><a href="#1-urlencode-格式数据" class="headerlink" title="1. urlencode 格式数据"></a>1. urlencode 格式数据</h5><p>方式 1 直接传数据：</p>
<blockquote>
<p>适合参数少的情景</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;login/&quot;)</span>  <br>	<span class="hljs-keyword">public</span> String <span class="hljs-title function_">login</span><span class="hljs-params">(String name,String pwd)</span>&#123;  <br>	System.out.println(<span class="hljs-string">&quot;name:&quot;</span>+name);  <br>	System.out.println(<span class="hljs-string">&quot;pwd:&quot;</span>+pwd);  <br>	<span class="hljs-keyword">return</span> name!=<span class="hljs-literal">null</span> &amp;&amp; pwd!=<span class="hljs-literal">null</span> ? <span class="hljs-string">&quot;登陆成功&quot;</span> : <span class="hljs-string">&quot;登陆失败&quot;</span>;  <br>&#125;<br></code></pre></td></tr></table></figure>

<p>方式 2 对象传数据：</p>
<blockquote>
<p>适合参数多的情景，<font color="#6425d0">User 为实体类</font></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;login2/&quot;)</span>  <br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">login2</span><span class="hljs-params">(User user)</span> &#123;  <br>System.out.println(<span class="hljs-string">&quot;name:&quot;</span> + user.getUsername());  <br>System.out.println(<span class="hljs-string">&quot;pwd:&quot;</span> + user.getPassword());  <br>System.out.println(user);  <br><span class="hljs-keyword">return</span> user.getUsername() != <span class="hljs-literal">null</span> &amp;&amp; user.getPassword() != <span class="hljs-literal">null</span> ? <span class="hljs-string">&quot;登陆成功&quot;</span> : <span class="hljs-string">&quot;登陆失败&quot;</span>;  <br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>[!NOTE] Tips<br><span style="background:#ff4d4f">上述两种方式，发送的 data 数据必须经过 urlencode 编码，否则接收不到。</span></p>
</blockquote>
<h5 id="2-json-格式数据"><a href="#2-json-格式数据" class="headerlink" title="2. json 格式数据"></a>2. json 格式数据</h5><blockquote>
<p>需要给视图函数形参中添加注解<font color="#245bdb">@RequestBody</font>，且 json data 中的参数键名需要与后端中的实体类的属性并一致。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;login3/&quot;)</span>  <br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">login3</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span> &#123;  <br>	System.out.println(<span class="hljs-string">&quot;name:&quot;</span> + user.getUsername());  <br>	System.out.println(<span class="hljs-string">&quot;pwd:&quot;</span> + user.getPassword());  <br>	System.out.println(user);  <br>	<span class="hljs-keyword">return</span> user.getUsername() != <span class="hljs-literal">null</span> &amp;&amp; user.getPassword() != <span class="hljs-literal">null</span> ? <span class="hljs-string">&quot;登陆成功&quot;</span> : <span class="hljs-string">&quot;登陆失败&quot;</span>;  <br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/20230428185132.png" srcset="/img/loading.gif" lazyload alt="image.png|500"></p>
<h1 id="3-文件上传"><a href="#3-文件上传" class="headerlink" title="3. 文件上传"></a>3. 文件上传</h1><h2 id="1-静态资源访问"><a href="#1-静态资源访问" class="headerlink" title="1. 静态资源访问"></a>1. 静态资源访问</h2><ol>
<li>使用 IDEA 创建 Spring Boot 项目，会默认创建出 <font color="#245bdb">classpath:&#x2F;static&#x2F;</font>目录, 静态资源一般放在这个目录下即可。</li>
<li>如果默认的静态资源过滤策略不能满足开发需求，也可以自定义静态资源过滤策略。</li>
<li>在 <span style="background:#d3f8b6">application. properties </span>中直接定义过滤规则和静态资源位置:</li>
</ol>
<ul>
<li><code>spring.mvc.static-path-pattern=/static/\*\*</code> </li>
<li><code>spring.web.resources.static-locations=classpath:/static/</code></li>
</ul>
<ol start="4">
<li>过滤规则为<font color="#00b0f0">&#x2F;static&#x2F;**</font>，静态资源位置为<font color="#00b0f0"> classpath:&#x2F;static&#x2F;</font></li>
</ol>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#设置静态路径过滤规则  </span><br><span class="hljs-attr">spring.mvc.static-path-pattern</span>=<span class="hljs-string">images/**  </span><br><span class="hljs-attr">spring.web.resources.static-locations</span>=<span class="hljs-string">classpath:/static/images/</span><br></code></pre></td></tr></table></figure>

<h2 id="2-文件上传"><a href="#2-文件上传" class="headerlink" title="2. 文件上传"></a>2. 文件上传</h2><h3 id="1-文件上传原理"><a href="#1-文件上传原理" class="headerlink" title="1. 文件上传原理"></a>1. 文件上传原理</h3><ul>
<li>表单的<font color="#ffff00"> enctype 属性</font>规定在发送到服务器之前对表单数据的<font color="#ffff00">编码方式</font>。</li>
<li>当表单的 enctype&#x3D;”<font color="#ffc000">application&#x2F;x-www-form-urlencoded</font>“ (默认)时,<br>form 表单中的数据格式为: <font color="#ffc000">key&#x3D;value&amp;key&#x3D;value</font></li>
<li>当表单的 enctype&#x3D;”<font color="#00b0f0">multipart&#x2F;form-data</font>“时，其传输数据形式如下：<br><img src="https://s2.loli.net/2023/04/28/jh6pWVrx2yZSB43.png" srcset="/img/loading.gif" lazyload alt="image.png|425"></li>
</ul>
<h3 id="2-配置文件大小"><a href="#2-配置文件大小" class="headerlink" title="2. 配置文件大小"></a>2. 配置文件大小</h3><ul>
<li>Spring Boot 工程嵌入的 tomcat 限制了请求的文件大小，每个文件的配置最大为 1 Mb，单次请求的文件的总数不能大于 10 Mb.</li>
<li>要更改这个默认值需要在配置文件 (如<font color="#00b0f0"> application.properties</font>) 中加入两个配置<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">spring.servlet.multipart.max-file-size=10MB<br>spring.servlet.multipart.max-request-size=10MB<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>当表单的 enctype&#x3D; “<font color="#9bbb59">multipart&#x2F;form-data</font>“时, 可以使用<font color="#9bbb59"> MultipartFile </font>获取上传的文件数据，再通过 <font color="#9bbb59">transferTo </font>方法将其写入到磁盘中</p>
</blockquote>
<p>demo：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.helloworld.controller;  <br>  <br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServlet;  <br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletRequest;  <br><span class="hljs-keyword">import</span> jakarta.servlet.http.HttpServletResponse;  <br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;  <br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;  <br><span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;  <br>  <br><span class="hljs-keyword">import</span> java.io.File;  <br><span class="hljs-keyword">import</span> java.io.IOException;  <br>  <br><span class="hljs-meta">@RestController</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileUploadController</span> &#123;  <br><span class="hljs-meta">@PostMapping(&quot;/upload&quot;)</span>  <br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">upload</span><span class="hljs-params">(String name, MultipartFile avatar, HttpServletRequest request)</span> <span class="hljs-keyword">throws</span> IOException &#123;  <br>System.out.println(name);  <br>System.out.println(<span class="hljs-string">&quot;filename:&quot;</span> + avatar.getOriginalFilename());  <br><span class="hljs-comment">// 获取文件类型  </span><br>System.out.println(avatar.getContentType());  <br><span class="hljs-comment">// 获取当前程序运行路径，部署时动态改变  </span><br><span class="hljs-comment">// String path = request.getServletContext().getRealPath(&quot;/upload/&quot;);  </span><br><span class="hljs-comment">// 固定为本地地址便于测试</span><br><span class="hljs-type">String</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;E:\\IDEAProjects\\helloworld\\src\\main\\resources\\static\\images\\&quot;</span>;  <br>System.out.println(path);  <br>saveFile(avatar, path);  <br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;上传成功&quot;</span>;  <br>&#125;  <br>  <br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveFile</span><span class="hljs-params">(MultipartFile avatar, String path)</span> <span class="hljs-keyword">throws</span> IOException &#123;  <br><span class="hljs-comment">// 获取上传文件夹  </span><br><span class="hljs-type">File</span> <span class="hljs-variable">dir</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(path);  <br><span class="hljs-comment">// 判断文件夹是否存在，不存在则创建  </span><br><span class="hljs-keyword">if</span> (!dir.exists()) &#123;  <br>dir.mkdir();  <br>&#125;  <br><span class="hljs-comment">// 实例化上传文件  </span><br><span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(path + avatar.getOriginalFilename());  <br>System.out.println(file.getPath());  <br><span class="hljs-comment">// 保存上传的文件  </span><br>avatar.transferTo(file);  <br>&#125;  <br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="3-拦截器"><a href="#3-拦截器" class="headerlink" title="3. 拦截器"></a>3. 拦截器</h2><p>简介：</p>
<blockquote>
<ol>
<li>拦截器在 Web 系统中非常常见，对于某些全局统一-的操作，我们可以把它提取到拦截器中实现。总结起来，拦截器大致有以下几种使用场景:</li>
<li><font color="#7030a0">权限检查:</font> 如登录检测，进入处理程序检测是否登录，如果没有，则直接返回登录页面。<br>3<font color="#7030a0">. 性能监控: </font>有时系统在某段时间莫名其妙很慢，可以通过拦截器在进入处理程序之前记录开始时间，在处理完后记录结束时间，从而得到该请求的处理时间</li>
<li><font color="#548dd4">通用行为: </font>读取 cookie 得到用户信息并将用户对象放入请求，从而方便后续流程使用，还有提取 Locale、Theme 信息等，只要是多个处理程序都需要的，即可使用拦截器实现。</li>
</ol>
</blockquote>
<blockquote>
<p>[!NOTE] tips</p>
<ol>
<li>Spring Boot 定义了 <span style="background:#d2cbff">HandlerInterceptor 接口</span>来实现自定义拦截器的功能</li>
<li>HandlerInterceptor 接口定义了<span style="background:#40a9ff"> preHandle、postHandle、 afterCompletion</span> 三种方法，通过重写这三种方法实现请求前、请求后等操作<br><img src="https://s2.loli.net/2023/04/29/dvnpCAF81RxlBK5.png" srcset="/img/loading.gif" lazyload alt="image.png|375"></li>
</ol>
</blockquote>
<h3 id="1-拦截器定义"><a href="#1-拦截器定义" class="headerlink" title="1. 拦截器定义"></a>1. 拦截器定义</h3><blockquote>
<p>类似于 django 的<font color="#4bacc6"> Midleware </font>中间件，控制请求。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">pub1ic <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginInterceptor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment">*在请求处理之前进行调用(Control1er方法调用之前)</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@override</span><br>pub1ic <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServ1etRequest request, HttpServ1etResponse response, object handTer)</span><br><span class="hljs-keyword">throws</span> Exception &#123;<br>	<span class="hljs-keyword">if</span> (条件) &#123;<br>	System.out.print1n(<span class="hljs-string">&quot;通过&quot;</span>);<br>	<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>	&#125;<span class="hljs-keyword">else</span>&#123;<br>	System.out.print1n(<span class="hljs-string">&quot;不通过&quot;</span>);<br>	<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>返回为 true 则进入下一个拦截器，否则拒绝通过。</p>
</blockquote>
<h3 id="2-拦截器注册"><a href="#2-拦截器注册" class="headerlink" title="2. 拦截器注册"></a>2. 拦截器注册</h3><ul>
<li><span style="background:#affad1"> addPathPatterns </span>方法定义拦截的地址</li>
<li><span style="background:#b1ffff">excludePathPatterns </span>定义排除某些地址不被拦截</li>
<li>添加的一个拦截器没有 addPathPattern 任何一个 url 则<font color="#92d050">默认拦截所有请求</font></li>
<li>如果没有 excludePathPatterns 任何一个请求，则<font color="#92cddc">默认不放过任何一个请求</font></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;  <br><span class="hljs-meta">@Override</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> &#123;  <br><span class="hljs-comment">// 只拦截user路由下的所有路由  </span><br><span class="hljs-comment">// registry.addInterceptor(new LoginInterceptor()).addPathPatterns(&quot;/admin/**&quot;);  </span><br><span class="hljs-comment">// 拦截所有路由  </span><br>registry.addInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LoginInterceptor</span>());  <br>  <br>&#125;  <br>&#125;<br></code></pre></td></tr></table></figure>


<h1 id="4-RESTful"><a href="#4-RESTful" class="headerlink" title="4. RESTful"></a>4. RESTful</h1><h2 id="1-RESTful-介绍"><a href="#1-RESTful-介绍" class="headerlink" title="1.RESTful 介绍"></a>1.RESTful 介绍</h2><ol>
<li>HTTP 提供了<font color="#4bacc6"> POST、GET、 PUT、DELETE</font> 等操作类型对某个 Web 资源进行 <font color="#4bacc6">Create、Read、 Update 和 Delete </font>操作。</li>
<li>一个 HTTP 请求除了利用 URI 标志目标资源之外，还需要通过 HTTP Method 指定针对该资源的操作类型，一些常见的 HTTP 方法及其在 RESTful 风格下的使用:</li>
</ol>
<p><img src="https://s2.loli.net/2023/04/29/wokjgHNQVc4TCSW.png" srcset="/img/loading.gif" lazyload alt="image.png|425"></p>
<h3 id="HTTP-状态码"><a href="#HTTP-状态码" class="headerlink" title="HTTP 状态码"></a>HTTP 状态码</h3><ul>
<li>HTTP 状态码就是服务向用户返回的状态码和提示信息，客户端的每一次请求，服务都必须给出回应，回应包括<font color="#8064a2"> HTTP 状态码和数据</font>两部分。</li>
<li>HTTP 定义了 40 个标准状态码，可用于传达客户端请求的结果。状态码分为以下<br><font color="#f79646">5 个类别:</font><blockquote>
<p>1 xx: 信息，通信传输协议级信息<br>2 xx: 成功，表示客户端的请求已成功接受<br>3 xx: 重定向，表示客户端必须执行一些其他操作才能完成其请求<br>4 xx: 客户端错误，此类错误状态码指向客户端<br>5 xx: 服务器错误，服务器负责这写错误状态码</p>
</blockquote>
</li>
</ul>
<h2 id="2-构建-RESTful-应用接口"><a href="#2-构建-RESTful-应用接口" class="headerlink" title="2. 构建 RESTful 应用接口"></a>2. 构建 RESTful 应用接口</h2><p>Spring Boot 提供的<span style="background:rgba(240, 107, 5, 0.2)"> spring-boot-starter-web </span>组件完全支持开发 RESTful API, 提供了与 REST 操作方式 (GET、POST、 PUT、DELETE) 对应的注解。</p>
<ol>
<li><code>@GetMapping:</code> 处理 GET 请求，获取资源。</li>
<li><code>@PostMapping:</code> 处理 POST 请求，新增资源。</li>
<li><code>@PutMapping:</code> 处理 PUT 请求，更新资源。</li>
<li><code>@DeleteMapping:</code> 处理 DELETE 请求，删除资源。</li>
<li><code>@PatchMapping:</code> 处理 PATCH 请求，用于部分更新资源。</li>
</ol>
<blockquote>
<p>类似于 django 的视图装饰器</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> cLass UserController &#123;<br><span class="hljs-meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUserById</span> <span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-type">int</span> id)</span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;根据ID获取用户&quot;</span>;<br>&#125;<br><span class="hljs-meta">@PostMapping(&quot;/user&quot; )</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">save</span><span class="hljs-params">(User user)</span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;添加用户&quot;</span>;<br>&#125;<br><span class="hljs-meta">@PutMapping(&quot;/user&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">update</span><span class="hljs-params">(User user)</span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;更新用户&quot;</span>;<br>&#125;<br><span class="hljs-meta">@DeleteMapping(&quot;/user/&#123;id&#125;&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">deleteById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-type">int</span> id)</span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot; 根据ID删除用户&quot;</span>;<br><span class="hljs-number">1</span>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="3-Swagger-生成-API-接口文档"><a href="#3-Swagger-生成-API-接口文档" class="headerlink" title="3. Swagger 生成 API 接口文档"></a>3. Swagger 生成 API 接口文档</h2><blockquote>
<ol>
<li>Swagger 是一个规范和完整的框架，用于生成、描述、调用和可视化 RESTful 风格的 Web 服务，是非常流行的 API 表达工具。</li>
<li>Swagger 能够自动生成完善的 RESTful API 文档，同时并根据后台代码的修改同步更新，同时提供完整的测试页面来调试 APl。</li>
</ol>
</blockquote>
<p><font color="#f79646">pom. xml 依赖配置:</font></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- swagger依赖--&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-swagger2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>添加配置类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.helloworld.config;  <br>  <br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;  <br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;  <br><span class="hljs-keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;  <br><span class="hljs-keyword">import</span> springfox.documentation.builders.PathSelectors;  <br><span class="hljs-keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;  <br><span class="hljs-keyword">import</span> springfox.documentation.service.ApiInfo;  <br><span class="hljs-keyword">import</span> springfox.documentation.spi.DocumentationType;  <br><span class="hljs-keyword">import</span> springfox.documentation.spring.web.plugins.Docket;  <br><span class="hljs-keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;  <br>  <br><span class="hljs-meta">@Configuration</span> <span class="hljs-comment">//告诉Spring容器， 这个类是一个配置类  </span><br><span class="hljs-meta">@EnableSwagger2</span> <span class="hljs-comment">//启用Swagger2功能  </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SwaggerConfig</span> &#123;  <br><span class="hljs-meta">@Bean</span>  <br><span class="hljs-keyword">public</span> Docket <span class="hljs-title function_">createRestApi</span><span class="hljs-params">()</span> &#123;  <br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Docket</span>(DocumentationType.SWAGGER_2)  <br>.apiInfo(apiInfo())  <br>.select()  <br><span class="hljs-comment">// com 包下所有API都交给Swagger2管理  </span><br>.apis(RequestHandlerSelectors.basePackage(<span class="hljs-string">&quot;com&quot;</span>))  <br>.paths(PathSelectors.any()).build();  <br>&#125;  <br>  <br><span class="hljs-comment">// API文档页面显示信息  </span><br><span class="hljs-keyword">private</span> ApiInfo <span class="hljs-title function_">apiInfo</span><span class="hljs-params">()</span> &#123;  <br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiInfoBuilder</span>()  <br>.title(<span class="hljs-string">&quot;演示项目API&quot;</span>) <span class="hljs-comment">//标题  </span><br>.description(<span class="hljs-string">&quot;学习Swagger2的演示项目&quot;</span>) <span class="hljs-comment">//描述  </span><br>.version(<span class="hljs-string">&quot;1.0&quot;</span>)  <br>.build();  <br>&#125;  <br>&#125;<br></code></pre></td></tr></table></figure>


<p>spring 3 的依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--spring3版本的swagger依赖--&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springdoc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  <br>  <br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springdoc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>配置文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.helloworld.config;  <br>  <br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;  <br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;  <br>  <br><span class="hljs-keyword">import</span> io.swagger.v3.oas.models.OpenAPI;  <br><span class="hljs-keyword">import</span> io.swagger.v3.oas.models.info.Info;  <br>  <br>  <br><span class="hljs-meta">@Configuration</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OpenApiConfig</span> &#123;  <br>  <br><span class="hljs-meta">@Bean</span>  <br><span class="hljs-keyword">public</span> OpenAPI <span class="hljs-title function_">springOpenAPI</span><span class="hljs-params">()</span> &#123;  <br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenAPI</span>().info(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>() <span class="hljs-comment">//  </span><br>.title(<span class="hljs-string">&quot;SpringDoc API Test&quot;</span>) <span class="hljs-comment">//  </span><br>.description(<span class="hljs-string">&quot;SpringDoc Simple Application Test&quot;</span>) <span class="hljs-comment">//  </span><br>.version(<span class="hljs-string">&quot;0.0.1&quot;</span>));  <br>&#125;  <br>  <br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="1-注解"><a href="#1-注解" class="headerlink" title="1.注解"></a>1.注解</h3><p>swagger 常用注解如下图所示：</p>
<p><img src="https://s2.loli.net/2023/05/02/sgfWcYZxHa2rJKm.png" srcset="/img/loading.gif" lazyload alt="image.png|375"></p>
<p>从 Springfox 迁移过来的，需要修改注解：</p>
<p><span style="background:rgba(3, 135, 102, 0.2)">&gt; 1. @Api → @Tag</span><br><span style="background:rgba(3, 135, 102, 0.2)">&gt; 2. @ApiIgnore → @Parameter (hidden &#x3D; true) or @Operation (hidden &#x3D; true) or @Hidden</span><br><span style="background:rgba(3, 135, 102, 0.2)">&gt; 3. @ApiImplicitParam → @Parameter</span><br><span style="background:rgba(3, 135, 102, 0.2)">&gt; 4. @ApiImplicitParams → @Parameters</span><br><span style="background:rgba(3, 135, 102, 0.2)">&gt; 5. @ApiModel → @Schema</span><br><span style="background:rgba(3, 135, 102, 0.2)">&gt; 6. @ApiModelProperty (hidden &#x3D; true) → @Schema (accessMode &#x3D; READ_ONLY)</span><br><span style="background:rgba(3, 135, 102, 0.2)">&gt; 7. @ApiModelProperty → @Schema</span><br><span style="background:rgba(3, 135, 102, 0.2)">&gt; 8. @ApiOperation (value &#x3D; “foo”, notes &#x3D; “bar”) → @Operation (summary &#x3D; “foo”, description &#x3D; “bar”)</span><br><span style="background:rgba(3, 135, 102, 0.2)">&gt; 9. @ApiParam → @Parameter</span><br><span style="background:rgba(3, 135, 102, 0.2)">&gt; 10. @ApiResponse (code &#x3D; 404, message &#x3D; “foo”) → @ApiResponse (responseCode &#x3D; “404”, description &#x3D; “foo”)</span></p>
<h3 id="2-访问-swagger"><a href="#2-访问-swagger" class="headerlink" title="2.访问 swagger"></a>2.访问 swagger</h3><ol>
<li>swagger 2： <a target="_blank" rel="noopener" href="http://localhost:8080/swagger-ui.html">http://localhost:8080/swagger-ui.html</a></li>
<li>swagger 3: <ul>
<li><a target="_blank" rel="noopener" href="http://localhost:8080/swagger-ui/index.html">http://localhost:8080/swagger-ui/index.html</a></li>
<li><a target="_blank" rel="noopener" href="http://localhost:8080/doc.html">http://localhost:8080/doc.html</a></li>
</ul>
</li>
</ol>
<h1 id="5-MybatisPlus"><a href="#5-MybatisPlus" class="headerlink" title="5. MybatisPlus"></a>5. MybatisPlus</h1><h2 id="1-ORM-介绍"><a href="#1-ORM-介绍" class="headerlink" title="1.ORM 介绍"></a>1.ORM 介绍</h2><ul>
<li><p>ORM，（Object Relational Mapping，对象关系映射）是为了解决面向对象与关系数据库存在的互不匹配现象的一种技术。</p>
</li>
<li><p>ORM 通过使用描述对象和数据库之间映射的元数据将程序中的对象自动持久化到关系数据库中。</p>
</li>
<li><p>ORM 框架的本质是简化编程中操作数据库的编码。</p>
</li>
</ul>
<p><img src="https://s2.loli.net/2023/05/29/PcG5L8ZYouWhyp6.png" srcset="/img/loading.gif" lazyload alt="image.png|350"></p>
<h2 id="2-MyBatis-Plus-介绍"><a href="#2-MyBatis-Plus-介绍" class="headerlink" title="2.MyBatis-Plus 介绍"></a>2.MyBatis-Plus 介绍</h2><ul>
<li>MyBatis 是一款优秀的数据持久层 ORM 框架，被广泛地应用于应用系统。</li>
<li>MyBatis 能够非常灵活地实现动态 SQL，可以使用 XML 或注解来配置和映射原生信息，能够轻松地将 Java 的 POJO（PlainOrdinaryJavaObject，普通的Java 对象）与数据库中的表和字段进行映射关联。</li>
<li>MyBatis-Plus 是一个 MyBatis 的增强工具，在 MyBatis 的基础上做了增强，简化了开发。</li>
</ul>
<p><font color="#8db3e2">添加依赖：</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;! MyBatisPlus依赖<br>&lt;dependency&gt;<br>   &lt;groupId&gt;com.baomidou&lt;/groupId&gt;<br>    &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">3.4</span><span class="hljs-number">.2</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br>&lt;!--mysql驱动依赖<br>&lt;dependency&gt;<br>    &lt;groupId&gt;mysql&lt;/groupId&gt;<br>     &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">5.1</span><span class="hljs-number">.47</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br>&lt;!-- 数据连接池druid<br>&lt;dependency&gt;<br>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;<br>    &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.1</span><span class="hljs-number">.20</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure>

<p><font color="#f79646">全局配置：</font></p>
<ul>
<li>配置数据库相关信息（application.properties）：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">spring.datasource.type=com.alibaba.druid.pool.DruidDatasource<br>spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver<br>spring.datasource.ur1=jdbc:mysql:<span class="hljs-comment">//1ocalhost:3306/mydb?usessL=false</span><br>spring.datasource.username=root<br>spring.datasource.password=<span class="hljs-number">123456</span><br>mybatis-plus.configuration.1og-impl=org.apache.ibatis.logging.stdout.stdoutImp1<br><br></code></pre></td></tr></table></figure>

<ul>
<li>添加@MapperScan 注解：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@springBootApplication</span><br><span class="hljs-meta">@Mapperscan(&quot;com.xx.mapper&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisplusDemoApplication</span> <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(string[] args)</span>&#123;<br>       SpringApplication.run(MybatisplusDemoApplication.class,args);<br><br></code></pre></td></tr></table></figure>

<p>Mybitis CRUD 注解：<br>注解功能<br><font color="#00b0f0">@Insert     实现插入</font><br><font color="#00b0f0">@Update   实现更新</font><br><font color="#00b0f0">@Delete    实现删除</font><br><font color="#00b0f0">@Select    实现查询</font><br><font color="#00b0f0">@Result    实现结果集封装</font><br><font color="#00b0f0">@Results  可以与@Result 一起使用，封装多个结果集</font><br><font color="#00b0f0">@One       实现一对一结果集封装</font><br><font color="#00b0f0">@Many     实现一对多结果集封装</font></p>
<h2 id="3-MyBatis-Plus-CRUD-操作"><a href="#3-MyBatis-Plus-CRUD-操作" class="headerlink" title="3.MyBatis-Plus CRUD 操作"></a>3.MyBatis-Plus CRUD 操作</h2><p><font color="#ffc000">mybatis 的 Mapper 操作方法</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> &#123;<br>   <span class="hljs-meta">@Insert(&quot;insert into user values(#&#123;id),#(username&#125;,#(password),#(birthday)&quot;)//id,username等属性为user对象的属性</span><br><span class="hljs-meta">    int add(User user);</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">   @update(&quot;update user set username=#(username&#125;,password=#(password),birthday=#(birthday&#125; where id=#&#123;id&#125;&quot;)</span><br><span class="hljs-meta">    int update(User user);</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">   @Delete(&quot;delete from user where id=#(id&quot;)</span><br><span class="hljs-meta">    int delete(int id);</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">   @select(&quot;select * from user where id=#(id&quot;)</span><br><span class="hljs-meta">   User findByid(int id);</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">   @select(&quot;select * from user&quot;)</span><br><span class="hljs-meta">   List&lt;User&gt; getA11();</span><br></code></pre></td></tr></table></figure>


<p><font color="#ff0000">mybatis-plus 的操作方法</font></p>
<blockquote>
<p>BaseMapper 泛型类里已经实现了基本的增删改查任务</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;User&gt; &#123;  <br>&#125;<br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>[!NOTE] 注意<br>Mybatis-plus 有一些对 entity 里的实体类的<strong>注解</strong>，标识对应的表名、主键和字段名等，如果不进行注解则实体类的类名必须与数据表名一致，属性必须与数据表的字段名一致。<br><a target="_blank" rel="noopener" href="https://baomidou.com/pages/24112f/#%E7%89%B9%E6%80%A7">注解细节</a></p>
</blockquote>
<h2 id="4-多表查询"><a href="#4-多表查询" class="headerlink" title="4. 多表查询"></a>4. 多表查询</h2><blockquote>
<p>实现复杂关系映射，可以使用@Results 注解，@Result 注解，@One 注解，<br>@Many 注解组合完成复杂关系的配置。</p>
</blockquote>
<p><img src="https://s2.loli.net/2023/06/01/Z6TuNLREyqGFazH.png" srcset="/img/loading.gif" lazyload alt="注解说明|325"></p>
<p>示例：<br><strong>任务表</strong></p>
<p>entity：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.airesume.entity;  <br>  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;  <br>  <br><span class="hljs-keyword">import</span> java.sql.Date;  <br><span class="hljs-keyword">import</span> java.time.LocalDateTime;  <br>  <br><span class="hljs-meta">@TableName(value = &quot;u_task&quot;)</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span> &#123;  <br>    <span class="hljs-meta">@TableId(value = &quot;id&quot;, type = IdType.AUTO)</span>  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> uid;  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> String content;  <br>    <span class="hljs-meta">@TableField(value = &quot;b_date&quot;)</span>  <br>    <span class="hljs-keyword">private</span> LocalDateTime b_date;  <br>    <span class="hljs-meta">@TableField(value = &quot;e_date&quot;)</span>  <br>    <span class="hljs-keyword">private</span> LocalDateTime e_date;  <br>    <span class="hljs-meta">@TableField(exist = false)</span>  <br>    <span class="hljs-keyword">private</span> User user;  <br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>Mapper：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">TaskMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;Task&gt; &#123;  <br>    <span class="hljs-meta">@Select(&quot;select * from task where uid = #&#123;uid&#125;&quot;)</span>  <br>    List&lt;Task&gt; <span class="hljs-title function_">selectByUid</span><span class="hljs-params">(<span class="hljs-type">int</span> uid)</span>;  <br><br>	<span class="hljs-meta">@Select(&quot;select * from task&quot;)</span>  <br><span class="hljs-meta">@Results(  </span><br><span class="hljs-meta">        &#123;  </span><br><span class="hljs-meta">                @Result(column = &quot;id&quot;, property = &quot;id&quot;),  </span><br><span class="hljs-meta">                @Result(column = &quot;name&quot;, property = &quot;name&quot;),  </span><br><span class="hljs-meta">                @Result(column = &quot;content&quot;, property = &quot;content&quot;),  </span><br><span class="hljs-meta">                @Result(column = &quot;b_date&quot;, property = &quot;b_date&quot;, javaType = LocalDateTime.class, jdbcType = JdbcType.TIMESTAMP),  </span><br><span class="hljs-meta">                @Result(column = &quot;e_date&quot;, property = &quot;e_date&quot;, javaType = LocalDateTime.class, jdbcType = JdbcType.TIMESTAMP),  </span><br><span class="hljs-meta">                @Result(column = &quot;uid&quot;, property = &quot;user&quot;, javaType = User.class,  </span><br><span class="hljs-meta">                        one = @One(select = &quot;com.alleyf.airesume.mapper.UserMapper.selectById&quot;)),  </span><br><span class="hljs-meta">        &#125;  </span><br><span class="hljs-meta">)</span>  <br>List&lt;Task&gt; <span class="hljs-title function_">queryAllTaskAndUser</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>用户表</strong></p>
<p>entity：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.airesume.entity;  <br>  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;  <br>  <br><span class="hljs-keyword">import</span> java.util.List;  <br>  <br><span class="hljs-meta">@TableName(value = &quot;user&quot;)</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;  <br>    <span class="hljs-meta">@TableId(value = &quot;id&quot;, type = IdType.AUTO)</span>  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;  <br>    <span class="hljs-keyword">private</span> String username;  <br>    <span class="hljs-keyword">private</span> String password;  <br>    <span class="hljs-meta">@TableField(exist = false)</span>  <br>    <span class="hljs-keyword">private</span> List&lt;Task&gt; tasks;  <br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>mapper：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;User&gt; &#123;  <br>  <br>    <span class="hljs-meta">@Select(&quot;select * from user&quot;)</span>  <br>    <span class="hljs-meta">@Results(  </span><br><span class="hljs-meta">            &#123;  </span><br><span class="hljs-meta">                    @Result(column = &quot;id&quot;, property = &quot;id&quot;),  </span><br><span class="hljs-meta">                    @Result(column = &quot;username&quot;, property = &quot;username&quot;),  </span><br><span class="hljs-meta">                    @Result(column = &quot;password&quot;, property = &quot;password&quot;),  </span><br><span class="hljs-meta">                    @Result(column = &quot;id&quot;, property = &quot;tasks&quot;, javaType = List.class,  </span><br><span class="hljs-meta">                            many = @Many(select = &quot;com.alleyf.airesume.mapper.TaskMapper.selectByUid&quot;)),  </span><br><span class="hljs-meta">            &#125;  </span><br><span class="hljs-meta">    )</span>  <br>    List&lt;User&gt; <span class="hljs-title function_">queryAllUserAndTasks</span><span class="hljs-params">()</span>;  <br>&#125;<br><br></code></pre></td></tr></table></figure>



<blockquote>
<p>[!NOTE] 注意<br>查询用户的同时查出与用户相关联的所有任务<br>Result 中的 column 的字段为查询到的数据库字段值，用来赋值给后面类对象的属性 property，对应的属性与字段相同，含有不存在的属性则使用外键间接查询。</p>
</blockquote>
<h2 id="5-条件查询"><a href="#5-条件查询" class="headerlink" title="5. 条件查询"></a>5. 条件查询</h2><p><span style="background:#affad1">Mybatis 实现：</span></p>
<blockquote>
<p>在 mapper 的接口中写 sql 语句进行条件查询。</p>
</blockquote>
<p>示例：<br>mapper：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**  </span><br><span class="hljs-comment"> * 按照任务名查询用户 * * <span class="hljs-doctag">@param</span> username 用户名  </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> 所有用户列表  </span><br><span class="hljs-comment"> */</span><span class="hljs-meta">@Select(&quot;select * from user where username = #&#123;username&#125;&quot;)</span>  <br><span class="hljs-meta">@Results(&#123;  </span><br><span class="hljs-meta">        @Result(column = &quot;id&quot;, property = &quot;id&quot;),  </span><br><span class="hljs-meta">        @Result(column = &quot;username&quot;, property = &quot;username&quot;),  </span><br><span class="hljs-meta">        @Result(column = &quot;password&quot;, property = &quot;password&quot;),  </span><br><span class="hljs-meta">        @Result(column = &quot;id&quot;, property = &quot;tasks&quot;, javaType = List.class,  </span><br><span class="hljs-meta">                many = @Many(select = &quot;com.alleyf.airesume.mapper.TaskMapper.selectByUid&quot;)),  </span><br><span class="hljs-meta">&#125;)</span>  <br>User <span class="hljs-title function_">selectByName</span><span class="hljs-params">(String username)</span>;<br><br></code></pre></td></tr></table></figure>

<p>controller：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-meta">@ApiOperation(&quot;按照用户名查询用户&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByMName&quot;)</span>  <br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">queryByMName</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;username&quot;)</span> String username)</span> &#123;  <br><span class="hljs-comment">//        return userMapper.selectList(null);  </span><br>        <span class="hljs-keyword">return</span> userMapper.selectByName(username);  <br>    &#125;<br><br></code></pre></td></tr></table></figure>

<p><span style="background:rgba(136, 49, 204, 0.2)">Mybatis-Plus 实现：</span></p>
<blockquote>
<ul>
<li>使用 <strong>QueryWrapper</strong> （条件查询）和 <strong>UpdateWrapper</strong>（条件更新） 两个条件查询类进行条件查询。</li>
<li>可选条件有：eq（等于），lt（大于），st（小于），le（大于等于），se（小于等于）等</li>
</ul>
</blockquote>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiOperation(&quot;按照用户名查询用户(MP)&quot;)</span>  <br><span class="hljs-meta">@GetMapping(&quot;/queryByMPName&quot;)</span>  <br><span class="hljs-keyword">public</span> User <span class="hljs-title function_">queryByMPName</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;username&quot;)</span> String username)</span> &#123;  <br>    <span class="hljs-keyword">return</span> userMapper.selectOne(<span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;User&gt;().eq(<span class="hljs-string">&quot;username&quot;</span>, username));  <br>&#125;<br><br></code></pre></td></tr></table></figure>


<h2 id="6-分页查询"><a href="#6-分页查询" class="headerlink" title="6. 分页查询"></a>6. 分页查询</h2><p>编写配置文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.airesume.config;  <br>  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;  <br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;  <br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;  <br>  <br><span class="hljs-meta">@Configuration</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PaginationConfig</span> &#123;  <br>    <span class="hljs-meta">@Bean</span>  <br>    <span class="hljs-keyword">public</span> MybatisPlusInterceptor <span class="hljs-title function_">paginationInterceptor</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">MybatisPlusInterceptor</span> <span class="hljs-variable">interceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MybatisPlusInterceptor</span>();  <br>        <span class="hljs-type">PaginationInnerInterceptor</span> <span class="hljs-variable">paginationInterceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PaginationInnerInterceptor</span>(DbType.MYSQL);  <br>        interceptor.addInnerInterceptor(paginationInterceptor);  <br>        <span class="hljs-keyword">return</span> interceptor;  <br>    &#125;  <br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>controller:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//查询所有用户：1oca1host：8080/findA11</span><br><span class="hljs-meta">@GetMapping(&quot;findAll&quot;)</span><br><span class="hljs-keyword">public</span> IPage <span class="hljs-title function_">findAl1</span><span class="hljs-params">()</span>t<br>   <span class="hljs-comment">//设置起始值及每页条数</span><br>   Page&lt;User&gt; page = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Page</span>&lt;&gt;(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>);<br>   <span class="hljs-keyword">return</span> userMapper.selectPage(page,nul1);<br><br><span class="hljs-meta">@ApiOperation(&quot;按照页码查询用户(MP)&quot;)</span>  <br><span class="hljs-meta">@GetMapping(&quot;/queryByPage/&#123;page&#125;&quot;)</span>  <br><span class="hljs-keyword">public</span> IPage <span class="hljs-title function_">queryByPage</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;page&quot;)</span> <span class="hljs-type">int</span> page)</span> &#123;  <br>    Page&lt;User&gt; page1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Page</span>&lt;&gt;(page, <span class="hljs-number">5</span>);  <br>    <span class="hljs-type">IPage</span> <span class="hljs-variable">iPage</span> <span class="hljs-operator">=</span> userMapper.selectPage(page1, <span class="hljs-literal">null</span>);  <br>    <span class="hljs-keyword">return</span> iPage;  <br>&#125;<br><br></code></pre></td></tr></table></figure>


<h1 id="6-JWT-跨域认证"><a href="#6-JWT-跨域认证" class="headerlink" title="6. JWT 跨域认证"></a>6. JWT 跨域认证</h1><h2 id="1-Session-认证"><a href="#1-Session-认证" class="headerlink" title="1. Session 认证"></a>1. Session 认证</h2><p>互联网服务离不开用户认证。一般流程是下面这样。</p>
<blockquote>
<ul>
<li>用户向服务器发送<strong>用户名和密码</strong>。</li>
<li>服务器验证通过后，在当前对话（session）里面保存相关数据，比如用户角色、登录时间等。</li>
<li>服务器向用户返回一个 session_id，写入用户的 Cookie。</li>
<li>用户随后的每一次请求，都会通过 Cookie，将 session_id 传回服务器。</li>
<li>服务器收到 session_id，找到前期保存的数据，由此得知用户的身份。</li>
</ul>
</blockquote>
<p>session 认证流程：<br><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202307311353929.png" srcset="/img/loading.gif" lazyload alt="|350"><br>session 认证的方式应用非常普遍，但也存在一些问题，扩展性不好，如果是服务<br>器集群，或者是跨域的服务导向架构，就要求 session 数据共享，每台服务器都能<br>够读取 session，针对此种问题一般有两种方案:</p>
<blockquote>
<ol>
<li><p>一种解决方案是 session 数据持久化，写入数据库或别的持久层。各种服务收到请求后，都向持久层请求数据。这种方案的优点是架构清晰，缺点是工程量比较大。</p>
</li>
<li><p>一种方案是服务器不再保存 session 数据，所有数据都保存在客户端，每次请求都发回服务器。Token 认证就是这种方案的一个代表。</p>
</li>
</ol>
</blockquote>
<h2 id="2-Token-认证"><a href="#2-Token-认证" class="headerlink" title="2. Token 认证"></a>2. Token 认证</h2><p>Token 是在服务端产生的一串字符串, 是客户端访问资源接口（API) 时所需要的资<br>源凭证，流程如下：</p>
<blockquote>
<ul>
<li>客户端使用用户名跟密码请求登录，服务端收到请求，去验证用户名与密码</li>
<li>验证成功后，服务端会签发一个 token 并把这个 token 发送给客户端</li>
<li>客户端收到 token 以后，会把它存储起来，比如放在 cookie 里或者 localStorage 里</li>
<li>客户端每次向服务端请求资源的时候需要带着服务端签发的 token</li>
<li>服务端收到请求，然后去验证客户端请求里面带着的 token，如果验证成功，就向客户端返回请求的数据</li>
</ul>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202307311410745.png" srcset="/img/loading.gif" lazyload alt="image.png|350"></p>
<ul>
<li><p>基于 token 的用户认证是一种服务端无状态的认证方式，服务端不用存放<br>token 数据。</p>
</li>
<li><p>用解析 token 的计算时间换取 session 的存储空间，从而减轻服务器的压力<br>减少频繁的查询数据库</p>
</li>
<li><p>token 完全由应用管理，所以它可以避开同源策略</p>
</li>
</ul>
<hr>
<h2 id="3-JWT-的使用"><a href="#3-JWT-的使用" class="headerlink" title="3. JWT 的使用"></a>3. JWT 的使用</h2><blockquote>
<p>JSON Web Token（简称 JWT）是一个 token 的具体实现方式，是目前最流行<br>的跨域认证解决方案。<br>JWT 的原理是，服务器认证以后，生成一个 JSON 对象，发回给用户，具体如下:</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;姓名&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;张三&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;角色&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;管理员&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;到期时间&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2018 年 7 月 1 日 0 点 0 分&quot;</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>用户与服务端通信的时候，都要发回这个 JSON 对象。服务器完全只靠这个对象认定用户身份。<br>为了防止用户篡改数据，服务器在生成这个对象的时候，会加上<strong>签名</strong>。</p>
</blockquote>
<blockquote>
<p>JWT 的由三个部分组成，依次如下：<br>  <em><strong>Header (头部)<br>  Payload (负载)<br>  Signature  (签名)</strong></em><br>  三部分最终组合为完整的字符串，中间使用·分隔，如下：<br>  Header.Payload.Signature<br>           <code>eyJhbGci0iJIUzI1NiIsInR5cCI6IkpXVCJ9. eyJzdwIi0iIxMjMoNTY30DkwIiwibmFtzsI6IkpvaG4 gRG91IiwiaXNTb2NpYWwiOnRydwV9. 4pcPyMD09o1PSyXnrXCjTwXyr4BsezdI1AVTmud2fU4</code></p>
</blockquote>
<h3 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h3><blockquote>
<p>Header 部分是一个 JSON 对象，描述 JWT 的元数据</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br> <span class="hljs-attr">&quot;alg&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;H256&quot;</span><span class="hljs-punctuation">,</span><br> <span class="hljs-attr">&quot;typ&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;JWT&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>alg 属性表示签名的算法（<strong>algorithm</strong>），默认是 HMAC SHA 256 (写成<br><strong>HS256</strong>)</li>
<li>typ 属性表示这个令牌（token）的类型（type），JWT 令牌统一写为 JWT</li>
<li>最后，将上面的 JSON 对象使用 Base 64 URL 算法转成字符串。</li>
</ul>
<h3 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h3><blockquote>
<p>Payload 部分也是一个 JSON 对象，用来存放实际需要传递的数据。JWT 规定了 7 个官方字段，供选用。</p>
</blockquote>
<ul>
<li>iss (issuer)：签发人</li>
<li>exp (expiration time): 过期时间</li>
<li>sub (subject): 主题</li>
<li>aud (audience): 受众</li>
<li>nbf (Not Before): 生效时间</li>
<li>iat (Issued At)：签发时间</li>
<li>jti (WT ID): 编号</li>
</ul>
<blockquote>
<p>注意，JWT 默认是不加密的，任何人都可以读到，所以不要把秘密信息放在个部分。<br>   这个 JSON 对象也要使用 <strong>Base 64 URL</strong> 算法转成字符串。</p>
</blockquote>
<h3 id="Signature"><a href="#Signature" class="headerlink" title="Signature"></a>Signature</h3><blockquote>
<p> Signature 部分是对前两部分的签名，防止数据篡改。<br>    首先，需要指定一个密钥（secret）。这个密钥只有服务器才知道，不能泄露给用户; 然后，使用 Header 里面指定的签名算法 （默认是 HMAC SHA 256），按照下面的公式产生签名。</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json">HMACSHA <span class="hljs-number">256</span> (<br>base64UrlEncode (header) + <span class="hljs-string">&quot;.&quot;</span> +<br>base64UrlEncode (payload)<span class="hljs-punctuation">,</span><br>secret)<br></code></pre></td></tr></table></figure>

<p>算出签名以后，把 Header、Payload、Signature 三个部分拼成一个字符串，每个部分之间用”点”（’.’）分隔，就可以返回给用户。<br><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202307311433682.png" srcset="/img/loading.gif" lazyload alt="image.png|450"></p>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li>客户端收到服务器返回的 JWT，可以储存在 Cookie 里面，也可以储存在 localStorage。</li>
<li>客户端每次与服务器通信，都要带上这个 JWT，可以把它放在 Cookie 里面自动发送，但是这样不能跨域。</li>
<li>更好的做法是放在 HTTP 请求的头信息’Authorization’字段里面，单独发送。</li>
</ul>
<h3 id="请求认证"><a href="#请求认证" class="headerlink" title="请求认证"></a>请求认证</h3><p><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202309262023932.png" srcset="/img/loading.gif" lazyload alt="image.png|525"></p>
<h3 id="JWT验证拦截器"><a href="#JWT验证拦截器" class="headerlink" title="JWT验证拦截器"></a>JWT验证拦截器</h3><p><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202309272236587.png" srcset="/img/loading.gif" lazyload alt="image.png|250"></p>
<p>定义拦截器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.config;  <br>  <br><span class="hljs-keyword">import</span> com.alibaba.fastjson2.JSON;  <br><span class="hljs-keyword">import</span> com.alleyf.sys.utils.Result;  <br><span class="hljs-keyword">import</span> com.alleyf.common.JwtUtils;  <br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;  <br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;  <br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;  <br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;  <br>  <br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;  <br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;  <br>  <br><span class="hljs-meta">@Component</span>  <br><span class="hljs-meta">@Slf4j</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JwtValidateInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;  <br>    <span class="hljs-meta">@Autowired</span>  <br>    <span class="hljs-keyword">private</span> JwtUtils jwtUtils;  <br>  <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;  <br>        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">&quot;X-Token&quot;</span>);  <br>        log.debug(request.getRequestURI() + <span class="hljs-string">&quot;待验证：&quot;</span> + token);  <br>        <span class="hljs-keyword">if</span> (token != <span class="hljs-literal">null</span>) &#123;  <br>            <span class="hljs-keyword">try</span> &#123;  <br>                jwtUtils.getClaimsByToken(token);  <br>                log.debug(request.getRequestURI() + <span class="hljs-string">&quot; 验证通过&quot;</span>);  <br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <br>            &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;  <br>                e.printStackTrace();  <br>            &#125;  <br>        &#125;  <br>        log.debug(request.getRequestURI() + <span class="hljs-string">&quot; 禁止访问&quot;</span>);  <br>        response.setContentType(<span class="hljs-string">&quot;application/json;charset=utf-8&quot;</span>);  <br>        response.getWriter().write(JSON.toJSONString(Result.error().message(<span class="hljs-string">&quot;jwt令牌无效，请重新登录&quot;</span>)));  <br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <br>    &#125;  <br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>配置使用拦截器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.config;  <br>  <br><span class="hljs-keyword">import</span> com.alleyf.config.JwtValidateInterceptor;  <br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;  <br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;  <br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistration;  <br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;  <br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;  <br>  <br><span class="hljs-meta">@Configuration</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyInterceptorConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;  <br>    <span class="hljs-meta">@Autowired</span>  <br>    <span class="hljs-keyword">private</span> JwtValidateInterceptor jwtValidateInterceptor;  <br>  <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> &#123;  <br>        <span class="hljs-type">InterceptorRegistration</span> <span class="hljs-variable">registration</span> <span class="hljs-operator">=</span> registry.addInterceptor(jwtValidateInterceptor);  <br>        registration.addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>).excludePathPatterns(  <br>                <span class="hljs-string">&quot;/user/login&quot;</span>,  <br>                <span class="hljs-string">&quot;/user/register&quot;</span>,  <br>                <span class="hljs-string">&quot;/user/logout&quot;</span>,  <br>                <span class="hljs-string">&quot;/user/info&quot;</span>,  <br>                <span class="hljs-string">&quot;/error&quot;</span>  <br>        );  <br>    &#125;  <br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="Swagger授权配置"><a href="#Swagger授权配置" class="headerlink" title="Swagger授权配置"></a>Swagger授权配置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*  </span><br><span class="hljs-comment"> * Copyright (c) alleyf 2023 - 5 - 29 20:33 * 适度编码益脑，沉迷编码伤身，合理安排时间，享受快乐生活。 * */</span>  <br><span class="hljs-keyword">package</span> com.alleyf.config;  <br>  <br><span class="hljs-keyword">import</span> com.github.xiaoymin.knife4j.spring.annotations.EnableKnife4j;  <br><span class="hljs-keyword">import</span> io.swagger.annotations.Api;  <br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;  <br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;  <br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;  <br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.CookieValue;  <br><span class="hljs-keyword">import</span> org.springframework.web.context.request.async.DeferredResult;  <br><span class="hljs-keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;  <br><span class="hljs-keyword">import</span> springfox.documentation.builders.PathSelectors;  <br><span class="hljs-keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;  <br><span class="hljs-keyword">import</span> springfox.documentation.oas.annotations.EnableOpenApi;  <br><span class="hljs-keyword">import</span> springfox.documentation.service.*;  <br><span class="hljs-keyword">import</span> springfox.documentation.spi.DocumentationType;  <br><span class="hljs-keyword">import</span> springfox.documentation.spi.service.contexts.SecurityContext;  <br><span class="hljs-keyword">import</span> springfox.documentation.spring.web.plugins.Docket;  <br><span class="hljs-keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;  <br>  <br><span class="hljs-keyword">import</span> java.util.Collections;  <br><span class="hljs-keyword">import</span> java.util.List;  <br>  <br><span class="hljs-meta">@Configuration</span>  <br><span class="hljs-meta">@EnableKnife4j</span>  <br><span class="hljs-meta">@EnableOpenApi</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SwaggerConfig</span> &#123;  <br>  <br>    <span class="hljs-meta">@Bean</span>  <br>    <span class="hljs-keyword">public</span> Docket <span class="hljs-title function_">Api</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Docket</span>(DocumentationType.OAS_30)  <br>                .enable(<span class="hljs-literal">true</span>)<span class="hljs-comment">//是否启用：注意生产环境需要关闭  </span><br>                .groupName(<span class="hljs-string">&quot;spring-boot-2.7.12&quot;</span>)  <br>                .genericModelSubstitutes(DeferredResult.class)  <br>                .useDefaultResponseMessages(<span class="hljs-literal">false</span>)  <br>                .forCodeGeneration(<span class="hljs-literal">true</span>)  <br>                .ignoredParameterTypes(CookieValue.class)  <br>                .apiInfo(apiInfo())  <br>                .select()  <br>                <span class="hljs-comment">//以下拦截配置可以三选一，根据需要进行添加,选择扫描哪些接口  </span><br><span class="hljs-comment">//                .apis(RequestHandlerSelectors.basePackage(&quot;com.alleyf.*.controller&quot;))  </span><br>                .apis(RequestHandlerSelectors.withClassAnnotation(Api.class))  <br><span class="hljs-comment">//                .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))  </span><br>                .paths(PathSelectors.any())  <br>                .build()  <br>                .securitySchemes(Collections.singletonList(securityScheme()))  <br>                .securityContexts(Collections.singletonList(securityContext()));  <br>  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">private</span> SecurityScheme <span class="hljs-title function_">securityScheme</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-comment">//return new ApiKey(&quot;Authorization&quot;, &quot;Authorization&quot;,&quot;header&quot;);  </span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiKey</span>(<span class="hljs-string">&quot;X-Token&quot;</span>, <span class="hljs-string">&quot;X-Token&quot;</span>, <span class="hljs-string">&quot;header&quot;</span>);  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">private</span> SecurityContext <span class="hljs-title function_">securityContext</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> SecurityContext.builder()  <br>                .securityReferences(defaultAuth())  <br>                .forPaths(PathSelectors.regex(<span class="hljs-string">&quot;^(?!auth).*$&quot;</span>))  <br>                .build();  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">private</span> List&lt;SecurityReference&gt; <span class="hljs-title function_">defaultAuth</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">AuthorizationScope</span> <span class="hljs-variable">authorizationScope</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AuthorizationScope</span>(<span class="hljs-string">&quot;global&quot;</span>, <span class="hljs-string">&quot;accessEverything&quot;</span>);  <br>        AuthorizationScope[] authorizationScopes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AuthorizationScope</span>[<span class="hljs-number">1</span>];  <br>        authorizationScopes[<span class="hljs-number">0</span>] = authorizationScope;  <br>        <span class="hljs-keyword">return</span> Collections.singletonList(  <br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityReference</span>(<span class="hljs-string">&quot;X-Token&quot;</span>, authorizationScopes));  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">private</span> ApiInfo <span class="hljs-title function_">apiInfo</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiInfoBuilder</span>()  <br>                .title(<span class="hljs-string">&quot;WHUT leave Go-Swagger3接口文档&quot;</span>)  <br>                .description(<span class="hljs-string">&quot;WHUT leave Go-前后端分离的接口文档&quot;</span>)  <br>                .version(<span class="hljs-string">&quot;1.0&quot;</span>)  <br>                .contact(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Contact</span>(<span class="hljs-string">&quot;alleyf&quot;</span>, <span class="hljs-string">&quot;https://fcsy.com&quot;</span>, <span class="hljs-string">&quot;alleyf@qq.com&quot;</span>))  <br>                .build();  <br>    &#125;  <br>&#125;<br><br></code></pre></td></tr></table></figure>



<h3 id="后端实现"><a href="#后端实现" class="headerlink" title="后端实现"></a>后端实现</h3><h4 id="加入依赖"><a href="#加入依赖" class="headerlink" title="加入依赖"></a>加入依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.jsonwebtoken<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jjwt<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.9.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="生成-Token"><a href="#生成-Token" class="headerlink" title="生成 Token"></a>生成 Token</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//7 天过期</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Long</span> <span class="hljs-variable">expire</span> <span class="hljs-operator">=</span> <span class="hljs-number">604800</span>;<br><span class="hljs-comment">//32 位秘钥</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">secret</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;abcdfghiabcdfghiabcdfghiabcdfghi&quot;</span>;<br><br><span class="hljs-comment">//生成 token</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">generateToken</span><span class="hljs-params">(String username)</span>&#123;<br>   <span class="hljs-type">Date</span> <span class="hljs-variable">now</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<br>   <span class="hljs-type">Date</span> <span class="hljs-variable">expiration</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span> (now.getTime() + <span class="hljs-number">1000</span> * expire);<br>   <span class="hljs-keyword">return</span> Jwts.builder ()<br>            .setHeaderParam(<span class="hljs-string">&quot;type&quot;</span>,<span class="hljs-string">&quot;JWT&quot;</span>)<br>            .setSubject(username)<br>            .setIssuedAt(now)<br>            .setExpiration(expiration)<br>            .signWith(SignatureAlgorithm.HS512, secret)<br>            .compact();<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="解析-token"><a href="#解析-token" class="headerlink" title="解析 token"></a>解析 token</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Claims <span class="hljs-title function_">getClaimsByToken</span><span class="hljs-params">(String token)</span> &#123;  <br>    <span class="hljs-keyword">return</span> Jwts.parser()  <br>            .setSigningKey(secret)  <br>            .parseClaimsJws(token)  <br>            .getBody();  <br>  <br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="后端完整部分"><a href="#后端完整部分" class="headerlink" title="后端完整部分"></a>后端完整部分</h4><p><code>UserController. java:</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*  </span><br><span class="hljs-comment"> * Copyright (c) alleyf 2023 - 6 - 1 19:56 * 适度编码益脑，沉迷编码伤身，合理安排时间，享受快乐生活。 * */</span>  <br><span class="hljs-keyword">package</span> com.alleyf.airesume.controller;  <br>  <br><span class="hljs-keyword">import</span> com.alleyf.airesume.entity.User;  <br><span class="hljs-keyword">import</span> com.alleyf.airesume.mapper.UserMapper;  <br><span class="hljs-keyword">import</span> com.alleyf.airesume.utils.JwtUtils;  <br><span class="hljs-keyword">import</span> com.alleyf.airesume.utils.Result;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.metadata.IPage;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;  <br><span class="hljs-keyword">import</span> io.swagger.annotations.Api;  <br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiOperation;  <br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;  <br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;  <br>  <br><span class="hljs-keyword">import</span> java.util.List;  <br>  <br><span class="hljs-meta">@Api(tags = &quot;用户&quot;, value = &quot;用户&quot;)</span>  <br><span class="hljs-meta">@RestController</span>  <br><span class="hljs-meta">@CrossOrigin</span>  <br><span class="hljs-meta">@RequestMapping(&quot;/user&quot;)</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;  <br>    <span class="hljs-meta">@Autowired</span>  <br>    UserMapper userMapper;  <br><br>    <span class="hljs-meta">@ApiOperation(&quot;用户登录&quot;)</span>  <br>    <span class="hljs-meta">@PostMapping(&quot;/login&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">login</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span> &#123;  <br>        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> JwtUtils.generateToken(user.getUsername());  <br>        <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;token&quot;</span>, token);  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;获取用户信息&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/info&quot;)</span>  <span class="hljs-comment">//&quot;token:xxx&quot;  </span><br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">info</span><span class="hljs-params">(String token)</span> &#123;  <br>        <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> JwtUtils.getClaimsByToken(token).getSubject();  <br>        <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;https://img2.baidu.com/it/u=1325995315,4158780794&amp;fm=26&amp;fmt=auto&amp;gp=0.jpg&quot;</span>;  <br>        <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;name&quot;</span>, username).data(<span class="hljs-string">&quot;avatar&quot;</span>, url);  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;注销&quot;)</span>  <br>    <span class="hljs-meta">@PostMapping(&quot;/logout&quot;)</span> <span class="hljs-comment">// &quot;token:xxx&quot;  </span><br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">logout</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> Result.ok();  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;查询所有用户&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryAll&quot;)</span>  <br>    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">queryAllUser</span><span class="hljs-params">()</span> &#123;  <br><span class="hljs-comment">//        return userMapper.selectList(null);  </span><br>        <span class="hljs-keyword">return</span> userMapper.queryAllUserAndTask();  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照用户名查询用户&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByMName&quot;)</span>  <br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">queryByMName</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;username&quot;)</span> String username)</span> &#123;  <br><span class="hljs-comment">//        return userMapper.selectList(null);  </span><br>        <span class="hljs-keyword">return</span> userMapper.selectByName(username);  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照用户名查询用户(MP)&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByMPName&quot;)</span>  <br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">queryByMPName</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;username&quot;)</span> String username)</span> &#123;  <br>        <span class="hljs-keyword">return</span> userMapper.selectOne(<span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;User&gt;().eq(<span class="hljs-string">&quot;username&quot;</span>, username));  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照用户名路径查询用户(MP)&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByPMPName/&#123;username&#125;&quot;)</span>  <br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">queryByPMPName</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;username&quot;)</span> String username)</span> &#123;  <br>        <span class="hljs-keyword">return</span> userMapper.selectOne(<span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;User&gt;().eq(<span class="hljs-string">&quot;username&quot;</span>, username));  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照页码查询用户(MP)&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByPage/&#123;page&#125;&quot;)</span>  <br>    <span class="hljs-keyword">public</span> IPage <span class="hljs-title function_">queryByPage</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;page&quot;)</span> <span class="hljs-type">int</span> page)</span> &#123;  <br>        Page&lt;User&gt; page1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Page</span>&lt;&gt;(page, <span class="hljs-number">5</span>);  <br>        <span class="hljs-type">IPage</span> <span class="hljs-variable">iPage</span> <span class="hljs-operator">=</span> userMapper.selectPage(page1, <span class="hljs-literal">null</span>);  <br>        <span class="hljs-keyword">return</span> iPage;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;添加用户&quot;)</span>  <br>    <span class="hljs-meta">@PostMapping(&quot;/add&quot;)</span>  <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUser</span><span class="hljs-params">(User user)</span> &#123;  <br>        <span class="hljs-keyword">return</span> userMapper.insert(user) &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;添加成功&quot;</span> : <span class="hljs-string">&quot;添加失败&quot;</span>;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>Result.java:</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*  </span><br><span class="hljs-comment"> * Copyright (c) alleyf 2023 - 5 - 29 &#125;9:52 * 适度编码益脑，沉迷编码伤身，合理安排时间，享受快乐生活。 * */</span>  <br><span class="hljs-keyword">package</span> com.alleyf.airesume.utils;  <br>  <br><span class="hljs-keyword">import</span> java.util.HashMap;  <br><span class="hljs-keyword">import</span> java.util.Map;  <br>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Result</span> &#123;  <br>    <span class="hljs-keyword">private</span> Boolean success;  <br>    <span class="hljs-keyword">private</span> Integer code;  <br>    <span class="hljs-keyword">private</span> String message;  <br>    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; data = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();  <br>  <br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Result</span><span class="hljs-params">()</span> &#123;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Result <span class="hljs-title function_">ok</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">Result</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Result</span>();  <br>        r.setCode(ResultCode.Success);  <br>        r.setSuccess(<span class="hljs-literal">true</span>);  <br>        r.setMessage(<span class="hljs-string">&quot;成功&quot;</span>);  <br>        <span class="hljs-keyword">return</span> r;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Result <span class="hljs-title function_">error</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">Result</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Result</span>();  <br>        r.setCode(ResultCode.Error);  <br>        r.setSuccess(<span class="hljs-literal">false</span>);  <br>        r.setMessage(<span class="hljs-string">&quot;失败&quot;</span>);  <br>        <span class="hljs-keyword">return</span> r;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">success</span><span class="hljs-params">(Boolean success)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.setSuccess(success);  <br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">message</span><span class="hljs-params">(String message)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.setMessage(message);  <br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">code</span><span class="hljs-params">(Integer code)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.setCode(code);  <br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">data</span><span class="hljs-params">(String key, Object value)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.data.put(key, value);  <br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">data</span><span class="hljs-params">(Map&lt;String, Object&gt; map)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.setData(map);  <br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> Boolean <span class="hljs-title function_">getSuccess</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> success;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSuccess</span><span class="hljs-params">(Boolean success)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.success = success;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">getCode</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> code;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCode</span><span class="hljs-params">(Integer code)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.code = code;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMessage</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> message;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMessage</span><span class="hljs-params">(String message)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.message = message;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title function_">getData</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> data;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setData</span><span class="hljs-params">(Map&lt;String, Object&gt; data)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.data = data;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>JwtUtils.java:</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.airesume.utils;  <br>  <br><span class="hljs-keyword">import</span> io.jsonwebtoken.Claims;  <br><span class="hljs-keyword">import</span> io.jsonwebtoken.Jwts;  <br><span class="hljs-keyword">import</span> io.jsonwebtoken.SignatureAlgorithm;  <br>  <br><span class="hljs-keyword">import</span> java.util.Date;  <br>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JwtUtils</span> &#123;  <br>    <span class="hljs-comment">//7 天过期  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Long</span> <span class="hljs-variable">expire</span> <span class="hljs-operator">=</span> <span class="hljs-number">604800L</span>;  <br>    <span class="hljs-comment">//32 位秘钥  </span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">secret</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;abcdfghiabcdfghiabcdfghiabcdfghi&quot;</span>;  <br>  <br>    <span class="hljs-comment">//生成 token  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">generateToken</span><span class="hljs-params">(String username)</span> &#123;  <br>        <span class="hljs-type">Date</span> <span class="hljs-variable">now</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();  <br>        <span class="hljs-type">Date</span> <span class="hljs-variable">expiration</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(now.getTime() + <span class="hljs-number">1000</span> * expire);  <br>        <span class="hljs-keyword">return</span> Jwts.builder()  <br>                .setHeaderParam(<span class="hljs-string">&quot;type&quot;</span>, <span class="hljs-string">&quot;JWT&quot;</span>)  <br>                .setSubject(username)  <br>                .setIssuedAt(now)  <br>                .setExpiration(expiration)  <br>                .signWith(SignatureAlgorithm.HS512, secret)  <br>                .compact();  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Claims <span class="hljs-title function_">getClaimsByToken</span><span class="hljs-params">(String token)</span> &#123;  <br>        <span class="hljs-keyword">return</span> Jwts.parser()  <br>                .setSigningKey(secret)  <br>                .parseClaimsJws(token)  <br>                .getBody();  <br>  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure>


<h1 id="项目实战-角色管理"><a href="#项目实战-角色管理" class="headerlink" title="项目实战-角色管理"></a>项目实战-角色管理</h1><h2 id="1-预览效果"><a href="#1-预览效果" class="headerlink" title="1.预览效果"></a>1.预览效果</h2><p><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310011258914.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<h2 id="2-前端"><a href="#2-前端" class="headerlink" title="2.前端"></a>2.前端</h2><p><font color="#ff0000">role.vue:</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;  <br>&lt;div&gt;  <br>&lt;!-- 添加角色--&gt;  <br>&lt;el-dialog  <br>:title=&quot;dialogTitle&quot;  <br>:visible.sync=&quot;dialogFormVisible&quot;  <br>center  <br>width=&quot;32%&quot;  <br>@close=&quot;clearForm&quot;  <br>&gt;  <br>&lt;el-form  <br>ref=&quot;roleForm&quot;  <br>:model=&quot;roleForm&quot;  <br>:rules=&quot;rules&quot;  <br>show-message  <br>status-icon  <br>&gt;  <br>&lt;el-form-item label=&quot;角色名&quot; label-width=&quot;80px&quot; prop=&quot;roleName&quot;&gt;  <br>&lt;el-input  <br>v-model=&quot;roleForm.roleName&quot;  <br>clearable  <br>prefix-icon=&quot;el-icon-user&quot;  <br>/&gt;  <br>&lt;/el-form-item&gt;  <br>&lt;el-form-item label=&quot;角色描述&quot; label-width=&quot;80px&quot; prop=&quot;roleDesc&quot;&gt;  <br>&lt;el-input  <br>v-model=&quot;roleForm.roleDesc&quot;  <br>clearable  <br>prefix-icon=&quot;el-icon-key&quot;  <br>/&gt;  <br>&lt;/el-form-item&gt;  <br>&lt;/el-form&gt;  <br>&lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;  <br>&lt;el-button @click=&quot;dialogFormVisible = false&quot;&gt;取 消&lt;/el-button&gt;  <br>&lt;el-button type=&quot;primary&quot; @click=&quot;saveRole(&#x27;roleForm&#x27;)&quot;&gt;确 定  <br>&lt;/el-button&gt;  <br>&lt;/div&gt;  <br>&lt;/el-dialog&gt;  <br>&lt;!-- 角色检索--&gt;  <br>&lt;el-card id=&quot;search&quot; shadow=&quot;hover&quot;&gt;  <br>&lt;el-row :gutter=&quot;5&quot;&gt;  <br>&lt;el-col :span=&quot;18&quot;&gt;  <br>&lt;div class=&quot;grid-content bg-purple&quot;&gt;  <br>&lt;el-input  <br>v-model=&quot;searchModel.queryContent&quot;  <br>clearable  <br>placeholder=&quot;请输入用户名&quot;  <br>suffix-icon=&quot;el-icon-user&quot;  <br>&gt;  <br>&lt;el-button  <br>slot=&quot;append&quot;  <br>icon=&quot;el-icon-search&quot;  <br>type=&quot;success&quot;  <br>@click=&quot;getRoles&quot;  <br>/&gt;  <br>&lt;/el-input&gt;  <br>&lt;/div&gt;  <br>&lt;/el-col&gt;  <br>&lt;el-col :span=&quot;6&quot; align=&quot;right&quot;&gt;  <br>&lt;div class=&quot;grid-content bg-purple&quot;&gt;  <br>&lt;el-button  <br>icon=&quot;el-icon-plus&quot;  <br>size=&quot;medium&quot;  <br>type=&quot;success&quot;  <br>@click=&quot;addRole&quot;  <br>/&gt;  <br>&lt;/div&gt;  <br>&lt;/el-col&gt;  <br>&lt;/el-row&gt;  <br>&lt;/el-card&gt;  <br>&lt;!-- 用户信息--&gt;  <br>&lt;el-card shadow=&quot;hover&quot;&gt;  <br>&lt;el-table  <br>v-loading=&quot;loading&quot;  <br>:cell-style=&quot;&#123; &#x27;text-align&#x27;: &#x27;center&#x27; &#125;&quot;  <br>:data=&quot;tableData&quot;  <br>:default-sort=&quot;&#123; prop: &#x27;id&#x27;, order: &#x27;ascending&#x27; &#125;&quot;  <br>:header-cell-style=&quot;&#123; &#x27;text-align&#x27;: &#x27;center&#x27; &#125;&quot;  <br>border  <br>max-height=&quot;520&quot;  <br>style=&quot;width: 100%&quot;  <br>&gt;  <br>&lt;el-table-column label=&quot;#&quot; type=&quot;index&quot; width=&quot;80&quot;&gt;  <br>&lt;template slot-scope=&quot;scope&quot;&gt;  <br>&lt;!-- (pageNum-1)*pageSize+index+1--&gt;  <br>&#123;&#123;  <br>(searchModel.pageNum - 1) * searchModel.pageSize + scope.$index + 1  <br>&#125;&#125;  <br>&lt;/template&gt;  <br>&lt;/el-table-column&gt;  <br>&lt;el-table-column label=&quot;角色id&quot; prop=&quot;roleId&quot; sortable width=&quot;200&quot;/&gt;  <br>&lt;el-table-column  <br>class=&quot;name-wrapper&quot;  <br>label=&quot;角色名称&quot;  <br>prop=&quot;roleName&quot;  <br>width=&quot;260&quot;  <br>/&gt;  <br>&lt;el-table-column label=&quot;角色描述&quot; prop=&quot;roleDesc&quot; resizable width=&quot;280&quot;/&gt;  <br>&lt;el-table-column fixed=&quot;right&quot; label=&quot;操作&quot; width=&quot;160&quot;&gt;  <br>&lt;template slot-scope=&quot;scope&quot;&gt;  <br>&lt;el-button  <br>circle  <br>icon=&quot;el-icon-delete&quot;  <br>size=&quot;small&quot;  <br>type=&quot;danger&quot;  <br>@click.native.prevent=&quot;deleteRole(scope.$index, tableData)&quot;  <br>&gt;  <br>&lt;/el-button&gt;  <br>&lt;el-button  <br>circle  <br>icon=&quot;el-icon-edit&quot;  <br>size=&quot;small&quot;  <br>type=&quot;primary&quot;  <br>@click=&quot;editRole(scope.row)&quot;  <br>&gt;  <br>&lt;/el-button&gt;  <br>&lt;/template&gt;  <br>&lt;/el-table-column&gt;  <br>&lt;/el-table&gt;  <br>&lt;/el-card&gt;  <br>&lt;!-- 分页组件--&gt;  <br>&lt;el-footer align=&quot;center&quot;&gt;  <br>&lt;div class=&quot;block&quot;&gt;  <br>&lt;el-pagination  <br>:current-page=&quot;searchModel.currentPage&quot;  <br>:page-size=&quot;searchModel.pageNum&quot;  <br>:page-sizes=&quot;pageSizes&quot;  <br>:total=&quot;total&quot;  <br>layout=&quot;total, sizes, prev, pager, next, jumper&quot;  <br>@size-change=&quot;handleSizeChange&quot;  <br>@current-change=&quot;handleCurrentChange&quot;  <br>/&gt;  <br>&lt;/div&gt;  <br>&lt;/el-footer&gt;  <br>&lt;el-backtop target=&quot;.page-component__scroll .el-scrollbar__wrap&quot;&gt;&lt;/el-backtop&gt;  <br>&lt;/div&gt;  <br>&lt;/template&gt;  <br>  <br>&lt;script&gt;  <br>import roleApi from &#x27;@/api/roleManage&#x27;  <br>import current from &#x27;element-ui/packages/table/src/store/current&#x27;  <br>// import &#x27;@/styles/roleManage.css&#x27;  <br>  <br>export default &#123;  <br>name: &#x27;Role&#x27;,  <br>data() &#123;  <br>return &#123;  <br>searchModel: &#123;  <br>queryContent: &#x27;&#x27;,  <br>pageNum: 1,  <br>pageSize: 10  <br>&#125;,  <br>pageSizes: [10, 20, 50, 100],  <br>total: 0,  <br>tableData: [],  <br>loading: true,  <br>dialogFormVisible: false,  <br>dialogTitle: &#x27;添加角色&#x27;,  <br>roleForm: &#123;  <br>roleName: &#x27;&#x27;,  <br>roleDesc: &#x27;&#x27;  <br>&#125;,  <br>rules: &#123;  <br>roleName: [  <br>&#123; required: true, message: &#x27;请输入角色名&#x27;, trigger: &#x27;blur&#x27; &#125;,  <br>&#123;  <br>min: 1,  <br>max: 20,  <br>message: &#x27;长度在 1 到 20 个字符&#x27;,  <br>trigger: &#x27;blur&#x27;  <br>&#125;  <br>],  <br>roleDesc: [  <br>&#123; required: true, message: &#x27;请输入角色描述&#x27;, trigger: &#x27;blur&#x27; &#125;,  <br>&#123;  <br>min: 1,  <br>max: 30,  <br>message: &#x27;长度在 3 到 30 个字符&#x27;,  <br>trigger: &#x27;blur&#x27;  <br>&#125;  <br>]  <br>&#125;  <br>&#125;  <br>&#125;,  <br>computed: &#123;  <br>current() &#123;  <br>return current  <br>&#125;  <br>&#125;,  <br>created() &#123;  <br>this.getRoles()  <br>&#125;,  <br>methods: &#123;  <br>getRoles() &#123;  <br>roleApi  <br>.search(this.searchModel)  <br>.then((res) =&gt; &#123;  <br>// console.log(res)  <br>this.tableData = res.data.data.records  <br>this.total = res.data.data.total  <br>this.searchModel.pageNum = res.data.data.current  <br>this.loading = false  <br>// console.log(this.searchModel.queryContent, this.searchModel.queryItem, this.searchModel.pageSize, this.searchModel.pageNum)  <br>&#125;)  <br>.catch((error) =&gt; &#123;  <br>console.log(error)  <br>&#125;)  <br>&#125;,  <br>saveRole(formName) &#123;  <br>// alert(this.roleForm)  <br>// 提交则触发表单验证  <br>this.$refs[formName].validate((valid) =&gt; &#123;  <br>if (valid) &#123;  <br>console.log(this.roleForm)  <br>// 提交请求到后台  <br>roleApi  <br>.save(this.roleForm)  <br>.then((res) =&gt; &#123;  <br>// console.log(res)  <br>this.dialogFormVisible = false  <br>// 提交结果消息提示  <br>this.notify(res, this.message)  <br>// 刷新表格  <br>this.getRoles()  <br>&#125;)  <br>.catch((error) =&gt; &#123;  <br>console.log(error)  <br>&#125;)  <br>&#125; else &#123;  <br>console.log(&#x27;error submit!!&#x27;)  <br>return false  <br>&#125;  <br>&#125;)  <br>&#125;,  <br>clearForm() &#123;  <br>this.roleForm = &#123;&#125;  <br>this.$refs.roleForm.clearValidate()  <br>&#125;,  <br>handleSizeChange(pageSize) &#123;  <br>this.searchModel.pageSize = pageSize  <br>this.getRoles()  <br>&#125;,  <br>handleCurrentChange(pageNum) &#123;  <br>this.searchModel.pageNum = pageNum  <br>this.getRoles()  <br>&#125;,  <br>addRole() &#123;  <br>this.dialogTitle = &#x27;添加角色&#x27;  <br>this.dialogFormVisible = true  <br>this.message = &#x27;添加角色成功！&#x27;  <br>&#125;,  <br>deleteRole(index, rows) &#123;  <br>// console.log(rows[index])  <br>this.$confirm(`此操作将永久删除角色&lt;strong style=&quot;color: red&quot;&gt;$&#123;rows[index].roleName&#125;&lt;/strong&gt;, 是否继续?`, &#x27;提示&#x27;, &#123;  <br>confirmButtonText: &#x27;确定&#x27;,  <br>cancelButtonText: &#x27;取消&#x27;,  <br>type: &#x27;warning&#x27;,  <br>center: true,  <br>dangerouslyUseHTMLString: true  <br>&#125;).then(() =&gt; &#123;  <br>roleApi.del(rows[index].roleId).then((res) =&gt; &#123;  <br>// console.log(res)  <br>rows.splice(index, 1)  <br>this.$message(&#123;  <br>type: &#x27;success&#x27;,  <br>message: res.message  <br>&#125;)  <br>&#125;)  <br>&#125;).catch(() =&gt; &#123;  <br>this.$message(&#123;  <br>type: &#x27;info&#x27;,  <br>message: &#x27;已取消删除&#x27;  <br>&#125;)  <br>&#125;)  <br>&#125;,  <br>editRole(row) &#123;  <br>roleApi.getById(row.roleId).then(res =&gt; &#123;  <br>this.roleForm = res.data.data  <br>// console.log(this.userForm)  <br>this.dialogTitle = &#x27;编辑角色&#x27;  <br>this.dialogFormVisible = true  <br>this.message = &#x27;更新角色成功！&#x27;  <br>&#125;).catch(error =&gt; &#123;  <br>console.log(error)  <br>&#125;)  <br>&#125;,  <br>notify(res, message = null) &#123;  <br>if (res.code === 20000) &#123;  <br>// 提交结果消息提示  <br>this.$notify(&#123;  <br>title: &#x27;成功&#x27;,  <br>message: message != null ? message : res.message,  <br>type: &#x27;success&#x27;  <br>&#125;)  <br>&#125; else &#123;  <br>this.$notify.error(&#123;  <br>title: &#x27;失败&#x27;,  <br>message: res.message  <br>&#125;)  <br>&#125;  <br>&#125;  <br>&#125;  <br>&#125;  <br>&lt;/script&gt;  <br>  <br>&lt;style scoped&gt;&lt;/style&gt;<br><br></code></pre></td></tr></table></figure>

<p><font color="#ff0000">roleManage.js:</font></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/request&#x27;</span>  <br>  <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <br>search (searchModel) &#123;  <br><span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;  <br><span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/role/search&#x27;</span>,  <br><span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;get&#x27;</span>,  <br><span class="hljs-attr">params</span>: &#123;  <br><span class="hljs-attr">queryContent</span>: searchModel.<span class="hljs-property">queryContent</span>,  <br><span class="hljs-attr">pageSize</span>: searchModel.<span class="hljs-property">pageSize</span>,  <br><span class="hljs-attr">pageNum</span>: searchModel.<span class="hljs-property">pageNum</span>  <br>&#125;  <br>&#125;)  <br>&#125;,  <br>save (roleForm) &#123;  <br><span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;  <br><span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/role/save&#x27;</span>,  <br><span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;post&#x27;</span>,  <br><span class="hljs-attr">data</span>: roleForm  <br>&#125;)  <br>&#125;,  <br>del (id) &#123;  <br><span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;  <br><span class="hljs-attr">url</span>: <span class="hljs-string">`/role/<span class="hljs-subst">$&#123;id&#125;</span>`</span>,  <br><span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;delete&#x27;</span>  <br>&#125;)  <br>&#125;,  <br>getById (id) &#123;  <br><span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;  <br><span class="hljs-attr">url</span>: <span class="hljs-string">`/role/<span class="hljs-subst">$&#123;id&#125;</span>`</span>,  <br><span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;get&#x27;</span>  <br>&#125;)  <br>&#125;  <br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="3-后端"><a href="#3-后端" class="headerlink" title="3.后端"></a>3.后端</h2><p><font color="#f79646">RoleController:</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.sys.controller;  <br>  <br><span class="hljs-keyword">import</span> com.alleyf.sys.entity.Role;  <br><span class="hljs-keyword">import</span> com.alleyf.sys.service.IRoleService;  <br><span class="hljs-keyword">import</span> com.alleyf.sys.utils.Result;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.metadata.IPage;  <br><span class="hljs-keyword">import</span> io.swagger.annotations.Api;  <br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiOperation;  <br><span class="hljs-keyword">import</span> io.swagger.util.Json;  <br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;  <br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;  <br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;  <br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;  <br>  <br><span class="hljs-comment">/**  </span><br><span class="hljs-comment"> * &lt;p&gt;  </span><br><span class="hljs-comment"> * 前端控制器  </span><br><span class="hljs-comment"> * &lt;/p&gt;  </span><br><span class="hljs-comment"> *  </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> alleyf  </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2023-08-06  </span><br><span class="hljs-comment"> */</span><span class="hljs-meta">@RestController</span>  <br><span class="hljs-meta">@Slf4j</span>  <br><span class="hljs-meta">@RequestMapping(&quot;/role&quot;)</span>  <br><span class="hljs-meta">@Api(tags = &#123;&quot;角色&quot;&#125;)</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoleController</span> &#123;  <br>    <span class="hljs-meta">@Autowired</span>  <br>    IRoleService roleService;  <br>  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照角色名查询角色(MP)&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByName&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">queryByName</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;roleName&quot;)</span> String roleName)</span> &#123;  <br>        <span class="hljs-type">Role</span> <span class="hljs-variable">role</span> <span class="hljs-operator">=</span> roleService.queryByName(roleName);  <br>        <span class="hljs-keyword">if</span> (role != <span class="hljs-literal">null</span>) &#123;  <br>            <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;data&quot;</span>, role);  <br>        &#125; <span class="hljs-keyword">else</span> &#123;  <br>            <span class="hljs-keyword">return</span> Result.error().message(roleName + <span class="hljs-string">&quot;角色不存在&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照角色名路径查询角色(MP)&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByPName/&#123;roleName&#125;&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">queryByPName</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;roleName&quot;)</span> String roleName)</span> &#123;  <br>        <span class="hljs-type">Role</span> <span class="hljs-variable">role</span> <span class="hljs-operator">=</span> roleService.queryByName(roleName);  <br>        <span class="hljs-keyword">if</span> (role != <span class="hljs-literal">null</span>) &#123;  <br>            <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;data&quot;</span>, role);  <br>        &#125; <span class="hljs-keyword">else</span> &#123;  <br>            <span class="hljs-keyword">return</span> Result.error().message(roleName + <span class="hljs-string">&quot;角色不存在&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照id路径查询角色&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">queryById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;  <br>        <span class="hljs-type">Role</span> <span class="hljs-variable">role</span> <span class="hljs-operator">=</span> roleService.getById(id);  <br>        <span class="hljs-keyword">if</span> (role != <span class="hljs-literal">null</span>) &#123;  <br>            <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;data&quot;</span>, role);  <br>        &#125; <span class="hljs-keyword">else</span> &#123;  <br>            <span class="hljs-keyword">return</span> Result.error().message(<span class="hljs-string">&quot;id为:&quot;</span> + id + <span class="hljs-string">&quot;的角色不存在&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照页码查询角色(MP)&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByPage&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">queryByPage</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;pageNum&quot;)</span> Long pageNum,  </span><br><span class="hljs-params">                              <span class="hljs-meta">@RequestParam(&quot;pageSize&quot;)</span> Long pageSize)</span> &#123;  <br>        IPage&lt;Role&gt; roleIPage = roleService.queryByPage(pageNum, pageSize, <span class="hljs-literal">null</span>);  <br>        <span class="hljs-keyword">return</span> roleIPage != <span class="hljs-literal">null</span> ? Result.ok().data(<span class="hljs-string">&quot;page&quot;</span>, roleIPage) : Result.error().message(<span class="hljs-string">&quot;平台没有角色&quot;</span>);  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;添加或更新角色&quot;)</span>  <br>    <span class="hljs-meta">@PostMapping(&quot;/save&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">addRole</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Role role)</span> &#123;  <br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">saveStatus</span> <span class="hljs-operator">=</span> roleService.saveOrUpdate(role);  <br>        <span class="hljs-keyword">return</span> saveStatus ? Result.ok().message(<span class="hljs-string">&quot;添加或更新角色成功&quot;</span>) : Result.error().message(<span class="hljs-string">&quot;添加或更新角色失败&quot;</span>);  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;删除角色&quot;)</span>  <br>    <span class="hljs-meta">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">delRole</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;  <br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">saveStatus</span> <span class="hljs-operator">=</span> roleService.removeById(id);  <br>        <span class="hljs-keyword">return</span> saveStatus ? Result.ok().message(<span class="hljs-string">&quot;删除角色成功&quot;</span>) : Result.error().message(<span class="hljs-string">&quot;删除角色失败&quot;</span>);  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;搜索角色&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/search&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;queryContent&quot;, required = false)</span> String queryContent,  </span><br><span class="hljs-params">                         <span class="hljs-meta">@RequestParam(value = &quot;pageSize&quot;, defaultValue = &quot;10&quot;)</span> Long pageSize,  </span><br><span class="hljs-params">                         <span class="hljs-meta">@RequestParam(value = &quot;pageNum&quot;, defaultValue = &quot;1&quot;)</span> Long pageNum)</span> &#123;  <br>        IPage&lt;Role&gt; roles = roleService.search(queryContent, pageSize, pageNum);  <br>        <span class="hljs-keyword">if</span> (roles != <span class="hljs-literal">null</span>) &#123;  <br>            log.debug(<span class="hljs-string">&quot;roles: &quot;</span> + roles);  <br>            <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;data&quot;</span>, roles);  <br>        &#125; <span class="hljs-keyword">else</span> &#123;  <br>            <span class="hljs-keyword">return</span> Result.error().message(<span class="hljs-string">&quot;平台没有该角色&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>&#125;<br><br></code></pre></td></tr></table></figure>


<h2 id="角色权限设置"><a href="#角色权限设置" class="headerlink" title="角色权限设置"></a>角色权限设置</h2><h3 id="1-效果预览"><a href="#1-效果预览" class="headerlink" title="1.效果预览"></a>1.效果预览</h3><p><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031214347.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<h3 id="2-前端-1"><a href="#2-前端-1" class="headerlink" title="2.前端"></a>2.前端</h3><p><font color="#f79646">role.vue:</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;  <br>&lt;div&gt;  <br>&lt;!-- 添加角色--&gt;  <br>&lt;el-dialog  <br>:title=&quot;dialogTitle&quot;  <br>:visible.sync=&quot;dialogFormVisible&quot;  <br>center  <br>width=&quot;32%&quot;  <br>@close=&quot;clearForm&quot;  <br>&gt;  <br>&lt;el-form  <br>ref=&quot;roleForm&quot;  <br>:model=&quot;roleForm&quot;  <br>:rules=&quot;rules&quot;  <br>show-message  <br>status-icon  <br>&gt;  <br>&lt;el-form-item label=&quot;角色名&quot; label-width=&quot;80px&quot; prop=&quot;roleName&quot;&gt;  <br>&lt;el-input  <br>v-model=&quot;roleForm.roleName&quot;  <br>clearable  <br>prefix-icon=&quot;el-icon-user&quot;  <br>/&gt;  <br>&lt;/el-form-item&gt;  <br>&lt;el-form-item label=&quot;角色描述&quot; label-width=&quot;80px&quot; prop=&quot;roleDesc&quot;&gt;  <br>&lt;el-input  <br>v-model=&quot;roleForm.roleDesc&quot;  <br>clearable  <br>prefix-icon=&quot;el-icon-key&quot;  <br>/&gt;  <br>&lt;/el-form-item&gt;  <br>&lt;el-form-item label=&quot;权限设置&quot; label-width=&quot;80px&quot; prop=&quot;menuIdList&quot;&gt;  <br>&lt;el-tree  <br>ref=&quot;menuRef&quot;  <br>:data=&quot;menuList&quot;  <br>:props=&quot;menuProps&quot;  <br>default-expand-all  <br>node-key=&quot;menuId&quot;  <br>show-checkbox  <br>&gt;  <br>&lt;/el-tree&gt;  <br>&lt;/el-form-item&gt;  <br>&lt;/el-form&gt;  <br>&lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;  <br>&lt;el-button @click=&quot;dialogFormVisible = false&quot;&gt;取 消&lt;/el-button&gt;  <br>&lt;el-button type=&quot;primary&quot; @click=&quot;saveRole(&#x27;roleForm&#x27;)&quot;&gt;确 定  <br>&lt;/el-button&gt;  <br>&lt;/div&gt;  <br>&lt;/el-dialog&gt;  <br>&lt;!-- 角色检索--&gt;  <br>&lt;el-card id=&quot;search&quot; shadow=&quot;hover&quot;&gt;  <br>&lt;el-row :gutter=&quot;5&quot;&gt;  <br>&lt;el-col :span=&quot;18&quot;&gt;  <br>&lt;div class=&quot;grid-content bg-purple&quot;&gt;  <br>&lt;el-input  <br>v-model=&quot;searchModel.queryContent&quot;  <br>clearable  <br>placeholder=&quot;请输入用户名&quot;  <br>suffix-icon=&quot;el-icon-user&quot;  <br>&gt;  <br>&lt;el-button  <br>slot=&quot;append&quot;  <br>icon=&quot;el-icon-search&quot;  <br>type=&quot;success&quot;  <br>@click=&quot;getRoles&quot;  <br>/&gt;  <br>&lt;/el-input&gt;  <br>&lt;/div&gt;  <br>&lt;/el-col&gt;  <br>&lt;el-col :span=&quot;6&quot; align=&quot;right&quot;&gt;  <br>&lt;div class=&quot;grid-content bg-purple&quot;&gt;  <br>&lt;el-button  <br>icon=&quot;el-icon-plus&quot;  <br>size=&quot;medium&quot;  <br>type=&quot;success&quot;  <br>@click=&quot;addRole&quot;  <br>/&gt;  <br>&lt;/div&gt;  <br>&lt;/el-col&gt;  <br>&lt;/el-row&gt;  <br>&lt;/el-card&gt;  <br>&lt;!-- 用户信息--&gt;  <br>&lt;el-card shadow=&quot;hover&quot;&gt;  <br>&lt;el-table  <br>v-loading=&quot;loading&quot;  <br>:cell-style=&quot;&#123; &#x27;text-align&#x27;: &#x27;center&#x27; &#125;&quot;  <br>:data=&quot;tableData&quot;  <br>:default-sort=&quot;&#123; prop: &#x27;id&#x27;, order: &#x27;ascending&#x27; &#125;&quot;  <br>:header-cell-style=&quot;&#123; &#x27;text-align&#x27;: &#x27;center&#x27; &#125;&quot;  <br>border  <br>max-height=&quot;520&quot;  <br>style=&quot;width: 100%&quot;  <br>&gt;  <br>&lt;el-table-column label=&quot;#&quot; type=&quot;index&quot; width=&quot;80&quot;&gt;  <br>&lt;template slot-scope=&quot;scope&quot;&gt;  <br>&lt;!-- (pageNum-1)*pageSize+index+1--&gt;  <br>&#123;&#123;  <br>(searchModel.pageNum - 1) * searchModel.pageSize + scope.$index + 1  <br>&#125;&#125;  <br>&lt;/template&gt;  <br>&lt;/el-table-column&gt;  <br>&lt;el-table-column label=&quot;角色id&quot; prop=&quot;roleId&quot; sortable width=&quot;200&quot;/&gt;  <br>&lt;el-table-column  <br>class=&quot;name-wrapper&quot;  <br>label=&quot;角色名称&quot;  <br>prop=&quot;roleName&quot;  <br>width=&quot;260&quot;  <br>/&gt;  <br>&lt;el-table-column label=&quot;角色描述&quot; prop=&quot;roleDesc&quot; resizable width=&quot;280&quot;/&gt;  <br>&lt;el-table-column fixed=&quot;right&quot; label=&quot;操作&quot; width=&quot;160&quot;&gt;  <br>&lt;template slot-scope=&quot;scope&quot;&gt;  <br>&lt;el-button  <br>circle  <br>icon=&quot;el-icon-delete&quot;  <br>size=&quot;small&quot;  <br>type=&quot;danger&quot;  <br>@click.native.prevent=&quot;deleteRole(scope.$index, tableData)&quot;  <br>&gt;  <br>&lt;/el-button&gt;  <br>&lt;el-button  <br>circle  <br>icon=&quot;el-icon-edit&quot;  <br>size=&quot;small&quot;  <br>type=&quot;primary&quot;  <br>@click=&quot;editRole(scope.row)&quot;  <br>&gt;  <br>&lt;/el-button&gt;  <br>&lt;/template&gt;  <br>&lt;/el-table-column&gt;  <br>&lt;/el-table&gt;  <br>&lt;/el-card&gt;  <br>&lt;!-- 分页组件--&gt;  <br>&lt;el-footer align=&quot;center&quot;&gt;  <br>&lt;div class=&quot;block&quot;&gt;  <br>&lt;el-pagination  <br>:current-page=&quot;searchModel.currentPage&quot;  <br>:page-size=&quot;searchModel.pageNum&quot;  <br>:page-sizes=&quot;pageSizes&quot;  <br>:total=&quot;total&quot;  <br>layout=&quot;total, sizes, prev, pager, next, jumper&quot;  <br>@size-change=&quot;handleSizeChange&quot;  <br>@current-change=&quot;handleCurrentChange&quot;  <br>/&gt;  <br>&lt;/div&gt;  <br>&lt;/el-footer&gt;  <br>&lt;el-backtop target=&quot;.page-component__scroll .el-scrollbar__wrap&quot;&gt;&lt;/el-backtop&gt;  <br>&lt;/div&gt;  <br>&lt;/template&gt;  <br>  <br>&lt;script&gt;  <br>import roleApi from &#x27;@/api/roleManage&#x27;  <br>import menuApi from &#x27;@/api/menuManage&#x27;  <br>import current from &#x27;element-ui/packages/table/src/store/current&#x27;  <br>// import &#x27;@/styles/roleManage.css&#x27;  <br>  <br>export default &#123;  <br>name: &#x27;Role&#x27;,  <br>data() &#123;  <br>return &#123;  <br>searchModel: &#123;  <br>queryContent: &#x27;&#x27;,  <br>pageNum: 1,  <br>pageSize: 10  <br>&#125;,  <br>pageSizes: [10, 20, 50, 100],  <br>total: 0,  <br>tableData: [],  <br>loading: true,  <br>dialogFormVisible: false,  <br>dialogTitle: &#x27;添加角色&#x27;,  <br>roleForm: &#123;  <br>roleName: &#x27;&#x27;,  <br>roleDesc: &#x27;&#x27;  <br>&#125;,  <br>rules: &#123;  <br>roleName: [  <br>&#123; required: true, message: &#x27;请输入角色名&#x27;, trigger: &#x27;blur&#x27; &#125;,  <br>&#123;  <br>min: 1,  <br>max: 20,  <br>message: &#x27;长度在 1 到 20 个字符&#x27;,  <br>trigger: &#x27;blur&#x27;  <br>&#125;  <br>],  <br>roleDesc: [  <br>&#123; required: true, message: &#x27;请输入角色描述&#x27;, trigger: &#x27;blur&#x27; &#125;,  <br>&#123;  <br>min: 1,  <br>max: 30,  <br>message: &#x27;长度在 3 到 30 个字符&#x27;,  <br>trigger: &#x27;blur&#x27;  <br>&#125;  <br>]  <br>&#125;,  <br>menuProps: &#123;  <br>label: &#x27;title&#x27;,  <br>children: &#x27;children&#x27;  <br>&#125;,  <br>menuList: []  <br>&#125;  <br>&#125;,  <br>computed: &#123;  <br>current() &#123;  <br>return current  <br>&#125;  <br>&#125;,  <br>created() &#123;  <br>this.getRoles()  <br>this.getAllMenu()  <br>&#125;,  <br>methods: &#123;  <br>getAllMenu() &#123;  <br>menuApi.getAllMenu().then(res =&gt; &#123;  <br>this.menuList = res.data.data  <br>&#125;)  <br>&#125;,  <br>getRoles() &#123;  <br>roleApi  <br>.search(this.searchModel)  <br>.then((res) =&gt; &#123;  <br>// console.log(res)  <br>this.tableData = res.data.data.records  <br>this.total = res.data.data.total  <br>this.searchModel.pageNum = res.data.data.current  <br>this.loading = false  <br>// console.log(this.searchModel.queryContent, this.searchModel.queryItem, this.searchModel.pageSize, this.searchModel.pageNum)  <br>&#125;)  <br>.catch((error) =&gt; &#123;  <br>console.log(error)  <br>&#125;)  <br>&#125;,  <br>saveRole(formName) &#123;  <br>// alert(this.roleForm)  <br>// 提交则触发表单验证  <br>this.$refs[formName].validate((valid) =&gt; &#123;  <br>if (valid) &#123;  <br>const checkedKeys = this.$refs.menuRef.getCheckedKeys()  <br>const halfcheckedKeys = this.$refs.menuRef.getHalfCheckedKeys()  <br>this.roleForm.menuIdList = checkedKeys.concat(halfcheckedKeys)  <br>// console.log(this.roleForm.menuIdList)  <br>// console.log(this.roleForm)  <br>// 提交请求到后台  <br>roleApi  <br>.save(this.roleForm)  <br>.then((res) =&gt; &#123;  <br>// console.log(res)  <br>this.dialogFormVisible = false  <br>// 提交结果消息提示  <br>this.notify(res, this.message)  <br>// 刷新表格  <br>this.getRoles()  <br>&#125;)  <br>.catch((error) =&gt; &#123;  <br>console.log(error)  <br>&#125;)  <br>&#125; else &#123;  <br>console.log(&#x27;error submit!!&#x27;)  <br>return false  <br>&#125;  <br>&#125;)  <br>&#125;,  <br>clearForm() &#123;  <br>this.roleForm = &#123;&#125;  <br>this.$refs.roleForm.clearValidate()  <br>this.$refs.menuRef.setCheckedKeys([])  <br>&#125;,  <br>handleSizeChange(pageSize) &#123;  <br>this.searchModel.pageSize = pageSize  <br>this.getRoles()  <br>&#125;,  <br>handleCurrentChange(pageNum) &#123;  <br>this.searchModel.pageNum = pageNum  <br>this.getRoles()  <br>&#125;,  <br>addRole() &#123;  <br>this.dialogTitle = &#x27;添加角色&#x27;  <br>this.dialogFormVisible = true  <br>this.message = &#x27;添加角色成功！&#x27;  <br>this.getAllMenu()  <br>&#125;,  <br>deleteRole(index, rows) &#123;  <br>// console.log(rows[index])  <br>this.$confirm(`此操作将永久删除角色&lt;strong style=&quot;color: red&quot;&gt;$&#123;rows[index].roleName&#125;&lt;/strong&gt;, 是否继续?`, &#x27;提示&#x27;, &#123;  <br>confirmButtonText: &#x27;确定&#x27;,  <br>cancelButtonText: &#x27;取消&#x27;,  <br>type: &#x27;warning&#x27;,  <br>center: true,  <br>dangerouslyUseHTMLString: true  <br>&#125;).then(() =&gt; &#123;  <br>roleApi.del(rows[index].roleId).then((res) =&gt; &#123;  <br>// console.log(res)  <br>rows.splice(index, 1)  <br>this.$message(&#123;  <br>type: &#x27;success&#x27;,  <br>message: res.message  <br>&#125;)  <br>&#125;)  <br>&#125;).catch(() =&gt; &#123;  <br>this.$message(&#123;  <br>type: &#x27;info&#x27;,  <br>message: &#x27;已取消删除&#x27;  <br>&#125;)  <br>&#125;)  <br>&#125;,  <br>editRole(row) &#123;  <br>roleApi.getById(row.roleId).then(res =&gt; &#123;  <br>this.roleForm = res.data.data  <br>console.log(res.data.data.menuIdList)  <br>this.dialogTitle = &#x27;编辑角色&#x27;  <br>this.dialogFormVisible = true  <br>this.$refs.menuRef.setCheckedKeys(res.data.data.menuIdList)  <br>this.message = &#x27;更新角色成功！&#x27;  <br>&#125;).catch(error =&gt; &#123;  <br>console.log(error)  <br>&#125;)  <br>&#125;,  <br>notify(res, message = null) &#123;  <br>if (res.code === 20000) &#123;  <br>// 提交结果消息提示  <br>this.$notify(&#123;  <br>title: &#x27;成功&#x27;,  <br>message: message != null ? message : res.message,  <br>type: &#x27;success&#x27;  <br>&#125;)  <br>&#125; else &#123;  <br>this.$notify.error(&#123;  <br>title: &#x27;失败&#x27;,  <br>message: res.message  <br>&#125;)  <br>&#125;  <br>&#125;  <br>&#125;  <br>&#125;  <br>&lt;/script&gt;  <br>  <br>&lt;style scoped&gt;&lt;/style&gt;<br><br></code></pre></td></tr></table></figure>



<h3 id="3-后端-1"><a href="#3-后端-1" class="headerlink" title="3.后端"></a>3.后端</h3><p><font color="#ff0000">RoleController.java:</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.alleyf.sys.controller;  <br>  <br><span class="hljs-keyword">import</span> com.alleyf.sys.entity.Role;  <br><span class="hljs-keyword">import</span> com.alleyf.sys.service.IRoleService;  <br><span class="hljs-keyword">import</span> com.alleyf.sys.utils.Result;  <br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.metadata.IPage;  <br><span class="hljs-keyword">import</span> io.swagger.annotations.Api;  <br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiOperation;  <br><span class="hljs-keyword">import</span> io.swagger.util.Json;  <br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;  <br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;  <br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;  <br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;  <br>  <br><span class="hljs-keyword">import</span> java.util.List;  <br>  <br><span class="hljs-comment">/**  </span><br><span class="hljs-comment"> * &lt;p&gt;  </span><br><span class="hljs-comment"> * 前端控制器  </span><br><span class="hljs-comment"> * &lt;/p&gt;  </span><br><span class="hljs-comment"> *  </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> alleyf  </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2023-08-06  </span><br><span class="hljs-comment"> */</span><span class="hljs-meta">@RestController</span>  <br><span class="hljs-meta">@Slf4j</span>  <br><span class="hljs-meta">@RequestMapping(&quot;/role&quot;)</span>  <br><span class="hljs-meta">@Api(tags = &#123;&quot;角色&quot;&#125;)</span>  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoleController</span> &#123;  <br>    <span class="hljs-meta">@Autowired</span>  <br>    IRoleService roleService;  <br>  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照角色名查询角色(MP)&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByName&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">queryByName</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;roleName&quot;)</span> String roleName)</span> &#123;  <br>        <span class="hljs-type">Role</span> <span class="hljs-variable">role</span> <span class="hljs-operator">=</span> roleService.queryByName(roleName);  <br>        <span class="hljs-keyword">if</span> (role != <span class="hljs-literal">null</span>) &#123;  <br>            <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;data&quot;</span>, role);  <br>        &#125; <span class="hljs-keyword">else</span> &#123;  <br>            <span class="hljs-keyword">return</span> Result.error().message(roleName + <span class="hljs-string">&quot;角色不存在&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照角色名路径查询角色(MP)&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByPName/&#123;roleName&#125;&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">queryByPName</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;roleName&quot;)</span> String roleName)</span> &#123;  <br>        <span class="hljs-type">Role</span> <span class="hljs-variable">role</span> <span class="hljs-operator">=</span> roleService.queryByName(roleName);  <br>        <span class="hljs-keyword">if</span> (role != <span class="hljs-literal">null</span>) &#123;  <br>            <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;data&quot;</span>, role);  <br>        &#125; <span class="hljs-keyword">else</span> &#123;  <br>            <span class="hljs-keyword">return</span> Result.error().message(roleName + <span class="hljs-string">&quot;角色不存在&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照id路径查询角色&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">queryById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;  <br>        <span class="hljs-type">Role</span> <span class="hljs-variable">role</span> <span class="hljs-operator">=</span> roleService.getRoleById(id);  <br>        <span class="hljs-keyword">if</span> (role != <span class="hljs-literal">null</span>) &#123;  <br>            <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;data&quot;</span>, role);  <br>        &#125; <span class="hljs-keyword">else</span> &#123;  <br>            <span class="hljs-keyword">return</span> Result.error().message(<span class="hljs-string">&quot;id为:&quot;</span> + id + <span class="hljs-string">&quot;的角色不存在&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;按照页码查询角色(MP)&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/queryByPage&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">queryByPage</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;pageNum&quot;)</span> Long pageNum,  </span><br><span class="hljs-params">                              <span class="hljs-meta">@RequestParam(&quot;pageSize&quot;)</span> Long pageSize)</span> &#123;  <br>        IPage&lt;Role&gt; roleIPage = roleService.queryByPage(pageNum, pageSize, <span class="hljs-literal">null</span>);  <br>        <span class="hljs-keyword">return</span> roleIPage != <span class="hljs-literal">null</span> ? Result.ok().data(<span class="hljs-string">&quot;page&quot;</span>, roleIPage) : Result.error().message(<span class="hljs-string">&quot;平台没有角色&quot;</span>);  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;添加或更新角色&quot;)</span>  <br>    <span class="hljs-meta">@PostMapping(&quot;/save&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">addRole</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Role role)</span> &#123;  <br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">saveStatus</span> <span class="hljs-operator">=</span> roleService.addOrUpdate(role);  <br><span class="hljs-comment">//        boolean saveStatus = roleService.saveOrUpdate(role);  </span><br>        <span class="hljs-keyword">return</span> saveStatus ? Result.ok().message(<span class="hljs-string">&quot;添加或更新角色成功&quot;</span>) : Result.error().message(<span class="hljs-string">&quot;添加或更新角色失败&quot;</span>);  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;删除角色&quot;)</span>  <br>    <span class="hljs-meta">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">delRole</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;  <br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">saveStatus</span> <span class="hljs-operator">=</span> roleService.delete(id);  <br>        <span class="hljs-keyword">return</span> saveStatus ? Result.ok().message(<span class="hljs-string">&quot;删除角色成功&quot;</span>) : Result.error().message(<span class="hljs-string">&quot;删除角色失败&quot;</span>);  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;搜索角色&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/search&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;queryContent&quot;, required = false)</span> String queryContent,  </span><br><span class="hljs-params">                         <span class="hljs-meta">@RequestParam(value = &quot;pageSize&quot;, defaultValue = &quot;10&quot;)</span> Long pageSize,  </span><br><span class="hljs-params">                         <span class="hljs-meta">@RequestParam(value = &quot;pageNum&quot;, defaultValue = &quot;1&quot;)</span> Long pageNum)</span> &#123;  <br>        IPage&lt;Role&gt; roles = roleService.search(queryContent, pageSize, pageNum);  <br>        <span class="hljs-keyword">if</span> (roles != <span class="hljs-literal">null</span>) &#123;  <br>            log.debug(<span class="hljs-string">&quot;roles: &quot;</span> + roles);  <br>            <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;data&quot;</span>, roles);  <br>        &#125; <span class="hljs-keyword">else</span> &#123;  <br>            <span class="hljs-keyword">return</span> Result.error().message(<span class="hljs-string">&quot;平台没有该角色&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@ApiOperation(&quot;获取所有角色&quot;)</span>  <br>    <span class="hljs-meta">@GetMapping(&quot;/all&quot;)</span>  <br>    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">getAll</span><span class="hljs-params">()</span> &#123;  <br>        List&lt;Role&gt; roles = roleService.list();  <br>        <span class="hljs-keyword">return</span> Result.ok().data(<span class="hljs-string">&quot;data&quot;</span>, roles);  <br>    &#125;  <br>  <br>&#125;<br><br></code></pre></td></tr></table></figure>


<h3 id="4-数据库"><a href="#4-数据库" class="headerlink" title="4.数据库"></a>4.数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> x_menu;<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span>‘x_menu’（<span class="hljs-string">&#x27;menu_id&#x27;</span>，‘component<span class="hljs-string">&#x27;，‘path&#x27;</span>，‘redirect<span class="hljs-string">&#x27;，‘name&#x27;</span>，‘title<span class="hljs-string">&#x27;，‘icon&#x27;</span>，‘parent_id<span class="hljs-string">&#x27;，‘is_leaf&#x27;</span>,<br>&quot;hidden&quot;）<span class="hljs-keyword">values</span>(<span class="hljs-string">&#x27;1&quot;,&#x27;</span>Layout<span class="hljs-string">&#x27;,&quot;/sys&#x27;</span>,<span class="hljs-string">&#x27;/sys/user&#x27;</span>,<span class="hljs-string">&#x27;sysManage&#x27;</span>,系统管理<span class="hljs-string">&#x27;,&#x27;</span>userManage<span class="hljs-string">&#x27;,&#x27;</span>o<span class="hljs-string">&#x27;,&#x27;</span>N<span class="hljs-string">&#x27;,&#x27;</span>o<span class="hljs-string">&#x27;);</span><br><span class="hljs-string">insert into‘x_menu&#x27;</span>（menu_id<span class="hljs-string">&#x27;，‘component&#x27;</span>，‘path<span class="hljs-string">&#x27;，‘redirect&#x27;</span>，‘name<span class="hljs-string">&#x27;，‘title&#x27;</span>，‘icon<span class="hljs-string">&#x27;，‘parent_id&#x27;</span>，‘is_leaf<span class="hljs-string">&#x27;,</span><br><span class="hljs-string">&quot;hidden&quot;）values(&#x27;</span><span class="hljs-number">2</span><span class="hljs-string">&#x27;,&#x27;</span>sys<span class="hljs-operator">/</span><span class="hljs-keyword">user</span><span class="hljs-string">&#x27;,&#x27;</span><span class="hljs-keyword">user</span><span class="hljs-string">&#x27;,NULL,&#x27;</span>userList<span class="hljs-string">&#x27;,用户列表&#x27;</span>,<span class="hljs-string">&#x27;user&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;Y&quot;,&#x27;</span>o<span class="hljs-string">&#x27;);</span><br><span class="hljs-string">insert into‘x_menu（&#x27;</span>menu_id<span class="hljs-string">&#x27;，‘component&#x27;</span>，‘path<span class="hljs-string">&#x27;，‘redirect&#x27;</span>，‘name<span class="hljs-string">&#x27;，‘title&#x27;</span>，‘icon<span class="hljs-string">&#x27;，‘parent_id&#x27;</span>，‘is_leaf<span class="hljs-string">&#x27;,</span><br><span class="hljs-string">‘hidden&#x27;</span>）<span class="hljs-keyword">values</span>(<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;sys/role&#x27;</span>,<span class="hljs-string">&#x27;role&#x27;</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-string">&#x27;roleList&#x27;</span>，<span class="hljs-string">&#x27;角色列表&#x27;</span>,<span class="hljs-string">&#x27;roleManage&#x27;</span>, ,<span class="hljs-string">&#x27;Y&#x27;&#x27;o&#x27;</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span>‘x_menu’（menu_id<span class="hljs-string">&#x27;，‘component&#x27;</span>，‘path<span class="hljs-string">&#x27;，‘redirect&#x27;</span>，‘name<span class="hljs-string">&#x27;，‘title&#x27;</span>, ，icon<span class="hljs-string">&#x27;，‘parent_id&#x27;</span>，‘is_leaf<span class="hljs-string">&#x27;,</span><br><span class="hljs-string">&quot;hidden&#x27;</span>）<span class="hljs-keyword">values</span>(<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;Layout&#x27;</span>，<span class="hljs-string">&#x27;/test&#x27;</span>,<span class="hljs-string">&#x27;/test/test1&#x27;</span>,<span class="hljs-string">&#x27;test&#x27;</span>,<span class="hljs-string">&#x27;功能测试&#x27;</span>,<span class="hljs-string">&#x27;form&#x27;</span>,<span class="hljs-string">&#x27;o&#x27;</span>  <span class="hljs-number">0</span><span class="hljs-string">&#x27;）;</span><br><span class="hljs-string">insert into‘x_menu’（menu_id&#x27;</span>，‘component<span class="hljs-string">&#x27;，‘path&#x27;</span>，‘redirect<span class="hljs-string">&#x27;，‘name&#x27;</span> <span class="hljs-string">&#x27;title&#x27;</span> &quot;icon&#x27;，‘parent_id&#x27;，‘is_leaf&#x27;,<br>&quot;hidden&quot;）values(&quot;<span class="hljs-number">5</span><span class="hljs-string">&#x27;,&#x27;</span>test<span class="hljs-operator">/</span>test1<span class="hljs-string">&#x27;,&#x27;</span>test1<span class="hljs-string">&#x27;,&quot;&quot;,&#x27;</span>test1<span class="hljs-string">&#x27;,&#x27;</span>测试点<span class="hljs-operator">-</span><span class="hljs-string">&#x27;,&#x27;</span>form<span class="hljs-string">&#x27;,</span><br><span class="hljs-string">insert into‘x_menu’（&#x27;</span>menu_id<span class="hljs-string">&#x27;，‘component&#x27;</span>，‘path<span class="hljs-string">&#x27;，‘redirect&#x27;</span>，‘name&quot;, &#x27;title&#x27; &#x27;icon&#x27;，‘parent_id&#x27;，is_leaf&#x27;,<br>‘hidden&#x27;)values(&#x27;6&#x27;,&#x27;test/test2&#x27;,&#x27;test2&#x27;, ，test2&#x27;，测试点二&quot;，<span class="hljs-string">&#x27;form&#x27;</span>   <span class="hljs-number">0</span><span class="hljs-string">&#x27;）;</span><br><span class="hljs-string">insert into‘x_menu（menu_id&#x27;</span>，‘component<span class="hljs-string">&#x27;，path&#x27;</span>，‘redirect<span class="hljs-string">&#x27;，‘name&#x27;</span>, ，‘title<span class="hljs-string">&#x27;，icon&#x27;</span>，parent_id，‘is_leaf,<br>hidden<span class="hljs-string">&#x27;)values(&#x27;</span><span class="hljs-number">7</span><span class="hljs-string">&#x27;,&#x27;</span>test<span class="hljs-operator">/</span>test3<span class="hljs-string">&#x27;,&#x27;</span>test3<span class="hljs-string">&#x27;, ,&#x27;</span>test3&quot;,&quot;测试点三<span class="hljs-string">&#x27;,&#x27;</span>form<span class="hljs-string">&#x27;,&#x27;</span><span class="hljs-number">4</span><span class="hljs-string">&#x27;&quot;,&#x27;</span>Y&quot;,o&#x27;);<br><br></code></pre></td></tr></table></figure>



<h1 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h1><h2 id="1-前端"><a href="#1-前端" class="headerlink" title="1.前端"></a>1.前端</h2><h3 id="1-修改原路由配置"><a href="#1-修改原路由配置" class="headerlink" title="1.修改原路由配置"></a>1.修改原路由配置</h3><p>src&#x2F;router&#x2F;index.js，保留基础路由，其它的删掉或注释</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>  <br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Router</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span>  <br>  <br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Router</span>)  <br>  <br><span class="hljs-comment">/* Layout */</span>  <br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Layout</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/layout&#x27;</span>  <br>  <br><span class="hljs-comment">/**  </span><br><span class="hljs-comment">* Note: sub-menu only appear when route children.length &gt;= 1  </span><br><span class="hljs-comment">* Detail see: https://panjiachen.github.io/vue-element-admin-site/guide/essentials/router-and-nav.html  </span><br><span class="hljs-comment">*  </span><br><span class="hljs-comment">* hidden: true if set true, item will not show in the sidebar(default is false)  </span><br><span class="hljs-comment">* alwaysShow: true if set true, will always show the root menu  </span><br><span class="hljs-comment">* if not set alwaysShow, when item has more than one children route,  </span><br><span class="hljs-comment">* it will becomes nested mode, otherwise not show the root menu  </span><br><span class="hljs-comment">* redirect: noRedirect if set noRedirect will no redirect in the breadcrumb  </span><br><span class="hljs-comment">* name:&#x27;router-name&#x27; the name is used by &lt;keep-alive&gt; (must set!!!)  </span><br><span class="hljs-comment">* meta : &#123;  </span><br><span class="hljs-comment">roles: [&#x27;admin&#x27;,&#x27;editor&#x27;] control the page roles (you can set multiple roles)  </span><br><span class="hljs-comment">title: &#x27;title&#x27; the name show in sidebar and breadcrumb (recommend set)  </span><br><span class="hljs-comment">icon: &#x27;svg-name&#x27;/&#x27;el-icon-x&#x27; the icon show in the sidebar  </span><br><span class="hljs-comment">breadcrumb: false if set false, the item will hidden in breadcrumb(default is true)  </span><br><span class="hljs-comment">activeMenu: &#x27;/example/list&#x27; if set path, the sidebar will highlight the path you set  </span><br><span class="hljs-comment">&#125;  </span><br><span class="hljs-comment">*/</span>  <br>  <br><span class="hljs-comment">/**  </span><br><span class="hljs-comment">* constantRoutes  </span><br><span class="hljs-comment">* a base page that does not have permission requirements  </span><br><span class="hljs-comment">* all roles can be accessed  </span><br><span class="hljs-comment">*/</span>  <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> constantRoutes = [  <br>&#123;  <br><span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/redirect&#x27;</span>,  <br><span class="hljs-attr">component</span>: <span class="hljs-title class_">Layout</span>,  <br><span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span>,  <br><span class="hljs-attr">children</span>: [  <br>&#123;  <br><span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/redirect/:path(.*)&#x27;</span>,  <br><span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/redirect/index&#x27;</span>)  <br>&#125;  <br>]  <br>&#125;,  <br>&#123;  <br><span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/login&#x27;</span>,  <br><span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/login/index&#x27;</span>),  <br><span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span>  <br>&#125;,  <br>  <br>&#123;  <br><span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/404&#x27;</span>,  <br><span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/404&#x27;</span>),  <br><span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span>  <br>&#125;,  <br>  <br>&#123;  <br><span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/&#x27;</span>,  <br><span class="hljs-attr">component</span>: <span class="hljs-title class_">Layout</span>,  <br><span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/dashboard&#x27;</span>,  <br><span class="hljs-attr">children</span>: [&#123;  <br><span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;dashboard&#x27;</span>,  <br><span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Dashboard&#x27;</span>,  <br><span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/dashboard/index&#x27;</span>),  <br><span class="hljs-attr">meta</span>: &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;首 页&#x27;</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;dashboard&#x27;</span>, <span class="hljs-attr">affix</span>: <span class="hljs-literal">true</span> &#125;  <br>&#125;]  <br>&#125;,  <br>  <br><span class="hljs-comment">// &#123;  </span><br><span class="hljs-comment">// path: &#x27;/sys&#x27;,  </span><br><span class="hljs-comment">// component: Layout,  </span><br><span class="hljs-comment">// redirect: &#x27;/sys/user&#x27;,  </span><br><span class="hljs-comment">// name: &#x27;Sys&#x27;,  </span><br><span class="hljs-comment">// meta: &#123; title: &#x27;系统管理&#x27;, icon: &#x27;el-icon-s-help&#x27; &#125;,  </span><br><span class="hljs-comment">// children: [  </span><br><span class="hljs-comment">// &#123;  </span><br><span class="hljs-comment">// path: &#x27;user&#x27;,  </span><br><span class="hljs-comment">// name: &#x27;User&#x27;,  </span><br><span class="hljs-comment">// component: () =&gt; import(&#x27;@/views/sys/user&#x27;),  </span><br><span class="hljs-comment">// meta: &#123; title: &#x27;系统用户&#x27;, icon: &#x27;user&#x27; &#125;  </span><br><span class="hljs-comment">// &#125;,  </span><br><span class="hljs-comment">// &#123;  </span><br><span class="hljs-comment">// path: &#x27;role&#x27;,  </span><br><span class="hljs-comment">// name: &#x27;Role&#x27;,  </span><br><span class="hljs-comment">// component: () =&gt; import(&#x27;@/views/sys/role&#x27;),  </span><br><span class="hljs-comment">// meta: &#123; title: &#x27;系统身份&#x27;, icon: &#x27;tree&#x27; &#125;  </span><br><span class="hljs-comment">// &#125;  </span><br><span class="hljs-comment">// ]  </span><br><span class="hljs-comment">// &#125;,  </span><br><span class="hljs-comment">// &#123;  </span><br><span class="hljs-comment">// path: &#x27;/test&#x27;,  </span><br><span class="hljs-comment">// component: Layout,  </span><br><span class="hljs-comment">// redirect: &#x27;/test/test1&#x27;,  </span><br><span class="hljs-comment">// name: &#x27;Test&#x27;,  </span><br><span class="hljs-comment">// meta: &#123;  </span><br><span class="hljs-comment">// title: &#x27;新品尝鲜&#x27;,  </span><br><span class="hljs-comment">// icon: &#x27;nested&#x27;  </span><br><span class="hljs-comment">// &#125;,  </span><br><span class="hljs-comment">// children: [  </span><br><span class="hljs-comment">// &#123;  </span><br><span class="hljs-comment">// path: &#x27;test1&#x27;,  </span><br><span class="hljs-comment">// component: () =&gt; import(&#x27;@/views/test/test1&#x27;),  </span><br><span class="hljs-comment">// name: &#x27;Test1&#x27;,  </span><br><span class="hljs-comment">// meta: &#123; title: &#x27;功能1&#x27; &#125;  </span><br><span class="hljs-comment">// &#125;,  </span><br><span class="hljs-comment">// &#123;  </span><br><span class="hljs-comment">// path: &#x27;test2&#x27;,  </span><br><span class="hljs-comment">// component: () =&gt; import(&#x27;@/views/test/test2&#x27;),  </span><br><span class="hljs-comment">// name: &#x27;Test2&#x27;,  </span><br><span class="hljs-comment">// meta: &#123; title: &#x27;功能2&#x27; &#125;  </span><br><span class="hljs-comment">// &#125;,  </span><br><span class="hljs-comment">// &#123;  </span><br><span class="hljs-comment">// path: &#x27;test3&#x27;,  </span><br><span class="hljs-comment">// component: () =&gt; import(&#x27;@/views/test/test3&#x27;),  </span><br><span class="hljs-comment">// name: &#x27;Test3&#x27;,  </span><br><span class="hljs-comment">// meta: &#123; title: &#x27;功能3&#x27; &#125;  </span><br><span class="hljs-comment">// &#125;  </span><br><span class="hljs-comment">// ]  </span><br><span class="hljs-comment">// &#125;,  </span><br><span class="hljs-comment">//  </span><br><span class="hljs-comment">// &#123;  </span><br><span class="hljs-comment">// path: &#x27;external-link&#x27;,  </span><br><span class="hljs-comment">// component: Layout,  </span><br><span class="hljs-comment">// children: [  </span><br><span class="hljs-comment">// &#123;  </span><br><span class="hljs-comment">// path: &#x27;https://panjiachen.github.io/vue-element-admin-site/#/&#x27;,  </span><br><span class="hljs-comment">// meta: &#123; title: &#x27;External Link&#x27;, icon: &#x27;link&#x27; &#125;  </span><br><span class="hljs-comment">// &#125;  </span><br><span class="hljs-comment">// ]  </span><br><span class="hljs-comment">// &#125;,  </span><br>  <br><span class="hljs-comment">// 404 page must be placed at the end !!!  </span><br>&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/404&#x27;</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> &#125;  <br>]  <br>  <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">createRouter</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>(&#123;  <br><span class="hljs-comment">// mode: &#x27;history&#x27;, // require service support  </span><br><span class="hljs-attr">scrollBehavior</span>: <span class="hljs-function">() =&gt;</span> (&#123; <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> &#125;),  <br><span class="hljs-attr">routes</span>: constantRoutes  <br>&#125;)  <br>  <br><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>()  <br>  <br><span class="hljs-comment">// Detail see: https://github.com/vuejs/vue-router/issues/1234#issuecomment-357941465  </span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">resetRouter</span>(<span class="hljs-params"></span>) &#123;  <br><span class="hljs-keyword">const</span> newRouter = <span class="hljs-title function_">createRouter</span>()  <br>router.<span class="hljs-property">matcher</span> = newRouter.<span class="hljs-property">matcher</span> <span class="hljs-comment">// reset router  </span><br>&#125;  <br>  <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router<br><br></code></pre></td></tr></table></figure>

<h3 id="2-获取菜单数据并保存到Vuex"><a href="#2-获取菜单数据并保存到Vuex" class="headerlink" title="2.获取菜单数据并保存到Vuex"></a>2.获取菜单数据并保存到Vuex</h3><p>src&#x2F;store&#x2F;modules&#x2F;user.js<br><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031453650.png" srcset="/img/loading.gif" lazyload alt="image.png"><br><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031453642.png" srcset="/img/loading.gif" lazyload alt="image.png"><br><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031453615.png" srcset="/img/loading.gif" lazyload alt="image.png"><br>src&#x2F;store&#x2F;getters.js<br><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202310031454406.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<h3 id="3-路由转换"><a href="#3-路由转换" class="headerlink" title="3.路由转换"></a>3.路由转换</h3><p>修改src目录下的permiss.js<br>（1）导入Layout</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> layout <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/layout&#x27;</span><br></code></pre></td></tr></table></figure>
<p>（2）添加动态路由</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//路由转换  </span><br><span class="hljs-keyword">let</span> myRoutes = <span class="hljs-title function_">myFilterAsyncRoutes</span>(store.<span class="hljs-property">getters</span>.<span class="hljs-property">menuList</span>)  <br><span class="hljs-comment">// 404  </span><br>myRoutes.<span class="hljs-title function_">push</span>(&#123;  <br><span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;*&#x27;</span>,  <br><span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/404&#x27;</span>,  <br><span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span>  <br>&#125;)  <br><span class="hljs-comment">//动态添加路由  </span><br>router.<span class="hljs-title function_">addRoutes</span>(myRoutes)  <br><span class="hljs-comment">//存至全局变量  </span><br><span class="hljs-variable language_">global</span>.<span class="hljs-property">myRoutes</span> = myRoutes  <br>  <br><span class="hljs-title function_">next</span>(&#123; ...to, <span class="hljs-attr">replace</span>: <span class="hljs-literal">true</span> &#125;)<span class="hljs-comment">// 防止刷新后页面空白</span><br></code></pre></td></tr></table></figure>

<p>完整部分：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router&#x27;</span>  <br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span>  <br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Message</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;element-ui&#x27;</span>  <br><span class="hljs-keyword">import</span> <span class="hljs-title class_">NProgress</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;nprogress&#x27;</span> <span class="hljs-comment">// progress bar  </span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;nprogress/nprogress.css&#x27;</span> <span class="hljs-comment">// progress bar style  </span><br><span class="hljs-keyword">import</span> &#123; getToken &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/auth&#x27;</span> <span class="hljs-comment">// get token from cookie  </span><br><span class="hljs-keyword">import</span> getPageTitle <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/get-page-title&#x27;</span>  <br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Layout</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/layout&#x27;</span>  <br>  <br><span class="hljs-title class_">NProgress</span>.<span class="hljs-title function_">configure</span>(&#123; <span class="hljs-attr">showSpinner</span>: <span class="hljs-literal">false</span> &#125;) <span class="hljs-comment">// NProgress Configuration  </span><br>  <br><span class="hljs-keyword">const</span> whiteList = [<span class="hljs-string">&#x27;/login&#x27;</span>] <span class="hljs-comment">// no redirect whitelist  </span><br>  <br>router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-title function_">async</span>(to, <span class="hljs-keyword">from</span>, next) =&gt; &#123;  <br><span class="hljs-comment">// start progress bar  </span><br><span class="hljs-title class_">NProgress</span>.<span class="hljs-title function_">start</span>()  <br>  <br><span class="hljs-comment">// set page title  </span><br><span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-title function_">getPageTitle</span>(to.<span class="hljs-property">meta</span>.<span class="hljs-property">title</span>)  <br>  <br><span class="hljs-comment">// determine whether the user has logged in  </span><br><span class="hljs-keyword">const</span> hasToken = <span class="hljs-title function_">getToken</span>()  <br>  <br><span class="hljs-keyword">if</span> (hasToken) &#123;  <br><span class="hljs-keyword">if</span> (to.<span class="hljs-property">path</span> === <span class="hljs-string">&#x27;/login&#x27;</span>) &#123;  <br><span class="hljs-comment">// if is logged in, redirect to the home page  </span><br><span class="hljs-title function_">next</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/&#x27;</span> &#125;)  <br><span class="hljs-title class_">NProgress</span>.<span class="hljs-title function_">done</span>()  <br>&#125; <span class="hljs-keyword">else</span> &#123;  <br><span class="hljs-keyword">const</span> hasGetUserInfo = store.<span class="hljs-property">getters</span>.<span class="hljs-property">name</span>  <br><span class="hljs-keyword">if</span> (hasGetUserInfo) &#123;  <br><span class="hljs-title function_">next</span>()  <br>&#125; <span class="hljs-keyword">else</span> &#123;  <br><span class="hljs-keyword">try</span> &#123;  <br><span class="hljs-comment">// get user info  </span><br><span class="hljs-keyword">await</span> store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&#x27;user/getInfo&#x27;</span>)  <br><span class="hljs-comment">// console.log(store.getters.menuList)  </span><br><span class="hljs-comment">// 路由转换  </span><br><span class="hljs-keyword">const</span> myRoutes = <span class="hljs-title function_">myFilterAsyncRoutes</span>(store.<span class="hljs-property">getters</span>.<span class="hljs-property">menuList</span>)  <br><span class="hljs-comment">// 404  </span><br>myRoutes.<span class="hljs-title function_">push</span>(&#123;  <br><span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;*&#x27;</span>,  <br><span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/404&#x27;</span>,  <br><span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span>  <br>&#125;)  <br><span class="hljs-comment">// 动态添加路由  </span><br>router.<span class="hljs-title function_">addRoutes</span>(myRoutes)  <br><span class="hljs-comment">// 存至全局变量  </span><br><span class="hljs-variable language_">global</span>.<span class="hljs-property">myRoutes</span> = myRoutes  <br>  <br><span class="hljs-title function_">next</span>(&#123; ...to, <span class="hljs-attr">replace</span>: <span class="hljs-literal">true</span> &#125;)<span class="hljs-comment">// 防止刷新后页面空白  </span><br>  <br><span class="hljs-comment">// next()  </span><br>&#125; <span class="hljs-keyword">catch</span> (error) &#123;  <br><span class="hljs-comment">// remove token and go to login page to re-login  </span><br><span class="hljs-keyword">await</span> store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&#x27;user/resetToken&#x27;</span>)  <br><span class="hljs-comment">// Message.error(error || &#x27;Has Error&#x27;)  </span><br><span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(&#123; <span class="hljs-attr">message</span>: error || <span class="hljs-string">&#x27;Has Error&#x27;</span> &#125;)  <br><span class="hljs-title function_">next</span>(<span class="hljs-string">`/login?redirect=<span class="hljs-subst">$&#123;to.path&#125;</span>`</span>)  <br><span class="hljs-title class_">NProgress</span>.<span class="hljs-title function_">done</span>()  <br>&#125;  <br>&#125;  <br>&#125;  <br>&#125; <span class="hljs-keyword">else</span> &#123;  <br><span class="hljs-comment">/* has no token*/</span>  <br>  <br><span class="hljs-keyword">if</span> (whiteList.<span class="hljs-title function_">indexOf</span>(to.<span class="hljs-property">path</span>) !== -<span class="hljs-number">1</span>) &#123;  <br><span class="hljs-comment">// in the free login whitelist, go directly  </span><br><span class="hljs-title function_">next</span>()  <br>&#125; <span class="hljs-keyword">else</span> &#123;  <br><span class="hljs-comment">// other pages that do not have permission to access are redirected to the login page.  </span><br><span class="hljs-title function_">next</span>(<span class="hljs-string">`/login?redirect=<span class="hljs-subst">$&#123;to.path&#125;</span>`</span>)  <br><span class="hljs-title class_">NProgress</span>.<span class="hljs-title function_">done</span>()  <br>&#125;  <br>&#125;  <br>&#125;)  <br>  <br>router.<span class="hljs-title function_">afterEach</span>(<span class="hljs-function">() =&gt;</span> &#123;  <br><span class="hljs-comment">// finish progress bar  </span><br><span class="hljs-title class_">NProgress</span>.<span class="hljs-title function_">done</span>()  <br>&#125;)  <br>  <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">myFilterAsyncRoutes</span>(<span class="hljs-params">menuList</span>) &#123;  <br>menuList.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">menu</span> =&gt;</span> &#123;  <br><span class="hljs-comment">// console.log(menu)  </span><br><span class="hljs-keyword">if</span> (menu.<span class="hljs-property">component</span> === <span class="hljs-string">&#x27;Layout&#x27;</span>) &#123;  <br><span class="hljs-comment">// console.log(menu.component)  </span><br>menu.<span class="hljs-property">component</span> = <span class="hljs-title class_">Layout</span>  <br>&#125; <span class="hljs-keyword">else</span> &#123;  <br>menu.<span class="hljs-property">component</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">`@/views/<span class="hljs-subst">$&#123;menu.component&#125;</span>.vue`</span>).<span class="hljs-property">default</span>  <br>&#125;  <br><span class="hljs-comment">// 递归处理子菜单  </span><br><span class="hljs-keyword">if</span> (menu.<span class="hljs-property">children</span> &amp;&amp; menu.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>) &#123;  <br>menu.<span class="hljs-property">children</span> = <span class="hljs-title function_">myFilterAsyncRoutes</span>(menu.<span class="hljs-property">children</span>)  <br>&#125;  <br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>  <br>&#125;)  <br><span class="hljs-keyword">return</span> menuList  <br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="4-路由合并"><a href="#4-路由合并" class="headerlink" title="4.路由合并"></a>4.路由合并</h3><p>src&#x2F;layout&#x2F;components&#x2F;Sidebar&#x2F;index.vue</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">routes</span>(<span class="hljs-params"></span>) &#123;  <br><span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-property">options</span>.<span class="hljs-property">routes</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-variable language_">global</span>.<span class="hljs-property">myRoutes</span>)  <br>&#125;,<br><br></code></pre></td></tr></table></figure>




<h1 id="Vue-框架快速上手"><a href="#Vue-框架快速上手" class="headerlink" title="Vue 框架快速上手"></a>Vue 框架快速上手</h1><blockquote>
<p><strong>[[Vue]]</strong></p>
</blockquote>
<h2 id="1-前端环境准备"><a href="#1-前端环境准备" class="headerlink" title="1. 前端环境准备"></a>1. 前端环境准备</h2><p>Vscode 或者WebStorm</p>
<h2 id="2-Vue-框架介绍"><a href="#2-Vue-框架介绍" class="headerlink" title="2.Vue 框架介绍"></a>2.Vue 框架介绍</h2><p>尤雨溪制作的渐进式 js 框架</p>
<h2 id="3-Vue-快速入门"><a href="#3-Vue-快速入门" class="headerlink" title="3.Vue 快速入门"></a>3.Vue 快速入门</h2><ul>
<li>导入 vue. js 的 script 脚本文件</li>
</ul>
<p> <code>&lt;script src=&quot;https://unpkg.com/vue@next&quot;&gt;&lt;/script&gt;</code></p>
<ul>
<li>在页面中声明一个将要被 vue 所控制的 DOM 区域，既 MVVM 中的 View</li>
</ul>
<pre><code class="hljs">`&lt;div id=&quot;app&quot;&gt;
  &#123;&#123; message &#125;&#125;
&lt;/div&gt;`
</code></pre>
<ul>
<li>创建 vm 实例对象 (vue 实例对象)</li>
</ul>
<p><code>const hello = &#123;    //指定数据源，既 MVVM 中的 Mode1    data: function () &#123;       return &#123;          message: &#39;Hello Vue!&#39;       &#125; &#125; const app = Vue.createApp (hello) app. mount（&#39; #app &#39;）/／指定当前 vue 实例要控制页面的哪个区域</code></p>
<h1 id="7-项目部署"><a href="#7-项目部署" class="headerlink" title="7. 项目部署"></a>7. 项目部署</h1><h2 id="1-云端环境准备"><a href="#1-云端环境准备" class="headerlink" title="1. 云端环境准备"></a>1. 云端环境准备</h2><h3 id="安装-Mysql"><a href="#安装-Mysql" class="headerlink" title="安装 Mysql"></a>安装 Mysql</h3><table>
<thead>
<tr>
<th>环境</th>
<th>准备</th>
<th align="center"></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021153950.png" srcset="/img/loading.gif" lazyload/></td>
<td><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021200042.png" srcset="/img/loading.gif" lazyload/></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021206531.png" srcset="/img/loading.gif" lazyload alt="image.png"></td>
<td></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021214865.png" srcset="/img/loading.gif" lazyload alt="image.png"></td>
<td></td>
<td align="center"></td>
<td></td>
</tr>
</tbody></table>
<h3 id="安装-Nginx"><a href="#安装-Nginx" class="headerlink" title="安装 Nginx"></a>安装 Nginx</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install epel-release<br>yum update<br>yum -y install nginx<br></code></pre></td></tr></table></figure>

<p>nginx 命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl start nginx #开启nginx服务<br>systemctl stop nginx #停止nginx服务<br>systemctl restart nginx #重启nginx服务<br></code></pre></td></tr></table></figure>

<h3 id="配置-JDK"><a href="#配置-JDK" class="headerlink" title="配置 JDK"></a>配置 JDK</h3><p>下载 JDK，登录官方 <a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/downloads/java8%E4%B8%8B%E8%BD%BD%E6%89%80%E9%9C%80%E7%89%88%E6%9C%AC%E7%9A%84JDK">https://www.oracle.com/java/technologies/downloads/java8下载所需版本的JDK</a> ，版本为 JDK1.8</p>
<p><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021240929.png" srcset="/img/loading.gif" lazyload alt="image.png"><br>解压</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zvxf jdk-8u131-linux-x64.tar.gz<br></code></pre></td></tr></table></figure>

<p>编辑&#x2F;etc&#x2F;profile 文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi /etc/profile<br><span class="hljs-meta prompt_">#</span><span class="language-bash">文件末尾增加</span><br>export JAVA_HOME=/usr/server/jdk1.8.0_131<br></code></pre></td></tr></table></figure>

<p>执行 source 命令，使配置立即生效</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">source /etc/profile<br></code></pre></td></tr></table></figure>
<p>检查是否安装成功</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -version<br></code></pre></td></tr></table></figure>

<h2 id="项目部署"><a href="#项目部署" class="headerlink" title="项目部署"></a>项目部署</h2><h3 id="部署-Vue-项目"><a href="#部署-Vue-项目" class="headerlink" title="部署 Vue 项目"></a>部署 Vue 项目</h3><h4 id="打包-vue-项目"><a href="#打包-vue-项目" class="headerlink" title="打包 vue 项目"></a>打包 vue 项目</h4><p>进入到 Vue 项目目录，执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm run build<br></code></pre></td></tr></table></figure>
<p>将生成的 dist 目录上传至服务器&#x2F;usr&#x2F;vue&#x2F;dist</p>
<h4 id="配置-nginx"><a href="#配置-nginx" class="headerlink" title="配置 nginx"></a>配置 nginx</h4><p>进入到&#x2F;etc&#x2F;nginx&#x2F;conf.d 目录，创建 vue.conf 文件，内容如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs conf">server &#123;<br>   listen  80;<br>   server_name locahost;<br><br>   1ocation / &#123;<br>       root /usr/app/dist;<br>       index index.html;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>使配置生效</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">nginx -s reload<br></code></pre></td></tr></table></figure>

<h3 id="打包-Java-程序"><a href="#打包-Java-程序" class="headerlink" title="打包 Java 程序"></a>打包 Java 程序</h3><p><img src="https://raw.githubusercontent.com/Alleyf/PictureMap/main/web_icons/202308021501320.png" srcset="/img/loading.gif" lazyload alt="image.png"><br>因为 springboot 有内置 tomcat 容器，这点比较方便，省去了 tomcat 的部署。我们到时候直接可以直接把 jar 包扔到 linux 上</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">nohup java -jar demo-0.0.1-SNAPSHOT.jar &gt; logName.1og 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure>



<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><ol>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1nV4y1s7ZN/">1天搞定SpringBoot+Vue全栈开发_哔哩哔哩_bilibili</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/javaDeveloper2010/article/details/129119489">Springdoc和Springfox</a></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Java/" class="category-chain-item">Java</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/SpringBoot/">#SpringBoot</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>SpringBoot启示录</div>
      <div>https://alleyf.github.io/2023/04/218510a8c5b9.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>alleyf</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年4月28日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2023年10月5日</div>
        </div>
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/05/8e2ac1a55f44.html" title="OS">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">OS</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/04/fbae7fa42803.html" title="DRF速通">
                        <span class="hidden-mobile">DRF速通</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.7.2/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"636f2864e051a199b91c","clientSecret":"5185fd11115bbcd8d2f636bc80de6bed98ed14c1","repo":"Gitalk","owner":"Alleyf","admin":["Alleyf"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":false,"proxy":"https://shielded-brushlands-08810.herokuapp.com/https://github.com/login/oauth/access_token"},
          {
            id: '2c17aba5d9cf4d3b5aa470868462f798'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://github.com/Alleyf" target="_blank" rel="nofollow noopener"><span>Alleyf</span></a> <i class="iconfont icon-love"></i> <a href="https://fcsy.fit" target="_blank" rel="nofollow noopener"><span>Homepage</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      陕ICP备2022010038号
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=2022010038"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="http://qnpicmap.fcsluck.top/pics/202311161820757.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>陕公网安备2022010038号</span>
        </a>
      </span>
    
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/assets/mmedia/mmedia-loader.js"></script><!-- hexo injector body_end end --></body>
</html>
